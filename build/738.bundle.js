var Do=Object.defineProperty,Fo=Object.defineProperties;var Oo=Object.getOwnPropertyDescriptors;var bn=Object.getOwnPropertySymbols;var xo=Object.prototype.hasOwnProperty,bo=Object.prototype.propertyIsEnumerable;var vo=(It,Ot,st)=>Ot in It?Do(It,Ot,{enumerable:!0,configurable:!0,writable:!0,value:st}):It[Ot]=st,pe=(It,Ot)=>{for(var st in Ot||(Ot={}))xo.call(Ot,st)&&vo(It,st,Ot[st]);if(bn)for(var st of bn(Ot))bo.call(Ot,st)&&vo(It,st,Ot[st]);return It},pi=(It,Ot)=>Fo(It,Oo(Ot));var to=(It,Ot)=>{var st={};for(var d in It)xo.call(It,d)&&Ot.indexOf(d)<0&&(st[d]=It[d]);if(It!=null&&bn)for(var d of bn(It))Ot.indexOf(d)<0&&bo.call(It,d)&&(st[d]=It[d]);return st};var Lt=(It,Ot,st)=>new Promise((d,yt)=>{var nt=_t=>{try{it(st.next(_t))}catch(H){yt(H)}},Ct=_t=>{try{it(st.throw(_t))}catch(H){yt(H)}},it=_t=>_t.done?d(_t.value):Promise.resolve(_t.value).then(nt,Ct);it((st=st.apply(It,Ot)).next())});(self.webpackChunkstellar_odyssey=self.webpackChunkstellar_odyssey||[]).push([[738],{1924:function(It,Ot,st){"use strict";var d=st(210),yt=st(5559),nt=yt(d("String.prototype.indexOf"));It.exports=function(it,_t){var H=d(it,!!_t);return typeof H=="function"&&nt(it,".prototype.")>-1?yt(H):H}},5559:function(It,Ot,st){"use strict";var d=st(8612),yt=st(210),nt=st(7771),Ct=yt("%TypeError%"),it=yt("%Function.prototype.apply%"),_t=yt("%Function.prototype.call%"),H=yt("%Reflect.apply%",!0)||d.call(_t,it),J=yt("%Object.defineProperty%",!0),L=yt("%Math.max%");if(J)try{J({},"a",{value:1})}catch(z){J=null}It.exports=function(j){if(typeof j!="function")throw new Ct("a function is required");var tt=H(d,_t,arguments);return nt(tt,1+L(0,j.length-(arguments.length-1)),!0)};var P=function(){return H(d,it,arguments)};J?J(It.exports,"apply",{value:P}):It.exports.apply=P},2296:function(It,Ot,st){"use strict";var d=st(1044)(),yt=st(210),nt=d&&yt("%Object.defineProperty%",!0);if(nt)try{nt({},"a",{value:1})}catch(H){nt=!1}var Ct=yt("%SyntaxError%"),it=yt("%TypeError%"),_t=st(7296);It.exports=function(J,L,P){if(!J||typeof J!="object"&&typeof J!="function")throw new it("`obj` must be an object or a function`");if(typeof L!="string"&&typeof L!="symbol")throw new it("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new it("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new it("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new it("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new it("`loose`, if provided, must be a boolean");var z=arguments.length>3?arguments[3]:null,j=arguments.length>4?arguments[4]:null,tt=arguments.length>5?arguments[5]:null,k=arguments.length>6?arguments[6]:!1,mt=!!_t&&_t(J,L);if(nt)nt(J,L,{configurable:tt===null&&mt?mt.configurable:!tt,enumerable:z===null&&mt?mt.enumerable:!z,value:P,writable:j===null&&mt?mt.writable:!j});else if(k||!z&&!j&&!tt)J[L]=P;else throw new Ct("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}},9187:function(It){"use strict";It.exports=Ot,It.exports.default=Ot;function Ot(E,C,I){I=I||2;var X=C&&C.length,W=X?C[0]*I:E.length,R=st(E,0,W,I,!0),V=[];if(!R||R.next===R.prev)return V;var ot,xt,ct,pt,At,Et,Ft;if(X&&(R=H(E,C,R,I)),E.length>80*I){ot=ct=E[0],xt=pt=E[1];for(var St=I;St<W;St+=I)At=E[St],Et=E[St+1],At<ot&&(ot=At),Et<xt&&(xt=Et),At>ct&&(ct=At),Et>pt&&(pt=Et);Ft=Math.max(ct-ot,pt-xt),Ft=Ft!==0?32767/Ft:0}return yt(R,V,I,ot,xt,Ft,0),V}function st(E,C,I,X,W){var R,V;if(W===Z(E,C,I,X)>0)for(R=C;R<I;R+=X)V=G(R,E[R],E[R+1],V);else for(R=I-X;R>=C;R-=X)V=G(R,E[R],E[R+1],V);return V&&q(V,V.next)&&(Tt(V),V=V.next),V}function d(E,C){if(!E)return E;C||(C=E);var I=E,X;do if(X=!1,!I.steiner&&(q(I,I.next)||U(I.prev,I,I.next)===0)){if(Tt(I),I=C=I.prev,I===I.next)break;X=!0}else I=I.next;while(X||I!==C);return C}function yt(E,C,I,X,W,R,V){if(E){!V&&R&&j(E,X,W,R);for(var ot=E,xt,ct;E.prev!==E.next;){if(xt=E.prev,ct=E.next,R?Ct(E,X,W,R):nt(E)){C.push(xt.i/I|0),C.push(E.i/I|0),C.push(ct.i/I|0),Tt(E),E=ct.next,ot=ct.next;continue}if(E=ct,E===ot){V?V===1?(E=it(d(E),C,I),yt(E,C,I,X,W,R,2)):V===2&&_t(E,C,I,X,W,R):yt(d(E),C,I,X,W,R,1);break}}}}function nt(E){var C=E.prev,I=E,X=E.next;if(U(C,I,X)>=0)return!1;for(var W=C.x,R=I.x,V=X.x,ot=C.y,xt=I.y,ct=X.y,pt=W<R?W<V?W:V:R<V?R:V,At=ot<xt?ot<ct?ot:ct:xt<ct?xt:ct,Et=W>R?W>V?W:V:R>V?R:V,Ft=ot>xt?ot>ct?ot:ct:xt>ct?xt:ct,St=X.next;St!==C;){if(St.x>=pt&&St.x<=Et&&St.y>=At&&St.y<=Ft&&ht(W,ot,R,xt,V,ct,St.x,St.y)&&U(St.prev,St,St.next)>=0)return!1;St=St.next}return!0}function Ct(E,C,I,X){var W=E.prev,R=E,V=E.next;if(U(W,R,V)>=0)return!1;for(var ot=W.x,xt=R.x,ct=V.x,pt=W.y,At=R.y,Et=V.y,Ft=ot<xt?ot<ct?ot:ct:xt<ct?xt:ct,St=pt<At?pt<Et?pt:Et:At<Et?At:Et,zt=ot>xt?ot>ct?ot:ct:xt>ct?xt:ct,Xt=pt>At?pt>Et?pt:Et:At>Et?At:Et,bt=k(Ft,St,C,I,X),he=k(zt,Xt,C,I,X),Nt=E.prevZ,kt=E.nextZ;Nt&&Nt.z>=bt&&kt&&kt.z<=he;){if(Nt.x>=Ft&&Nt.x<=zt&&Nt.y>=St&&Nt.y<=Xt&&Nt!==W&&Nt!==V&&ht(ot,pt,xt,At,ct,Et,Nt.x,Nt.y)&&U(Nt.prev,Nt,Nt.next)>=0||(Nt=Nt.prevZ,kt.x>=Ft&&kt.x<=zt&&kt.y>=St&&kt.y<=Xt&&kt!==W&&kt!==V&&ht(ot,pt,xt,At,ct,Et,kt.x,kt.y)&&U(kt.prev,kt,kt.next)>=0))return!1;kt=kt.nextZ}for(;Nt&&Nt.z>=bt;){if(Nt.x>=Ft&&Nt.x<=zt&&Nt.y>=St&&Nt.y<=Xt&&Nt!==W&&Nt!==V&&ht(ot,pt,xt,At,ct,Et,Nt.x,Nt.y)&&U(Nt.prev,Nt,Nt.next)>=0)return!1;Nt=Nt.prevZ}for(;kt&&kt.z<=he;){if(kt.x>=Ft&&kt.x<=zt&&kt.y>=St&&kt.y<=Xt&&kt!==W&&kt!==V&&ht(ot,pt,xt,At,ct,Et,kt.x,kt.y)&&U(kt.prev,kt,kt.next)>=0)return!1;kt=kt.nextZ}return!0}function it(E,C,I){var X=E;do{var W=X.prev,R=X.next.next;!q(W,R)&&at(W,X,X.next,R)&&F(W,R)&&F(R,W)&&(C.push(W.i/I|0),C.push(X.i/I|0),C.push(R.i/I|0),Tt(X),Tt(X.next),X=E=R),X=X.next}while(X!==E);return d(X)}function _t(E,C,I,X,W,R){var V=E;do{for(var ot=V.next.next;ot!==V.prev;){if(V.i!==ot.i&&B(V,ot)){var xt=D(V,ot);V=d(V,V.next),xt=d(xt,xt.next),yt(V,C,I,X,W,R,0),yt(xt,C,I,X,W,R,0);return}ot=ot.next}V=V.next}while(V!==E)}function H(E,C,I,X){var W=[],R,V,ot,xt,ct;for(R=0,V=C.length;R<V;R++)ot=C[R]*X,xt=R<V-1?C[R+1]*X:E.length,ct=st(E,ot,xt,X,!1),ct===ct.next&&(ct.steiner=!0),W.push(mt(ct));for(W.sort(J),R=0;R<W.length;R++)I=L(W[R],I);return I}function J(E,C){return E.x-C.x}function L(E,C){var I=P(E,C);if(!I)return C;var X=D(I,E);return d(X,X.next),d(I,I.next)}function P(E,C){var I=C,X=E.x,W=E.y,R=-1/0,V;do{if(W<=I.y&&W>=I.next.y&&I.next.y!==I.y){var ot=I.x+(W-I.y)*(I.next.x-I.x)/(I.next.y-I.y);if(ot<=X&&ot>R&&(R=ot,V=I.x<I.next.x?I:I.next,ot===X))return V}I=I.next}while(I!==C);if(!V)return null;var xt=V,ct=V.x,pt=V.y,At=1/0,Et;I=V;do X>=I.x&&I.x>=ct&&X!==I.x&&ht(W<pt?X:R,W,ct,pt,W<pt?R:X,W,I.x,I.y)&&(Et=Math.abs(W-I.y)/(X-I.x),F(I,E)&&(Et<At||Et===At&&(I.x>V.x||I.x===V.x&&z(V,I)))&&(V=I,At=Et)),I=I.next;while(I!==xt);return V}function z(E,C){return U(E.prev,E,C.prev)<0&&U(C.next,E,E.next)<0}function j(E,C,I,X){var W=E;do W.z===0&&(W.z=k(W.x,W.y,C,I,X)),W.prevZ=W.prev,W.nextZ=W.next,W=W.next;while(W!==E);W.prevZ.nextZ=null,W.prevZ=null,tt(W)}function tt(E){var C,I,X,W,R,V,ot,xt,ct=1;do{for(I=E,E=null,R=null,V=0;I;){for(V++,X=I,ot=0,C=0;C<ct&&(ot++,X=X.nextZ,!!X);C++);for(xt=ct;ot>0||xt>0&&X;)ot!==0&&(xt===0||!X||I.z<=X.z)?(W=I,I=I.nextZ,ot--):(W=X,X=X.nextZ,xt--),R?R.nextZ=W:E=W,W.prevZ=R,R=W;I=X}R.nextZ=null,ct*=2}while(V>1);return E}function k(E,C,I,X,W){return E=(E-I)*W|0,C=(C-X)*W|0,E=(E|E<<8)&16711935,E=(E|E<<4)&252645135,E=(E|E<<2)&858993459,E=(E|E<<1)&1431655765,C=(C|C<<8)&16711935,C=(C|C<<4)&252645135,C=(C|C<<2)&858993459,C=(C|C<<1)&1431655765,E|C<<1}function mt(E){var C=E,I=E;do(C.x<I.x||C.x===I.x&&C.y<I.y)&&(I=C),C=C.next;while(C!==E);return I}function ht(E,C,I,X,W,R,V,ot){return(W-V)*(C-ot)>=(E-V)*(R-ot)&&(E-V)*(X-ot)>=(I-V)*(C-ot)&&(I-V)*(R-ot)>=(W-V)*(X-ot)}function B(E,C){return E.next.i!==C.i&&E.prev.i!==C.i&&!S(E,C)&&(F(E,C)&&F(C,E)&&_(E,C)&&(U(E.prev,E,C.prev)||U(E,C.prev,C))||q(E,C)&&U(E.prev,E,E.next)>0&&U(C.prev,C,C.next)>0)}function U(E,C,I){return(C.y-E.y)*(I.x-C.x)-(C.x-E.x)*(I.y-C.y)}function q(E,C){return E.x===C.x&&E.y===C.y}function at(E,C,I,X){var W=dt(U(E,C,I)),R=dt(U(E,C,X)),V=dt(U(I,X,E)),ot=dt(U(I,X,C));return!!(W!==R&&V!==ot||W===0&&rt(E,I,C)||R===0&&rt(E,X,C)||V===0&&rt(I,E,X)||ot===0&&rt(I,C,X))}function rt(E,C,I){return C.x<=Math.max(E.x,I.x)&&C.x>=Math.min(E.x,I.x)&&C.y<=Math.max(E.y,I.y)&&C.y>=Math.min(E.y,I.y)}function dt(E){return E>0?1:E<0?-1:0}function S(E,C){var I=E;do{if(I.i!==E.i&&I.next.i!==E.i&&I.i!==C.i&&I.next.i!==C.i&&at(I,I.next,E,C))return!0;I=I.next}while(I!==E);return!1}function F(E,C){return U(E.prev,E,E.next)<0?U(E,C,E.next)>=0&&U(E,E.prev,C)>=0:U(E,C,E.prev)<0||U(E,E.next,C)<0}function _(E,C){var I=E,X=!1,W=(E.x+C.x)/2,R=(E.y+C.y)/2;do I.y>R!=I.next.y>R&&I.next.y!==I.y&&W<(I.next.x-I.x)*(R-I.y)/(I.next.y-I.y)+I.x&&(X=!X),I=I.next;while(I!==E);return X}function D(E,C){var I=new wt(E.i,E.x,E.y),X=new wt(C.i,C.x,C.y),W=E.next,R=C.prev;return E.next=C,C.prev=E,I.next=W,W.prev=I,X.next=I,I.prev=X,R.next=X,X.prev=R,X}function G(E,C,I,X){var W=new wt(E,C,I);return X?(W.next=X.next,W.prev=X,X.next.prev=W,X.next=W):(W.prev=W,W.next=W),W}function Tt(E){E.next.prev=E.prev,E.prev.next=E.next,E.prevZ&&(E.prevZ.nextZ=E.nextZ),E.nextZ&&(E.nextZ.prevZ=E.prevZ)}function wt(E,C,I){this.i=E,this.x=C,this.y=I,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ot.deviation=function(E,C,I,X){var W=C&&C.length,R=W?C[0]*I:E.length,V=Math.abs(Z(E,0,R,I));if(W)for(var ot=0,xt=C.length;ot<xt;ot++){var ct=C[ot]*I,pt=ot<xt-1?C[ot+1]*I:E.length;V-=Math.abs(Z(E,ct,pt,I))}var At=0;for(ot=0;ot<X.length;ot+=3){var Et=X[ot]*I,Ft=X[ot+1]*I,St=X[ot+2]*I;At+=Math.abs((E[Et]-E[St])*(E[Ft+1]-E[Et+1])-(E[Et]-E[Ft])*(E[St+1]-E[Et+1]))}return V===0&&At===0?0:Math.abs((At-V)/V)};function Z(E,C,I,X){for(var W=0,R=C,V=I-X;R<I;R+=X)W+=(E[V]-E[R])*(E[R+1]+E[V+1]),V=R;return W}Ot.flatten=function(E){for(var C=E[0][0].length,I={vertices:[],holes:[],dimensions:C},X=0,W=0;W<E.length;W++){for(var R=0;R<E[W].length;R++)for(var V=0;V<C;V++)I.vertices.push(E[W][R][V]);W>0&&(X+=E[W-1].length,I.holes.push(X))}return I}},6729:function(It){"use strict";var Ot=Object.prototype.hasOwnProperty,st="~";function d(){}Object.create&&(d.prototype=Object.create(null),new d().__proto__||(st=!1));function yt(_t,H,J){this.fn=_t,this.context=H,this.once=J||!1}function nt(_t,H,J,L,P){if(typeof J!="function")throw new TypeError("The listener must be a function");var z=new yt(J,L||_t,P),j=st?st+H:H;return _t._events[j]?_t._events[j].fn?_t._events[j]=[_t._events[j],z]:_t._events[j].push(z):(_t._events[j]=z,_t._eventsCount++),_t}function Ct(_t,H){--_t._eventsCount===0?_t._events=new d:delete _t._events[H]}function it(){this._events=new d,this._eventsCount=0}it.prototype.eventNames=function(){var H=[],J,L;if(this._eventsCount===0)return H;for(L in J=this._events)Ot.call(J,L)&&H.push(st?L.slice(1):L);return Object.getOwnPropertySymbols?H.concat(Object.getOwnPropertySymbols(J)):H},it.prototype.listeners=function(H){var J=st?st+H:H,L=this._events[J];if(!L)return[];if(L.fn)return[L.fn];for(var P=0,z=L.length,j=new Array(z);P<z;P++)j[P]=L[P].fn;return j},it.prototype.listenerCount=function(H){var J=st?st+H:H,L=this._events[J];return L?L.fn?1:L.length:0},it.prototype.emit=function(H,J,L,P,z,j){var tt=st?st+H:H;if(!this._events[tt])return!1;var k=this._events[tt],mt=arguments.length,ht,B;if(k.fn){switch(k.once&&this.removeListener(H,k.fn,void 0,!0),mt){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,J),!0;case 3:return k.fn.call(k.context,J,L),!0;case 4:return k.fn.call(k.context,J,L,P),!0;case 5:return k.fn.call(k.context,J,L,P,z),!0;case 6:return k.fn.call(k.context,J,L,P,z,j),!0}for(B=1,ht=new Array(mt-1);B<mt;B++)ht[B-1]=arguments[B];k.fn.apply(k.context,ht)}else{var U=k.length,q;for(B=0;B<U;B++)switch(k[B].once&&this.removeListener(H,k[B].fn,void 0,!0),mt){case 1:k[B].fn.call(k[B].context);break;case 2:k[B].fn.call(k[B].context,J);break;case 3:k[B].fn.call(k[B].context,J,L);break;case 4:k[B].fn.call(k[B].context,J,L,P);break;default:if(!ht)for(q=1,ht=new Array(mt-1);q<mt;q++)ht[q-1]=arguments[q];k[B].fn.apply(k[B].context,ht)}}return!0},it.prototype.on=function(H,J,L){return nt(this,H,J,L,!1)},it.prototype.once=function(H,J,L){return nt(this,H,J,L,!0)},it.prototype.removeListener=function(H,J,L,P){var z=st?st+H:H;if(!this._events[z])return this;if(!J)return Ct(this,z),this;var j=this._events[z];if(j.fn)j.fn===J&&(!P||j.once)&&(!L||j.context===L)&&Ct(this,z);else{for(var tt=0,k=[],mt=j.length;tt<mt;tt++)(j[tt].fn!==J||P&&!j[tt].once||L&&j[tt].context!==L)&&k.push(j[tt]);k.length?this._events[z]=k.length===1?k[0]:k:Ct(this,z)}return this},it.prototype.removeAllListeners=function(H){var J;return H?(J=st?st+H:H,this._events[J]&&Ct(this,J)):(this._events=new d,this._eventsCount=0),this},it.prototype.off=it.prototype.removeListener,it.prototype.addListener=it.prototype.on,it.prefixed=st,it.EventEmitter=it,It.exports=it},7648:function(It){"use strict";var Ot="Function.prototype.bind called on incompatible ",st=Object.prototype.toString,d=Math.max,yt="[object Function]",nt=function(H,J){for(var L=[],P=0;P<H.length;P+=1)L[P]=H[P];for(var z=0;z<J.length;z+=1)L[z+H.length]=J[z];return L},Ct=function(H,J){for(var L=[],P=J||0,z=0;P<H.length;P+=1,z+=1)L[z]=H[P];return L},it=function(_t,H){for(var J="",L=0;L<_t.length;L+=1)J+=_t[L],L+1<_t.length&&(J+=H);return J};It.exports=function(H){var J=this;if(typeof J!="function"||st.apply(J)!==yt)throw new TypeError(Ot+J);for(var L=Ct(arguments,1),P,z=function(){if(this instanceof P){var ht=J.apply(this,nt(L,arguments));return Object(ht)===ht?ht:this}return J.apply(H,nt(L,arguments))},j=d(0,J.length-L.length),tt=[],k=0;k<j;k++)tt[k]="$"+k;if(P=Function("binder","return function ("+it(tt,",")+"){ return binder.apply(this,arguments); }")(z),J.prototype){var mt=function(){};mt.prototype=J.prototype,P.prototype=new mt,mt.prototype=null}return P}},8612:function(It,Ot,st){"use strict";var d=st(7648);It.exports=Function.prototype.bind||d},210:function(It,Ot,st){"use strict";var d,yt=SyntaxError,nt=Function,Ct=TypeError,it=function(wt){try{return nt('"use strict"; return ('+wt+").constructor;")()}catch(Z){}},_t=Object.getOwnPropertyDescriptor;if(_t)try{_t({},"")}catch(wt){_t=null}var H=function(){throw new Ct},J=_t?function(){try{return arguments.callee,H}catch(wt){try{return _t(arguments,"callee").get}catch(Z){return H}}}():H,L=st(1405)(),P=st(8185)(),z=Object.getPrototypeOf||(P?function(wt){return wt.__proto__}:null),j={},tt=typeof Uint8Array=="undefined"||!z?d:z(Uint8Array),k={"%AggregateError%":typeof AggregateError=="undefined"?d:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?d:ArrayBuffer,"%ArrayIteratorPrototype%":L&&z?z([][Symbol.iterator]()):d,"%AsyncFromSyncIteratorPrototype%":d,"%AsyncFunction%":j,"%AsyncGenerator%":j,"%AsyncGeneratorFunction%":j,"%AsyncIteratorPrototype%":j,"%Atomics%":typeof Atomics=="undefined"?d:Atomics,"%BigInt%":typeof BigInt=="undefined"?d:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?d:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?d:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?d:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?d:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?d:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?d:FinalizationRegistry,"%Function%":nt,"%GeneratorFunction%":j,"%Int8Array%":typeof Int8Array=="undefined"?d:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?d:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?d:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":L&&z?z(z([][Symbol.iterator]())):d,"%JSON%":typeof JSON=="object"?JSON:d,"%Map%":typeof Map=="undefined"?d:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!L||!z?d:z(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?d:Promise,"%Proxy%":typeof Proxy=="undefined"?d:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?d:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?d:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!L||!z?d:z(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?d:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":L&&z?z(""[Symbol.iterator]()):d,"%Symbol%":L?Symbol:d,"%SyntaxError%":yt,"%ThrowTypeError%":J,"%TypedArray%":tt,"%TypeError%":Ct,"%Uint8Array%":typeof Uint8Array=="undefined"?d:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?d:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?d:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?d:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?d:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?d:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?d:WeakSet};if(z)try{null.error}catch(wt){var mt=z(z(wt));k["%Error.prototype%"]=mt}var ht=function wt(Z){var E;if(Z==="%AsyncFunction%")E=it("async function () {}");else if(Z==="%GeneratorFunction%")E=it("function* () {}");else if(Z==="%AsyncGeneratorFunction%")E=it("async function* () {}");else if(Z==="%AsyncGenerator%"){var C=wt("%AsyncGeneratorFunction%");C&&(E=C.prototype)}else if(Z==="%AsyncIteratorPrototype%"){var I=wt("%AsyncGenerator%");I&&z&&(E=z(I.prototype))}return k[Z]=E,E},B={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},U=st(8612),q=st(8824),at=U.call(Function.call,Array.prototype.concat),rt=U.call(Function.apply,Array.prototype.splice),dt=U.call(Function.call,String.prototype.replace),S=U.call(Function.call,String.prototype.slice),F=U.call(Function.call,RegExp.prototype.exec),_=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,D=/\\(\\)?/g,G=function(Z){var E=S(Z,0,1),C=S(Z,-1);if(E==="%"&&C!=="%")throw new yt("invalid intrinsic syntax, expected closing `%`");if(C==="%"&&E!=="%")throw new yt("invalid intrinsic syntax, expected opening `%`");var I=[];return dt(Z,_,function(X,W,R,V){I[I.length]=R?dt(V,D,"$1"):W||X}),I},Tt=function(Z,E){var C=Z,I;if(q(B,C)&&(I=B[C],C="%"+I[0]+"%"),q(k,C)){var X=k[C];if(X===j&&(X=ht(C)),typeof X=="undefined"&&!E)throw new Ct("intrinsic "+Z+" exists, but is not available. Please file an issue!");return{alias:I,name:C,value:X}}throw new yt("intrinsic "+Z+" does not exist!")};It.exports=function(Z,E){if(typeof Z!="string"||Z.length===0)throw new Ct("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof E!="boolean")throw new Ct('"allowMissing" argument must be a boolean');if(F(/^%?[^%]*%?$/,Z)===null)throw new yt("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var C=G(Z),I=C.length>0?C[0]:"",X=Tt("%"+I+"%",E),W=X.name,R=X.value,V=!1,ot=X.alias;ot&&(I=ot[0],rt(C,at([0,1],ot)));for(var xt=1,ct=!0;xt<C.length;xt+=1){var pt=C[xt],At=S(pt,0,1),Et=S(pt,-1);if((At==='"'||At==="'"||At==="`"||Et==='"'||Et==="'"||Et==="`")&&At!==Et)throw new yt("property names with quotes must have matching quotes");if((pt==="constructor"||!ct)&&(V=!0),I+="."+pt,W="%"+I+"%",q(k,W))R=k[W];else if(R!=null){if(!(pt in R)){if(!E)throw new Ct("base intrinsic for "+Z+" exists, but the property is not available.");return}if(_t&&xt+1>=C.length){var Ft=_t(R,pt);ct=!!Ft,ct&&"get"in Ft&&!("originalValue"in Ft.get)?R=Ft.get:R=R[pt]}else ct=q(R,pt),R=R[pt];ct&&!V&&(k[W]=R)}}return R}},7296:function(It,Ot,st){"use strict";var d=st(210),yt=d("%Object.getOwnPropertyDescriptor%",!0);if(yt)try{yt([],"length")}catch(nt){yt=null}It.exports=yt},1044:function(It,Ot,st){"use strict";var d=st(210),yt=d("%Object.defineProperty%",!0),nt=function(){if(yt)try{return yt({},"a",{value:1}),!0}catch(it){return!1}return!1};nt.hasArrayLengthDefineBug=function(){if(!nt())return null;try{return yt([],"length",{value:1}).length!==1}catch(it){return!0}},It.exports=nt},8185:function(It){"use strict";var Ot={foo:{}},st=Object;It.exports=function(){return{__proto__:Ot}.foo===Ot.foo&&!({__proto__:null}instanceof st)}},1405:function(It,Ot,st){"use strict";var d=typeof Symbol!="undefined"&&Symbol,yt=st(5419);It.exports=function(){return typeof d!="function"||typeof Symbol!="function"||typeof d("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:yt()}},5419:function(It){"use strict";It.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var st={},d=Symbol("test"),yt=Object(d);if(typeof d=="string"||Object.prototype.toString.call(d)!=="[object Symbol]"||Object.prototype.toString.call(yt)!=="[object Symbol]")return!1;var nt=42;st[d]=nt;for(d in st)return!1;if(typeof Object.keys=="function"&&Object.keys(st).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(st).length!==0)return!1;var Ct=Object.getOwnPropertySymbols(st);if(Ct.length!==1||Ct[0]!==d||!Object.prototype.propertyIsEnumerable.call(st,d))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var it=Object.getOwnPropertyDescriptor(st,d);if(it.value!==nt||it.enumerable!==!0)return!1}return!0}},8824:function(It,Ot,st){"use strict";var d=Function.prototype.call,yt=Object.prototype.hasOwnProperty,nt=st(8612);It.exports=nt.call(d,yt)},631:function(It,Ot,st){var d=typeof Map=="function"&&Map.prototype,yt=Object.getOwnPropertyDescriptor&&d?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,nt=d&&yt&&typeof yt.get=="function"?yt.get:null,Ct=d&&Map.prototype.forEach,it=typeof Set=="function"&&Set.prototype,_t=Object.getOwnPropertyDescriptor&&it?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,H=it&&_t&&typeof _t.get=="function"?_t.get:null,J=it&&Set.prototype.forEach,L=typeof WeakMap=="function"&&WeakMap.prototype,P=L?WeakMap.prototype.has:null,z=typeof WeakSet=="function"&&WeakSet.prototype,j=z?WeakSet.prototype.has:null,tt=typeof WeakRef=="function"&&WeakRef.prototype,k=tt?WeakRef.prototype.deref:null,mt=Boolean.prototype.valueOf,ht=Object.prototype.toString,B=Function.prototype.toString,U=String.prototype.match,q=String.prototype.slice,at=String.prototype.replace,rt=String.prototype.toUpperCase,dt=String.prototype.toLowerCase,S=RegExp.prototype.test,F=Array.prototype.concat,_=Array.prototype.join,D=Array.prototype.slice,G=Math.floor,Tt=typeof BigInt=="function"?BigInt.prototype.valueOf:null,wt=Object.getOwnPropertySymbols,Z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,E=typeof Symbol=="function"&&typeof Symbol.iterator=="object",C=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===E||"symbol")?Symbol.toStringTag:null,I=Object.prototype.propertyIsEnumerable,X=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(Y){return Y.__proto__}:null);function W(Y,Q){if(Y===1/0||Y===-1/0||Y!==Y||Y&&Y>-1e3&&Y<1e3||S.call(/e/,Q))return Q;var Jt=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof Y=="number"){var ie=Y<0?-G(-Y):G(Y);if(ie!==Y){var me=String(ie),qt=q.call(Q,me.length+1);return at.call(me,Jt,"$&_")+"."+at.call(at.call(qt,/([0-9]{3})/g,"$&_"),/_$/,"")}}return at.call(Q,Jt,"$&_")}var R=st(4654),V=R.custom,ot=bt(V)?V:null;It.exports=function Y(Q,Jt,ie,me){var qt=Jt||{};if(kt(qt,"quoteStyle")&&qt.quoteStyle!=="single"&&qt.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(kt(qt,"maxStringLength")&&(typeof qt.maxStringLength=="number"?qt.maxStringLength<0&&qt.maxStringLength!==1/0:qt.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var De=kt(qt,"customInspect")?qt.customInspect:!0;if(typeof De!="boolean"&&De!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(kt(qt,"indent")&&qt.indent!==null&&qt.indent!=="	"&&!(parseInt(qt.indent,10)===qt.indent&&qt.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(kt(qt,"numericSeparator")&&typeof qt.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var er=qt.numericSeparator;if(typeof Q=="undefined")return"undefined";if(Q===null)return"null";if(typeof Q=="boolean")return Q?"true":"false";if(typeof Q=="string")return qr(Q,qt);if(typeof Q=="number"){if(Q===0)return 1/0/Q>0?"0":"-0";var Me=String(Q);return er?W(Q,Me):Me}if(typeof Q=="bigint"){var je=String(Q)+"n";return er?W(Q,je):je}var Zr=typeof qt.depth=="undefined"?5:qt.depth;if(typeof ie=="undefined"&&(ie=0),ie>=Zr&&Zr>0&&typeof Q=="object")return pt(Q)?"[Array]":"[Object]";var He=mi(qt,ie);if(typeof me=="undefined")me=[];else if(Ue(me,Q)>=0)return"[Circular]";function Se(ar,xr,ti){if(xr&&(me=D.call(me),me.push(xr)),ti){var _i={depth:qt.depth};return kt(qt,"quoteStyle")&&(_i.quoteStyle=qt.quoteStyle),Y(ar,_i,ie+1,me)}return Y(ar,qt,ie+1,me)}if(typeof Q=="function"&&!Et(Q)){var Qr=Ge(Q),$i=Lr(Q,Se);return"[Function"+(Qr?": "+Qr:" (anonymous)")+"]"+($i.length>0?" { "+_.call($i,", ")+" }":"")}if(bt(Q)){var Nr=E?at.call(String(Q),/^(Symbol\(.*\))_[^)]*$/,"$1"):Z.call(Q);return typeof Q=="object"&&!E?Ee(Nr):Nr}if(Re(Q)){for(var Xe="<"+dt.call(String(Q.nodeName)),Ur=Q.attributes||[],Ye=0;Ye<Ur.length;Ye++)Xe+=" "+Ur[Ye].name+"="+xt(ct(Ur[Ye].value),"double",qt);return Xe+=">",Q.childNodes&&Q.childNodes.length&&(Xe+="..."),Xe+="</"+dt.call(String(Q.nodeName))+">",Xe}if(pt(Q)){if(Q.length===0)return"[]";var we=Lr(Q,Se);return He&&!tr(we)?"["+vr(we,He)+"]":"[ "+_.call(we,", ")+" ]"}if(Ft(Q)){var kr=Lr(Q,Se);return!("cause"in Error.prototype)&&"cause"in Q&&!I.call(Q,"cause")?"{ ["+String(Q)+"] "+_.call(F.call("[cause]: "+Se(Q.cause),kr),", ")+" }":kr.length===0?"["+String(Q)+"]":"{ ["+String(Q)+"] "+_.call(kr,", ")+" }"}if(typeof Q=="object"&&De){if(ot&&typeof Q[ot]=="function"&&R)return R(Q,{depth:Zr-ie});if(De!=="symbol"&&typeof Q.inspect=="function")return Q.inspect()}if(Pe(Q)){var gi=[];return Ct&&Ct.call(Q,function(ar,xr){gi.push(Se(xr,Q,!0)+" => "+Se(ar,Q))}),de("Map",nt.call(Q),gi,He)}if(zi(Q)){var ji=[];return J&&J.call(Q,function(ar){ji.push(Se(ar,Q))}),de("Set",H.call(Q),ji,He)}if(ee(Q))return _e("WeakMap");if($e(Q))return _e("WeakSet");if(Le(Q))return _e("WeakRef");if(zt(Q))return Ee(Se(Number(Q)));if(he(Q))return Ee(Se(Tt.call(Q)));if(Xt(Q))return Ee(mt.call(Q));if(St(Q))return Ee(Se(String(Q)));if(typeof window!="undefined"&&Q===window)return"{ [object Window] }";if(Q===st.g)return"{ [object globalThis] }";if(!At(Q)&&!Et(Q)){var or=Lr(Q,Se),rr=X?X(Q)===Object.prototype:Q instanceof Object||Q.constructor===Object,Ce=Q instanceof Object?"":"null prototype",yi=!rr&&C&&Object(Q)===Q&&C in Q?q.call(ye(Q),8,-1):Ce?"Object":"",Yi=rr||typeof Q.constructor!="function"?"":Q.constructor.name?Q.constructor.name+" ":"",Jr=Yi+(yi||Ce?"["+_.call(F.call([],yi||[],Ce||[]),": ")+"] ":"");return or.length===0?Jr+"{}":He?Jr+"{"+vr(or,He)+"}":Jr+"{ "+_.call(or,", ")+" }"}return String(Q)};function xt(Y,Q,Jt){var ie=(Jt.quoteStyle||Q)==="double"?'"':"'";return ie+Y+ie}function ct(Y){return at.call(String(Y),/"/g,"&quot;")}function pt(Y){return ye(Y)==="[object Array]"&&(!C||!(typeof Y=="object"&&C in Y))}function At(Y){return ye(Y)==="[object Date]"&&(!C||!(typeof Y=="object"&&C in Y))}function Et(Y){return ye(Y)==="[object RegExp]"&&(!C||!(typeof Y=="object"&&C in Y))}function Ft(Y){return ye(Y)==="[object Error]"&&(!C||!(typeof Y=="object"&&C in Y))}function St(Y){return ye(Y)==="[object String]"&&(!C||!(typeof Y=="object"&&C in Y))}function zt(Y){return ye(Y)==="[object Number]"&&(!C||!(typeof Y=="object"&&C in Y))}function Xt(Y){return ye(Y)==="[object Boolean]"&&(!C||!(typeof Y=="object"&&C in Y))}function bt(Y){if(E)return Y&&typeof Y=="object"&&Y instanceof Symbol;if(typeof Y=="symbol")return!0;if(!Y||typeof Y!="object"||!Z)return!1;try{return Z.call(Y),!0}catch(Q){}return!1}function he(Y){if(!Y||typeof Y!="object"||!Tt)return!1;try{return Tt.call(Y),!0}catch(Q){}return!1}var Nt=Object.prototype.hasOwnProperty||function(Y){return Y in this};function kt(Y,Q){return Nt.call(Y,Q)}function ye(Y){return ht.call(Y)}function Ge(Y){if(Y.name)return Y.name;var Q=U.call(B.call(Y),/^function\s*([\w$]+)/);return Q?Q[1]:null}function Ue(Y,Q){if(Y.indexOf)return Y.indexOf(Q);for(var Jt=0,ie=Y.length;Jt<ie;Jt++)if(Y[Jt]===Q)return Jt;return-1}function Pe(Y){if(!nt||!Y||typeof Y!="object")return!1;try{nt.call(Y);try{H.call(Y)}catch(Q){return!0}return Y instanceof Map}catch(Q){}return!1}function ee(Y){if(!P||!Y||typeof Y!="object")return!1;try{P.call(Y,P);try{j.call(Y,j)}catch(Q){return!0}return Y instanceof WeakMap}catch(Q){}return!1}function Le(Y){if(!k||!Y||typeof Y!="object")return!1;try{return k.call(Y),!0}catch(Q){}return!1}function zi(Y){if(!H||!Y||typeof Y!="object")return!1;try{H.call(Y);try{nt.call(Y)}catch(Q){return!0}return Y instanceof Set}catch(Q){}return!1}function $e(Y){if(!j||!Y||typeof Y!="object")return!1;try{j.call(Y,j);try{P.call(Y,P)}catch(Q){return!0}return Y instanceof WeakSet}catch(Q){}return!1}function Re(Y){return!Y||typeof Y!="object"?!1:typeof HTMLElement!="undefined"&&Y instanceof HTMLElement?!0:typeof Y.nodeName=="string"&&typeof Y.getAttribute=="function"}function qr(Y,Q){if(Y.length>Q.maxStringLength){var Jt=Y.length-Q.maxStringLength,ie="... "+Jt+" more character"+(Jt>1?"s":"");return qr(q.call(Y,0,Q.maxStringLength),Q)+ie}var me=at.call(at.call(Y,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Je);return xt(me,"single",Q)}function Je(Y){var Q=Y.charCodeAt(0),Jt={8:"b",9:"t",10:"n",12:"f",13:"r"}[Q];return Jt?"\\"+Jt:"\\x"+(Q<16?"0":"")+rt.call(Q.toString(16))}function Ee(Y){return"Object("+Y+")"}function _e(Y){return Y+" { ? }"}function de(Y,Q,Jt,ie){var me=ie?vr(Jt,ie):_.call(Jt,", ");return Y+" ("+Q+") {"+me+"}"}function tr(Y){for(var Q=0;Q<Y.length;Q++)if(Ue(Y[Q],`
`)>=0)return!1;return!0}function mi(Y,Q){var Jt;if(Y.indent==="	")Jt="	";else if(typeof Y.indent=="number"&&Y.indent>0)Jt=_.call(Array(Y.indent+1)," ");else return null;return{base:Jt,prev:_.call(Array(Q+1),Jt)}}function vr(Y,Q){if(Y.length===0)return"";var Jt=`
`+Q.prev+Q.base;return Jt+_.call(Y,","+Jt)+`
`+Q.prev}function Lr(Y,Q){var Jt=pt(Y),ie=[];if(Jt){ie.length=Y.length;for(var me=0;me<Y.length;me++)ie[me]=kt(Y,me)?Q(Y[me],Y):""}var qt=typeof wt=="function"?wt(Y):[],De;if(E){De={};for(var er=0;er<qt.length;er++)De["$"+qt[er]]=qt[er]}for(var Me in Y)kt(Y,Me)&&(Jt&&String(Number(Me))===Me&&Me<Y.length||E&&De["$"+Me]instanceof Symbol||(S.call(/[^\w$]/,Me)?ie.push(Q(Me,Y)+": "+Q(Y[Me],Y)):ie.push(Me+": "+Q(Y[Me],Y))));if(typeof wt=="function")for(var je=0;je<qt.length;je++)I.call(Y,qt[je])&&ie.push("["+Q(qt[je])+"]: "+Q(Y[qt[je]],Y));return ie}},5798:function(It){"use strict";var Ot=String.prototype.replace,st=/%20/g,d={RFC1738:"RFC1738",RFC3986:"RFC3986"};It.exports={default:d.RFC3986,formatters:{RFC1738:function(yt){return Ot.call(yt,st,"+")},RFC3986:function(yt){return String(yt)}},RFC1738:d.RFC1738,RFC3986:d.RFC3986}},129:function(It,Ot,st){"use strict";var d=st(8261),yt=st(5235),nt=st(5798);It.exports={formats:nt,parse:yt,stringify:d}},5235:function(It,Ot,st){"use strict";var d=st(2769),yt=Object.prototype.hasOwnProperty,nt=Array.isArray,Ct={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:d.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},it=function(tt){return tt.replace(/&#(\d+);/g,function(k,mt){return String.fromCharCode(parseInt(mt,10))})},_t=function(tt,k){return tt&&typeof tt=="string"&&k.comma&&tt.indexOf(",")>-1?tt.split(","):tt},H="utf8=%26%2310003%3B",J="utf8=%E2%9C%93",L=function(k,mt){var ht={__proto__:null},B=mt.ignoreQueryPrefix?k.replace(/^\?/,""):k,U=mt.parameterLimit===1/0?void 0:mt.parameterLimit,q=B.split(mt.delimiter,U),at=-1,rt,dt=mt.charset;if(mt.charsetSentinel)for(rt=0;rt<q.length;++rt)q[rt].indexOf("utf8=")===0&&(q[rt]===J?dt="utf-8":q[rt]===H&&(dt="iso-8859-1"),at=rt,rt=q.length);for(rt=0;rt<q.length;++rt)if(rt!==at){var S=q[rt],F=S.indexOf("]="),_=F===-1?S.indexOf("="):F+1,D,G;_===-1?(D=mt.decoder(S,Ct.decoder,dt,"key"),G=mt.strictNullHandling?null:""):(D=mt.decoder(S.slice(0,_),Ct.decoder,dt,"key"),G=d.maybeMap(_t(S.slice(_+1),mt),function(Tt){return mt.decoder(Tt,Ct.decoder,dt,"value")})),G&&mt.interpretNumericEntities&&dt==="iso-8859-1"&&(G=it(G)),S.indexOf("[]=")>-1&&(G=nt(G)?[G]:G),yt.call(ht,D)?ht[D]=d.combine(ht[D],G):ht[D]=G}return ht},P=function(tt,k,mt,ht){for(var B=ht?k:_t(k,mt),U=tt.length-1;U>=0;--U){var q,at=tt[U];if(at==="[]"&&mt.parseArrays)q=[].concat(B);else{q=mt.plainObjects?Object.create(null):{};var rt=at.charAt(0)==="["&&at.charAt(at.length-1)==="]"?at.slice(1,-1):at,dt=parseInt(rt,10);!mt.parseArrays&&rt===""?q={0:B}:!isNaN(dt)&&at!==rt&&String(dt)===rt&&dt>=0&&mt.parseArrays&&dt<=mt.arrayLimit?(q=[],q[dt]=B):rt!=="__proto__"&&(q[rt]=B)}B=q}return B},z=function(k,mt,ht,B){if(k){var U=ht.allowDots?k.replace(/\.([^.[]+)/g,"[$1]"):k,q=/(\[[^[\]]*])/,at=/(\[[^[\]]*])/g,rt=ht.depth>0&&q.exec(U),dt=rt?U.slice(0,rt.index):U,S=[];if(dt){if(!ht.plainObjects&&yt.call(Object.prototype,dt)&&!ht.allowPrototypes)return;S.push(dt)}for(var F=0;ht.depth>0&&(rt=at.exec(U))!==null&&F<ht.depth;){if(F+=1,!ht.plainObjects&&yt.call(Object.prototype,rt[1].slice(1,-1))&&!ht.allowPrototypes)return;S.push(rt[1])}return rt&&S.push("["+U.slice(rt.index)+"]"),P(S,mt,ht,B)}},j=function(k){if(!k)return Ct;if(k.decoder!==null&&k.decoder!==void 0&&typeof k.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof k.charset!="undefined"&&k.charset!=="utf-8"&&k.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var mt=typeof k.charset=="undefined"?Ct.charset:k.charset;return{allowDots:typeof k.allowDots=="undefined"?Ct.allowDots:!!k.allowDots,allowPrototypes:typeof k.allowPrototypes=="boolean"?k.allowPrototypes:Ct.allowPrototypes,allowSparse:typeof k.allowSparse=="boolean"?k.allowSparse:Ct.allowSparse,arrayLimit:typeof k.arrayLimit=="number"?k.arrayLimit:Ct.arrayLimit,charset:mt,charsetSentinel:typeof k.charsetSentinel=="boolean"?k.charsetSentinel:Ct.charsetSentinel,comma:typeof k.comma=="boolean"?k.comma:Ct.comma,decoder:typeof k.decoder=="function"?k.decoder:Ct.decoder,delimiter:typeof k.delimiter=="string"||d.isRegExp(k.delimiter)?k.delimiter:Ct.delimiter,depth:typeof k.depth=="number"||k.depth===!1?+k.depth:Ct.depth,ignoreQueryPrefix:k.ignoreQueryPrefix===!0,interpretNumericEntities:typeof k.interpretNumericEntities=="boolean"?k.interpretNumericEntities:Ct.interpretNumericEntities,parameterLimit:typeof k.parameterLimit=="number"?k.parameterLimit:Ct.parameterLimit,parseArrays:k.parseArrays!==!1,plainObjects:typeof k.plainObjects=="boolean"?k.plainObjects:Ct.plainObjects,strictNullHandling:typeof k.strictNullHandling=="boolean"?k.strictNullHandling:Ct.strictNullHandling}};It.exports=function(tt,k){var mt=j(k);if(tt===""||tt===null||typeof tt=="undefined")return mt.plainObjects?Object.create(null):{};for(var ht=typeof tt=="string"?L(tt,mt):tt,B=mt.plainObjects?Object.create(null):{},U=Object.keys(ht),q=0;q<U.length;++q){var at=U[q],rt=z(at,ht[at],mt,typeof tt=="string");B=d.merge(B,rt,mt)}return mt.allowSparse===!0?B:d.compact(B)}},8261:function(It,Ot,st){"use strict";var d=st(7478),yt=st(2769),nt=st(5798),Ct=Object.prototype.hasOwnProperty,it={brackets:function(B){return B+"[]"},comma:"comma",indices:function(B,U){return B+"["+U+"]"},repeat:function(B){return B}},_t=Array.isArray,H=Array.prototype.push,J=function(ht,B){H.apply(ht,_t(B)?B:[B])},L=Date.prototype.toISOString,P=nt.default,z={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:yt.encode,encodeValuesOnly:!1,format:P,formatter:nt.formatters[P],indices:!1,serializeDate:function(B){return L.call(B)},skipNulls:!1,strictNullHandling:!1},j=function(B){return typeof B=="string"||typeof B=="number"||typeof B=="boolean"||typeof B=="symbol"||typeof B=="bigint"},tt={},k=function ht(B,U,q,at,rt,dt,S,F,_,D,G,Tt,wt,Z,E,C){for(var I=B,X=C,W=0,R=!1;(X=X.get(tt))!==void 0&&!R;){var V=X.get(B);if(W+=1,typeof V!="undefined"){if(V===W)throw new RangeError("Cyclic object value");R=!0}typeof X.get(tt)=="undefined"&&(W=0)}if(typeof F=="function"?I=F(U,I):I instanceof Date?I=G(I):q==="comma"&&_t(I)&&(I=yt.maybeMap(I,function(bt){return bt instanceof Date?G(bt):bt})),I===null){if(rt)return S&&!Z?S(U,z.encoder,E,"key",Tt):U;I=""}if(j(I)||yt.isBuffer(I)){if(S){var ot=Z?U:S(U,z.encoder,E,"key",Tt);return[wt(ot)+"="+wt(S(I,z.encoder,E,"value",Tt))]}return[wt(U)+"="+wt(String(I))]}var xt=[];if(typeof I=="undefined")return xt;var ct;if(q==="comma"&&_t(I))Z&&S&&(I=yt.maybeMap(I,S)),ct=[{value:I.length>0?I.join(",")||null:void 0}];else if(_t(F))ct=F;else{var pt=Object.keys(I);ct=_?pt.sort(_):pt}for(var At=at&&_t(I)&&I.length===1?U+"[]":U,Et=0;Et<ct.length;++Et){var Ft=ct[Et],St=typeof Ft=="object"&&typeof Ft.value!="undefined"?Ft.value:I[Ft];if(!(dt&&St===null)){var zt=_t(I)?typeof q=="function"?q(At,Ft):At:At+(D?"."+Ft:"["+Ft+"]");C.set(B,W);var Xt=d();Xt.set(tt,C),J(xt,ht(St,zt,q,at,rt,dt,q==="comma"&&Z&&_t(I)?null:S,F,_,D,G,Tt,wt,Z,E,Xt))}}return xt},mt=function(B){if(!B)return z;if(B.encoder!==null&&typeof B.encoder!="undefined"&&typeof B.encoder!="function")throw new TypeError("Encoder has to be a function.");var U=B.charset||z.charset;if(typeof B.charset!="undefined"&&B.charset!=="utf-8"&&B.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var q=nt.default;if(typeof B.format!="undefined"){if(!Ct.call(nt.formatters,B.format))throw new TypeError("Unknown format option provided.");q=B.format}var at=nt.formatters[q],rt=z.filter;return(typeof B.filter=="function"||_t(B.filter))&&(rt=B.filter),{addQueryPrefix:typeof B.addQueryPrefix=="boolean"?B.addQueryPrefix:z.addQueryPrefix,allowDots:typeof B.allowDots=="undefined"?z.allowDots:!!B.allowDots,charset:U,charsetSentinel:typeof B.charsetSentinel=="boolean"?B.charsetSentinel:z.charsetSentinel,delimiter:typeof B.delimiter=="undefined"?z.delimiter:B.delimiter,encode:typeof B.encode=="boolean"?B.encode:z.encode,encoder:typeof B.encoder=="function"?B.encoder:z.encoder,encodeValuesOnly:typeof B.encodeValuesOnly=="boolean"?B.encodeValuesOnly:z.encodeValuesOnly,filter:rt,format:q,formatter:at,serializeDate:typeof B.serializeDate=="function"?B.serializeDate:z.serializeDate,skipNulls:typeof B.skipNulls=="boolean"?B.skipNulls:z.skipNulls,sort:typeof B.sort=="function"?B.sort:null,strictNullHandling:typeof B.strictNullHandling=="boolean"?B.strictNullHandling:z.strictNullHandling}};It.exports=function(ht,B){var U=ht,q=mt(B),at,rt;typeof q.filter=="function"?(rt=q.filter,U=rt("",U)):_t(q.filter)&&(rt=q.filter,at=rt);var dt=[];if(typeof U!="object"||U===null)return"";var S;B&&B.arrayFormat in it?S=B.arrayFormat:B&&"indices"in B?S=B.indices?"indices":"repeat":S="indices";var F=it[S];if(B&&"commaRoundTrip"in B&&typeof B.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var _=F==="comma"&&B&&B.commaRoundTrip;at||(at=Object.keys(U)),q.sort&&at.sort(q.sort);for(var D=d(),G=0;G<at.length;++G){var Tt=at[G];q.skipNulls&&U[Tt]===null||J(dt,k(U[Tt],Tt,F,_,q.strictNullHandling,q.skipNulls,q.encode?q.encoder:null,q.filter,q.sort,q.allowDots,q.serializeDate,q.format,q.formatter,q.encodeValuesOnly,q.charset,D))}var wt=dt.join(q.delimiter),Z=q.addQueryPrefix===!0?"?":"";return q.charsetSentinel&&(q.charset==="iso-8859-1"?Z+="utf8=%26%2310003%3B&":Z+="utf8=%E2%9C%93&"),wt.length>0?Z+wt:""}},2769:function(It,Ot,st){"use strict";var d=st(5798),yt=Object.prototype.hasOwnProperty,nt=Array.isArray,Ct=function(){for(var ht=[],B=0;B<256;++B)ht.push("%"+((B<16?"0":"")+B.toString(16)).toUpperCase());return ht}(),it=function(B){for(;B.length>1;){var U=B.pop(),q=U.obj[U.prop];if(nt(q)){for(var at=[],rt=0;rt<q.length;++rt)typeof q[rt]!="undefined"&&at.push(q[rt]);U.obj[U.prop]=at}}},_t=function(B,U){for(var q=U&&U.plainObjects?Object.create(null):{},at=0;at<B.length;++at)typeof B[at]!="undefined"&&(q[at]=B[at]);return q},H=function ht(B,U,q){if(!U)return B;if(typeof U!="object"){if(nt(B))B.push(U);else if(B&&typeof B=="object")(q&&(q.plainObjects||q.allowPrototypes)||!yt.call(Object.prototype,U))&&(B[U]=!0);else return[B,U];return B}if(!B||typeof B!="object")return[B].concat(U);var at=B;return nt(B)&&!nt(U)&&(at=_t(B,q)),nt(B)&&nt(U)?(U.forEach(function(rt,dt){if(yt.call(B,dt)){var S=B[dt];S&&typeof S=="object"&&rt&&typeof rt=="object"?B[dt]=ht(S,rt,q):B.push(rt)}else B[dt]=rt}),B):Object.keys(U).reduce(function(rt,dt){var S=U[dt];return yt.call(rt,dt)?rt[dt]=ht(rt[dt],S,q):rt[dt]=S,rt},at)},J=function(B,U){return Object.keys(U).reduce(function(q,at){return q[at]=U[at],q},B)},L=function(ht,B,U){var q=ht.replace(/\+/g," ");if(U==="iso-8859-1")return q.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(q)}catch(at){return q}},P=function(B,U,q,at,rt){if(B.length===0)return B;var dt=B;if(typeof B=="symbol"?dt=Symbol.prototype.toString.call(B):typeof B!="string"&&(dt=String(B)),q==="iso-8859-1")return escape(dt).replace(/%u[0-9a-f]{4}/gi,function(D){return"%26%23"+parseInt(D.slice(2),16)+"%3B"});for(var S="",F=0;F<dt.length;++F){var _=dt.charCodeAt(F);if(_===45||_===46||_===95||_===126||_>=48&&_<=57||_>=65&&_<=90||_>=97&&_<=122||rt===d.RFC1738&&(_===40||_===41)){S+=dt.charAt(F);continue}if(_<128){S=S+Ct[_];continue}if(_<2048){S=S+(Ct[192|_>>6]+Ct[128|_&63]);continue}if(_<55296||_>=57344){S=S+(Ct[224|_>>12]+Ct[128|_>>6&63]+Ct[128|_&63]);continue}F+=1,_=65536+((_&1023)<<10|dt.charCodeAt(F)&1023),S+=Ct[240|_>>18]+Ct[128|_>>12&63]+Ct[128|_>>6&63]+Ct[128|_&63]}return S},z=function(B){for(var U=[{obj:{o:B},prop:"o"}],q=[],at=0;at<U.length;++at)for(var rt=U[at],dt=rt.obj[rt.prop],S=Object.keys(dt),F=0;F<S.length;++F){var _=S[F],D=dt[_];typeof D=="object"&&D!==null&&q.indexOf(D)===-1&&(U.push({obj:dt,prop:_}),q.push(D))}return it(U),B},j=function(B){return Object.prototype.toString.call(B)==="[object RegExp]"},tt=function(B){return!B||typeof B!="object"?!1:!!(B.constructor&&B.constructor.isBuffer&&B.constructor.isBuffer(B))},k=function(B,U){return[].concat(B,U)},mt=function(B,U){if(nt(B)){for(var q=[],at=0;at<B.length;at+=1)q.push(U(B[at]));return q}return U(B)};It.exports={arrayToObject:_t,assign:J,combine:k,compact:z,decode:L,encode:P,isBuffer:tt,isRegExp:j,maybeMap:mt,merge:H}},7771:function(It,Ot,st){"use strict";var d=st(210),yt=st(2296),nt=st(1044)(),Ct=st(7296),it=d("%TypeError%"),_t=d("%Math.floor%");It.exports=function(J,L){if(typeof J!="function")throw new it("`fn` is not a function");if(typeof L!="number"||L<0||L>4294967295||_t(L)!==L)throw new it("`length` must be a positive 32-bit integer");var P=arguments.length>2&&!!arguments[2],z=!0,j=!0;if("length"in J&&Ct){var tt=Ct(J,"length");tt&&!tt.configurable&&(z=!1),tt&&!tt.writable&&(j=!1)}return(z||j||!P)&&(nt?yt(J,"length",L,!0,!0):yt(J,"length",L)),J}},7478:function(It,Ot,st){"use strict";var d=st(210),yt=st(1924),nt=st(631),Ct=d("%TypeError%"),it=d("%WeakMap%",!0),_t=d("%Map%",!0),H=yt("WeakMap.prototype.get",!0),J=yt("WeakMap.prototype.set",!0),L=yt("WeakMap.prototype.has",!0),P=yt("Map.prototype.get",!0),z=yt("Map.prototype.set",!0),j=yt("Map.prototype.has",!0),tt=function(B,U){for(var q=B,at;(at=q.next)!==null;q=at)if(at.key===U)return q.next=at.next,at.next=B.next,B.next=at,at},k=function(B,U){var q=tt(B,U);return q&&q.value},mt=function(B,U,q){var at=tt(B,U);at?at.value=q:B.next={key:U,next:B.next,value:q}},ht=function(B,U){return!!tt(B,U)};It.exports=function(){var U,q,at,rt={assert:function(dt){if(!rt.has(dt))throw new Ct("Side channel does not contain "+nt(dt))},get:function(dt){if(it&&dt&&(typeof dt=="object"||typeof dt=="function")){if(U)return H(U,dt)}else if(_t){if(q)return P(q,dt)}else if(at)return k(at,dt)},has:function(dt){if(it&&dt&&(typeof dt=="object"||typeof dt=="function")){if(U)return L(U,dt)}else if(_t){if(q)return j(q,dt)}else if(at)return ht(at,dt);return!1},set:function(dt,S){it&&dt&&(typeof dt=="object"||typeof dt=="function")?(U||(U=new it),J(U,dt,S)):_t?(q||(q=new _t),z(q,dt,S)):(at||(at={key:{},next:null}),mt(at,dt,S))}};return rt}},2511:function(It,Ot,st){It=st.nmd(It);var d;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(yt){var nt=Ot&&!Ot.nodeType&&Ot,Ct=It&&!It.nodeType&&It,it=typeof st.g=="object"&&st.g;(it.global===it||it.window===it||it.self===it)&&(yt=it);var _t,H=2147483647,J=36,L=1,P=26,z=38,j=700,tt=72,k=128,mt="-",ht=/^xn--/,B=/[^\x20-\x7E]/,U=/[\x2E\u3002\uFF0E\uFF61]/g,q={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},at=J-L,rt=Math.floor,dt=String.fromCharCode,S;function F(R){throw new RangeError(q[R])}function _(R,V){for(var ot=R.length,xt=[];ot--;)xt[ot]=V(R[ot]);return xt}function D(R,V){var ot=R.split("@"),xt="";ot.length>1&&(xt=ot[0]+"@",R=ot[1]),R=R.replace(U,".");var ct=R.split("."),pt=_(ct,V).join(".");return xt+pt}function G(R){for(var V=[],ot=0,xt=R.length,ct,pt;ot<xt;)ct=R.charCodeAt(ot++),ct>=55296&&ct<=56319&&ot<xt?(pt=R.charCodeAt(ot++),(pt&64512)==56320?V.push(((ct&1023)<<10)+(pt&1023)+65536):(V.push(ct),ot--)):V.push(ct);return V}function Tt(R){return _(R,function(V){var ot="";return V>65535&&(V-=65536,ot+=dt(V>>>10&1023|55296),V=56320|V&1023),ot+=dt(V),ot}).join("")}function wt(R){return R-48<10?R-22:R-65<26?R-65:R-97<26?R-97:J}function Z(R,V){return R+22+75*(R<26)-((V!=0)<<5)}function E(R,V,ot){var xt=0;for(R=ot?rt(R/j):R>>1,R+=rt(R/V);R>at*P>>1;xt+=J)R=rt(R/at);return rt(xt+(at+1)*R/(R+z))}function C(R){var V=[],ot=R.length,xt,ct=0,pt=k,At=tt,Et,Ft,St,zt,Xt,bt,he,Nt,kt;for(Et=R.lastIndexOf(mt),Et<0&&(Et=0),Ft=0;Ft<Et;++Ft)R.charCodeAt(Ft)>=128&&F("not-basic"),V.push(R.charCodeAt(Ft));for(St=Et>0?Et+1:0;St<ot;){for(zt=ct,Xt=1,bt=J;St>=ot&&F("invalid-input"),he=wt(R.charCodeAt(St++)),(he>=J||he>rt((H-ct)/Xt))&&F("overflow"),ct+=he*Xt,Nt=bt<=At?L:bt>=At+P?P:bt-At,!(he<Nt);bt+=J)kt=J-Nt,Xt>rt(H/kt)&&F("overflow"),Xt*=kt;xt=V.length+1,At=E(ct-zt,xt,zt==0),rt(ct/xt)>H-pt&&F("overflow"),pt+=rt(ct/xt),ct%=xt,V.splice(ct++,0,pt)}return Tt(V)}function I(R){var V,ot,xt,ct,pt,At,Et,Ft,St,zt,Xt,bt=[],he,Nt,kt,ye;for(R=G(R),he=R.length,V=k,ot=0,pt=tt,At=0;At<he;++At)Xt=R[At],Xt<128&&bt.push(dt(Xt));for(xt=ct=bt.length,ct&&bt.push(mt);xt<he;){for(Et=H,At=0;At<he;++At)Xt=R[At],Xt>=V&&Xt<Et&&(Et=Xt);for(Nt=xt+1,Et-V>rt((H-ot)/Nt)&&F("overflow"),ot+=(Et-V)*Nt,V=Et,At=0;At<he;++At)if(Xt=R[At],Xt<V&&++ot>H&&F("overflow"),Xt==V){for(Ft=ot,St=J;zt=St<=pt?L:St>=pt+P?P:St-pt,!(Ft<zt);St+=J)ye=Ft-zt,kt=J-zt,bt.push(dt(Z(zt+ye%kt,0))),Ft=rt(ye/kt);bt.push(dt(Z(Ft,0))),pt=E(ot,Nt,xt==ct),ot=0,++xt}++ot,++V}return bt.join("")}function X(R){return D(R,function(V){return ht.test(V)?C(V.slice(4).toLowerCase()):V})}function W(R){return D(R,function(V){return B.test(V)?"xn--"+I(V):V})}_t={version:"1.4.1",ucs2:{decode:G,encode:Tt},decode:C,encode:I,toASCII:W,toUnicode:X},d=function(){return _t}.call(Ot,st,Ot,It),d!==void 0&&(It.exports=d)})(this)},8575:function(It,Ot,st){"use strict";var d,yt=st(2511);function nt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Ct=/^([a-z0-9.+-]+:)/i,it=/:[0-9]*$/,_t=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,H=["<",">",'"',"`"," ","\r",`
`,"	"],J=["{","}","|","\\","^","`"].concat(H),L=["'"].concat(J),P=["%","/","?",";","#"].concat(L),z=["/","?","#"],j=255,tt=/^[+a-z0-9A-Z_-]{0,63}$/,k=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,mt={javascript:!0,"javascript:":!0},ht={javascript:!0,"javascript:":!0},B={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},U=st(129);function q(S,F,_){if(S&&typeof S=="object"&&S instanceof nt)return S;var D=new nt;return D.parse(S,F,_),D}nt.prototype.parse=function(S,F,_){if(typeof S!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof S);var D=S.indexOf("?"),G=D!==-1&&D<S.indexOf("#")?"?":"#",Tt=S.split(G),wt=/\\/g;Tt[0]=Tt[0].replace(wt,"/"),S=Tt.join(G);var Z=S;if(Z=Z.trim(),!_&&S.split("#").length===1){var E=_t.exec(Z);if(E)return this.path=Z,this.href=Z,this.pathname=E[1],E[2]?(this.search=E[2],F?this.query=U.parse(this.search.substr(1)):this.query=this.search.substr(1)):F&&(this.search="",this.query={}),this}var C=Ct.exec(Z);if(C){C=C[0];var I=C.toLowerCase();this.protocol=I,Z=Z.substr(C.length)}if(_||C||Z.match(/^\/\/[^@/]+@[^@/]+/)){var X=Z.substr(0,2)==="//";X&&!(C&&ht[C])&&(Z=Z.substr(2),this.slashes=!0)}if(!ht[C]&&(X||C&&!B[C])){for(var W=-1,R=0;R<z.length;R++){var V=Z.indexOf(z[R]);V!==-1&&(W===-1||V<W)&&(W=V)}var ot,xt;W===-1?xt=Z.lastIndexOf("@"):xt=Z.lastIndexOf("@",W),xt!==-1&&(ot=Z.slice(0,xt),Z=Z.slice(xt+1),this.auth=decodeURIComponent(ot)),W=-1;for(var R=0;R<P.length;R++){var V=Z.indexOf(P[R]);V!==-1&&(W===-1||V<W)&&(W=V)}W===-1&&(W=Z.length),this.host=Z.slice(0,W),Z=Z.slice(W),this.parseHost(),this.hostname=this.hostname||"";var ct=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ct)for(var pt=this.hostname.split(/\./),R=0,At=pt.length;R<At;R++){var Et=pt[R];if(Et&&!Et.match(tt)){for(var Ft="",St=0,zt=Et.length;St<zt;St++)Et.charCodeAt(St)>127?Ft+="x":Ft+=Et[St];if(!Ft.match(tt)){var Xt=pt.slice(0,R),bt=pt.slice(R+1),he=Et.match(k);he&&(Xt.push(he[1]),bt.unshift(he[2])),bt.length&&(Z="/"+bt.join(".")+Z),this.hostname=Xt.join(".");break}}}this.hostname.length>j?this.hostname="":this.hostname=this.hostname.toLowerCase(),ct||(this.hostname=yt.toASCII(this.hostname));var Nt=this.port?":"+this.port:"",kt=this.hostname||"";this.host=kt+Nt,this.href+=this.host,ct&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),Z[0]!=="/"&&(Z="/"+Z))}if(!mt[I])for(var R=0,At=L.length;R<At;R++){var ye=L[R];if(Z.indexOf(ye)!==-1){var Ge=encodeURIComponent(ye);Ge===ye&&(Ge=escape(ye)),Z=Z.split(ye).join(Ge)}}var Ue=Z.indexOf("#");Ue!==-1&&(this.hash=Z.substr(Ue),Z=Z.slice(0,Ue));var Pe=Z.indexOf("?");if(Pe!==-1?(this.search=Z.substr(Pe),this.query=Z.substr(Pe+1),F&&(this.query=U.parse(this.query)),Z=Z.slice(0,Pe)):F&&(this.search="",this.query={}),Z&&(this.pathname=Z),B[I]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var Nt=this.pathname||"",ee=this.search||"";this.path=Nt+ee}return this.href=this.format(),this};function at(S){return typeof S=="string"&&(S=q(S)),S instanceof nt?S.format():nt.prototype.format.call(S)}nt.prototype.format=function(){var S=this.auth||"";S&&(S=encodeURIComponent(S),S=S.replace(/%3A/i,":"),S+="@");var F=this.protocol||"",_=this.pathname||"",D=this.hash||"",G=!1,Tt="";this.host?G=S+this.host:this.hostname&&(G=S+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(G+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(Tt=U.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var wt=this.search||Tt&&"?"+Tt||"";return F&&F.substr(-1)!==":"&&(F+=":"),this.slashes||(!F||B[F])&&G!==!1?(G="//"+(G||""),_&&_.charAt(0)!=="/"&&(_="/"+_)):G||(G=""),D&&D.charAt(0)!=="#"&&(D="#"+D),wt&&wt.charAt(0)!=="?"&&(wt="?"+wt),_=_.replace(/[?#]/g,function(Z){return encodeURIComponent(Z)}),wt=wt.replace("#","%23"),F+G+_+wt+D};function rt(S,F){return q(S,!1,!0).resolve(F)}nt.prototype.resolve=function(S){return this.resolveObject(q(S,!1,!0)).format()};function dt(S,F){return S?q(S,!1,!0).resolveObject(F):F}nt.prototype.resolveObject=function(S){if(typeof S=="string"){var F=new nt;F.parse(S,!1,!0),S=F}for(var _=new nt,D=Object.keys(this),G=0;G<D.length;G++){var Tt=D[G];_[Tt]=this[Tt]}if(_.hash=S.hash,S.href==="")return _.href=_.format(),_;if(S.slashes&&!S.protocol){for(var wt=Object.keys(S),Z=0;Z<wt.length;Z++){var E=wt[Z];E!=="protocol"&&(_[E]=S[E])}return B[_.protocol]&&_.hostname&&!_.pathname&&(_.pathname="/",_.path=_.pathname),_.href=_.format(),_}if(S.protocol&&S.protocol!==_.protocol){if(!B[S.protocol]){for(var C=Object.keys(S),I=0;I<C.length;I++){var X=C[I];_[X]=S[X]}return _.href=_.format(),_}if(_.protocol=S.protocol,!S.host&&!ht[S.protocol]){for(var At=(S.pathname||"").split("/");At.length&&!(S.host=At.shift()););S.host||(S.host=""),S.hostname||(S.hostname=""),At[0]!==""&&At.unshift(""),At.length<2&&At.unshift(""),_.pathname=At.join("/")}else _.pathname=S.pathname;if(_.search=S.search,_.query=S.query,_.host=S.host||"",_.auth=S.auth,_.hostname=S.hostname||S.host,_.port=S.port,_.pathname||_.search){var W=_.pathname||"",R=_.search||"";_.path=W+R}return _.slashes=_.slashes||S.slashes,_.href=_.format(),_}var V=_.pathname&&_.pathname.charAt(0)==="/",ot=S.host||S.pathname&&S.pathname.charAt(0)==="/",xt=ot||V||_.host&&S.pathname,ct=xt,pt=_.pathname&&_.pathname.split("/")||[],At=S.pathname&&S.pathname.split("/")||[],Et=_.protocol&&!B[_.protocol];if(Et&&(_.hostname="",_.port=null,_.host&&(pt[0]===""?pt[0]=_.host:pt.unshift(_.host)),_.host="",S.protocol&&(S.hostname=null,S.port=null,S.host&&(At[0]===""?At[0]=S.host:At.unshift(S.host)),S.host=null),xt=xt&&(At[0]===""||pt[0]==="")),ot)_.host=S.host||S.host===""?S.host:_.host,_.hostname=S.hostname||S.hostname===""?S.hostname:_.hostname,_.search=S.search,_.query=S.query,pt=At;else if(At.length)pt||(pt=[]),pt.pop(),pt=pt.concat(At),_.search=S.search,_.query=S.query;else if(S.search!=null){if(Et){_.host=pt.shift(),_.hostname=_.host;var Ft=_.host&&_.host.indexOf("@")>0?_.host.split("@"):!1;Ft&&(_.auth=Ft.shift(),_.hostname=Ft.shift(),_.host=_.hostname)}return _.search=S.search,_.query=S.query,(_.pathname!==null||_.search!==null)&&(_.path=(_.pathname?_.pathname:"")+(_.search?_.search:"")),_.href=_.format(),_}if(!pt.length)return _.pathname=null,_.search?_.path="/"+_.search:_.path=null,_.href=_.format(),_;for(var St=pt.slice(-1)[0],zt=(_.host||S.host||pt.length>1)&&(St==="."||St==="..")||St==="",Xt=0,bt=pt.length;bt>=0;bt--)St=pt[bt],St==="."?pt.splice(bt,1):St===".."?(pt.splice(bt,1),Xt++):Xt&&(pt.splice(bt,1),Xt--);if(!xt&&!ct)for(;Xt--;Xt)pt.unshift("..");xt&&pt[0]!==""&&(!pt[0]||pt[0].charAt(0)!=="/")&&pt.unshift(""),zt&&pt.join("/").substr(-1)!=="/"&&pt.push("");var he=pt[0]===""||pt[0]&&pt[0].charAt(0)==="/";if(Et){_.hostname=he?"":pt.length?pt.shift():"",_.host=_.hostname;var Ft=_.host&&_.host.indexOf("@")>0?_.host.split("@"):!1;Ft&&(_.auth=Ft.shift(),_.hostname=Ft.shift(),_.host=_.hostname)}return xt=xt||_.host&&pt.length,xt&&!he&&pt.unshift(""),pt.length>0?_.pathname=pt.join("/"):(_.pathname=null,_.path=null),(_.pathname!==null||_.search!==null)&&(_.path=(_.pathname?_.pathname:"")+(_.search?_.search:"")),_.auth=S.auth||_.auth,_.slashes=_.slashes||S.slashes,_.href=_.format(),_},nt.prototype.parseHost=function(){var S=this.host,F=it.exec(S);F&&(F=F[0],F!==":"&&(this.port=F.substr(1)),S=S.substr(0,S.length-F.length)),S&&(this.hostname=S)},Ot.Qc=q,Ot.DB=rt,d=dt,Ot.WU=at,d=nt},5936:function(It,Ot,st){"use strict";st.d(Ot,{zb:function(){return k},yE:function(){return B}});var d;(function(F){F[F.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",F[F.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",F[F.CLASS_TO_CLASS=2]="CLASS_TO_CLASS"})(d||(d={}));var yt=function(){function F(){this._typeMetadatas=new Map,this._transformMetadatas=new Map,this._exposeMetadatas=new Map,this._excludeMetadatas=new Map,this._ancestorsMap=new Map}return F.prototype.addTypeMetadata=function(_){this._typeMetadatas.has(_.target)||this._typeMetadatas.set(_.target,new Map),this._typeMetadatas.get(_.target).set(_.propertyName,_)},F.prototype.addTransformMetadata=function(_){this._transformMetadatas.has(_.target)||this._transformMetadatas.set(_.target,new Map),this._transformMetadatas.get(_.target).has(_.propertyName)||this._transformMetadatas.get(_.target).set(_.propertyName,[]),this._transformMetadatas.get(_.target).get(_.propertyName).push(_)},F.prototype.addExposeMetadata=function(_){this._exposeMetadatas.has(_.target)||this._exposeMetadatas.set(_.target,new Map),this._exposeMetadatas.get(_.target).set(_.propertyName,_)},F.prototype.addExcludeMetadata=function(_){this._excludeMetadatas.has(_.target)||this._excludeMetadatas.set(_.target,new Map),this._excludeMetadatas.get(_.target).set(_.propertyName,_)},F.prototype.findTransformMetadatas=function(_,D,G){return this.findMetadatas(this._transformMetadatas,_,D).filter(function(Tt){return!Tt.options||Tt.options.toClassOnly===!0&&Tt.options.toPlainOnly===!0?!0:Tt.options.toClassOnly===!0?G===d.CLASS_TO_CLASS||G===d.PLAIN_TO_CLASS:Tt.options.toPlainOnly===!0?G===d.CLASS_TO_PLAIN:!0})},F.prototype.findExcludeMetadata=function(_,D){return this.findMetadata(this._excludeMetadatas,_,D)},F.prototype.findExposeMetadata=function(_,D){return this.findMetadata(this._exposeMetadatas,_,D)},F.prototype.findExposeMetadataByCustomName=function(_,D){return this.getExposedMetadatas(_).find(function(G){return G.options&&G.options.name===D})},F.prototype.findTypeMetadata=function(_,D){return this.findMetadata(this._typeMetadatas,_,D)},F.prototype.getStrategy=function(_){var D=this._excludeMetadatas.get(_),G=D&&D.get(void 0),Tt=this._exposeMetadatas.get(_),wt=Tt&&Tt.get(void 0);return G&&wt||!G&&!wt?"none":G?"excludeAll":"exposeAll"},F.prototype.getExposedMetadatas=function(_){return this.getMetadata(this._exposeMetadatas,_)},F.prototype.getExcludedMetadatas=function(_){return this.getMetadata(this._excludeMetadatas,_)},F.prototype.getExposedProperties=function(_,D){return this.getExposedMetadatas(_).filter(function(G){return!G.options||G.options.toClassOnly===!0&&G.options.toPlainOnly===!0?!0:G.options.toClassOnly===!0?D===d.CLASS_TO_CLASS||D===d.PLAIN_TO_CLASS:G.options.toPlainOnly===!0?D===d.CLASS_TO_PLAIN:!0}).map(function(G){return G.propertyName})},F.prototype.getExcludedProperties=function(_,D){return this.getExcludedMetadatas(_).filter(function(G){return!G.options||G.options.toClassOnly===!0&&G.options.toPlainOnly===!0?!0:G.options.toClassOnly===!0?D===d.CLASS_TO_CLASS||D===d.PLAIN_TO_CLASS:G.options.toPlainOnly===!0?D===d.CLASS_TO_PLAIN:!0}).map(function(G){return G.propertyName})},F.prototype.clear=function(){this._typeMetadatas.clear(),this._exposeMetadatas.clear(),this._excludeMetadatas.clear(),this._ancestorsMap.clear()},F.prototype.getMetadata=function(_,D){var G=_.get(D),Tt;G&&(Tt=Array.from(G.values()).filter(function(W){return W.propertyName!==void 0}));for(var wt=[],Z=0,E=this.getAncestors(D);Z<E.length;Z++){var C=E[Z],I=_.get(C);if(I){var X=Array.from(I.values()).filter(function(W){return W.propertyName!==void 0});wt.push.apply(wt,X)}}return wt.concat(Tt||[])},F.prototype.findMetadata=function(_,D,G){var Tt=_.get(D);if(Tt){var wt=Tt.get(G);if(wt)return wt}for(var Z=0,E=this.getAncestors(D);Z<E.length;Z++){var C=E[Z],I=_.get(C);if(I){var X=I.get(G);if(X)return X}}},F.prototype.findMetadatas=function(_,D,G){var Tt=_.get(D),wt;Tt&&(wt=Tt.get(G));for(var Z=[],E=0,C=this.getAncestors(D);E<C.length;E++){var I=C[E],X=_.get(I);X&&X.has(G)&&Z.push.apply(Z,X.get(G))}return Z.slice().reverse().concat((wt||[]).slice().reverse())},F.prototype.getAncestors=function(_){if(!_)return[];if(!this._ancestorsMap.has(_)){for(var D=[],G=Object.getPrototypeOf(_.prototype.constructor);typeof G.prototype!="undefined";G=Object.getPrototypeOf(G.prototype.constructor))D.push(G);this._ancestorsMap.set(_,D)}return this._ancestorsMap.get(_)},F}(),nt=new yt;function Ct(){if(typeof globalThis!="undefined")return globalThis;if(typeof st.g!="undefined")return st.g;if(typeof window!="undefined")return window;if(typeof self!="undefined")return self}function it(F){return F!==null&&typeof F=="object"&&typeof F.then=="function"}var _t=function(F,_,D){if(D||arguments.length===2)for(var G=0,Tt=_.length,wt;G<Tt;G++)(wt||!(G in _))&&(wt||(wt=Array.prototype.slice.call(_,0,G)),wt[G]=_[G]);return F.concat(wt||Array.prototype.slice.call(_))};function H(F){var _=new F;return!(_ instanceof Set)&&!("push"in _)?[]:_}var J=function(){function F(_,D){this.transformationType=_,this.options=D,this.recursionStack=new Set}return F.prototype.transform=function(_,D,G,Tt,wt,Z){var E=this;if(Z===void 0&&(Z=0),Array.isArray(D)||D instanceof Set){var C=Tt&&this.transformationType===d.PLAIN_TO_CLASS?H(Tt):[];return D.forEach(function(ct,pt){var At=_?_[pt]:void 0;if(!E.options.enableCircularCheck||!E.isCircular(ct)){var Et=void 0;if(typeof G!="function"&&G&&G.options&&G.options.discriminator&&G.options.discriminator.property&&G.options.discriminator.subTypes){if(E.transformationType===d.PLAIN_TO_CLASS){Et=G.options.discriminator.subTypes.find(function(Xt){return Xt.name===ct[G.options.discriminator.property]});var Ft={newObject:C,object:ct,property:void 0},St=G.typeFunction(Ft);Et===void 0?Et=St:Et=Et.value,G.options.keepDiscriminatorProperty||delete ct[G.options.discriminator.property]}E.transformationType===d.CLASS_TO_CLASS&&(Et=ct.constructor),E.transformationType===d.CLASS_TO_PLAIN&&(ct[G.options.discriminator.property]=G.options.discriminator.subTypes.find(function(Xt){return Xt.value===ct.constructor}).name)}else Et=G;var zt=E.transform(At,ct,Et,void 0,ct instanceof Map,Z+1);C instanceof Set?C.add(zt):C.push(zt)}else E.transformationType===d.CLASS_TO_CLASS&&(C instanceof Set?C.add(ct):C.push(ct))}),C}else{if(G===String&&!wt)return D==null?D:String(D);if(G===Number&&!wt)return D==null?D:Number(D);if(G===Boolean&&!wt)return D==null?D:!!D;if((G===Date||D instanceof Date)&&!wt)return D instanceof Date?new Date(D.valueOf()):D==null?D:new Date(D);if(Ct().Buffer&&(G===Buffer||D instanceof Buffer)&&!wt)return D==null?D:Buffer.from(D);if(it(D)&&!wt)return new Promise(function(ct,pt){D.then(function(At){return ct(E.transform(void 0,At,G,void 0,void 0,Z+1))},pt)});if(!wt&&D!==null&&typeof D=="object"&&typeof D.then=="function")return D;if(typeof D=="object"&&D!==null){!G&&D.constructor!==Object&&(!Array.isArray(D)&&D.constructor===Array||(G=D.constructor)),!G&&_&&(G=_.constructor),this.options.enableCircularCheck&&this.recursionStack.add(D);var I=this.getKeys(G,D,wt),X=_||{};!_&&(this.transformationType===d.PLAIN_TO_CLASS||this.transformationType===d.CLASS_TO_CLASS)&&(wt?X=new Map:G?X=new G:X={});for(var W=function(ct){if(ct==="__proto__"||ct==="constructor")return"continue";var pt=ct,At=ct,Et=ct;if(!R.options.ignoreDecorators&&G){if(R.transformationType===d.PLAIN_TO_CLASS){var Ft=nt.findExposeMetadataByCustomName(G,ct);Ft&&(Et=Ft.propertyName,At=Ft.propertyName)}else if(R.transformationType===d.CLASS_TO_PLAIN||R.transformationType===d.CLASS_TO_CLASS){var Ft=nt.findExposeMetadata(G,ct);Ft&&Ft.options&&Ft.options.name&&(At=Ft.options.name)}}var St=void 0;R.transformationType===d.PLAIN_TO_CLASS?St=D[pt]:D instanceof Map?St=D.get(pt):D[pt]instanceof Function?St=D[pt]():St=D[pt];var zt=void 0,Xt=St instanceof Map;if(G&&wt)zt=G;else if(G){var bt=nt.findTypeMetadata(G,Et);if(bt){var he={newObject:X,object:D,property:Et},Nt=bt.typeFunction?bt.typeFunction(he):bt.reflectedType;bt.options&&bt.options.discriminator&&bt.options.discriminator.property&&bt.options.discriminator.subTypes?D[pt]instanceof Array?zt=bt:(R.transformationType===d.PLAIN_TO_CLASS&&(zt=bt.options.discriminator.subTypes.find(function(Le){if(St&&St instanceof Object&&bt.options.discriminator.property in St)return Le.name===St[bt.options.discriminator.property]}),zt===void 0?zt=Nt:zt=zt.value,bt.options.keepDiscriminatorProperty||St&&St instanceof Object&&bt.options.discriminator.property in St&&delete St[bt.options.discriminator.property]),R.transformationType===d.CLASS_TO_CLASS&&(zt=St.constructor),R.transformationType===d.CLASS_TO_PLAIN&&St&&(St[bt.options.discriminator.property]=bt.options.discriminator.subTypes.find(function(Le){return Le.value===St.constructor}).name)):zt=Nt,Xt=Xt||bt.reflectedType===Map}else if(R.options.targetMaps)R.options.targetMaps.filter(function(Le){return Le.target===G&&!!Le.properties[Et]}).forEach(function(Le){return zt=Le.properties[Et]});else if(R.options.enableImplicitConversion&&R.transformationType===d.PLAIN_TO_CLASS){var kt=Reflect.getMetadata("design:type",G.prototype,Et);kt&&(zt=kt)}}var ye=Array.isArray(D[pt])?R.getReflectedType(G,Et):void 0,Ge=_?_[pt]:void 0;if(X.constructor.prototype){var Ue=Object.getOwnPropertyDescriptor(X.constructor.prototype,At);if((R.transformationType===d.PLAIN_TO_CLASS||R.transformationType===d.CLASS_TO_CLASS)&&(Ue&&!Ue.set||X[At]instanceof Function))return"continue"}if(!R.options.enableCircularCheck||!R.isCircular(St)){var Pe=R.transformationType===d.PLAIN_TO_CLASS?At:ct,ee=void 0;R.transformationType===d.CLASS_TO_PLAIN?(ee=D[Pe],ee=R.applyCustomTransformations(ee,G,Pe,D,R.transformationType),ee=D[Pe]===ee?St:ee,ee=R.transform(Ge,ee,zt,ye,Xt,Z+1)):St===void 0&&R.options.exposeDefaultValues?ee=X[At]:(ee=R.transform(Ge,St,zt,ye,Xt,Z+1),ee=R.applyCustomTransformations(ee,G,Pe,D,R.transformationType)),(ee!==void 0||R.options.exposeUnsetFields)&&(X instanceof Map?X.set(At,ee):X[At]=ee)}else if(R.transformationType===d.CLASS_TO_CLASS){var ee=St;ee=R.applyCustomTransformations(ee,G,ct,D,R.transformationType),(ee!==void 0||R.options.exposeUnsetFields)&&(X instanceof Map?X.set(At,ee):X[At]=ee)}},R=this,V=0,ot=I;V<ot.length;V++){var xt=ot[V];W(xt)}return this.options.enableCircularCheck&&this.recursionStack.delete(D),X}else return D}},F.prototype.applyCustomTransformations=function(_,D,G,Tt,wt){var Z=this,E=nt.findTransformMetadatas(D,G,this.transformationType);return this.options.version!==void 0&&(E=E.filter(function(C){return C.options?Z.checkVersion(C.options.since,C.options.until):!0})),this.options.groups&&this.options.groups.length?E=E.filter(function(C){return C.options?Z.checkGroups(C.options.groups):!0}):E=E.filter(function(C){return!C.options||!C.options.groups||!C.options.groups.length}),E.forEach(function(C){_=C.transformFn({value:_,key:G,obj:Tt,type:wt,options:Z.options})}),_},F.prototype.isCircular=function(_){return this.recursionStack.has(_)},F.prototype.getReflectedType=function(_,D){if(_){var G=nt.findTypeMetadata(_,D);return G?G.reflectedType:void 0}},F.prototype.getKeys=function(_,D,G){var Tt=this,wt=nt.getStrategy(_);wt==="none"&&(wt=this.options.strategy||"exposeAll");var Z=[];if((wt==="exposeAll"||G)&&(D instanceof Map?Z=Array.from(D.keys()):Z=Object.keys(D)),G)return Z;if(this.options.ignoreDecorators&&this.options.excludeExtraneousValues&&_){var E=nt.getExposedProperties(_,this.transformationType),C=nt.getExcludedProperties(_,this.transformationType);Z=_t(_t([],E,!0),C,!0)}if(!this.options.ignoreDecorators&&_){var E=nt.getExposedProperties(_,this.transformationType);this.transformationType===d.PLAIN_TO_CLASS&&(E=E.map(function(W){var R=nt.findExposeMetadata(_,W);return R&&R.options&&R.options.name?R.options.name:W})),this.options.excludeExtraneousValues?Z=E:Z=Z.concat(E);var I=nt.getExcludedProperties(_,this.transformationType);I.length>0&&(Z=Z.filter(function(W){return!I.includes(W)})),this.options.version!==void 0&&(Z=Z.filter(function(W){var R=nt.findExposeMetadata(_,W);return!R||!R.options?!0:Tt.checkVersion(R.options.since,R.options.until)})),this.options.groups&&this.options.groups.length?Z=Z.filter(function(W){var R=nt.findExposeMetadata(_,W);return!R||!R.options?!0:Tt.checkGroups(R.options.groups)}):Z=Z.filter(function(W){var R=nt.findExposeMetadata(_,W);return!R||!R.options||!R.options.groups||!R.options.groups.length})}return this.options.excludePrefixes&&this.options.excludePrefixes.length&&(Z=Z.filter(function(X){return Tt.options.excludePrefixes.every(function(W){return X.substr(0,W.length)!==W})})),Z=Z.filter(function(X,W,R){return R.indexOf(X)===W}),Z},F.prototype.checkVersion=function(_,D){var G=!0;return G&&_&&(G=this.options.version>=_),G&&D&&(G=this.options.version<D),G},F.prototype.checkGroups=function(_){return _?this.options.groups.some(function(D){return _.includes(D)}):!0},F}(),L={enableCircularCheck:!1,enableImplicitConversion:!1,excludeExtraneousValues:!1,excludePrefixes:void 0,exposeDefaultValues:!1,exposeUnsetFields:!0,groups:void 0,ignoreDecorators:!1,strategy:void 0,targetMaps:void 0,version:void 0},P=function(){return P=Object.assign||function(F){for(var _,D=1,G=arguments.length;D<G;D++){_=arguments[D];for(var Tt in _)Object.prototype.hasOwnProperty.call(_,Tt)&&(F[Tt]=_[Tt])}return F},P.apply(this,arguments)},z=function(){function F(){}return F.prototype.instanceToPlain=function(_,D){var G=new J(d.CLASS_TO_PLAIN,P(P({},L),D));return G.transform(void 0,_,void 0,void 0,void 0,void 0)},F.prototype.classToPlainFromExist=function(_,D,G){var Tt=new J(d.CLASS_TO_PLAIN,P(P({},L),G));return Tt.transform(D,_,void 0,void 0,void 0,void 0)},F.prototype.plainToInstance=function(_,D,G){var Tt=new J(d.PLAIN_TO_CLASS,P(P({},L),G));return Tt.transform(void 0,D,_,void 0,void 0,void 0)},F.prototype.plainToClassFromExist=function(_,D,G){var Tt=new J(d.PLAIN_TO_CLASS,P(P({},L),G));return Tt.transform(_,D,void 0,void 0,void 0,void 0)},F.prototype.instanceToInstance=function(_,D){var G=new J(d.CLASS_TO_CLASS,P(P({},L),D));return G.transform(void 0,_,void 0,void 0,void 0,void 0)},F.prototype.classToClassFromExist=function(_,D,G){var Tt=new J(d.CLASS_TO_CLASS,P(P({},L),G));return Tt.transform(D,_,void 0,void 0,void 0,void 0)},F.prototype.serialize=function(_,D){return JSON.stringify(this.instanceToPlain(_,D))},F.prototype.deserialize=function(_,D,G){var Tt=JSON.parse(D);return this.plainToInstance(_,Tt,G)},F.prototype.deserializeArray=function(_,D,G){var Tt=JSON.parse(D);return this.plainToInstance(_,Tt,G)},F}(),j=new z;function tt(F,_){return j.instanceToPlain(F,_)}function k(F,_){return j.instanceToPlain(F,_)}function mt(F,_,D){return j.classToPlainFromExist(F,_,D)}function ht(F,_,D){return j.plainToInstance(F,_,D)}function B(F,_,D){return j.plainToInstance(F,_,D)}function U(F,_,D){return j.plainToClassFromExist(F,_,D)}function q(F,_){return j.instanceToInstance(F,_)}function at(F,_,D){return j.classToClassFromExist(F,_,D)}function rt(F,_){return j.serialize(F,_)}function dt(F,_,D){return j.deserialize(F,_,D)}function S(F,_,D){return j.deserializeArray(F,_,D)}},6775:function(It,Ot,st){var d,yt=function(){var nt=String.fromCharCode,Ct="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",it="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",_t={};function H(L,P){if(!_t[L]){_t[L]={};for(var z=0;z<L.length;z++)_t[L][L.charAt(z)]=z}return _t[L][P]}var J={compressToBase64:function(L){if(L==null)return"";var P=J._compress(L,6,function(z){return Ct.charAt(z)});switch(P.length%4){default:case 0:return P;case 1:return P+"===";case 2:return P+"==";case 3:return P+"="}},decompressFromBase64:function(L){return L==null?"":L==""?null:J._decompress(L.length,32,function(P){return H(Ct,L.charAt(P))})},compressToUTF16:function(L){return L==null?"":J._compress(L,15,function(P){return nt(P+32)})+" "},decompressFromUTF16:function(L){return L==null?"":L==""?null:J._decompress(L.length,16384,function(P){return L.charCodeAt(P)-32})},compressToUint8Array:function(L){for(var P=J.compress(L),z=new Uint8Array(P.length*2),j=0,tt=P.length;j<tt;j++){var k=P.charCodeAt(j);z[j*2]=k>>>8,z[j*2+1]=k%256}return z},decompressFromUint8Array:function(L){if(L==null)return J.decompress(L);for(var P=new Array(L.length/2),z=0,j=P.length;z<j;z++)P[z]=L[z*2]*256+L[z*2+1];var tt=[];return P.forEach(function(k){tt.push(nt(k))}),J.decompress(tt.join(""))},compressToEncodedURIComponent:function(L){return L==null?"":J._compress(L,6,function(P){return it.charAt(P)})},decompressFromEncodedURIComponent:function(L){return L==null?"":L==""?null:(L=L.replace(/ /g,"+"),J._decompress(L.length,32,function(P){return H(it,L.charAt(P))}))},compress:function(L){return J._compress(L,16,function(P){return nt(P)})},_compress:function(L,P,z){if(L==null)return"";var j,tt,k={},mt={},ht="",B="",U="",q=2,at=3,rt=2,dt=[],S=0,F=0,_;for(_=0;_<L.length;_+=1)if(ht=L.charAt(_),Object.prototype.hasOwnProperty.call(k,ht)||(k[ht]=at++,mt[ht]=!0),B=U+ht,Object.prototype.hasOwnProperty.call(k,B))U=B;else{if(Object.prototype.hasOwnProperty.call(mt,U)){if(U.charCodeAt(0)<256){for(j=0;j<rt;j++)S=S<<1,F==P-1?(F=0,dt.push(z(S)),S=0):F++;for(tt=U.charCodeAt(0),j=0;j<8;j++)S=S<<1|tt&1,F==P-1?(F=0,dt.push(z(S)),S=0):F++,tt=tt>>1}else{for(tt=1,j=0;j<rt;j++)S=S<<1|tt,F==P-1?(F=0,dt.push(z(S)),S=0):F++,tt=0;for(tt=U.charCodeAt(0),j=0;j<16;j++)S=S<<1|tt&1,F==P-1?(F=0,dt.push(z(S)),S=0):F++,tt=tt>>1}q--,q==0&&(q=Math.pow(2,rt),rt++),delete mt[U]}else for(tt=k[U],j=0;j<rt;j++)S=S<<1|tt&1,F==P-1?(F=0,dt.push(z(S)),S=0):F++,tt=tt>>1;q--,q==0&&(q=Math.pow(2,rt),rt++),k[B]=at++,U=String(ht)}if(U!==""){if(Object.prototype.hasOwnProperty.call(mt,U)){if(U.charCodeAt(0)<256){for(j=0;j<rt;j++)S=S<<1,F==P-1?(F=0,dt.push(z(S)),S=0):F++;for(tt=U.charCodeAt(0),j=0;j<8;j++)S=S<<1|tt&1,F==P-1?(F=0,dt.push(z(S)),S=0):F++,tt=tt>>1}else{for(tt=1,j=0;j<rt;j++)S=S<<1|tt,F==P-1?(F=0,dt.push(z(S)),S=0):F++,tt=0;for(tt=U.charCodeAt(0),j=0;j<16;j++)S=S<<1|tt&1,F==P-1?(F=0,dt.push(z(S)),S=0):F++,tt=tt>>1}q--,q==0&&(q=Math.pow(2,rt),rt++),delete mt[U]}else for(tt=k[U],j=0;j<rt;j++)S=S<<1|tt&1,F==P-1?(F=0,dt.push(z(S)),S=0):F++,tt=tt>>1;q--,q==0&&(q=Math.pow(2,rt),rt++)}for(tt=2,j=0;j<rt;j++)S=S<<1|tt&1,F==P-1?(F=0,dt.push(z(S)),S=0):F++,tt=tt>>1;for(;;)if(S=S<<1,F==P-1){dt.push(z(S));break}else F++;return dt.join("")},decompress:function(L){return L==null?"":L==""?null:J._decompress(L.length,32768,function(P){return L.charCodeAt(P)})},_decompress:function(L,P,z){var j=[],tt,k=4,mt=4,ht=3,B="",U=[],q,at,rt,dt,S,F,_,D={val:z(0),position:P,index:1};for(q=0;q<3;q+=1)j[q]=q;for(rt=0,S=Math.pow(2,2),F=1;F!=S;)dt=D.val&D.position,D.position>>=1,D.position==0&&(D.position=P,D.val=z(D.index++)),rt|=(dt>0?1:0)*F,F<<=1;switch(tt=rt){case 0:for(rt=0,S=Math.pow(2,8),F=1;F!=S;)dt=D.val&D.position,D.position>>=1,D.position==0&&(D.position=P,D.val=z(D.index++)),rt|=(dt>0?1:0)*F,F<<=1;_=nt(rt);break;case 1:for(rt=0,S=Math.pow(2,16),F=1;F!=S;)dt=D.val&D.position,D.position>>=1,D.position==0&&(D.position=P,D.val=z(D.index++)),rt|=(dt>0?1:0)*F,F<<=1;_=nt(rt);break;case 2:return""}for(j[3]=_,at=_,U.push(_);;){if(D.index>L)return"";for(rt=0,S=Math.pow(2,ht),F=1;F!=S;)dt=D.val&D.position,D.position>>=1,D.position==0&&(D.position=P,D.val=z(D.index++)),rt|=(dt>0?1:0)*F,F<<=1;switch(_=rt){case 0:for(rt=0,S=Math.pow(2,8),F=1;F!=S;)dt=D.val&D.position,D.position>>=1,D.position==0&&(D.position=P,D.val=z(D.index++)),rt|=(dt>0?1:0)*F,F<<=1;j[mt++]=nt(rt),_=mt-1,k--;break;case 1:for(rt=0,S=Math.pow(2,16),F=1;F!=S;)dt=D.val&D.position,D.position>>=1,D.position==0&&(D.position=P,D.val=z(D.index++)),rt|=(dt>0?1:0)*F,F<<=1;j[mt++]=nt(rt),_=mt-1,k--;break;case 2:return U.join("")}if(k==0&&(k=Math.pow(2,ht),ht++),j[_])B=j[_];else if(_===mt)B=at+at.charAt(0);else return null;U.push(B),j[mt++]=at+B.charAt(0),k--,at=B,k==0&&(k=Math.pow(2,ht),ht++)}}};return J}();d=function(){return yt}.call(Ot,st,Ot,It),d!==void 0&&(It.exports=d)},9774:function(It,Ot,st){"use strict";var yr;st.d(Ot,{iw:function(){return k},T$:function(){return it},VL:function(){return oe},a$:function(){return Xs},JZ:function(){return Hr},Ie:function(){return qs},lW:function(){return Ie},qm:function(){return Ai},yl:function(){return mt},Cd:function(){return hs},Il:function(){return Ce},ZX:function(){return Vs},lg:function(){return _t},Pj:function(){return Xr},nw:function(){return Qt},I2:function(){return H},wn:function(){return sr},wG:function(){return Er},A7:function(){return U},KI:function(){return tt},y3:function(){return fe},bO:function(){return zr},AB:function(){return Ne},_b:function(){return os},E9:function(){return le},mg:function(){return wr},$r:function(){return Pr},ud:function(){return en},jl:function(){return as},Ae:function(){return ne},TI:function(){return Rr},c9:function(){return oi},aH:function(){return z},HS:function(){return lr},pX:function(){return Ps},ex:function(){return Vr},ZM:function(){return Tr},vK:function(){return L},xE:function(){return ae},UX:function(){return Ts},vB:function(){return Mt},wx:function(){return ls},uF:function(){return vt},oo:function(){return qe},eH:function(){return fi},Rv:function(){return Gs},Nt:function(){return j},e6:function(){return Bt},Y9:function(){return Ut},kP:function(){return ue},Rw:function(){return se},Xd:function(){return S},P6:function(){return d}});var d={};st.r(d),st.d(d,{BaseTextureCache:function(){return Fe},BoundingBox:function(){return Gr},CanvasRenderTarget:function(){return br},DATA_URI:function(){return Ki},EventEmitter:function(){return Ft},ProgramCache:function(){return We},TextureCache:function(){return be},clearTextureCache:function(){return Fn},correctBlendMode:function(){return _i},createIndicesForQuads:function(){return Pn},decomposeDataUri:function(){return On},deprecation:function(){return bt},destroyTextureCache:function(){return Dn},detectVideoAlphaMode:function(){return Le},determineCrossOrigin:function(){return si},earcut:function(){return St},getBufferType:function(){return xi},getCanvasBoundingBox:function(){return Ns},getResolutionOfUrl:function(){return Zi},hex2rgb:function(){return yi},hex2string:function(){return Yi},interleaveTypedArrays:function(){return Rn},isMobile:function(){return Et},isPow2:function(){return ri},isWebGLSupported:function(){return qr},log2:function(){return qi},nextPow2:function(){return ei},path:function(){return Pe},premultiplyBlendMode:function(){return ti},premultiplyRgba:function(){return Cn},premultiplyTint:function(){return vi},premultiplyTintToRgba:function(){return In},removeItems:function(){return Ls},rgb2hex:function(){return ar},sayHello:function(){return $e},sign:function(){return Mn},skipHello:function(){return zi},string2hex:function(){return Jr},trimCanvas:function(){return Us},uid:function(){return hr},url:function(){return he}});var yt=(s=>(s[s.WEBGL_LEGACY=0]="WEBGL_LEGACY",s[s.WEBGL=1]="WEBGL",s[s.WEBGL2=2]="WEBGL2",s))(yt||{}),nt=(s=>(s[s.UNKNOWN=0]="UNKNOWN",s[s.WEBGL=1]="WEBGL",s[s.CANVAS=2]="CANVAS",s))(nt||{}),Ct=(s=>(s[s.COLOR=16384]="COLOR",s[s.DEPTH=256]="DEPTH",s[s.STENCIL=1024]="STENCIL",s))(Ct||{}),it=(s=>(s[s.NORMAL=0]="NORMAL",s[s.ADD=1]="ADD",s[s.MULTIPLY=2]="MULTIPLY",s[s.SCREEN=3]="SCREEN",s[s.OVERLAY=4]="OVERLAY",s[s.DARKEN=5]="DARKEN",s[s.LIGHTEN=6]="LIGHTEN",s[s.COLOR_DODGE=7]="COLOR_DODGE",s[s.COLOR_BURN=8]="COLOR_BURN",s[s.HARD_LIGHT=9]="HARD_LIGHT",s[s.SOFT_LIGHT=10]="SOFT_LIGHT",s[s.DIFFERENCE=11]="DIFFERENCE",s[s.EXCLUSION=12]="EXCLUSION",s[s.HUE=13]="HUE",s[s.SATURATION=14]="SATURATION",s[s.COLOR=15]="COLOR",s[s.LUMINOSITY=16]="LUMINOSITY",s[s.NORMAL_NPM=17]="NORMAL_NPM",s[s.ADD_NPM=18]="ADD_NPM",s[s.SCREEN_NPM=19]="SCREEN_NPM",s[s.NONE=20]="NONE",s[s.SRC_OVER=0]="SRC_OVER",s[s.SRC_IN=21]="SRC_IN",s[s.SRC_OUT=22]="SRC_OUT",s[s.SRC_ATOP=23]="SRC_ATOP",s[s.DST_OVER=24]="DST_OVER",s[s.DST_IN=25]="DST_IN",s[s.DST_OUT=26]="DST_OUT",s[s.DST_ATOP=27]="DST_ATOP",s[s.ERASE=26]="ERASE",s[s.SUBTRACT=28]="SUBTRACT",s[s.XOR=29]="XOR",s))(it||{}),_t=(s=>(s[s.POINTS=0]="POINTS",s[s.LINES=1]="LINES",s[s.LINE_LOOP=2]="LINE_LOOP",s[s.LINE_STRIP=3]="LINE_STRIP",s[s.TRIANGLES=4]="TRIANGLES",s[s.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",s[s.TRIANGLE_FAN=6]="TRIANGLE_FAN",s))(_t||{}),H=(s=>(s[s.RGBA=6408]="RGBA",s[s.RGB=6407]="RGB",s[s.RG=33319]="RG",s[s.RED=6403]="RED",s[s.RGBA_INTEGER=36249]="RGBA_INTEGER",s[s.RGB_INTEGER=36248]="RGB_INTEGER",s[s.RG_INTEGER=33320]="RG_INTEGER",s[s.RED_INTEGER=36244]="RED_INTEGER",s[s.ALPHA=6406]="ALPHA",s[s.LUMINANCE=6409]="LUMINANCE",s[s.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",s[s.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",s[s.DEPTH_STENCIL=34041]="DEPTH_STENCIL",s))(H||{}),J=(s=>(s[s.TEXTURE_2D=3553]="TEXTURE_2D",s[s.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",s[s.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",s[s.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",s[s.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",s[s.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",s[s.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",s))(J||{}),L=(s=>(s[s.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",s[s.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",s[s.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",s[s.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",s[s.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",s[s.UNSIGNED_INT=5125]="UNSIGNED_INT",s[s.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",s[s.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",s[s.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",s[s.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",s[s.BYTE=5120]="BYTE",s[s.SHORT=5122]="SHORT",s[s.INT=5124]="INT",s[s.FLOAT=5126]="FLOAT",s[s.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",s[s.HALF_FLOAT=36193]="HALF_FLOAT",s))(L||{}),P=(s=>(s[s.FLOAT=0]="FLOAT",s[s.INT=1]="INT",s[s.UINT=2]="UINT",s))(P||{}),z=(s=>(s[s.NEAREST=0]="NEAREST",s[s.LINEAR=1]="LINEAR",s))(z||{}),j=(s=>(s[s.CLAMP=33071]="CLAMP",s[s.REPEAT=10497]="REPEAT",s[s.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",s))(j||{}),tt=(s=>(s[s.OFF=0]="OFF",s[s.POW2=1]="POW2",s[s.ON=2]="ON",s[s.ON_MANUAL=3]="ON_MANUAL",s))(tt||{}),k=(s=>(s[s.NPM=0]="NPM",s[s.UNPACK=1]="UNPACK",s[s.PMA=2]="PMA",s[s.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",s[s.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",s[s.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",s))(k||{}),mt=(s=>(s[s.NO=0]="NO",s[s.YES=1]="YES",s[s.AUTO=2]="AUTO",s[s.BLEND=0]="BLEND",s[s.CLEAR=1]="CLEAR",s[s.BLIT=2]="BLIT",s))(mt||{}),ht=(s=>(s[s.AUTO=0]="AUTO",s[s.MANUAL=1]="MANUAL",s))(ht||{}),B=(s=>(s.LOW="lowp",s.MEDIUM="mediump",s.HIGH="highp",s))(B||{}),U=(s=>(s[s.NONE=0]="NONE",s[s.SCISSOR=1]="SCISSOR",s[s.STENCIL=2]="STENCIL",s[s.SPRITE=3]="SPRITE",s[s.COLOR=4]="COLOR",s))(U||{}),q=(s=>(s[s.RED=1]="RED",s[s.GREEN=2]="GREEN",s[s.BLUE=4]="BLUE",s[s.ALPHA=8]="ALPHA",s))(q||{}),at=(s=>(s[s.NONE=0]="NONE",s[s.LOW=2]="LOW",s[s.MEDIUM=4]="MEDIUM",s[s.HIGH=8]="HIGH",s))(at||{}),rt=(s=>(s[s.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",s[s.ARRAY_BUFFER=34962]="ARRAY_BUFFER",s[s.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",s))(rt||{});const S={ADAPTER:{createCanvas:(s,e)=>{const i=document.createElement("canvas");return i.width=s,i.height=e,i},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>{var s;return(s=document.baseURI)!=null?s:window.location.href},getFontFaceSet:()=>document.fonts,fetch:(s,e)=>fetch(s,e),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")},RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var F=/iPhone/i,_=/iPod/i,D=/iPad/i,G=/\biOS-universal(?:.+)Mac\b/i,Tt=/\bAndroid(?:.+)Mobile\b/i,wt=/Android/i,Z=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,E=/Silk/i,C=/Windows Phone/i,I=/\bWindows(?:.+)ARM\b/i,X=/BlackBerry/i,W=/BB10/i,R=/Opera Mini/i,V=/\b(CriOS|Chrome)(?:.+)Mobile/i,ot=/Mobile(?:.+)Firefox\b/i,xt=function(s){return typeof s!="undefined"&&s.platform==="MacIntel"&&typeof s.maxTouchPoints=="number"&&s.maxTouchPoints>1&&typeof MSStream=="undefined"};function ct(s){return function(e){return e.test(s)}}function pt(s){var e={userAgent:"",platform:"",maxTouchPoints:0};!s&&typeof navigator!="undefined"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof s=="string"?e.userAgent=s:s&&s.userAgent&&(e={userAgent:s.userAgent,platform:s.platform,maxTouchPoints:s.maxTouchPoints||0});var i=e.userAgent,o=i.split("[FBAN");typeof o[1]!="undefined"&&(i=o[0]),o=i.split("Twitter"),typeof o[1]!="undefined"&&(i=o[0]);var h=ct(i),u={apple:{phone:h(F)&&!h(C),ipod:h(_),tablet:!h(F)&&(h(D)||xt(e))&&!h(C),universal:h(G),device:(h(F)||h(_)||h(D)||h(G)||xt(e))&&!h(C)},amazon:{phone:h(Z),tablet:!h(Z)&&h(E),device:h(Z)||h(E)},android:{phone:!h(C)&&h(Z)||!h(C)&&h(Tt),tablet:!h(C)&&!h(Z)&&!h(Tt)&&(h(E)||h(wt)),device:!h(C)&&(h(Z)||h(E)||h(Tt)||h(wt))||h(/\bokhttp\b/i)},windows:{phone:h(C),tablet:h(I),device:h(C)||h(I)},other:{blackberry:h(X),blackberry10:h(W),opera:h(R),firefox:h(ot),chrome:h(V),device:h(X)||h(W)||h(R)||h(ot)||h(V)},any:!1,phone:!1,tablet:!1};return u.any=u.apple.device||u.android.device||u.windows.device||u.other.device,u.phone=u.apple.phone||u.android.phone||u.windows.phone,u.tablet=u.apple.tablet||u.android.tablet||u.windows.tablet,u}const At=(yr=pt.default)!=null?yr:pt,Et=At(globalThis.navigator);S.RETINA_PREFIX=/@([0-9\.]+)x/,S.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Ft=st(6729),St=st(9187),zt=st(8575);const Xt={};function bt(s,e,i=3){if(Xt[e])return;let o=new Error().stack;typeof o>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${s}`):(o=o.split(`
`).splice(i).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${s}`),console.warn(o),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${s}`),console.warn(o))),Xt[e]=!0}const he={get parse(){return bt("7.3.0","utils.url.parse is deprecated, use native URL API instead."),zt.Qc},get format(){return bt("7.3.0","utils.url.format is deprecated, use native URL API instead."),zt.WU},get resolve(){return bt("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),zt.DB}};function Nt(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function kt(s){return s.split("?")[0].split("#")[0]}function ye(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ge(s,e,i){return s.replace(new RegExp(ye(e),"g"),i)}function Ue(s,e){let i="",o=0,h=-1,u=0,m=-1;for(let v=0;v<=s.length;++v){if(v<s.length)m=s.charCodeAt(v);else{if(m===47)break;m=47}if(m===47){if(!(h===v-1||u===1))if(h!==v-1&&u===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){const w=i.lastIndexOf("/");if(w!==i.length-1){w===-1?(i="",o=0):(i=i.slice(0,w),o=i.length-1-i.lastIndexOf("/")),h=v,u=0;continue}}else if(i.length===2||i.length===1){i="",o=0,h=v,u=0;continue}}e&&(i.length>0?i+="/..":i="..",o=2)}else i.length>0?i+=`/${s.slice(h+1,v)}`:i=s.slice(h+1,v),o=v-h-1;h=v,u=0}else m===46&&u!==-1?++u:u=-1}return i}const Pe={toPosix(s){return Ge(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},isBlobUrl(s){return s.startsWith("blob:")},hasProtocol(s){return/^[^/:]+:/.test(this.toPosix(s))},getProtocol(s){Nt(s),s=this.toPosix(s);const e=/^file:\/\/\//.exec(s);if(e)return e[0];const i=/^[^/:]+:\/{0,2}/.exec(s);return i?i[0]:""},toAbsolute(s,e,i){if(Nt(s),this.isDataUrl(s)||this.isBlobUrl(s))return s;const o=kt(this.toPosix(e!=null?e:S.ADAPTER.getBaseUrl())),h=kt(this.toPosix(i!=null?i:this.rootname(o)));return s=this.toPosix(s),s.startsWith("/")?Pe.join(h,s.slice(1)):this.isAbsolute(s)?s:this.join(o,s)},normalize(s){if(Nt(s),s.length===0)return".";if(this.isDataUrl(s)||this.isBlobUrl(s))return s;s=this.toPosix(s);let e="";const i=s.startsWith("/");this.hasProtocol(s)&&(e=this.rootname(s),s=s.slice(e.length));const o=s.endsWith("/");return s=Ue(s,!1),s.length>0&&o&&(s+="/"),i?`/${s}`:e+s},isAbsolute(s){return Nt(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){var i;if(s.length===0)return".";let e;for(let o=0;o<s.length;++o){const h=s[o];if(Nt(h),h.length>0)if(e===void 0)e=h;else{const u=(i=s[o-1])!=null?i:"";this.extname(u)?e+=`/../${h}`:e+=`/${h}`}}return e===void 0?".":this.normalize(e)},dirname(s){if(Nt(s),s.length===0)return".";s=this.toPosix(s);let e=s.charCodeAt(0);const i=e===47;let o=-1,h=!0;const u=this.getProtocol(s),m=s;s=s.slice(u.length);for(let v=s.length-1;v>=1;--v)if(e=s.charCodeAt(v),e===47){if(!h){o=v;break}}else h=!1;return o===-1?i?"/":this.isUrl(m)?u+s:u:i&&o===1?"//":u+s.slice(0,o)},rootname(s){Nt(s),s=this.toPosix(s);let e="";if(s.startsWith("/")?e="/":e=this.getProtocol(s),this.isUrl(s)){const i=s.indexOf("/",e.length);i!==-1?e=s.slice(0,i):e=s,e.endsWith("/")||(e+="/")}return e},basename(s,e){Nt(s),e&&Nt(e),s=kt(this.toPosix(s));let i=0,o=-1,h=!0,u;if(e!==void 0&&e.length>0&&e.length<=s.length){if(e.length===s.length&&e===s)return"";let m=e.length-1,v=-1;for(u=s.length-1;u>=0;--u){const w=s.charCodeAt(u);if(w===47){if(!h){i=u+1;break}}else v===-1&&(h=!1,v=u+1),m>=0&&(w===e.charCodeAt(m)?--m===-1&&(o=u):(m=-1,o=v))}return i===o?o=v:o===-1&&(o=s.length),s.slice(i,o)}for(u=s.length-1;u>=0;--u)if(s.charCodeAt(u)===47){if(!h){i=u+1;break}}else o===-1&&(h=!1,o=u+1);return o===-1?"":s.slice(i,o)},extname(s){Nt(s),s=kt(this.toPosix(s));let e=-1,i=0,o=-1,h=!0,u=0;for(let m=s.length-1;m>=0;--m){const v=s.charCodeAt(m);if(v===47){if(!h){i=m+1;break}continue}o===-1&&(h=!1,o=m+1),v===46?e===-1?e=m:u!==1&&(u=1):e!==-1&&(u=-1)}return e===-1||o===-1||u===0||u===1&&e===o-1&&e===i+1?"":s.slice(e,o)},parse(s){Nt(s);const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return e;s=kt(this.toPosix(s));let i=s.charCodeAt(0);const o=this.isAbsolute(s);let h;const u="";e.root=this.rootname(s),o||this.hasProtocol(s)?h=1:h=0;let m=-1,v=0,w=-1,N=!0,lt=s.length-1,gt=0;for(;lt>=h;--lt){if(i=s.charCodeAt(lt),i===47){if(!N){v=lt+1;break}continue}w===-1&&(N=!1,w=lt+1),i===46?m===-1?m=lt:gt!==1&&(gt=1):m!==-1&&(gt=-1)}return m===-1||w===-1||gt===0||gt===1&&m===w-1&&m===v+1?w!==-1&&(v===0&&o?e.base=e.name=s.slice(1,w):e.base=e.name=s.slice(v,w)):(v===0&&o?(e.name=s.slice(1,m),e.base=s.slice(1,w)):(e.name=s.slice(v,m),e.base=s.slice(v,w)),e.ext=s.slice(m,w)),e.dir=this.dirname(s),u&&(e.dir=u+e.dir),e},sep:"/",delimiter:":"};let ee;function Le(){return Lt(this,null,function*(){return ee!=null||(ee=(()=>Lt(this,null,function*(){var u;const s=document.createElement("canvas").getContext("webgl");if(!s)return k.UNPACK;const e=yield new Promise(m=>{const v=document.createElement("video");v.onloadeddata=()=>m(v),v.onerror=()=>m(null),v.autoplay=!1,v.crossOrigin="anonymous",v.preload="auto",v.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",v.load()});if(!e)return k.UNPACK;const i=s.createTexture();s.bindTexture(s.TEXTURE_2D,i);const o=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,o),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,i,0),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.NONE),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,e);const h=new Uint8Array(4);return s.readPixels(0,0,1,1,s.RGBA,s.UNSIGNED_BYTE,h),s.deleteFramebuffer(o),s.deleteTexture(i),(u=s.getExtension("WEBGL_lose_context"))==null||u.loseContext(),h[0]<=h[3]?k.PMA:k.UNPACK}))()),ee})}function zi(){bt("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function $e(){bt("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}let Re;function qr(){return typeof Re>"u"&&(Re=function(){var e;const s={stencil:!0,failIfMajorPerformanceCaveat:S.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!S.ADAPTER.getWebGLRenderingContext())return!1;const i=S.ADAPTER.createCanvas();let o=i.getContext("webgl",s)||i.getContext("experimental-webgl",s);const h=!!((e=o==null?void 0:o.getContextAttributes())!=null&&e.stencil);if(o){const u=o.getExtension("WEBGL_lose_context");u&&u.loseContext()}return o=null,h}catch(i){return!1}}()),Re}var Je={grad:.9,turn:360,rad:360/(2*Math.PI)},Ee=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},_e=function(s,e,i){return e===void 0&&(e=0),i===void 0&&(i=Math.pow(10,e)),Math.round(i*s)/i+0},de=function(s,e,i){return e===void 0&&(e=0),i===void 0&&(i=1),s>i?i:s>e?s:e},tr=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},mi=function(s){return{r:de(s.r,0,255),g:de(s.g,0,255),b:de(s.b,0,255),a:de(s.a)}},vr=function(s){return{r:_e(s.r),g:_e(s.g),b:_e(s.b),a:_e(s.a,3)}},Lr=/^#([0-9a-f]{3,8})$/i,Y=function(s){var e=s.toString(16);return e.length<2?"0"+e:e},Q=function(s){var e=s.r,i=s.g,o=s.b,h=s.a,u=Math.max(e,i,o),m=u-Math.min(e,i,o),v=m?u===e?(i-o)/m:u===i?2+(o-e)/m:4+(e-i)/m:0;return{h:60*(v<0?v+6:v),s:u?m/u*100:0,v:u/255*100,a:h}},Jt=function(s){var e=s.h,i=s.s,o=s.v,h=s.a;e=e/360*6,i/=100,o/=100;var u=Math.floor(e),m=o*(1-i),v=o*(1-(e-u)*i),w=o*(1-(1-e+u)*i),N=u%6;return{r:255*[o,v,m,m,w,o][N],g:255*[w,o,o,v,m,m][N],b:255*[m,m,w,o,o,v][N],a:h}},ie=function(s){return{h:tr(s.h),s:de(s.s,0,100),l:de(s.l,0,100),a:de(s.a)}},me=function(s){return{h:_e(s.h),s:_e(s.s),l:_e(s.l),a:_e(s.a,3)}},qt=function(s){return Jt((i=(e=s).s,{h:e.h,s:(i*=((o=e.l)<50?o:100-o)/100)>0?2*i/(o+i)*100:0,v:o+i,a:e.a}));var e,i,o},De=function(s){return{h:(e=Q(s)).h,s:(h=(200-(i=e.s))*(o=e.v)/100)>0&&h<200?i*o/100/(h<=100?h:200-h)*100:0,l:h/2,a:e.a};var e,i,o,h},er=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Me=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,je=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Zr=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,He={string:[[function(s){var e=Lr.exec(s);return e?(s=e[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?_e(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?_e(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var e=je.exec(s)||Zr.exec(s);return e?e[2]!==e[4]||e[4]!==e[6]?null:mi({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(s){var e=er.exec(s)||Me.exec(s);if(!e)return null;var i,o,h=ie({h:(i=e[1],o=e[2],o===void 0&&(o="deg"),Number(i)*(Je[o]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return qt(h)},"hsl"]],object:[[function(s){var e=s.r,i=s.g,o=s.b,h=s.a,u=h===void 0?1:h;return Ee(e)&&Ee(i)&&Ee(o)?mi({r:Number(e),g:Number(i),b:Number(o),a:Number(u)}):null},"rgb"],[function(s){var e=s.h,i=s.s,o=s.l,h=s.a,u=h===void 0?1:h;if(!Ee(e)||!Ee(i)||!Ee(o))return null;var m=ie({h:Number(e),s:Number(i),l:Number(o),a:Number(u)});return qt(m)},"hsl"],[function(s){var e=s.h,i=s.s,o=s.v,h=s.a,u=h===void 0?1:h;if(!Ee(e)||!Ee(i)||!Ee(o))return null;var m=function(v){return{h:tr(v.h),s:de(v.s,0,100),v:de(v.v,0,100),a:de(v.a)}}({h:Number(e),s:Number(i),v:Number(o),a:Number(u)});return Jt(m)},"hsv"]]},Se=function(s,e){for(var i=0;i<e.length;i++){var o=e[i][0](s);if(o)return[o,e[i][1]]}return[null,void 0]},Qr=function(s){return typeof s=="string"?Se(s.trim(),He.string):typeof s=="object"&&s!==null?Se(s,He.object):[null,void 0]},$i=function(s){return Qr(s)[1]},Nr=function(s,e){var i=De(s);return{h:i.h,s:de(i.s+100*e,0,100),l:i.l,a:i.a}},Xe=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},Ur=function(s,e){var i=De(s);return{h:i.h,s:i.s,l:de(i.l+100*e,0,100),a:i.a}},Ye=function(){function s(e){this.parsed=Qr(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return _e(Xe(this.rgba),2)},s.prototype.isDark=function(){return Xe(this.rgba)<.5},s.prototype.isLight=function(){return Xe(this.rgba)>=.5},s.prototype.toHex=function(){return e=vr(this.rgba),i=e.r,o=e.g,h=e.b,m=(u=e.a)<1?Y(_e(255*u)):"","#"+Y(i)+Y(o)+Y(h)+m;var e,i,o,h,u,m},s.prototype.toRgb=function(){return vr(this.rgba)},s.prototype.toRgbString=function(){return e=vr(this.rgba),i=e.r,o=e.g,h=e.b,(u=e.a)<1?"rgba("+i+", "+o+", "+h+", "+u+")":"rgb("+i+", "+o+", "+h+")";var e,i,o,h,u},s.prototype.toHsl=function(){return me(De(this.rgba))},s.prototype.toHslString=function(){return e=me(De(this.rgba)),i=e.h,o=e.s,h=e.l,(u=e.a)<1?"hsla("+i+", "+o+"%, "+h+"%, "+u+")":"hsl("+i+", "+o+"%, "+h+"%)";var e,i,o,h,u},s.prototype.toHsv=function(){return e=Q(this.rgba),{h:_e(e.h),s:_e(e.s),v:_e(e.v),a:_e(e.a,3)};var e},s.prototype.invert=function(){return we({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},s.prototype.saturate=function(e){return e===void 0&&(e=.1),we(Nr(this.rgba,e))},s.prototype.desaturate=function(e){return e===void 0&&(e=.1),we(Nr(this.rgba,-e))},s.prototype.grayscale=function(){return we(Nr(this.rgba,-1))},s.prototype.lighten=function(e){return e===void 0&&(e=.1),we(Ur(this.rgba,e))},s.prototype.darken=function(e){return e===void 0&&(e=.1),we(Ur(this.rgba,-e))},s.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},s.prototype.alpha=function(e){return typeof e=="number"?we({r:(i=this.rgba).r,g:i.g,b:i.b,a:e}):_e(this.rgba.a,3);var i},s.prototype.hue=function(e){var i=De(this.rgba);return typeof e=="number"?we({h:e,s:i.s,l:i.l,a:i.a}):_e(i.h)},s.prototype.isEqual=function(e){return this.toHex()===we(e).toHex()},s}(),we=function(s){return s instanceof Ye?s:new Ye(s)},kr=[],gi=function(s){s.forEach(function(e){kr.indexOf(e)<0&&(e(Ye,He),kr.push(e))})},ji=function(){return new Ye({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})};function or(s,e){var i={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},o={};for(var h in i)o[i[h]]=h;var u={};s.prototype.toName=function(m){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var v,w,N=o[this.toHex()];if(N)return N;if(m!=null&&m.closest){var lt=this.toRgb(),gt=1/0,Pt="black";if(!u.length)for(var Kt in i)u[Kt]=new s(i[Kt]).toRgb();for(var ce in i){var Zt=(v=lt,w=u[ce],Math.pow(v.r-w.r,2)+Math.pow(v.g-w.g,2)+Math.pow(v.b-w.b,2));Zt<gt&&(gt=Zt,Pt=ce)}return Pt}},e.string.push([function(m){var v=m.toLowerCase(),w=v==="transparent"?"#0000":i[v];return w?new s(w).toRgb():null},"name"])}gi([or]);const rr=class Tn{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Tn)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?pe({},e):e}isSourceEqual(e,i){const o=typeof e;if(o!==typeof i)return!1;if(o==="number"||o==="string"||e instanceof Number)return e===i;if(Array.isArray(e)&&Array.isArray(i)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(i))return e.length!==i.length?!1:e.every((h,u)=>h===i[u]);if(e!==null&&i!==null){const h=Object.keys(e),u=Object.keys(i);return h.length!==u.length?!1:h.every(m=>e[m]===i[m])}return e===i}toRgba(){const[e,i,o,h]=this._components;return{r:e,g:i,b:o,a:h}}toRgb(){const[e,i,o]=this._components;return{r:e,g:i,b:o}}toRgbaString(){const[e,i,o]=this.toUint8RgbArray();return`rgba(${e},${i},${o},${this.alpha})`}toUint8RgbArray(e){const[i,o,h]=this._components;return e=e!=null?e:[],e[0]=Math.round(i*255),e[1]=Math.round(o*255),e[2]=Math.round(h*255),e}toRgbArray(e){e=e!=null?e:[];const[i,o,h]=this._components;return e[0]=i,e[1]=o,e[2]=h,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[i,o,h,u]=Tn.temp.setValue(e)._components;return this._components[0]*=i,this._components[1]*=o,this._components[2]*=h,this._components[3]*=u,this.refreshInt(),this._value=null,this}premultiply(e,i=!0){return i&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,i=!0){if(e===1)return(255<<24)+this._int;if(e===0)return i?0:this._int;let o=this._int>>16&255,h=this._int>>8&255,u=this._int&255;return i&&(o=o*e+.5|0,h=h*e+.5|0,u=u*e+.5|0),(e*255<<24)+(o<<16)+(h<<8)+u}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[i,o,h]=this._components;return this._components[0]=Math.round(i*e)/e,this._components[1]=Math.round(o*e)/e,this._components[2]=Math.round(h*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e!=null?e:[];const[i,o,h,u]=this._components;return e[0]=i,e[1]=o,e[2]=h,e[3]=u,e}normalize(e){let i,o,h,u;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const m=e;i=(m>>16&255)/255,o=(m>>8&255)/255,h=(m&255)/255,u=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[i,o,h,u=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[i,o,h,u=255]=e,i/=255,o/=255,h/=255,u/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const v=Tn.HEX_PATTERN.exec(e);v&&(e=`#${v[2]}`)}const m=we(e);m.isValid()&&({r:i,g:o,b:h,a:u}=m.rgba,i/=255,o/=255,h/=255)}if(i!==void 0)this._components[0]=i,this._components[1]=o,this._components[2]=h,this._components[3]=u,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,i,o]=this._components;this._int=(e*255<<16)+(i*255<<8)+(o*255|0)}_clamp(e,i=0,o=1){return typeof e=="number"?Math.min(Math.max(e,i),o):(e.forEach((h,u)=>{e[u]=Math.min(Math.max(h,i),o)}),e)}};rr.shared=new rr,rr.temp=new rr,rr.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Ce=rr;function yi(s,e=[]){return bt("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),Ce.shared.setValue(s).toRgbArray(e)}function Yi(s){return bt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Ce.shared.setValue(s).toHex()}function Jr(s){return bt("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),Ce.shared.setValue(s).toNumber()}function ar(s){return bt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Ce.shared.setValue(s).toNumber()}function xr(){const s=[],e=[];for(let o=0;o<32;o++)s[o]=o,e[o]=o;s[it.NORMAL_NPM]=it.NORMAL,s[it.ADD_NPM]=it.ADD,s[it.SCREEN_NPM]=it.SCREEN,e[it.NORMAL]=it.NORMAL_NPM,e[it.ADD]=it.ADD_NPM,e[it.SCREEN]=it.SCREEN_NPM;const i=[];return i.push(e),i.push(s),i}const ti=xr();function _i(s,e){return ti[e?1:0][s]}function Cn(s,e,i,o=!0){return bt("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),Ce.shared.setValue(s).premultiply(e,o).toArray(i!=null?i:new Float32Array(4))}function vi(s,e){return bt("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),Ce.shared.setValue(s).toPremultiplied(e)}function In(s,e,i,o=!0){return bt("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),Ce.shared.setValue(s).premultiply(e,o).toArray(i!=null?i:new Float32Array(4))}const Ki=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Pn(s,e=null){const i=s*6;if(e=e||new Uint16Array(i),e.length!==i)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${i}`);for(let o=0,h=0;o<i;o+=6,h+=4)e[o+0]=h+0,e[o+1]=h+1,e[o+2]=h+2,e[o+3]=h+0,e[o+4]=h+2,e[o+5]=h+3;return e}function xi(s){if(s.BYTES_PER_ELEMENT===4)return s instanceof Float32Array?"Float32Array":s instanceof Uint32Array?"Uint32Array":"Int32Array";if(s.BYTES_PER_ELEMENT===2){if(s instanceof Uint16Array)return"Uint16Array"}else if(s.BYTES_PER_ELEMENT===1&&s instanceof Uint8Array)return"Uint8Array";return null}const Os={Float32Array,Uint32Array,Int32Array,Uint8Array};function Rn(s,e){let i=0,o=0;const h={};for(let w=0;w<s.length;w++)o+=e[w],i+=s[w].length;const u=new ArrayBuffer(i*4);let m=null,v=0;for(let w=0;w<s.length;w++){const N=e[w],lt=s[w],gt=xi(lt);h[gt]||(h[gt]=new Os[gt](u)),m=h[gt];for(let Pt=0;Pt<lt.length;Pt++){const Kt=(Pt/N|0)*o+v,ce=Pt%N;m[Kt+ce]=lt[Pt]}v+=N}return new Float32Array(u)}function ei(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function ri(s){return!(s&s-1)&&!!s}function qi(s){let e=(s>65535?1:0)<<4;s>>>=e;let i=(s>255?1:0)<<3;return s>>>=i,e|=i,i=(s>15?1:0)<<2,s>>>=i,e|=i,i=(s>3?1:0)<<1,s>>>=i,e|=i,e|s>>1}function Ls(s,e,i){const o=s.length;let h;if(e>=o||i===0)return;i=e+i>o?o-e:i;const u=o-i;for(h=e;h<u;++h)s[h]=s[h+i];s.length=u}function Mn(s){return s===0?0:s<0?-1:1}let Bn=0;function hr(){return++Bn}const Be=class{constructor(s,e,i,o){this.left=s,this.top=e,this.right=i,this.bottom=o}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};Be.EMPTY=new Be(0,0,0,0);let Gr=Be;const We={},be=Object.create(null),Fe=Object.create(null);function Dn(){let s;for(s in be)be[s].destroy();for(s in Fe)Fe[s].destroy()}function Fn(){let s;for(s in be)delete be[s];for(s in Fe)delete Fe[s]}class br{constructor(e,i,o){this._canvas=S.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=o||S.RESOLUTION,this.resize(e,i)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,i){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(i*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function bi(s,e,i){for(let o=0,h=4*i*e;o<e;++o,h+=4)if(s[h+3]!==0)return!1;return!0}function ii(s,e,i,o,h){const u=4*e;for(let m=o,v=o*u+4*i;m<=h;++m,v+=u)if(s[v+3]!==0)return!1;return!0}function Ns(s){const{width:e,height:i}=s,o=s.getContext("2d",{willReadFrequently:!0});if(o===null)throw new TypeError("Failed to get canvas 2D context");const h=o.getImageData(0,0,e,i).data;let u=0,m=0,v=e-1,w=i-1;for(;m<i&&bi(h,e,m);)++m;if(m===i)return Gr.EMPTY;for(;bi(h,e,w);)--w;for(;ii(h,e,u,m,w);)++u;for(;ii(h,e,v,m,w);)--v;return++v,++w,new Gr(u,m,v,w)}function Us(s){const e=Ns(s),{width:i,height:o}=e;let h=null;if(!e.isEmpty()){const u=s.getContext("2d");if(u===null)throw new TypeError("Failed to get canvas 2D context");h=u.getImageData(e.left,e.top,i,o)}return{width:i,height:o,data:h}}function On(s){const e=Ki.exec(s);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}function si(s,e=globalThis.location){if(s.startsWith("data:"))return"";e=e||globalThis.location;const i=new URL(s,document.baseURI);return i.hostname!==e.hostname||i.port!==e.port||i.protocol!==e.protocol?"anonymous":""}function Zi(s,e=1){var o;const i=(o=S.RETINA_PREFIX)==null?void 0:o.exec(s);return i?parseFloat(i[1]):e}var Qt=(s=>(s.Renderer="renderer",s.Application="application",s.RendererSystem="renderer-webgl-system",s.RendererPlugin="renderer-webgl-plugin",s.CanvasRendererSystem="renderer-canvas-system",s.CanvasRendererPlugin="renderer-canvas-plugin",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s))(Qt||{});const Qi=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s=pi(pe({},typeof s.extension!="object"?{type:s.extension}:s.extension),{ref:s})}if(typeof s=="object")s=pe({},s);else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},ks=(s,e)=>{var i;return(i=Qi(s).priority)!=null?i:e},se={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(Qi).forEach(e=>{e.type.forEach(i=>{var o,h;return(h=(o=this._removeHandlers)[i])==null?void 0:h.call(o,e)})}),this},add(...s){return s.map(Qi).forEach(e=>{e.type.forEach(i=>{const o=this._addHandlers,h=this._queue;o[i]?o[i](e):(h[i]=h[i]||[],h[i].push(e))})}),this},handle(s,e,i){const o=this._addHandlers,h=this._removeHandlers;if(o[s]||h[s])throw new Error(`Extension type ${s} already has a handler`);o[s]=e,h[s]=i;const u=this._queue;return u[s]&&(u[s].forEach(m=>e(m)),delete u[s]),this},handleByMap(s,e){return this.handle(s,i=>{e[i.name]=i.ref},i=>{delete e[i.name]})},handleByList(s,e,i=-1){return this.handle(s,o=>{e.includes(o.ref)||(e.push(o.ref),e.sort((h,u)=>ks(u,i)-ks(h,i)))},o=>{const h=e.indexOf(o.ref);h!==-1&&e.splice(h,1)})}};class Gs{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const Ln=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Nn(s){let e="";for(let i=0;i<s;++i)i>0&&(e+=`
else `),i<s-1&&(e+=`if(test == ${i}.0){}`);return e}function Un(s,e){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const i=e.createShader(e.FRAGMENT_SHADER);for(;;){const o=Ln.replace(/%forloop%/gi,Nn(s));if(e.shaderSource(i,o),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))s=s/2|0;else break}return s}const Ji=0,ts=1,es=2,rs=3,is=4,ss=5;class Tr{constructor(){this.data=0,this.blendMode=it.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Ji)}set blend(e){!!(this.data&1<<Ji)!==e&&(this.data^=1<<Ji)}get offsets(){return!!(this.data&1<<ts)}set offsets(e){!!(this.data&1<<ts)!==e&&(this.data^=1<<ts)}get culling(){return!!(this.data&1<<es)}set culling(e){!!(this.data&1<<es)!==e&&(this.data^=1<<es)}get depthTest(){return!!(this.data&1<<rs)}set depthTest(e){!!(this.data&1<<rs)!==e&&(this.data^=1<<rs)}get depthMask(){return!!(this.data&1<<ss)}set depthMask(e){!!(this.data&1<<ss)!==e&&(this.data^=1<<ss)}get clockwiseFrontFace(){return!!(this.data&1<<is)}set clockwiseFrontFace(e){!!(this.data&1<<is)!==e&&(this.data^=1<<is)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==it.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new Tr;return e.depthTest=!1,e.blend=!0,e}}Tr.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Ti=[];function Hs(s,e){if(!s)return null;let i="";if(typeof s=="string"){const o=/\.(\w{3,4})(?:$|\?|#)/i.exec(s);o&&(i=o[1].toLowerCase())}for(let o=Ti.length-1;o>=0;--o){const h=Ti[o];if(h.test&&h.test(s,i))return new h(s,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class xe{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,i,o,h,u,m,v,w){if(arguments.length>8)throw new Error("max arguments reached");const{name:N,items:lt}=this;this._aliasCount++;for(let gt=0,Pt=lt.length;gt<Pt;gt++)lt[gt][N](e,i,o,h,u,m,v,w);return lt===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const i=this.items.indexOf(e);return i!==-1&&(this.ensureNonAliasedItems(),this.items.splice(i,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(xe.prototype,{dispatch:{value:xe.prototype.emit},run:{value:xe.prototype.emit}});class Ar{constructor(e=0,i=0){this._width=e,this._height=i,this.destroyed=!1,this.internal=!1,this.onResize=new xe("setRealSize"),this.onUpdate=new xe("update"),this.onError=new xe("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,i){(e!==this._width||i!==this._height)&&(this._width=e,this._height=i,this.onResize.emit(e,i))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,i,o){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,i){return!1}}class Ai extends Ar{constructor(e,i){var u;const{width:o,height:h}=i||{};if(!o||!h)throw new Error("BufferResource width or height invalid");super(o,h),this.data=e,this.unpackAlignment=(u=i.unpackAlignment)!=null?u:4}upload(e,i,o){const h=e.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,this.unpackAlignment),h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===k.UNPACK);const u=i.realWidth,m=i.realHeight;return o.width===u&&o.height===m?h.texSubImage2D(i.target,0,0,0,u,m,i.format,o.type,this.data):(o.width=u,o.height=m,h.texImage2D(i.target,0,o.internalFormat,u,m,0,i.format,o.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const kn={scaleMode:z.NEAREST,alphaMode:k.NPM},ns=class Hi extends Ft{constructor(e=null,i=null){super(),i=Object.assign({},Hi.defaultOptions,i);const{alphaMode:o,mipmap:h,anisotropicLevel:u,scaleMode:m,width:v,height:w,wrapMode:N,format:lt,type:gt,target:Pt,resolution:Kt,resourceOptions:ce}=i;e&&!(e instanceof Ar)&&(e=Hs(e,ce),e.internal=!0),this.resolution=Kt||S.RESOLUTION,this.width=Math.round((v||0)*this.resolution)/this.resolution,this.height=Math.round((w||0)*this.resolution)/this.resolution,this._mipmap=h,this.anisotropicLevel=u,this._wrapMode=N,this._scaleMode=m,this.format=lt,this.type=gt,this.target=Pt,this.alphaMode=o,this.uid=hr(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=v>0&&w>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,i){let o;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,o=!0),i!==void 0&&i!==this.mipmap&&(this.mipmap=i,o=!0),o&&this.dirtyStyleId++,this}setSize(e,i,o){return o=o||this.resolution,this.setRealSize(e*o,i*o,o)}setRealSize(e,i,o){return this.resolution=o||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(i)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=ri(this.realWidth)&&ri(this.realHeight)}setResolution(e){const i=this.resolution;return i===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*i)/e,this.height=Math.round(this.height*i)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Fe[this.cacheId],delete be[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Hi.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,i,o=S.STRICT_TEXTURE_CACHE){const h=typeof e=="string";let u=null;if(h)u=e;else{if(!e._pixiId){const v=(i==null?void 0:i.pixiIdPrefix)||"pixiid";e._pixiId=`${v}_${hr()}`}u=e._pixiId}let m=Fe[u];if(h&&o&&!m)throw new Error(`The cacheId "${u}" does not exist in BaseTextureCache.`);return m||(m=new Hi(e,i),m.cacheId=u,Hi.addToCache(m,u)),m}static fromBuffer(e,i,o,h){e=e||new Float32Array(i*o*4);const u=new Ai(e,pe({width:i,height:o},h==null?void 0:h.resourceOptions));let m,v;return e instanceof Float32Array?(m=H.RGBA,v=L.FLOAT):e instanceof Int32Array?(m=H.RGBA_INTEGER,v=L.INT):e instanceof Uint32Array?(m=H.RGBA_INTEGER,v=L.UNSIGNED_INT):e instanceof Int16Array?(m=H.RGBA_INTEGER,v=L.SHORT):e instanceof Uint16Array?(m=H.RGBA_INTEGER,v=L.UNSIGNED_SHORT):e instanceof Int8Array?(m=H.RGBA,v=L.BYTE):(m=H.RGBA,v=L.UNSIGNED_BYTE),u.internal=!0,new Hi(u,Object.assign({},kn,{type:v,format:m},h))}static addToCache(e,i){i&&(e.textureCacheIds.includes(i)||e.textureCacheIds.push(i),Fe[i]&&Fe[i]!==e&&console.warn(`BaseTexture added to the cache with an id [${i}] that already had an entry`),Fe[i]=e)}static removeFromCache(e){if(typeof e=="string"){const i=Fe[e];if(i){const o=i.textureCacheIds.indexOf(e);return o>-1&&i.textureCacheIds.splice(o,1),delete Fe[e],i}}else if(e!=null&&e.textureCacheIds){for(let i=0;i<e.textureCacheIds.length;++i)delete Fe[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null}};ns.defaultOptions={mipmap:tt.POW2,anisotropicLevel:0,scaleMode:z.LINEAR,wrapMode:j.CLAMP,alphaMode:k.UNPACK,target:J.TEXTURE_2D,format:H.RGBA,type:L.UNSIGNED_BYTE},ns._globalBatch=0;let oe=ns;class Xs{constructor(){this.texArray=null,this.blend=0,this.type=_t.TRIANGLES,this.start=0,this.size=0,this.data=null}}let Gn=0;class Ie{constructor(e,i=!0,o=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=o,this.static=i,this.id=Gn++,this.disposeRunner=new xe("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?rt.ELEMENT_ARRAY_BUFFER:rt.ARRAY_BUFFER}get index(){return this.type===rt.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new Ie(e)}}class Ei{constructor(e,i=0,o=!1,h=L.FLOAT,u,m,v,w=1){this.buffer=e,this.size=i,this.normalized=o,this.type=h,this.stride=u,this.start=m,this.instance=v,this.divisor=w}destroy(){this.buffer=null}static from(e,i,o,h,u){return new Ei(e,i,o,h,u)}}const Hn={Float32Array,Uint32Array,Int32Array,Uint8Array};function Xn(s,e){let i=0,o=0;const h={};for(let w=0;w<s.length;w++)o+=e[w],i+=s[w].length;const u=new ArrayBuffer(i*4);let m=null,v=0;for(let w=0;w<s.length;w++){const N=e[w],lt=s[w],gt=xi(lt);h[gt]||(h[gt]=new Hn[gt](u)),m=h[gt];for(let Pt=0;Pt<lt.length;Pt++){const Kt=(Pt/N|0)*o+v,ce=Pt%N;m[Kt+ce]=lt[Pt]}v+=N}return new Float32Array(u)}const ni={5126:4,5123:2,5121:1};let Wn=0;const Ws={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Er{constructor(e=[],i={}){this.buffers=e,this.indexBuffer=null,this.attributes=i,this.glVertexArrayObjects={},this.id=Wn++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new xe("disposeGeometry"),this.refCount=0}addAttribute(e,i,o=0,h=!1,u,m,v,w=!1){if(!i)throw new Error("You must pass a buffer when creating an attribute");i instanceof Ie||(i instanceof Array&&(i=new Float32Array(i)),i=new Ie(i));const N=e.split("|");if(N.length>1){for(let gt=0;gt<N.length;gt++)this.addAttribute(N[gt],i,o,h,u);return this}let lt=this.buffers.indexOf(i);return lt===-1&&(this.buffers.push(i),lt=this.buffers.length-1),this.attributes[e]=new Ei(lt,o,h,u,m,v,w),this.instanced=this.instanced||w,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof Ie||(e instanceof Array&&(e=new Uint16Array(e)),e=new Ie(e)),e.type=rt.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],i=[],o=new Ie;let h;for(h in this.attributes){const u=this.attributes[h],m=this.buffers[u.buffer];e.push(m.data),i.push(u.size*ni[u.type]/4),u.buffer=0}for(o.data=Xn(e,i),h=0;h<this.buffers.length;h++)this.buffers[h]!==this.indexBuffer&&this.buffers[h].destroy();return this.buffers=[o],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const i=this.attributes[e];return this.buffers[i.buffer].data.length/(i.stride/4||i.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new Er;for(let i=0;i<this.buffers.length;i++)e.buffers[i]=new Ie(this.buffers[i].data.slice(0));for(const i in this.attributes){const o=this.attributes[i];e.attributes[i]=new Ei(o.buffer,o.size,o.normalized,o.type,o.stride,o.start,o.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=rt.ELEMENT_ARRAY_BUFFER),e}static merge(e){const i=new Er,o=[],h=[],u=[];let m;for(let v=0;v<e.length;v++){m=e[v];for(let w=0;w<m.buffers.length;w++)h[w]=h[w]||0,h[w]+=m.buffers[w].data.length,u[w]=0}for(let v=0;v<m.buffers.length;v++)o[v]=new Ws[xi(m.buffers[v].data)](h[v]),i.buffers[v]=new Ie(o[v]);for(let v=0;v<e.length;v++){m=e[v];for(let w=0;w<m.buffers.length;w++)o[w].set(m.buffers[w].data,u[w]),u[w]+=m.buffers[w].data.length}if(i.attributes=m.attributes,m.indexBuffer){i.indexBuffer=i.buffers[m.buffers.indexOf(m.indexBuffer)],i.indexBuffer.type=rt.ELEMENT_ARRAY_BUFFER;let v=0,w=0,N=0,lt=0;for(let gt=0;gt<m.buffers.length;gt++)if(m.buffers[gt]!==m.indexBuffer){lt=gt;break}for(const gt in m.attributes){const Pt=m.attributes[gt];(Pt.buffer|0)===lt&&(w+=Pt.size*ni[Pt.type]/4)}for(let gt=0;gt<e.length;gt++){const Pt=e[gt].indexBuffer.data;for(let Kt=0;Kt<Pt.length;Kt++)i.indexBuffer.data[Kt+N]+=v;v+=e[gt].buffers[lt].data.length/w,N+=Pt.length}}return i}}class Hr extends Er{constructor(e=!1){super(),this._buffer=new Ie(null,e,!1),this._indexBuffer=new Ie(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,L.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,L.FLOAT).addAttribute("aColor",this._buffer,4,!0,L.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,L.FLOAT).addIndex(this._indexBuffer)}}const os=Math.PI*2,as=180/Math.PI,Vs=Math.PI/180;var lr=(s=>(s[s.POLY=0]="POLY",s[s.RECT=1]="RECT",s[s.CIRC=2]="CIRC",s[s.ELIP=3]="ELIP",s[s.RREC=4]="RREC",s))(lr||{});class le{constructor(e=0,i=0){this.x=0,this.y=0,this.x=e,this.y=i}clone(){return new le(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,i=e){return this.x=e,this.y=i,this}}le.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Ve=[new le,new le,new le,new le];class ne{constructor(e=0,i=0,o=0,h=0){this.x=Number(e),this.y=Number(i),this.width=Number(o),this.height=Number(h),this.type=lr.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new ne(0,0,0,0)}clone(){return new ne(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,i){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&i>=this.y&&i<this.y+this.height}intersects(e,i){if(!i){const Mo=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=Mo)return!1;const Bo=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>Bo}const o=this.left,h=this.right,u=this.top,m=this.bottom;if(h<=o||m<=u)return!1;const v=Ve[0].set(e.left,e.top),w=Ve[1].set(e.left,e.bottom),N=Ve[2].set(e.right,e.top),lt=Ve[3].set(e.right,e.bottom);if(N.x<=v.x||w.y<=v.y)return!1;const gt=Math.sign(i.a*i.d-i.b*i.c);if(gt===0||(i.apply(v,v),i.apply(w,w),i.apply(N,N),i.apply(lt,lt),Math.max(v.x,w.x,N.x,lt.x)<=o||Math.min(v.x,w.x,N.x,lt.x)>=h||Math.max(v.y,w.y,N.y,lt.y)<=u||Math.min(v.y,w.y,N.y,lt.y)>=m))return!1;const Pt=gt*(w.y-v.y),Kt=gt*(v.x-w.x),ce=Pt*o+Kt*u,Zt=Pt*h+Kt*u,ve=Pt*o+Kt*m,Kr=Pt*h+Kt*m;if(Math.max(ce,Zt,ve,Kr)<=Pt*v.x+Kt*v.y||Math.min(ce,Zt,ve,Kr)>=Pt*lt.x+Kt*lt.y)return!1;const Br=gt*(v.y-N.y),Dr=gt*(N.x-v.x),Fr=Br*o+Dr*u,Or=Br*h+Dr*u,yo=Br*o+Dr*m,_o=Br*h+Dr*m;return!(Math.max(Fr,Or,yo,_o)<=Br*v.x+Dr*v.y||Math.min(Fr,Or,yo,_o)>=Br*lt.x+Dr*lt.y)}pad(e=0,i=e){return this.x-=e,this.y-=i,this.width+=e*2,this.height+=i*2,this}fit(e){const i=Math.max(this.x,e.x),o=Math.min(this.x+this.width,e.x+e.width),h=Math.max(this.y,e.y),u=Math.min(this.y+this.height,e.y+e.height);return this.x=i,this.width=Math.max(o-i,0),this.y=h,this.height=Math.max(u-h,0),this}ceil(e=1,i=.001){const o=Math.ceil((this.x+this.width-i)*e)/e,h=Math.ceil((this.y+this.height-i)*e)/e;return this.x=Math.floor((this.x+i)*e)/e,this.y=Math.floor((this.y+i)*e)/e,this.width=o-this.x,this.height=h-this.y,this}enlarge(e){const i=Math.min(this.x,e.x),o=Math.max(this.x+this.width,e.x+e.width),h=Math.min(this.y,e.y),u=Math.max(this.y+this.height,e.y+e.height);return this.x=i,this.width=o-i,this.y=h,this.height=u-h,this}}ne.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class hs{constructor(e=0,i=0,o=0){this.x=e,this.y=i,this.radius=o,this.type=lr.CIRC}clone(){return new hs(this.x,this.y,this.radius)}contains(e,i){if(this.radius<=0)return!1;const o=this.radius*this.radius;let h=this.x-e,u=this.y-i;return h*=h,u*=u,h+u<=o}getBounds(){return new ne(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}hs.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Xr{constructor(e=0,i=0,o=0,h=0){this.x=e,this.y=i,this.width=o,this.height=h,this.type=lr.ELIP}clone(){return new Xr(this.x,this.y,this.width,this.height)}contains(e,i){if(this.width<=0||this.height<=0)return!1;let o=(e-this.x)/this.width,h=(i-this.y)/this.height;return o*=o,h*=h,o+h<=1}getBounds(){return new ne(this.x-this.width,this.y-this.height,this.width,this.height)}}Xr.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class wr{constructor(...e){let i=Array.isArray(e[0])?e[0]:e;if(typeof i[0]!="number"){const o=[];for(let h=0,u=i.length;h<u;h++)o.push(i[h].x,i[h].y);i=o}this.points=i,this.type=lr.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),i=new wr(e);return i.closeStroke=this.closeStroke,i}contains(e,i){let o=!1;const h=this.points.length/2;for(let u=0,m=h-1;u<h;m=u++){const v=this.points[u*2],w=this.points[u*2+1],N=this.points[m*2],lt=this.points[m*2+1];w>i!=lt>i&&e<(N-v)*((i-w)/(lt-w))+v&&(o=!o)}return o}}wr.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((s,e)=>`${s}, ${e}`,"")}]`};class oi{constructor(e=0,i=0,o=0,h=0,u=20){this.x=e,this.y=i,this.width=o,this.height=h,this.radius=u,this.type=lr.RREC}clone(){return new oi(this.x,this.y,this.width,this.height,this.radius)}contains(e,i){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&i>=this.y&&i<=this.y+this.height){const o=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(i>=this.y+o&&i<=this.y+this.height-o||e>=this.x+o&&e<=this.x+this.width-o)return!0;let h=e-(this.x+o),u=i-(this.y+o);const m=o*o;if(h*h+u*u<=m||(h=e-(this.x+this.width-o),h*h+u*u<=m)||(u=i-(this.y+this.height-o),h*h+u*u<=m)||(h=e-(this.x+o),h*h+u*u<=m))return!0}return!1}}oi.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class fe{constructor(e=1,i=0,o=0,h=1,u=0,m=0){this.array=null,this.a=e,this.b=i,this.c=o,this.d=h,this.tx=u,this.ty=m}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,i,o,h,u,m){return this.a=e,this.b=i,this.c=o,this.d=h,this.tx=u,this.ty=m,this}toArray(e,i){this.array||(this.array=new Float32Array(9));const o=i||this.array;return e?(o[0]=this.a,o[1]=this.b,o[2]=0,o[3]=this.c,o[4]=this.d,o[5]=0,o[6]=this.tx,o[7]=this.ty,o[8]=1):(o[0]=this.a,o[1]=this.c,o[2]=this.tx,o[3]=this.b,o[4]=this.d,o[5]=this.ty,o[6]=0,o[7]=0,o[8]=1),o}apply(e,i){i=i||new le;const o=e.x,h=e.y;return i.x=this.a*o+this.c*h+this.tx,i.y=this.b*o+this.d*h+this.ty,i}applyInverse(e,i){i=i||new le;const o=1/(this.a*this.d+this.c*-this.b),h=e.x,u=e.y;return i.x=this.d*o*h+-this.c*o*u+(this.ty*this.c-this.tx*this.d)*o,i.y=this.a*o*u+-this.b*o*h+(-this.ty*this.a+this.tx*this.b)*o,i}translate(e,i){return this.tx+=e,this.ty+=i,this}scale(e,i){return this.a*=e,this.d*=i,this.c*=e,this.b*=i,this.tx*=e,this.ty*=i,this}rotate(e){const i=Math.cos(e),o=Math.sin(e),h=this.a,u=this.c,m=this.tx;return this.a=h*i-this.b*o,this.b=h*o+this.b*i,this.c=u*i-this.d*o,this.d=u*o+this.d*i,this.tx=m*i-this.ty*o,this.ty=m*o+this.ty*i,this}append(e){const i=this.a,o=this.b,h=this.c,u=this.d;return this.a=e.a*i+e.b*h,this.b=e.a*o+e.b*u,this.c=e.c*i+e.d*h,this.d=e.c*o+e.d*u,this.tx=e.tx*i+e.ty*h+this.tx,this.ty=e.tx*o+e.ty*u+this.ty,this}setTransform(e,i,o,h,u,m,v,w,N){return this.a=Math.cos(v+N)*u,this.b=Math.sin(v+N)*u,this.c=-Math.sin(v-w)*m,this.d=Math.cos(v-w)*m,this.tx=e-(o*this.a+h*this.c),this.ty=i-(o*this.b+h*this.d),this}prepend(e){const i=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const o=this.a,h=this.c;this.a=o*e.a+this.b*e.c,this.b=o*e.b+this.b*e.d,this.c=h*e.a+this.d*e.c,this.d=h*e.b+this.d*e.d}return this.tx=i*e.a+this.ty*e.c+e.tx,this.ty=i*e.b+this.ty*e.d+e.ty,this}decompose(e){const i=this.a,o=this.b,h=this.c,u=this.d,m=e.pivot,v=-Math.atan2(-h,u),w=Math.atan2(o,i),N=Math.abs(v+w);return N<1e-5||Math.abs(os-N)<1e-5?(e.rotation=w,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=v,e.skew.y=w),e.scale.x=Math.sqrt(i*i+o*o),e.scale.y=Math.sqrt(h*h+u*u),e.position.x=this.tx+(m.x*i+m.y*h),e.position.y=this.ty+(m.x*o+m.y*u),e}invert(){const e=this.a,i=this.b,o=this.c,h=this.d,u=this.tx,m=e*h-i*o;return this.a=h/m,this.b=-i/m,this.c=-o/m,this.d=e/m,this.tx=(o*this.ty-h*u)/m,this.ty=-(e*this.ty-i*u)/m,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new fe;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new fe}static get TEMP_MATRIX(){return new fe}}fe.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const Sr=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Cr=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ir=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ke=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Wr=[],wi=[],ur=Math.sign;function Si(){for(let s=0;s<16;s++){const e=[];Wr.push(e);for(let i=0;i<16;i++){const o=ur(Sr[s]*Sr[i]+ir[s]*Cr[i]),h=ur(Cr[s]*Sr[i]+Ke[s]*Cr[i]),u=ur(Sr[s]*ir[i]+ir[s]*Ke[i]),m=ur(Cr[s]*ir[i]+Ke[s]*Ke[i]);for(let v=0;v<16;v++)if(Sr[v]===o&&Cr[v]===h&&ir[v]===u&&Ke[v]===m){e.push(v);break}}}for(let s=0;s<16;s++){const e=new fe;e.set(Sr[s],Cr[s],ir[s],Ke[s],0,0),wi.push(e)}}Si();const ge={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>Sr[s],uY:s=>Cr[s],vX:s=>ir[s],vY:s=>Ke[s],inv:s=>s&8?s&15:-s&7,add:(s,e)=>Wr[s][e],sub:(s,e)=>Wr[s][ge.inv(e)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,e)=>Math.abs(s)*2<=Math.abs(e)?e>=0?ge.S:ge.N:Math.abs(e)*2<=Math.abs(s)?s>0?ge.E:ge.W:e>0?s>0?ge.SE:ge.SW:s>0?ge.NE:ge.NW,matrixAppendRotationInv:(s,e,i=0,o=0)=>{const h=wi[ge.inv(e)];h.tx=i,h.ty=o,s.append(h)}};class Ne{constructor(e,i,o=0,h=0){this._x=o,this._y=h,this.cb=e,this.scope=i}clone(e=this.cb,i=this.scope){return new Ne(e,i,this._x,this._y)}set(e=0,i=e){return(this._x!==e||this._y!==i)&&(this._x=e,this._y=i,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Ne.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Ci=class{constructor(){this.worldTransform=new fe,this.localTransform=new fe,this.position=new Ne(this.onChange,this,0,0),this.scale=new Ne(this.onChange,this,1,1),this.pivot=new Ne(this.onChange,this,0,0),this.skew=new Ne(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const s=this.localTransform;this._localID!==this._currentLocalID&&(s.a=this._cx*this.scale.x,s.b=this._sx*this.scale.x,s.c=this._cy*this.scale.y,s.d=this._sy*this.scale.y,s.tx=this.position.x-(this.pivot.x*s.a+this.pivot.y*s.c),s.ty=this.position.y-(this.pivot.x*s.b+this.pivot.y*s.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(s){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==s._worldID){const i=s.worldTransform,o=this.worldTransform;o.a=e.a*i.a+e.b*i.c,o.b=e.a*i.b+e.b*i.d,o.c=e.c*i.a+e.d*i.c,o.d=e.c*i.b+e.d*i.d,o.tx=e.tx*i.a+e.ty*i.c+i.tx,o.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=s._worldID,this._worldID++}}setFromMatrix(s){s.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(s){this._rotation!==s&&(this._rotation=s,this.updateSkew())}};Ci.IDENTITY=new Ci;let ls=Ci;ls.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var Ii=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,us=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;const cr=[{test:s=>s.type==="float"&&s.size===1&&!s.isArray,code:s=>`
            if(uv["${s}"] !== ud["${s}"].value)
            {
                ud["${s}"].value = uv["${s}"]
                gl.uniform1f(ud["${s}"].location, uv["${s}"])
            }
            `},{test:(s,e)=>(s.type==="sampler2D"||s.type==="samplerCube"||s.type==="sampler2DArray")&&s.size===1&&!s.isArray&&(e==null||e.castToBaseTexture!==void 0),code:s=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${s}"], t);

            if(ud["${s}"].value !== t)
            {
                ud["${s}"].value = t;
                gl.uniform1i(ud["${s}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(s,e)=>s.type==="mat3"&&s.size===1&&!s.isArray&&e.a!==void 0,code:s=>`
            gl.uniformMatrix3fv(ud["${s}"].location, false, uv["${s}"].toArray(true));
            `,codeUbo:s=>`
                var ${s}_matrix = uv.${s}.toArray(true);

                data[offset] = ${s}_matrix[0];
                data[offset+1] = ${s}_matrix[1];
                data[offset+2] = ${s}_matrix[2];
        
                data[offset + 4] = ${s}_matrix[3];
                data[offset + 5] = ${s}_matrix[4];
                data[offset + 6] = ${s}_matrix[5];
        
                data[offset + 8] = ${s}_matrix[6];
                data[offset + 9] = ${s}_matrix[7];
                data[offset + 10] = ${s}_matrix[8];
            `},{test:(s,e)=>s.type==="vec2"&&s.size===1&&!s.isArray&&e.x!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${s}"].location, v.x, v.y);
                }`,codeUbo:s=>`
                v = uv.${s};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:s=>s.type==="vec2"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${s}"].location, v[0], v[1]);
                }
            `},{test:(s,e)=>s.type==="vec4"&&s.size===1&&!s.isArray&&e.width!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${s}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(s,e)=>s.type==="vec4"&&s.size===1&&!s.isArray&&e.red!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${s}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(s,e)=>s.type==="vec3"&&s.size===1&&!s.isArray&&e.red!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${s}"].location, v.red, v.green, v.blue)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:s=>s.type==="vec4"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${s}"].location, v[0], v[1], v[2], v[3])
                }`}],cs={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},ds={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function ho(s,e){var o;const i=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const h in s.uniforms){const u=e[h];if(!u){((o=s.uniforms[h])==null?void 0:o.group)===!0&&(s.uniforms[h].ubo?i.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${h}, '${h}');
                    `):i.push(`
                        renderer.shader.syncUniformGroup(uv.${h}, syncData);
                    `));continue}const m=s.uniforms[h];let v=!1;for(let w=0;w<cr.length;w++)if(cr[w].test(u,m)){i.push(cr[w].code(h,m)),v=!0;break}if(!v){const w=(u.size===1&&!u.isArray?cs:ds)[u.type].replace("location",`ud["${h}"].location`);i.push(`
            cu = ud["${h}"];
            cv = cu.value;
            v = uv["${h}"];
            ${w};`)}}return new Function("ud","uv","renderer","syncData",i.join(`
`))}const zs={};let dr=zs;function $s(){if(dr===zs||dr!=null&&dr.isContextLost()){const s=S.ADAPTER.createCanvas();let e;S.PREFER_ENV>=yt.WEBGL2&&(e=s.getContext("webgl2",{})),e||(e=s.getContext("webgl",{})||s.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),dr=e}return dr}let ai;function js(){if(!ai){ai=B.MEDIUM;const s=$s();if(s&&s.getShaderPrecisionFormat){const e=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT);e&&(ai=e.precision?B.HIGH:B.MEDIUM)}}return ai}const Vn={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Ys(s){return Vn[s]}let Pi=null;const fs={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function zn(s,e){if(!Pi){const i=Object.keys(fs);Pi={};for(let o=0;o<i.length;++o){const h=i[o];Pi[s[h]]=fs[h]}}return Pi[e]}function $n(s,e,i){if(s.substring(0,9)!=="precision"){let o=e;return e===B.HIGH&&i!==B.HIGH&&(o=B.MEDIUM),`precision ${o} float;
${s}`}else if(i!==B.HIGH&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}let lo=0;const Ir={},Ks=class Xi{constructor(e,i,o="pixi-shader",h={}){this.extra={},this.id=lo++,this.vertexSrc=e||Xi.defaultVertexSrc,this.fragmentSrc=i||Xi.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=h,this.vertexSrc.substring(0,8)!=="#version"&&(o=o.replace(/\s+/g,"-"),Ir[o]?(Ir[o]++,o+=`-${Ir[o]}`):Ir[o]=1,this.vertexSrc=`#define SHADER_NAME ${o}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${o}
${this.fragmentSrc}`,this.vertexSrc=$n(this.vertexSrc,Xi.defaultVertexPrecision,B.HIGH),this.fragmentSrc=$n(this.fragmentSrc,Xi.defaultFragmentPrecision,js())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return us}static get defaultFragmentSrc(){return Ii}static from(e,i,o){const h=e+i;let u=We[h];return u||(We[h]=u=new Xi(e,i,o)),u}};Ks.defaultVertexPrecision=B.HIGH,Ks.defaultFragmentPrecision=Et.apple.device?B.HIGH:B.MEDIUM;let Pr=Ks,uo=0;class qe{constructor(e,i,o){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=uo++,this.static=!!i,this.ubo=!!o,e instanceof Ie?(this.buffer=e,this.buffer.type=rt.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new Ie(new Float32Array(1)),this.buffer.type=rt.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,i,o){if(!this.ubo)this.uniforms[e]=new qe(i,o);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,i,o){return new qe(e,i,o)}static uboFrom(e,i){return new qe(e,i!=null?i:!0,!0)}}class Vr{constructor(e,i){this.uniformBindCount=0,this.program=e,i?i instanceof qe?this.uniformGroup=i:this.uniformGroup=new qe(i):this.uniformGroup=new qe({}),this.disposeRunner=new xe("disposeShader")}checkUniformExists(e,i){if(i.uniforms[e])return!0;for(const o in i.uniforms){const h=i.uniforms[o];if(h.group===!0&&this.checkUniformExists(e,h))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,i,o){const h=Pr.from(e,i);return new Vr(h,o)}}class jn{constructor(e,i){if(this.vertexSrc=e,this.fragTemplate=i,this.programCache={},this.defaultGroupCache={},!i.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!i.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const o=new Int32Array(e);for(let u=0;u<e;u++)o[u]=u;this.defaultGroupCache[e]=qe.from({uSamplers:o},!0);let h=this.fragTemplate;h=h.replace(/%count%/gi,`${e}`),h=h.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Pr(this.vertexSrc,h)}const i={tint:new Float32Array([1,1,1,1]),translationMatrix:new fe,default:this.defaultGroupCache[e]};return new Vr(this.programCache[e],i)}generateSampleSrc(e){let i="";i+=`
`,i+=`
`;for(let o=0;o<e;o++)o>0&&(i+=`
else `),o<e-1&&(i+=`if(vTextureId < ${o}.5)`),i+=`
{`,i+=`
	color = texture2D(uSamplers[${o}], vTextureCoord);`,i+=`
}`;return i+=`
`,i+=`
`,i}}class qs{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function Zs(){return!Et.apple.device}function Ri(s){let e=!0;const i=S.ADAPTER.getNavigator();if(Et.tablet||Et.phone){if(Et.apple.device){const o=i.userAgent.match(/OS (\d+)_(\d+)?/);o&&parseInt(o[1],10)<11&&(e=!1)}if(Et.android.device){const o=i.userAgent.match(/Android\s([0-9.]*)/);o&&parseInt(o[1],10)<7&&(e=!1)}}return e?s:4}class zr{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var Ze=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,fr=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const hi=class nr extends zr{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=Hr,this.vertexSize=6,this.state=Tr.for2d(),this.size=nr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){var e;return this._defaultMaxTextures=(e=this._defaultMaxTextures)!=null?e:Ri(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){var e;return this._canUploadSameBuffer=(e=this._canUploadSameBuffer)!=null?e:Zs(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return bt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return fr}static get defaultFragmentTemplate(){return Ze}setShaderGenerator({vertex:e=nr.defaultVertexSrc,fragment:i=nr.defaultFragmentTemplate}={}){this.shaderGenerator=new jn(e,i)}contextChange(){const e=this.renderer.gl;S.PREFER_ENV===yt.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),nr.defaultMaxTextures),this.maxTextures=Un(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:i}=nr,o=this.size/4,h=Math.floor(o/this.maxTextures)+1;for(;e.length<o;)e.push(new Xs);for(;i.length<h;)i.push(new qs);for(let u=0;u<this.maxTextures;u++)this._tempBoundTextures[u]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:i}=this,o=nr._textureArrayPool,h=this.renderer.batch,u=this._tempBoundTextures,m=this.renderer.textureGC.count;let v=++oe._globalBatch,w=0,N=o[0],lt=0;h.copyBoundTextures(u,i);for(let gt=0;gt<this._bufferSize;++gt){const Pt=e[gt];e[gt]=null,Pt._batchEnabled!==v&&(N.count>=i&&(h.boundArray(N,u,v,i),this.buildDrawCalls(N,lt,gt),lt=gt,N=o[++w],++v),Pt._batchEnabled=v,Pt.touched=m,N.elements[N.count++]=Pt)}N.count>0&&(h.boundArray(N,u,v,i),this.buildDrawCalls(N,lt,this._bufferSize),++w,++v);for(let gt=0;gt<u.length;gt++)u[gt]=null;oe._globalBatch=v}buildDrawCalls(e,i,o){const{_bufferedElements:h,_attributeBuffer:u,_indexBuffer:m,vertexSize:v}=this,w=nr._drawCallPool;let N=this._dcIndex,lt=this._aIndex,gt=this._iIndex,Pt=w[N];Pt.start=this._iIndex,Pt.texArray=e;for(let Kt=i;Kt<o;++Kt){const ce=h[Kt],Zt=ce._texture.baseTexture,ve=ti[Zt.alphaMode?1:0][ce.blendMode];h[Kt]=null,i<Kt&&Pt.blend!==ve&&(Pt.size=gt-Pt.start,i=Kt,Pt=w[++N],Pt.texArray=e,Pt.start=gt),this.packInterleavedGeometry(ce,u,m,lt,gt),lt+=ce.vertexData.length/2*v,gt+=ce.indices.length,Pt.blend=ve}i<o&&(Pt.size=gt-Pt.start,++N),this._dcIndex=N,this._aIndex=lt,this._iIndex=gt}bindAndClearTexArray(e){const i=this.renderer.texture;for(let o=0;o<e.count;o++)i.bind(e.elements[o],e.ids[o]),e.elements[o]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:i,_indexBuffer:o}=this;nr.canUploadSameBuffer?(e[this._flushId]._buffer.update(i.rawBinaryData),e[this._flushId]._indexBuffer.update(o),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(i.rawBinaryData),e[this._flushId]._indexBuffer.update(o),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:i,state:o}=this.renderer,h=nr._drawCallPool;let u=null;for(let m=0;m<e;m++){const{texArray:v,type:w,size:N,start:lt,blend:gt}=h[m];u!==v&&(u=v,this.bindAndClearTexArray(v)),this.state.blendMode=gt,o.set(this.state),i.drawElements(w,N,i.UNSIGNED_SHORT,lt*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),nr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const i=ei(Math.ceil(e/8)),o=qi(i),h=i*8;this._aBuffers.length<=o&&(this._iBuffers.length=o+1);let u=this._aBuffers[h];return u||(this._aBuffers[h]=u=new Gs(h*this.vertexSize*4)),u}getIndexBuffer(e){const i=ei(Math.ceil(e/12)),o=qi(i),h=i*12;this._iBuffers.length<=o&&(this._iBuffers.length=o+1);let u=this._iBuffers[o];return u||(this._iBuffers[o]=u=new Uint16Array(h)),u}packInterleavedGeometry(e,i,o,h,u){const{uint32View:m,float32View:v}=i,w=h/this.vertexSize,N=e.uvs,lt=e.indices,gt=e.vertexData,Pt=e._texture.baseTexture._batchLocation,Kt=Math.min(e.worldAlpha,1),ce=Ce.shared.setValue(e._tintRGB).toPremultiplied(Kt,e._texture.baseTexture.alphaMode>0);for(let Zt=0;Zt<gt.length;Zt+=2)v[h++]=gt[Zt],v[h++]=gt[Zt+1],v[h++]=N[Zt],v[h++]=N[Zt+1],m[h++]=ce,v[h++]=Pt;for(let Zt=0;Zt<lt.length;Zt++)o[u++]=w+lt[Zt]}};hi.defaultBatchSize=4096,hi.extension={name:"batch",type:Qt.RendererPlugin},hi._drawCallPool=[],hi._textureArrayPool=[];let pr=hi;se.add(pr);var mr=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,ps=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const ms=class Rs extends Vr{constructor(e,i,o){const h=Pr.from(e||Rs.defaultVertexSrc,i||Rs.defaultFragmentSrc);super(h,o),this.padding=0,this.resolution=Rs.defaultResolution,this.multisample=Rs.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Tr}apply(e,i,o,h,u){e.applyFilter(this,i,o,h)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return ps}static get defaultFragmentSrc(){return mr}};ms.defaultResolution=1,ms.defaultMultisample=at.NONE;let sr=ms;class Mi{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Ce(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:i,background:o,backgroundAlpha:h}=e,u=o!=null?o:i;u!==void 0&&(this.color=u),this.alpha=h}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}Mi.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Mi.extension={type:[Qt.RendererSystem,Qt.CanvasRendererSystem],name:"background"},se.add(Mi);class gs{constructor(e){this.renderer=e,this.emptyRenderer=new zr(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,i){const{boundTextures:o}=this.renderer.texture;for(let h=i-1;h>=0;--h)e[h]=o[h]||null,e[h]&&(e[h]._batchLocation=h)}boundArray(e,i,o,h){const{elements:u,ids:m,count:v}=e;let w=0;for(let N=0;N<v;N++){const lt=u[N],gt=lt._batchLocation;if(gt>=0&&gt<h&&i[gt]===lt){m[N]=gt;continue}for(;w<h;){const Pt=i[w];if(Pt&&Pt._batchEnabled===o&&Pt._batchLocation===w){w++;continue}m[N]=w,lt._batchLocation=w,i[w]=lt;break}}}destroy(){this.renderer=null}}gs.extension={type:Qt.RendererSystem,name:"batch"},se.add(gs);let ys=0;class Bi{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=ys++}init(e){if(e.context)this.initFromContext(e.context);else{const i=this.renderer.background.alpha<1,o=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:i,premultipliedAlpha:o,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=ys++,this.renderer.runners.contextChange.emit(e);const i=this.renderer.view;i.addEventListener!==void 0&&(i.addEventListener("webglcontextlost",this.handleContextLost,!1),i.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const i=this.createContext(this.renderer.view,e);this.initFromContext(i)}createContext(e,i){let o;if(S.PREFER_ENV>=yt.WEBGL2&&(o=e.getContext("webgl2",i)),o)this.webGLVersion=2;else if(this.webGLVersion=1,o=e.getContext("webgl",i)||e.getContext("experimental-webgl",i),!o)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=o,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,i={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,i,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,i,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const i=e.getContextAttributes(),o="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;o&&(this.webGLVersion=2),i&&!i.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const h=o||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=h,h||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Bi.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Bi.extension={type:Qt.RendererSystem,name:"context"},se.add(Bi);class _s{constructor(e,i){if(this.width=Math.round(e),this.height=Math.round(i),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new xe("disposeFramebuffer"),this.multisample=at.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,i){return this.colorTextures[e]=i||new oe(null,{scaleMode:z.NEAREST,resolution:1,mipmap:tt.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new oe(null,{scaleMode:z.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:tt.OFF,format:H.DEPTH_COMPONENT,type:L.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,i){if(e=Math.round(e),i=Math.round(i),!e||!i)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&i===this.height)){this.width=e,this.height=i,this.dirtyId++,this.dirtySize++;for(let o=0;o<this.colorTextures.length;o++){const h=this.colorTextures[o],u=h.resolution;h.setSize(e/u,i/u)}if(this.depthTexture){const o=this.depthTexture.resolution;this.depthTexture.setSize(e/o,i/o)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Qs extends oe{constructor(e={}){var i,o,h;if(typeof e=="number"){const u=arguments[0],m=arguments[1],v=arguments[2],w=arguments[3];e={width:u,height:m,scaleMode:v,resolution:w}}e.width=(i=e.width)!=null?i:100,e.height=(o=e.height)!=null?o:100,(h=e.multisample)!=null||(e.multisample=at.NONE),super(null,e),this.mipmap=tt.OFF,this.valid=!0,this._clear=new Ce([0,0,0,0]),this.framebuffer=new _s(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,i){this.framebuffer.resize(e*this.resolution,i*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class gr extends Ar{constructor(e){const i=e,o=i.naturalWidth||i.videoWidth||i.width,h=i.naturalHeight||i.videoHeight||i.height;super(o,h),this.source=e,this.noSubImage=!1}static crossOrigin(e,i,o){o===void 0&&!i.startsWith("data:")?e.crossOrigin=si(i):o!==!1&&(e.crossOrigin=typeof o=="string"?o:"anonymous")}upload(e,i,o,h){const u=e.gl,m=i.realWidth,v=i.realHeight;if(h=h||this.source,typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement){if(!h.complete||h.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&h instanceof HTMLVideoElement&&h.readyState<=1)return!1;return u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===k.UNPACK),!this.noSubImage&&i.target===u.TEXTURE_2D&&o.width===m&&o.height===v?u.texSubImage2D(u.TEXTURE_2D,0,0,0,i.format,o.type,h):(o.width=m,o.height=v,u.texImage2D(i.target,0,o.internalFormat,i.format,o.type,h)),!0}update(){if(this.destroyed)return;const e=this.source,i=e.naturalWidth||e.videoWidth||e.width,o=e.naturalHeight||e.videoHeight||e.height;this.resize(i,o),super.update()}dispose(){this.source=null}}class Js extends gr{constructor(e,i){var o;if(i=i||{},typeof e=="string"){const h=new Image;gr.crossOrigin(h,e,i.crossorigin),h.src=e,e=h}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=((o=i.createBitmap)!=null?o:S.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof i.alphaMode=="number"?i.alphaMode:null,this.bitmap=null,this._load=null,i.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((i,o)=>{const h=this.source;this.url=h.src;const u=()=>{this.destroyed||(h.onload=null,h.onerror=null,this.update(),this._load=null,this.createBitmap?i(this.process()):i(this))};h.complete&&h.src?u():(h.onload=u,h.onerror=m=>{o(m),this.onError.emit(m)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const i=globalThis.createImageBitmap,o=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:o?"cors":"no-cors"}).then(h=>h.blob()).then(h=>i(h,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===k.UNPACK?"premultiply":"none"})).then(h=>this.destroyed?Promise.reject():(this.bitmap=h,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,i,o){if(typeof this.alphaMode=="number"&&(i.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,i,o);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,i,o,this.bitmap),!this.preserveBitmap){let h=!0;const u=i._glTextures;for(const m in u){const v=u[m];if(v!==o&&v.dirtyId!==i.dirtyId){h=!1;break}}h&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class vs{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,i,o){const h=i.width,u=i.height;if(o){const m=e.width/2/h,v=e.height/2/u,w=e.x/h+m,N=e.y/u+v;o=ge.add(o,ge.NW),this.x0=w+m*ge.uX(o),this.y0=N+v*ge.uY(o),o=ge.add(o,2),this.x1=w+m*ge.uX(o),this.y1=N+v*ge.uY(o),o=ge.add(o,2),this.x2=w+m*ge.uX(o),this.y2=N+v*ge.uY(o),o=ge.add(o,2),this.x3=w+m*ge.uX(o),this.y3=N+v*ge.uY(o)}else this.x0=e.x/h,this.y0=e.y/u,this.x1=(e.x+e.width)/h,this.y1=e.y/u,this.x2=(e.x+e.width)/h,this.y2=(e.y+e.height)/u,this.x3=e.x/h,this.y3=(e.y+e.height)/u;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}vs.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const tn=new vs;function Di(s){s.destroy=function(){},s.on=function(){},s.once=function(){},s.emit=function(){}}class ae extends Ft{constructor(e,i,o,h,u,m,v){if(super(),this.noFrame=!1,i||(this.noFrame=!0,i=new ne(0,0,1,1)),e instanceof ae&&(e=e.baseTexture),this.baseTexture=e,this._frame=i,this.trim=h,this.valid=!1,this.destroyed=!1,this._uvs=tn,this.uvMatrix=null,this.orig=o||i,this._rotate=Number(u||0),u===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=m?new le(m.x,m.y):new le(0,0),this.defaultBorders=v,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=i:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:i}=this.baseTexture;i!=null&&i.url&&be[i.url]&&ae.removeFromCache(i.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,ae.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var h;const e=this._frame.clone(),i=this._frame===this.orig?e:this.orig.clone(),o=new ae(this.baseTexture,!this.noFrame&&e,i,(h=this.trim)==null?void 0:h.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(o._frame=e),o}updateUvs(){this._uvs===tn&&(this._uvs=new vs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,i={},o=S.STRICT_TEXTURE_CACHE){const h=typeof e=="string";let u=null;if(h)u=e;else if(e instanceof oe){if(!e.cacheId){const v=(i==null?void 0:i.pixiIdPrefix)||"pixiid";e.cacheId=`${v}-${hr()}`,oe.addToCache(e,e.cacheId)}u=e.cacheId}else{if(!e._pixiId){const v=(i==null?void 0:i.pixiIdPrefix)||"pixiid";e._pixiId=`${v}_${hr()}`}u=e._pixiId}let m=be[u];if(h&&o&&!m)throw new Error(`The cacheId "${u}" does not exist in TextureCache.`);return!m&&!(e instanceof oe)?(i.resolution||(i.resolution=Zi(e)),m=new ae(new oe(e,i)),m.baseTexture.cacheId=u,oe.addToCache(m.baseTexture,u),ae.addToCache(m,u)):!m&&e instanceof oe&&(m=new ae(e),ae.addToCache(m,u)),m}static fromURL(e,i){const o=Object.assign({autoLoad:!1},i==null?void 0:i.resourceOptions),h=ae.from(e,Object.assign({resourceOptions:o},i),!1),u=h.baseTexture.resource;return h.baseTexture.valid?Promise.resolve(h):u.load().then(()=>Promise.resolve(h))}static fromBuffer(e,i,o,h){return new ae(oe.fromBuffer(e,i,o,h))}static fromLoader(e,i,o,h){const u=new oe(e,Object.assign({scaleMode:oe.defaultOptions.scaleMode,resolution:Zi(i)},h)),{resource:m}=u;m instanceof Js&&(m.url=i);const v=new ae(u);return o||(o=i),oe.addToCache(v.baseTexture,o),ae.addToCache(v,o),o!==i&&(oe.addToCache(v.baseTexture,i),ae.addToCache(v,i)),v.baseTexture.valid?Promise.resolve(v):new Promise(w=>{v.baseTexture.once("loaded",()=>w(v))})}static addToCache(e,i){i&&(e.textureCacheIds.includes(i)||e.textureCacheIds.push(i),be[i]&&be[i]!==e&&console.warn(`Texture added to the cache with an id [${i}] that already had an entry`),be[i]=e)}static removeFromCache(e){if(typeof e=="string"){const i=be[e];if(i){const o=i.textureCacheIds.indexOf(e);return o>-1&&i.textureCacheIds.splice(o,1),delete be[e],i}}else if(e!=null&&e.textureCacheIds){for(let i=0;i<e.textureCacheIds.length;++i)be[e.textureCacheIds[i]]===e&&delete be[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:i,y:o,width:h,height:u}=e,m=i+h>this.baseTexture.width,v=o+u>this.baseTexture.height;if(m||v){const w=m&&v?"and":"or",N=`X: ${i} + ${h} = ${i+h} > ${this.baseTexture.width}`,lt=`Y: ${o} + ${u} = ${o+u} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${N} ${w} ${lt}`)}this.valid=h&&u&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return ae._EMPTY||(ae._EMPTY=new ae(new oe),Di(ae._EMPTY),Di(ae._EMPTY.baseTexture)),ae._EMPTY}static get WHITE(){if(!ae._WHITE){const e=S.ADAPTER.createCanvas(16,16),i=e.getContext("2d");e.width=16,e.height=16,i.fillStyle="white",i.fillRect(0,0,16,16),ae._WHITE=new ae(oe.from(e)),Di(ae._WHITE),Di(ae._WHITE.baseTexture)}return ae._WHITE}}class Rr extends ae{constructor(e,i){super(e,i),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,i,o=!0){const h=this.baseTexture.resolution,u=Math.round(e*h)/h,m=Math.round(i*h)/h;this.valid=u>0&&m>0,this._frame.width=this.orig.width=u,this._frame.height=this.orig.height=m,o&&this.baseTexture.resize(u,m),this.updateUvs()}setResolution(e){const{baseTexture:i}=this;i.resolution!==e&&(i.setResolution(e),this.resize(i.width,i.height,!1))}static create(e){return new Rr(new Qs(e))}}class xs{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,i,o=at.NONE){const h=new Qs(Object.assign({width:e,height:i,resolution:1,multisample:o},this.textureOptions));return new Rr(h)}getOptimalTexture(e,i,o=1,h=at.NONE){let u;e=Math.max(Math.ceil(e*o-1e-6),1),i=Math.max(Math.ceil(i*o-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||i!==this._pixelsHeight?(e=ei(e),i=ei(i),u=((e&65535)<<16|i&65535)>>>0,h>1&&(u+=h*4294967296)):u=h>1?-h:-1,this.texturePool[u]||(this.texturePool[u]=[]);let m=this.texturePool[u].pop();return m||(m=this.createTexture(e,i,h)),m.filterPoolKey=u,m.setResolution(o),m}getFilterTexture(e,i,o){const h=this.getOptimalTexture(e.width,e.height,i||e.resolution,o||at.NONE);return h.filterFrame=e.filterFrame,h}returnTexture(e){const i=e.filterPoolKey;e.filterFrame=null,this.texturePool[i].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const i in this.texturePool){const o=this.texturePool[i];if(o)for(let h=0;h<o.length;h++)o[h].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const i in this.texturePool){if(!(Number(i)<0))continue;const o=this.texturePool[i];if(o)for(let h=0;h<o.length;h++)o[h].destroy(!0);this.texturePool[i]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}xs.SCREEN_KEY=-1;class Yn extends Er{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class en extends Er{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Ie(this.vertices),this.uvBuffer=new Ie(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,i){let o=0,h=0;return this.uvs[0]=o,this.uvs[1]=h,this.uvs[2]=o+i.width/e.width,this.uvs[3]=h,this.uvs[4]=o+i.width/e.width,this.uvs[5]=h+i.height/e.height,this.uvs[6]=o,this.uvs[7]=h+i.height/e.height,o=i.x,h=i.y,this.vertices[0]=o,this.vertices[1]=h,this.vertices[2]=o+i.width,this.vertices[3]=h,this.vertices[4]=o+i.width,this.vertices[5]=h+i.height,this.vertices[6]=o,this.vertices[7]=h+i.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class rn{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=at.NONE,this.sourceFrame=new ne,this.destinationFrame=new ne,this.bindingSourceFrame=new ne,this.bindingDestinationFrame=new ne,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const $r=[new le,new le,new le,new le],Mr=new fe;class bs{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new xs,this.statePool=[],this.quad=new Yn,this.quadUv=new en,this.tempRect=new ne,this.activeState={},this.globalUniforms=new qe({outputFrame:new ne,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,i){var ve,Kr,Br,Dr;const o=this.renderer,h=this.defaultFilterStack,u=this.statePool.pop()||new rn,m=o.renderTexture;let v,w;if(m.current){const Fr=m.current;v=Fr.resolution,w=Fr.multisample}else v=o.resolution,w=o.multisample;let N=i[0].resolution||v,lt=(ve=i[0].multisample)!=null?ve:w,gt=i[0].padding,Pt=i[0].autoFit,Kt=(Kr=i[0].legacy)!=null?Kr:!0;for(let Fr=1;Fr<i.length;Fr++){const Or=i[Fr];N=Math.min(N,Or.resolution||v),lt=Math.min(lt,(Br=Or.multisample)!=null?Br:w),gt=this.useMaxPadding?Math.max(gt,Or.padding):gt+Or.padding,Pt=Pt&&Or.autoFit,Kt=Kt||((Dr=Or.legacy)!=null?Dr:!0)}h.length===1&&(this.defaultFilterStack[0].renderTexture=m.current),h.push(u),u.resolution=N,u.multisample=lt,u.legacy=Kt,u.target=e,u.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),u.sourceFrame.pad(gt);const ce=this.tempRect.copyFrom(m.sourceFrame);o.projection.transform&&this.transformAABB(Mr.copyFrom(o.projection.transform).invert(),ce),Pt?(u.sourceFrame.fit(ce),(u.sourceFrame.width<=0||u.sourceFrame.height<=0)&&(u.sourceFrame.width=0,u.sourceFrame.height=0)):u.sourceFrame.intersects(ce)||(u.sourceFrame.width=0,u.sourceFrame.height=0),this.roundFrame(u.sourceFrame,m.current?m.current.resolution:o.resolution,m.sourceFrame,m.destinationFrame,o.projection.transform),u.renderTexture=this.getOptimalFilterTexture(u.sourceFrame.width,u.sourceFrame.height,N,lt),u.filters=i,u.destinationFrame.width=u.renderTexture.width,u.destinationFrame.height=u.renderTexture.height;const Zt=this.tempRect;Zt.x=0,Zt.y=0,Zt.width=u.sourceFrame.width,Zt.height=u.sourceFrame.height,u.renderTexture.filterFrame=u.sourceFrame,u.bindingSourceFrame.copyFrom(m.sourceFrame),u.bindingDestinationFrame.copyFrom(m.destinationFrame),u.transform=o.projection.transform,o.projection.transform=null,m.bind(u.renderTexture,u.sourceFrame,Zt),o.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,i=e.pop(),o=i.filters;this.activeState=i;const h=this.globalUniforms.uniforms;h.outputFrame=i.sourceFrame,h.resolution=i.resolution;const u=h.inputSize,m=h.inputPixel,v=h.inputClamp;if(u[0]=i.destinationFrame.width,u[1]=i.destinationFrame.height,u[2]=1/u[0],u[3]=1/u[1],m[0]=Math.round(u[0]*i.resolution),m[1]=Math.round(u[1]*i.resolution),m[2]=1/m[0],m[3]=1/m[1],v[0]=.5*m[2],v[1]=.5*m[3],v[2]=i.sourceFrame.width*u[2]-.5*m[2],v[3]=i.sourceFrame.height*u[3]-.5*m[3],i.legacy){const N=h.filterArea;N[0]=i.destinationFrame.width,N[1]=i.destinationFrame.height,N[2]=i.sourceFrame.x,N[3]=i.sourceFrame.y,h.filterClamp=h.inputClamp}this.globalUniforms.update();const w=e[e.length-1];if(this.renderer.framebuffer.blit(),o.length===1)o[0].apply(this,i.renderTexture,w.renderTexture,mt.BLEND,i),this.returnFilterTexture(i.renderTexture);else{let N=i.renderTexture,lt=this.getOptimalFilterTexture(N.width,N.height,i.resolution);lt.filterFrame=N.filterFrame;let gt=0;for(gt=0;gt<o.length-1;++gt){gt===1&&i.multisample>1&&(lt=this.getOptimalFilterTexture(N.width,N.height,i.resolution),lt.filterFrame=N.filterFrame),o[gt].apply(this,N,lt,mt.CLEAR,i);const Pt=N;N=lt,lt=Pt}o[gt].apply(this,N,w.renderTexture,mt.BLEND,i),gt>1&&i.multisample>1&&this.returnFilterTexture(i.renderTexture),this.returnFilterTexture(N),this.returnFilterTexture(lt)}i.clear(),this.statePool.push(i)}bindAndClear(e,i=mt.CLEAR){const{renderTexture:o,state:h}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const m=this.tempRect;m.x=0,m.y=0,m.width=e.filterFrame.width,m.height=e.filterFrame.height,o.bind(e,e.filterFrame,m)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?o.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const u=h.stateId&1||this.forceClear;(i===mt.CLEAR||i===mt.BLIT&&u)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,i,o,h){const u=this.renderer;u.state.set(e.state),this.bindAndClear(o,h),e.uniforms.uSampler=i,e.uniforms.filterGlobals=this.globalUniforms,u.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(i._frame,i.filterFrame),u.geometry.bind(this.quadUv),u.geometry.draw(_t.TRIANGLES)):(u.geometry.bind(this.quad),u.geometry.draw(_t.TRIANGLE_STRIP))}calculateSpriteMatrix(e,i){const{sourceFrame:o,destinationFrame:h}=this.activeState,{orig:u}=i._texture,m=e.set(h.width,0,0,h.height,o.x,o.y),v=i.worldTransform.copyTo(fe.TEMP_MATRIX);return v.invert(),m.prepend(v),m.scale(1/u.width,1/u.height),m.translate(i.anchor.x,i.anchor.y),m}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,i,o=1,h=at.NONE){return this.texturePool.getOptimalTexture(e,i,o,h)}getFilterTexture(e,i,o){if(typeof e=="number"){const u=e;e=i,i=u}e=e||this.activeState.renderTexture;const h=this.texturePool.getOptimalTexture(e.width,e.height,i||e.resolution,o||at.NONE);return h.filterFrame=e.filterFrame,h}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,i){const o=$r[0],h=$r[1],u=$r[2],m=$r[3];o.set(i.left,i.top),h.set(i.left,i.bottom),u.set(i.right,i.top),m.set(i.right,i.bottom),e.apply(o,o),e.apply(h,h),e.apply(u,u),e.apply(m,m);const v=Math.min(o.x,h.x,u.x,m.x),w=Math.min(o.y,h.y,u.y,m.y),N=Math.max(o.x,h.x,u.x,m.x),lt=Math.max(o.y,h.y,u.y,m.y);i.x=v,i.y=w,i.width=N-v,i.height=lt-w}roundFrame(e,i,o,h,u){if(!(e.width<=0||e.height<=0||o.width<=0||o.height<=0)){if(u){const{a:m,b:v,c:w,d:N}=u;if((Math.abs(v)>1e-4||Math.abs(w)>1e-4)&&(Math.abs(m)>1e-4||Math.abs(N)>1e-4))return}u=u?Mr.copyFrom(u):Mr.identity(),u.translate(-o.x,-o.y).scale(h.width/o.width,h.height/o.height).translate(h.x,h.y),this.transformAABB(u,e),e.ceil(i),this.transformAABB(u.invert(),e)}}}bs.extension={type:Qt.RendererSystem,name:"filter"},se.add(bs);class Kn{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=at.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const qn=new ne;class sn{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new _s(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ne,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let i=this.renderer.context.extensions.drawBuffers,o=this.renderer.context.extensions.depthTexture;S.PREFER_ENV===yt.WEBGL_LEGACY&&(i=null,o=null),i?e.drawBuffers=h=>i.drawBuffersWEBGL(h):(this.hasMRT=!1,e.drawBuffers=()=>{}),o||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,i,o=0){const{gl:h}=this;if(e){const u=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,h.bindFramebuffer(h.FRAMEBUFFER,u.framebuffer)),u.mipLevel!==o&&(e.dirtyId++,e.dirtyFormat++,u.mipLevel=o),u.dirtyId!==e.dirtyId&&(u.dirtyId=e.dirtyId,u.dirtyFormat!==e.dirtyFormat?(u.dirtyFormat=e.dirtyFormat,u.dirtySize=e.dirtySize,this.updateFramebuffer(e,o)):u.dirtySize!==e.dirtySize&&(u.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let m=0;m<e.colorTextures.length;m++){const v=e.colorTextures[m];this.renderer.texture.unbind(v.parentTextureArray||v)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),i){const m=i.width>>o,v=i.height>>o,w=m/i.width;this.setViewport(i.x*w,i.y*w,m,v)}else{const m=e.width>>o,v=e.height>>o;this.setViewport(0,0,m,v)}}else this.current&&(this.current=null,h.bindFramebuffer(h.FRAMEBUFFER,null)),i?this.setViewport(i.x,i.y,i.width,i.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,i,o,h){const u=this.viewport;e=Math.round(e),i=Math.round(i),o=Math.round(o),h=Math.round(h),(u.width!==o||u.height!==h||u.x!==e||u.y!==i)&&(u.x=e,u.y=i,u.width=o,u.height=h,this.gl.viewport(e,i,o,h))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,i,o,h,u=Ct.COLOR|Ct.DEPTH){const{gl:m}=this;m.clearColor(e,i,o,h),m.clear(u)}initFramebuffer(e){const{gl:i}=this,o=new Kn(i.createFramebuffer());return o.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=o,this.managedFramebuffers.push(e),e.disposeRunner.add(this),o}resizeFramebuffer(e){const{gl:i}=this,o=e.glFramebuffers[this.CONTEXT_UID];if(o.stencil){i.bindRenderbuffer(i.RENDERBUFFER,o.stencil);let m;this.renderer.context.webGLVersion===1?m=i.DEPTH_STENCIL:e.depth&&e.stencil?m=i.DEPTH24_STENCIL8:e.depth?m=i.DEPTH_COMPONENT24:m=i.STENCIL_INDEX8,o.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,o.multisample,m,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,m,e.width,e.height)}const h=e.colorTextures;let u=h.length;i.drawBuffers||(u=Math.min(u,1));for(let m=0;m<u;m++){const v=h[m],w=v.parentTextureArray||v;this.renderer.texture.bind(w,0),m===0&&o.msaaBuffer&&(i.bindRenderbuffer(i.RENDERBUFFER,o.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,o.multisample,w._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,i){const{gl:o}=this,h=e.glFramebuffers[this.CONTEXT_UID],u=e.colorTextures;let m=u.length;o.drawBuffers||(m=Math.min(m,1)),h.multisample>1&&this.canMultisampleFramebuffer(e)?h.msaaBuffer=h.msaaBuffer||o.createRenderbuffer():h.msaaBuffer&&(o.deleteRenderbuffer(h.msaaBuffer),h.msaaBuffer=null,h.blitFramebuffer&&(h.blitFramebuffer.dispose(),h.blitFramebuffer=null));const v=[];for(let w=0;w<m;w++){const N=u[w],lt=N.parentTextureArray||N;this.renderer.texture.bind(lt,0),w===0&&h.msaaBuffer?(o.bindRenderbuffer(o.RENDERBUFFER,h.msaaBuffer),o.renderbufferStorageMultisample(o.RENDERBUFFER,h.multisample,lt._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.RENDERBUFFER,h.msaaBuffer)):(o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+w,N.target,lt._glTextures[this.CONTEXT_UID].texture,i),v.push(o.COLOR_ATTACHMENT0+w))}if(v.length>1&&o.drawBuffers(v),e.depthTexture&&this.writeDepthTexture){const w=e.depthTexture;this.renderer.texture.bind(w,0),o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,w._glTextures[this.CONTEXT_UID].texture,i)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){h.stencil=h.stencil||o.createRenderbuffer();let w,N;this.renderer.context.webGLVersion===1?(w=o.DEPTH_STENCIL_ATTACHMENT,N=o.DEPTH_STENCIL):e.depth&&e.stencil?(w=o.DEPTH_STENCIL_ATTACHMENT,N=o.DEPTH24_STENCIL8):e.depth?(w=o.DEPTH_ATTACHMENT,N=o.DEPTH_COMPONENT24):(w=o.STENCIL_ATTACHMENT,N=o.STENCIL_INDEX8),o.bindRenderbuffer(o.RENDERBUFFER,h.stencil),h.msaaBuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,h.multisample,N,e.width,e.height):o.renderbufferStorage(o.RENDERBUFFER,N,e.width,e.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,w,o.RENDERBUFFER,h.stencil)}else h.stencil&&(o.deleteRenderbuffer(h.stencil),h.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:i}=this;let o=at.NONE;if(e<=1||i===null)return o;for(let h=0;h<i.length;h++)if(i[h]<=e){o=i[h];break}return o===1&&(o=at.NONE),o}blit(e,i,o){const{current:h,renderer:u,gl:m,CONTEXT_UID:v}=this;if(u.context.webGLVersion!==2||!h)return;const w=h.glFramebuffers[v];if(!w)return;if(!e){if(!w.msaaBuffer)return;const lt=h.colorTextures[0];if(!lt)return;w.blitFramebuffer||(w.blitFramebuffer=new _s(h.width,h.height),w.blitFramebuffer.addColorTexture(0,lt)),e=w.blitFramebuffer,e.colorTextures[0]!==lt&&(e.colorTextures[0]=lt,e.dirtyId++,e.dirtyFormat++),(e.width!==h.width||e.height!==h.height)&&(e.width=h.width,e.height=h.height,e.dirtyId++,e.dirtySize++)}i||(i=qn,i.width=h.width,i.height=h.height),o||(o=i);const N=i.width===o.width&&i.height===o.height;this.bind(e),m.bindFramebuffer(m.READ_FRAMEBUFFER,w.framebuffer),m.blitFramebuffer(i.left,i.top,i.right,i.bottom,o.left,o.top,o.right,o.bottom,m.COLOR_BUFFER_BIT,N?m.NEAREST:m.LINEAR),m.bindFramebuffer(m.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,i){const o=e.glFramebuffers[this.CONTEXT_UID],h=this.gl;if(!o)return;delete e.glFramebuffers[this.CONTEXT_UID];const u=this.managedFramebuffers.indexOf(e);u>=0&&this.managedFramebuffers.splice(u,1),e.disposeRunner.remove(this),i||(h.deleteFramebuffer(o.framebuffer),o.msaaBuffer&&h.deleteRenderbuffer(o.msaaBuffer),o.stencil&&h.deleteRenderbuffer(o.stencil)),o.blitFramebuffer&&this.disposeFramebuffer(o.blitFramebuffer,i)}disposeAll(e){const i=this.managedFramebuffers;this.managedFramebuffers=[];for(let o=0;o<i.length;o++)this.disposeFramebuffer(i[o],e)}forceStencil(){const e=this.current;if(!e)return;const i=e.glFramebuffers[this.CONTEXT_UID];if(!i||i.stencil&&e.stencil)return;e.stencil=!0;const o=e.width,h=e.height,u=this.gl,m=i.stencil=u.createRenderbuffer();u.bindRenderbuffer(u.RENDERBUFFER,m);let v,w;this.renderer.context.webGLVersion===1?(v=u.DEPTH_STENCIL_ATTACHMENT,w=u.DEPTH_STENCIL):e.depth?(v=u.DEPTH_STENCIL_ATTACHMENT,w=u.DEPTH24_STENCIL8):(v=u.STENCIL_ATTACHMENT,w=u.STENCIL_INDEX8),i.msaaBuffer?u.renderbufferStorageMultisample(u.RENDERBUFFER,i.multisample,w,o,h):u.renderbufferStorage(u.RENDERBUFFER,w,o,h),u.framebufferRenderbuffer(u.FRAMEBUFFER,v,u.RENDERBUFFER,m)}reset(){this.current=this.unknownFramebuffer,this.viewport=new ne}destroy(){this.renderer=null}}sn.extension={type:Qt.RendererSystem,name:"framebuffer"},se.add(sn);const Fi={5126:4,5123:2,5121:1};class nn{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,i=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,i.webGLVersion!==2){let o=this.renderer.context.extensions.vertexArrayObject;S.PREFER_ENV===yt.WEBGL_LEGACY&&(o=null),o?(e.createVertexArray=()=>o.createVertexArrayOES(),e.bindVertexArray=h=>o.bindVertexArrayOES(h),e.deleteVertexArray=h=>o.deleteVertexArrayOES(h)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(i.webGLVersion!==2){const o=e.getExtension("ANGLE_instanced_arrays");o?(e.vertexAttribDivisor=(h,u)=>o.vertexAttribDivisorANGLE(h,u),e.drawElementsInstanced=(h,u,m,v,w)=>o.drawElementsInstancedANGLE(h,u,m,v,w),e.drawArraysInstanced=(h,u,m,v)=>o.drawArraysInstancedANGLE(h,u,m,v)):this.hasInstance=!1}this.canUseUInt32ElementIndex=i.webGLVersion===2||!!i.extensions.uint32ElementIndex}bind(e,i){i=i||this.renderer.shader.shader;const{gl:o}=this;let h=e.glVertexArrayObjects[this.CONTEXT_UID],u=!1;h||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=h={},u=!0);const m=h[i.program.id]||this.initGeometryVao(e,i,u);this._activeGeometry=e,this._activeVao!==m&&(this._activeVao=m,this.hasVao?o.bindVertexArray(m):this.activateVao(e,i.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,i=this.renderer.buffer;for(let o=0;o<e.buffers.length;o++){const h=e.buffers[o];i.update(h)}}checkCompatibility(e,i){const o=e.attributes,h=i.attributeData;for(const u in h)if(!o[u])throw new Error(`shader and geometry incompatible, geometry missing the "${u}" attribute`)}getSignature(e,i){const o=e.attributes,h=i.attributeData,u=["g",e.id];for(const m in o)h[m]&&u.push(m,h[m].location);return u.join("-")}initGeometryVao(e,i,o=!0){const h=this.gl,u=this.CONTEXT_UID,m=this.renderer.buffer,v=i.program;v.glPrograms[u]||this.renderer.shader.generateProgram(i),this.checkCompatibility(e,v);const w=this.getSignature(e,v),N=e.glVertexArrayObjects[this.CONTEXT_UID];let lt=N[w];if(lt)return N[v.id]=lt,lt;const gt=e.buffers,Pt=e.attributes,Kt={},ce={};for(const Zt in gt)Kt[Zt]=0,ce[Zt]=0;for(const Zt in Pt)!Pt[Zt].size&&v.attributeData[Zt]?Pt[Zt].size=v.attributeData[Zt].size:Pt[Zt].size||console.warn(`PIXI Geometry attribute '${Zt}' size cannot be determined (likely the bound shader does not have the attribute)`),Kt[Pt[Zt].buffer]+=Pt[Zt].size*Fi[Pt[Zt].type];for(const Zt in Pt){const ve=Pt[Zt],Kr=ve.size;ve.stride===void 0&&(Kt[ve.buffer]===Kr*Fi[ve.type]?ve.stride=0:ve.stride=Kt[ve.buffer]),ve.start===void 0&&(ve.start=ce[ve.buffer],ce[ve.buffer]+=Kr*Fi[ve.type])}lt=h.createVertexArray(),h.bindVertexArray(lt);for(let Zt=0;Zt<gt.length;Zt++){const ve=gt[Zt];m.bind(ve),o&&ve._glBuffers[u].refCount++}return this.activateVao(e,v),N[v.id]=lt,N[w]=lt,h.bindVertexArray(null),m.unbind(rt.ARRAY_BUFFER),lt}disposeGeometry(e,i){var v;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const o=e.glVertexArrayObjects[this.CONTEXT_UID],h=this.gl,u=e.buffers,m=(v=this.renderer)==null?void 0:v.buffer;if(e.disposeRunner.remove(this),!!o){if(m)for(let w=0;w<u.length;w++){const N=u[w]._glBuffers[this.CONTEXT_UID];N&&(N.refCount--,N.refCount===0&&!i&&m.dispose(u[w],i))}if(!i){for(const w in o)if(w[0]==="g"){const N=o[w];this._activeVao===N&&this.unbind(),h.deleteVertexArray(N)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const i=Object.keys(this.managedGeometries);for(let o=0;o<i.length;o++)this.disposeGeometry(this.managedGeometries[i[o]],e)}activateVao(e,i){const o=this.gl,h=this.CONTEXT_UID,u=this.renderer.buffer,m=e.buffers,v=e.attributes;e.indexBuffer&&u.bind(e.indexBuffer);let w=null;for(const N in v){const lt=v[N],gt=m[lt.buffer],Pt=gt._glBuffers[h];if(i.attributeData[N]){w!==Pt&&(u.bind(gt),w=Pt);const Kt=i.attributeData[N].location;if(o.enableVertexAttribArray(Kt),o.vertexAttribPointer(Kt,lt.size,lt.type||o.FLOAT,lt.normalized,lt.stride,lt.start),lt.instance)if(this.hasInstance)o.vertexAttribDivisor(Kt,lt.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,i,o,h){const{gl:u}=this,m=this._activeGeometry;if(m.indexBuffer){const v=m.indexBuffer.data.BYTES_PER_ELEMENT,w=v===2?u.UNSIGNED_SHORT:u.UNSIGNED_INT;v===2||v===4&&this.canUseUInt32ElementIndex?m.instanced?u.drawElementsInstanced(e,i||m.indexBuffer.data.length,w,(o||0)*v,h||1):u.drawElements(e,i||m.indexBuffer.data.length,w,(o||0)*v):console.warn("unsupported index buffer type: uint32")}else m.instanced?u.drawArraysInstanced(e,o,i||m.getSize(),h||1):u.drawArrays(e,o,i||m.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}nn.extension={type:Qt.RendererSystem,name:"geometry"},se.add(nn);const li=new fe;class Ts{constructor(e,i){this._texture=e,this.mapCoord=new fe,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof i>"u"?.5:i,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,i){i===void 0&&(i=e);const o=this.mapCoord;for(let h=0;h<e.length;h+=2){const u=e[h],m=e[h+1];i[h]=u*o.a+m*o.c+o.tx,i[h+1]=u*o.b+m*o.d+o.ty}return i}update(e){const i=this._texture;if(!i||!i.valid||!e&&this._textureID===i._updateID)return!1;this._textureID=i._updateID,this._updateID++;const o=i._uvs;this.mapCoord.set(o.x1-o.x0,o.y1-o.y0,o.x3-o.x0,o.y3-o.y0,o.x0,o.y0);const h=i.orig,u=i.trim;u&&(li.set(h.width/u.width,0,0,h.height/u.height,-u.x/u.width,-u.y/u.height),this.mapCoord.append(li));const m=i.baseTexture,v=this.uClampFrame,w=this.clampMargin/m.resolution,N=this.clampOffset;return v[0]=(i._frame.x+w+N)/m.width,v[1]=(i._frame.y+w+N)/m.height,v[2]=(i._frame.x+i._frame.width-w+N)/m.width,v[3]=(i._frame.y+i._frame.height-w+N)/m.height,this.uClampOffset[0]=N/m.realWidth,this.uClampOffset[1]=N/m.realHeight,this.isSimple=i._frame.width===m.width&&i._frame.height===m.height&&i.rotate===0,!0}}var on=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,an=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Zn extends sr{constructor(e,i,o){let h=null;typeof e!="string"&&i===void 0&&o===void 0&&(h=e,e=void 0,i=void 0,o=void 0),super(e||an,i||on,o),this.maskSprite=h,this.maskMatrix=new fe}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,i,o,h){const u=this._maskSprite,m=u._texture;m.valid&&(m.uvMatrix||(m.uvMatrix=new Ts(m,0)),m.uvMatrix.update(),this.uniforms.npmAlpha=m.baseTexture.alphaMode?0:1,this.uniforms.mask=m,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,u).prepend(m.uvMatrix.mapCoord),this.uniforms.alpha=u.worldAlpha,this.uniforms.maskClamp=m.uvMatrix.uClampFrame,e.applyFilter(this,i,o,h))}}class hn{constructor(e=null){this.type=U.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=sr.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=U.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class ln{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,i){let o=i;if(!o.isMaskData){const u=this.maskDataPool.pop()||new hn;u.pooled=!0,u.maskObject=i,o=u}const h=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(o.copyCountersOrReset(h),o._colorMask=h?h._colorMask:15,o.autoDetect&&this.detect(o),o._target=e,o.type!==U.SPRITE&&this.maskStack.push(o),o.enabled)switch(o.type){case U.SCISSOR:this.renderer.scissor.push(o);break;case U.STENCIL:this.renderer.stencil.push(o);break;case U.SPRITE:o.copyCountersOrReset(null),this.pushSpriteMask(o);break;case U.COLOR:this.pushColorMask(o);break;default:break}o.type===U.SPRITE&&this.maskStack.push(o)}pop(e){const i=this.maskStack.pop();if(!(!i||i._target!==e)){if(i.enabled)switch(i.type){case U.SCISSOR:this.renderer.scissor.pop(i);break;case U.STENCIL:this.renderer.stencil.pop(i.maskObject);break;case U.SPRITE:this.popSpriteMask(i);break;case U.COLOR:this.popColorMask(i);break;default:break}if(i.reset(),i.pooled&&this.maskDataPool.push(i),this.maskStack.length!==0){const o=this.maskStack[this.maskStack.length-1];o.type===U.SPRITE&&o._filters&&(o._filters[0].maskSprite=o.maskObject)}}}detect(e){const i=e.maskObject;i?i.isSprite?e.type=U.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=U.SCISSOR:e.type=U.STENCIL:e.type=U.COLOR}pushSpriteMask(e){const{maskObject:i}=e,o=e._target;let h=e._filters;h||(h=this.alphaMaskPool[this.alphaMaskIndex],h||(h=this.alphaMaskPool[this.alphaMaskIndex]=[new Zn])),h[0].resolution=e.resolution,h[0].multisample=e.multisample,h[0].maskSprite=i;const u=o.filterArea;o.filterArea=i.getBounds(!0),this.renderer.filter.push(o,h),o.filterArea=u,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const i=e._colorMask,o=e._colorMask=i&e.colorMask;o!==i&&this.renderer.gl.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)}popColorMask(e){const i=e._colorMask,o=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;o!==i&&this.renderer.gl.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)}destroy(){this.renderer=null}}ln.extension={type:Qt.RendererSystem,name:"mask"},se.add(ln);class ui{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:i}=this.renderer,o=this.getStackLength();this.maskStack=e;const h=this.getStackLength();h!==o&&(h===0?i.disable(this.glConst):(i.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const ci=new fe,Oi=[],Li=class An extends ui{constructor(e){super(e),this.glConst=S.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){var v;if(e._scissorRectLocal)return;const i=e._scissorRect,{maskObject:o}=e,{renderer:h}=this,u=h.renderTexture,m=o.getBounds(!0,(v=Oi.pop())!=null?v:new ne);this.roundFrameToPixels(m,u.current?u.current.resolution:h.resolution,u.sourceFrame,u.destinationFrame,h.projection.transform),i&&m.fit(i),e._scissorRectLocal=m}static isMatrixRotated(e){if(!e)return!1;const{a:i,b:o,c:h,d:u}=e;return(Math.abs(o)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(i)>1e-4||Math.abs(u)>1e-4)}testScissor(e){const{maskObject:i}=e;if(!i.isFastRect||!i.isFastRect()||An.isMatrixRotated(i.worldTransform)||An.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const o=e._scissorRectLocal;return o.width>0&&o.height>0}roundFrameToPixels(e,i,o,h,u){An.isMatrixRotated(u)||(u=u?ci.copyFrom(u):ci.identity(),u.translate(-o.x,-o.y).scale(h.width/o.width,h.height/o.height).translate(h.x,h.y),this.renderer.filter.transformAABB(u,e),e.fit(h),e.x=Math.round(e.x*i),e.y=Math.round(e.y*i),e.width=Math.round(e.width*i),e.height=Math.round(e.height*i))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:i}=this.renderer;e._scissorRect||i.enable(i.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:i}=this.renderer;e&&Oi.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():i.disable(i.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let i;this.renderer.renderTexture.current?i=e.y:i=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,i,e.width,e.height)}};Li.extension={type:Qt.RendererSystem,name:"scissor"};let As=Li;se.add(As);class un extends ui{constructor(e){super(e),this.glConst=S.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const i=e.maskObject,{gl:o}=this.renderer,h=e._stencilCounter;h===0&&(this.renderer.framebuffer.forceStencil(),o.clearStencil(0),o.clear(o.STENCIL_BUFFER_BIT),o.enable(o.STENCIL_TEST)),e._stencilCounter++;const u=e._colorMask;u!==0&&(e._colorMask=0,o.colorMask(!1,!1,!1,!1)),o.stencilFunc(o.EQUAL,h,4294967295),o.stencilOp(o.KEEP,o.KEEP,o.INCR),i.renderable=!0,i.render(this.renderer),this.renderer.batch.flush(),i.renderable=!1,u!==0&&(e._colorMask=u,o.colorMask((u&1)!==0,(u&2)!==0,(u&4)!==0,(u&8)!==0)),this._useCurrent()}pop(e){const i=this.renderer.gl;if(this.getStackLength()===0)i.disable(i.STENCIL_TEST);else{const o=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,h=o?o._colorMask:15;h!==0&&(o._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilOp(i.KEEP,i.KEEP,i.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,h!==0&&(o._colorMask=h,i.colorMask((h&1)!==0,(h&2)!==0,(h&4)!==0,(h&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}un.extension={type:Qt.RendererSystem,name:"stencil"},se.add(un);class cn{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return bt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return bt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return bt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const i in e)this.plugins[i]=new e[i](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}cn.extension={type:[Qt.RendererSystem,Qt.CanvasRendererSystem],name:"_plugin"},se.add(cn);class dn{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new fe,this.transform=null}update(e,i,o,h){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=i||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,o,h),this.transform&&this.projectionMatrix.append(this.transform);const u=this.renderer;u.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,u.globalUniforms.update(),u.shader.shader&&u.shader.syncUniformGroup(u.shader.shader.uniforms.globals)}calculateProjection(e,i,o,h){const u=this.projectionMatrix,m=h?-1:1;u.identity(),u.a=1/i.width*2,u.d=m*(1/i.height*2),u.tx=-1-i.x*u.a,u.ty=-m-i.y*u.d}setTransform(e){}destroy(){this.renderer=null}}dn.extension={type:Qt.RendererSystem,name:"projection"},se.add(dn);const fn=new ls,pn=new ne;class di{constructor(e){this.renderer=e,this._tempMatrix=new fe}generateTexture(e,i){var lt;const N=i||{},{region:o}=N,h=to(N,["region"]),u=(o==null?void 0:o.copyTo(pn))||e.getLocalBounds(pn,!0),m=h.resolution||this.renderer.resolution;u.width=Math.max(u.width,1/m),u.height=Math.max(u.height,1/m),h.width=u.width,h.height=u.height,h.resolution=m,(lt=h.multisample)!=null||(h.multisample=this.renderer.multisample);const v=Rr.create(h);this._tempMatrix.tx=-u.x,this._tempMatrix.ty=-u.y;const w=e.transform;return e.transform=fn,this.renderer.render(e,{renderTexture:v,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=w,v}destroy(){}}di.extension={type:[Qt.RendererSystem,Qt.CanvasRendererSystem],name:"textureGenerator"},se.add(di);const Oe=new ne,ke=new ne;class mn{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ne,this.destinationFrame=new ne,this.viewportFrame=new ne}contextChange(){var i;const e=(i=this.renderer)==null?void 0:i.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,i,o){const h=this.renderer;this.current=e;let u,m,v;e?(u=e.baseTexture,v=u.resolution,i||(Oe.width=e.frame.width,Oe.height=e.frame.height,i=Oe),o||(ke.x=e.frame.x,ke.y=e.frame.y,ke.width=i.width,ke.height=i.height,o=ke),m=u.framebuffer):(v=h.resolution,i||(Oe.width=h._view.screen.width,Oe.height=h._view.screen.height,i=Oe),o||(o=Oe,o.width=i.width,o.height=i.height));const w=this.viewportFrame;w.x=o.x*v,w.y=o.y*v,w.width=o.width*v,w.height=o.height*v,e||(w.y=h.view.height-(w.y+w.height)),w.ceil(),this.renderer.framebuffer.bind(m,w),this.renderer.projection.update(o,i,v,!m),e?this.renderer.mask.setMaskStack(u.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(i),this.destinationFrame.copyFrom(o)}clear(e,i){const o=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,h=Ce.shared.setValue(e||o);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&h.premultiply(h.alpha);const u=this.destinationFrame,m=this.current?this.current.baseTexture:this.renderer._view.screen,v=u.width!==m.width||u.height!==m.height;if(v){let{x:w,y:N,width:lt,height:gt}=this.viewportFrame;w=Math.round(w),N=Math.round(N),lt=Math.round(lt),gt=Math.round(gt),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(w,N,lt,gt)}this.renderer.framebuffer.clear(h.red,h.green,h.blue,h.alpha,i),v&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}mn.extension={type:Qt.RendererSystem,name:"renderTexture"},se.add(mn);class co{}class gn{constructor(e,i){this.program=e,this.uniformData=i,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function Es(s,e,i){const o=s.createShader(e);return s.shaderSource(o,i),s.compileShader(o),o}function Ni(s){const e=new Array(s);for(let i=0;i<e.length;i++)e[i]=!1;return e}function yn(s,e){switch(s){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Ni(2*e);case"bvec3":return Ni(3*e);case"bvec4":return Ni(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function fo(s,e){const i={},o=e.getProgramParameter(s,e.ACTIVE_ATTRIBUTES);for(let h=0;h<o;h++){const u=e.getActiveAttrib(s,h);if(u.name.startsWith("gl_"))continue;const m=zn(e,u.type),v={type:m,name:u.name,size:Ys(m),location:e.getAttribLocation(s,u.name)};i[u.name]=v}return i}function Qn(s,e){const i={},o=e.getProgramParameter(s,e.ACTIVE_UNIFORMS);for(let h=0;h<o;h++){const u=e.getActiveUniform(s,h),m=u.name.replace(/\[.*?\]$/,""),v=!!u.name.match(/\[.*?\]$/),w=zn(e,u.type);i[m]={name:m,index:h,type:w,size:u.size,isArray:v,value:yn(w,u.size)}}return i}function _n(s,e){const i=s.getShaderSource(e).split(`
`).map((N,lt)=>`${lt}: ${N}`),o=s.getShaderInfoLog(e),h=o.split(`
`),u={},m=h.map(N=>parseFloat(N.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(N=>N&&!u[N]?(u[N]=!0,!0):!1),v=[""];m.forEach(N=>{i[N-1]=`%c${i[N-1]}%c`,v.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const w=i.join(`
`);v[0]=w,console.error(o),console.groupCollapsed("click to view full shader code"),console.warn(...v),console.groupEnd()}function ws(s,e,i,o){s.getProgramParameter(e,s.LINK_STATUS)||(s.getShaderParameter(i,s.COMPILE_STATUS)||_n(s,i),s.getShaderParameter(o,s.COMPILE_STATUS)||_n(s,o),console.error("PixiJS Error: Could not initialize shader."),s.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",s.getProgramInfoLog(e)))}function Ss(s,e){var v;const i=Es(s,s.VERTEX_SHADER,e.vertexSrc),o=Es(s,s.FRAGMENT_SHADER,e.fragmentSrc),h=s.createProgram();s.attachShader(h,i),s.attachShader(h,o);const u=(v=e.extra)==null?void 0:v.transformFeedbackVaryings;if(u&&(typeof s.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):s.transformFeedbackVaryings(h,u.names,u.bufferMode==="separate"?s.SEPARATE_ATTRIBS:s.INTERLEAVED_ATTRIBS)),s.linkProgram(h),s.getProgramParameter(h,s.LINK_STATUS)||ws(s,h,i,o),e.attributeData=fo(h,s),e.uniformData=Qn(h,s),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const w=Object.keys(e.attributeData);w.sort((N,lt)=>N>lt?1:-1);for(let N=0;N<w.length;N++)e.attributeData[w[N]].location=N,s.bindAttribLocation(h,N,w[N]);s.linkProgram(h)}s.deleteShader(i),s.deleteShader(o);const m={};for(const w in e.uniformData){const N=e.uniformData[w];m[w]={location:s.getUniformLocation(h,w),value:yn(N.type,N.size)}}return new gn(h,m)}function Ui(s,e,i,o,h){i.buffer.update(h)}const po={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},mo={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function So(s){const e=s.map(u=>({data:u,offset:0,dataLen:0,dirty:0}));let i=0,o=0,h=0;for(let u=0;u<e.length;u++){const m=e[u];if(i=mo[m.data.type],m.data.size>1&&(i=Math.max(i,16)*m.data.size),m.dataLen=i,o%i!==0&&o<16){const v=o%i%16;o+=v,h+=v}o+i>16?(h=Math.ceil(h/16)*16,m.offset=h,h+=i,o=i):(m.offset=h,o+=i,h+=i)}return h=Math.ceil(h/16)*16,{uboElements:e,size:h}}function Co(s,e){const i=[];for(const o in s)e[o]&&i.push(e[o]);return i.sort((o,h)=>o.index-h.index),i}function Io(s,e){if(!s.autoManage)return{size:0,syncFunc:Ui};const i=Co(s.uniforms,e),{uboElements:o,size:h}=So(i),u=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let m=0;m<o.length;m++){const v=o[m],w=s.uniforms[v.data.name],N=v.data.name;let lt=!1;for(let gt=0;gt<cr.length;gt++){const Pt=cr[gt];if(Pt.codeUbo&&Pt.test(v.data,w)){u.push(`offset = ${v.offset/4};`,cr[gt].codeUbo(v.data.name,w)),lt=!0;break}}if(!lt)if(v.data.size>1){const gt=Ys(v.data.type),Pt=Math.max(mo[v.data.type]/16,1),Kt=gt/Pt,ce=(4-Kt%4)%4;u.push(`
                cv = ud.${N}.value;
                v = uv.${N};
                offset = ${v.offset/4};

                t = 0;

                for(var i=0; i < ${v.data.size*Pt}; i++)
                {
                    for(var j = 0; j < ${Kt}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${ce};
                }

                `)}else{const gt=po[v.data.type];u.push(`
                cv = ud.${N}.value;
                v = uv.${N};
                offset = ${v.offset/4};
                ${gt};
                `)}}return u.push(`
       renderer.buffer.update(buffer);
    `),{size:h,syncFunc:new Function("ud","uv","renderer","syncData","buffer",u.join(`
`))}}let Cs;function Po(){if(typeof Cs=="boolean")return Cs;try{Cs=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch(s){Cs=!1}return Cs}let Ro=0;const vn={textureCount:0,uboCount:0};class go{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Ro++}systemCheck(){if(!Po())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,i){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const o=e.program,h=o.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==o&&(this.program=o,this.gl.useProgram(h.program)),i||(vn.textureCount=0,vn.uboCount=0,this.syncUniformGroup(e.uniformGroup,vn)),h}setUniforms(e){const i=this.shader.program,o=i.glPrograms[this.renderer.CONTEXT_UID];i.syncUniforms(o.uniformData,e,this.renderer)}syncUniformGroup(e,i){const o=this.getGlProgram();(!e.static||e.dirtyId!==o.uniformDirtyGroups[e.id])&&(o.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,o,i))}syncUniforms(e,i,o){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(i.uniformData,e.uniforms,this.renderer,o)}createSyncGroups(e){const i=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[i]||(this.cache[i]=ho(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[i],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,i){const o=this.getGlProgram();if(!e.static||e.dirtyId!==0||!o.uniformGroups[e.id]){e.dirtyId=0;const h=o.uniformGroups[e.id]||this.createSyncBufferGroup(e,o,i);e.buffer.update(),h(o.uniformData,e.uniforms,this.renderer,vn,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,o.uniformBufferBindings[i])}createSyncBufferGroup(e,i,o){const{gl:h}=this.renderer;this.renderer.buffer.bind(e.buffer);const u=this.gl.getUniformBlockIndex(i.program,o);i.uniformBufferBindings[o]=this.shader.uniformBindCount,h.uniformBlockBinding(i.program,u,this.shader.uniformBindCount),this.shader.uniformBindCount++;const m=this.getSignature(e,this.shader.program.uniformData,"ubo");let v=this._uboCache[m];if(v||(v=this._uboCache[m]=Io(e,this.shader.program.uniformData)),e.autoManage){const w=new Float32Array(v.size/4);e.buffer.update(w)}return i.uniformGroups[e.id]=v.syncFunc,i.uniformGroups[e.id]}getSignature(e,i,o){const h=e.uniforms,u=[`${o}-`];for(const m in h)u.push(m),i[m]&&u.push(i[m].type);return u.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const i=this.gl,o=e.program,h=Ss(i,o);return o.glPrograms[this.renderer.CONTEXT_UID]=h,h}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}go.extension={type:Qt.RendererSystem,name:"shader"},se.add(go);class xn{constructor(e){this.renderer=e}run(e){const{renderer:i}=this;i.runners.init.emit(i.options),e.hello&&console.log(`PixiJS 7.3.2 - ${i.rendererLogId} - https://pixijs.com`),i.resize(i.screen.width,i.screen.height)}destroy(){}}xn.defaultOptions={hello:!1},xn.extension={type:[Qt.RendererSystem,Qt.CanvasRendererSystem],name:"startup"},se.add(xn);function f(s,e=[]){return e[it.NORMAL]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.ADD]=[s.ONE,s.ONE],e[it.MULTIPLY]=[s.DST_COLOR,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.SCREEN]=[s.ONE,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.OVERLAY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.DARKEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.LIGHTEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.COLOR_DODGE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.COLOR_BURN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.HARD_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.SOFT_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.DIFFERENCE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.EXCLUSION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.HUE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.SATURATION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.COLOR]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.LUMINOSITY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.NONE]=[0,0],e[it.NORMAL_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.ADD_NPM]=[s.SRC_ALPHA,s.ONE,s.ONE,s.ONE],e[it.SCREEN_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],e[it.SRC_IN]=[s.DST_ALPHA,s.ZERO],e[it.SRC_OUT]=[s.ONE_MINUS_DST_ALPHA,s.ZERO],e[it.SRC_ATOP]=[s.DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],e[it.DST_OVER]=[s.ONE_MINUS_DST_ALPHA,s.ONE],e[it.DST_IN]=[s.ZERO,s.SRC_ALPHA],e[it.DST_OUT]=[s.ZERO,s.ONE_MINUS_SRC_ALPHA],e[it.DST_ATOP]=[s.ONE_MINUS_DST_ALPHA,s.SRC_ALPHA],e[it.XOR]=[s.ONE_MINUS_DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],e[it.SUBTRACT]=[s.ONE,s.ONE,s.ONE,s.ONE,s.FUNC_REVERSE_SUBTRACT,s.FUNC_ADD],e}const t=0,r=1,n=2,a=3,l=4,c=5,p=class eo{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=it.NONE,this._blendEq=!1,this.map=[],this.map[t]=this.setBlend,this.map[r]=this.setOffset,this.map[n]=this.setCullFace,this.map[a]=this.setDepthTest,this.map[l]=this.setFrontFace,this.map[c]=this.setDepthMask,this.checks=[],this.defaultState=new Tr,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=f(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let i=this.stateId^e.data,o=0;for(;i;)i&1&&this.map[o].call(this,!!(e.data&1<<o)),i=i>>1,o++;this.stateId=e.data}for(let i=0;i<this.checks.length;i++)this.checks[i](this,e)}forceState(e){e=e||this.defaultState;for(let i=0;i<this.map.length;i++)this.map[i].call(this,!!(e.data&1<<i));for(let i=0;i<this.checks.length;i++)this.checks[i](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(eo.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(eo.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const i=this.blendModes[e],o=this.gl;i.length===2?o.blendFunc(i[0],i[1]):o.blendFuncSeparate(i[0],i[1],i[2],i[3]),i.length===6?(this._blendEq=!0,o.blendEquationSeparate(i[4],i[5])):this._blendEq&&(this._blendEq=!1,o.blendEquationSeparate(o.FUNC_ADD,o.FUNC_ADD))}setPolygonOffset(e,i){this.gl.polygonOffset(e,i)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,i){const o=this.checks.indexOf(e);i&&o===-1?this.checks.push(e):!i&&o!==-1&&this.checks.splice(o,1)}static checkBlendMode(e,i){e.setBlendMode(i.blendMode)}static checkPolygonOffset(e,i){e.setPolygonOffset(1,i.polygonOffset)}destroy(){this.gl=null}};p.extension={type:Qt.RendererSystem,name:"state"};let g=p;se.add(g);class y extends Ft{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){var h;this.addRunners(...e.runners);const i=((h=e.priority)!=null?h:[]).filter(u=>e.systems[u]),o=[...i,...Object.keys(e.systems).filter(u=>!i.includes(u))];for(const u of o)this.addSystem(e.systems[u],u)}addRunners(...e){e.forEach(i=>{this.runners[i]=new xe(i)})}addSystem(e,i){const o=new e(this);if(this[i])throw new Error(`Whoops! The name "${i}" is already in use`);this[i]=o,this._systemsHash[i]=o;for(const h in this.runners)this.runners[h].add(o);return this}emitWithCustomOptions(e,i){const o=Object.keys(this._systemsHash);e.items.forEach(h=>{const u=o.find(m=>this._systemsHash[m]===h);h[e.name](i[u])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const x=class En{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=En.defaultMaxIdle,this.checkCountMax=En.defaultCheckCountMax,this.mode=En.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==ht.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,i=e.managedTextures;let o=!1;for(let h=0;h<i.length;h++){const u=i[h];u.resource&&this.count-u.touched>this.maxIdle&&(e.destroyTexture(u,!0),i[h]=null,o=!0)}if(o){let h=0;for(let u=0;u<i.length;u++)i[u]!==null&&(i[h++]=i[u]);i.length=h}}unload(e){const i=this.renderer.texture,o=e._texture;o&&!o.framebuffer&&i.destroyTexture(o);for(let h=e.children.length-1;h>=0;h--)this.unload(e.children[h])}destroy(){this.renderer=null}};x.defaultMode=ht.AUTO,x.defaultMaxIdle=60*60,x.defaultCheckCountMax=60*10,x.extension={type:Qt.RendererSystem,name:"textureGC"};let b=x;se.add(b);class A{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=L.UNSIGNED_BYTE,this.internalFormat=H.RGBA,this.samplerType=0}}function T(s){let e;return"WebGL2RenderingContext"in globalThis&&s instanceof globalThis.WebGL2RenderingContext?e={[s.RGB]:P.FLOAT,[s.RGBA]:P.FLOAT,[s.ALPHA]:P.FLOAT,[s.LUMINANCE]:P.FLOAT,[s.LUMINANCE_ALPHA]:P.FLOAT,[s.R8]:P.FLOAT,[s.R8_SNORM]:P.FLOAT,[s.RG8]:P.FLOAT,[s.RG8_SNORM]:P.FLOAT,[s.RGB8]:P.FLOAT,[s.RGB8_SNORM]:P.FLOAT,[s.RGB565]:P.FLOAT,[s.RGBA4]:P.FLOAT,[s.RGB5_A1]:P.FLOAT,[s.RGBA8]:P.FLOAT,[s.RGBA8_SNORM]:P.FLOAT,[s.RGB10_A2]:P.FLOAT,[s.RGB10_A2UI]:P.FLOAT,[s.SRGB8]:P.FLOAT,[s.SRGB8_ALPHA8]:P.FLOAT,[s.R16F]:P.FLOAT,[s.RG16F]:P.FLOAT,[s.RGB16F]:P.FLOAT,[s.RGBA16F]:P.FLOAT,[s.R32F]:P.FLOAT,[s.RG32F]:P.FLOAT,[s.RGB32F]:P.FLOAT,[s.RGBA32F]:P.FLOAT,[s.R11F_G11F_B10F]:P.FLOAT,[s.RGB9_E5]:P.FLOAT,[s.R8I]:P.INT,[s.R8UI]:P.UINT,[s.R16I]:P.INT,[s.R16UI]:P.UINT,[s.R32I]:P.INT,[s.R32UI]:P.UINT,[s.RG8I]:P.INT,[s.RG8UI]:P.UINT,[s.RG16I]:P.INT,[s.RG16UI]:P.UINT,[s.RG32I]:P.INT,[s.RG32UI]:P.UINT,[s.RGB8I]:P.INT,[s.RGB8UI]:P.UINT,[s.RGB16I]:P.INT,[s.RGB16UI]:P.UINT,[s.RGB32I]:P.INT,[s.RGB32UI]:P.UINT,[s.RGBA8I]:P.INT,[s.RGBA8UI]:P.UINT,[s.RGBA16I]:P.INT,[s.RGBA16UI]:P.UINT,[s.RGBA32I]:P.INT,[s.RGBA32UI]:P.UINT,[s.DEPTH_COMPONENT16]:P.FLOAT,[s.DEPTH_COMPONENT24]:P.FLOAT,[s.DEPTH_COMPONENT32F]:P.FLOAT,[s.DEPTH_STENCIL]:P.FLOAT,[s.DEPTH24_STENCIL8]:P.FLOAT,[s.DEPTH32F_STENCIL8]:P.FLOAT}:e={[s.RGB]:P.FLOAT,[s.RGBA]:P.FLOAT,[s.ALPHA]:P.FLOAT,[s.LUMINANCE]:P.FLOAT,[s.LUMINANCE_ALPHA]:P.FLOAT,[s.DEPTH_STENCIL]:P.FLOAT},e}function M(s){let e;return"WebGL2RenderingContext"in globalThis&&s instanceof globalThis.WebGL2RenderingContext?e={[L.UNSIGNED_BYTE]:{[H.RGBA]:s.RGBA8,[H.RGB]:s.RGB8,[H.RG]:s.RG8,[H.RED]:s.R8,[H.RGBA_INTEGER]:s.RGBA8UI,[H.RGB_INTEGER]:s.RGB8UI,[H.RG_INTEGER]:s.RG8UI,[H.RED_INTEGER]:s.R8UI,[H.ALPHA]:s.ALPHA,[H.LUMINANCE]:s.LUMINANCE,[H.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[L.BYTE]:{[H.RGBA]:s.RGBA8_SNORM,[H.RGB]:s.RGB8_SNORM,[H.RG]:s.RG8_SNORM,[H.RED]:s.R8_SNORM,[H.RGBA_INTEGER]:s.RGBA8I,[H.RGB_INTEGER]:s.RGB8I,[H.RG_INTEGER]:s.RG8I,[H.RED_INTEGER]:s.R8I},[L.UNSIGNED_SHORT]:{[H.RGBA_INTEGER]:s.RGBA16UI,[H.RGB_INTEGER]:s.RGB16UI,[H.RG_INTEGER]:s.RG16UI,[H.RED_INTEGER]:s.R16UI,[H.DEPTH_COMPONENT]:s.DEPTH_COMPONENT16},[L.SHORT]:{[H.RGBA_INTEGER]:s.RGBA16I,[H.RGB_INTEGER]:s.RGB16I,[H.RG_INTEGER]:s.RG16I,[H.RED_INTEGER]:s.R16I},[L.UNSIGNED_INT]:{[H.RGBA_INTEGER]:s.RGBA32UI,[H.RGB_INTEGER]:s.RGB32UI,[H.RG_INTEGER]:s.RG32UI,[H.RED_INTEGER]:s.R32UI,[H.DEPTH_COMPONENT]:s.DEPTH_COMPONENT24},[L.INT]:{[H.RGBA_INTEGER]:s.RGBA32I,[H.RGB_INTEGER]:s.RGB32I,[H.RG_INTEGER]:s.RG32I,[H.RED_INTEGER]:s.R32I},[L.FLOAT]:{[H.RGBA]:s.RGBA32F,[H.RGB]:s.RGB32F,[H.RG]:s.RG32F,[H.RED]:s.R32F,[H.DEPTH_COMPONENT]:s.DEPTH_COMPONENT32F},[L.HALF_FLOAT]:{[H.RGBA]:s.RGBA16F,[H.RGB]:s.RGB16F,[H.RG]:s.RG16F,[H.RED]:s.R16F},[L.UNSIGNED_SHORT_5_6_5]:{[H.RGB]:s.RGB565},[L.UNSIGNED_SHORT_4_4_4_4]:{[H.RGBA]:s.RGBA4},[L.UNSIGNED_SHORT_5_5_5_1]:{[H.RGBA]:s.RGB5_A1},[L.UNSIGNED_INT_2_10_10_10_REV]:{[H.RGBA]:s.RGB10_A2,[H.RGBA_INTEGER]:s.RGB10_A2UI},[L.UNSIGNED_INT_10F_11F_11F_REV]:{[H.RGB]:s.R11F_G11F_B10F},[L.UNSIGNED_INT_5_9_9_9_REV]:{[H.RGB]:s.RGB9_E5},[L.UNSIGNED_INT_24_8]:{[H.DEPTH_STENCIL]:s.DEPTH24_STENCIL8},[L.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[H.DEPTH_STENCIL]:s.DEPTH32F_STENCIL8}}:e={[L.UNSIGNED_BYTE]:{[H.RGBA]:s.RGBA,[H.RGB]:s.RGB,[H.ALPHA]:s.ALPHA,[H.LUMINANCE]:s.LUMINANCE,[H.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[L.UNSIGNED_SHORT_5_6_5]:{[H.RGB]:s.RGB},[L.UNSIGNED_SHORT_4_4_4_4]:{[H.RGBA]:s.RGBA},[L.UNSIGNED_SHORT_5_5_5_1]:{[H.RGBA]:s.RGBA}},e}class O{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new oe,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=M(e),this.samplerTypes=T(e);const i=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=i;for(let h=0;h<i;h++)this.boundTextures[h]=null;this.emptyTextures={};const o=new A(e.createTexture());e.bindTexture(e.TEXTURE_2D,o.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=o,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new A(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let h=0;h<6;h++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let h=0;h<this.boundTextures.length;h++)this.bind(null,h)}bind(e,i=0){const{gl:o}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const h=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[i]!==e&&(this.currentLocation!==i&&(this.currentLocation=i,o.activeTexture(o.TEXTURE0+i)),o.bindTexture(e.target,h.texture)),h.dirtyId!==e.dirtyId?(this.currentLocation!==i&&(this.currentLocation=i,o.activeTexture(o.TEXTURE0+i)),this.updateTexture(e)):h.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[i]=e}else this.currentLocation!==i&&(this.currentLocation=i,o.activeTexture(o.TEXTURE0+i)),o.bindTexture(o.TEXTURE_2D,this.emptyTextures[o.TEXTURE_2D].texture),this.boundTextures[i]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:i,boundTextures:o}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let h=0;h<o.length;h++)o[h]===this.unknownTexture&&this.bind(null,h)}for(let h=0;h<o.length;h++)o[h]===e&&(this.currentLocation!==h&&(i.activeTexture(i.TEXTURE0+h),this.currentLocation=h),i.bindTexture(e.target,this.emptyTextures[e.target].texture),o[h]=null)}ensureSamplerType(e){const{boundTextures:i,hasIntegerTextures:o,CONTEXT_UID:h}=this;if(o)for(let u=e-1;u>=0;--u){const m=i[u];m&&m._glTextures[h].samplerType!==P.FLOAT&&this.renderer.texture.unbind(m)}}initTexture(e){const i=new A(this.gl.createTexture());return i.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=i,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),i}initTextureType(e,i){var o,h,u;i.internalFormat=(h=(o=this.internalFormats[e.type])==null?void 0:o[e.format])!=null?h:e.format,i.samplerType=(u=this.samplerTypes[i.internalFormat])!=null?u:P.FLOAT,this.webGLVersion===2&&e.type===L.HALF_FLOAT?i.type=this.gl.HALF_FLOAT:i.type=e.type}updateTexture(e){var h;const i=e._glTextures[this.CONTEXT_UID];if(!i)return;const o=this.renderer;if(this.initTextureType(e,i),(h=e.resource)==null?void 0:h.upload(o,e,i))i.samplerType!==P.FLOAT&&(this.hasIntegerTextures=!0);else{const u=e.realWidth,m=e.realHeight,v=o.gl;(i.width!==u||i.height!==m||i.dirtyId<0)&&(i.width=u,i.height=m,v.texImage2D(e.target,0,i.internalFormat,u,m,0,e.format,i.type,null))}e.dirtyStyleId!==i.dirtyStyleId&&this.updateTextureStyle(e),i.dirtyId=e.dirtyId}destroyTexture(e,i){const{gl:o}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),o.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!i)){const h=this.managedTextures.indexOf(e);h!==-1&&Ls(this.managedTextures,h,1)}}updateTextureStyle(e){var o;const i=e._glTextures[this.CONTEXT_UID];i&&((e.mipmap===tt.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?i.mipmap=!1:i.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?i.wrapMode=j.CLAMP:i.wrapMode=e.wrapMode,(o=e.resource)!=null&&o.style(this.renderer,e,i)||this.setStyle(e,i),i.dirtyStyleId=e.dirtyStyleId)}setStyle(e,i){const o=this.gl;if(i.mipmap&&e.mipmap!==tt.ON_MANUAL&&o.generateMipmap(e.target),o.texParameteri(e.target,o.TEXTURE_WRAP_S,i.wrapMode),o.texParameteri(e.target,o.TEXTURE_WRAP_T,i.wrapMode),i.mipmap){o.texParameteri(e.target,o.TEXTURE_MIN_FILTER,e.scaleMode===z.LINEAR?o.LINEAR_MIPMAP_LINEAR:o.NEAREST_MIPMAP_NEAREST);const h=this.renderer.context.extensions.anisotropicFiltering;if(h&&e.anisotropicLevel>0&&e.scaleMode===z.LINEAR){const u=Math.min(e.anisotropicLevel,o.getParameter(h.MAX_TEXTURE_MAX_ANISOTROPY_EXT));o.texParameterf(e.target,h.TEXTURE_MAX_ANISOTROPY_EXT,u)}}else o.texParameteri(e.target,o.TEXTURE_MIN_FILTER,e.scaleMode===z.LINEAR?o.LINEAR:o.NEAREST);o.texParameteri(e.target,o.TEXTURE_MAG_FILTER,e.scaleMode===z.LINEAR?o.LINEAR:o.NEAREST)}destroy(){this.renderer=null}}O.extension={type:Qt.RendererSystem,name:"texture"},se.add(O);class K{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:i,CONTEXT_UID:o}=this,h=e._glTransformFeedbacks[o]||this.createGLTransformFeedback(e);i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,h)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,i){const{gl:o,renderer:h}=this;i&&h.shader.bind(i),o.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:i,renderer:o,CONTEXT_UID:h}=this,u=i.createTransformFeedback();e._glTransformFeedbacks[h]=u,i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,u);for(let m=0;m<e.buffers.length;m++){const v=e.buffers[m];v&&(o.buffer.update(v),v._glBuffers[h].refCount++,i.bindBufferBase(i.TRANSFORM_FEEDBACK_BUFFER,m,v._glBuffers[h].buffer||null))}return i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),u}disposeTransformFeedback(e,i){const o=e._glTransformFeedbacks[this.CONTEXT_UID],h=this.gl;e.disposeRunner.remove(this);const u=this.renderer.buffer;if(u)for(let m=0;m<e.buffers.length;m++){const v=e.buffers[m];if(!v)continue;const w=v._glBuffers[this.CONTEXT_UID];w&&(w.refCount--,w.refCount===0&&!i&&u.dispose(v,i))}o&&(i||h.deleteTransformFeedback(o),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}K.extension={type:Qt.RendererSystem,name:"transformFeedback"},se.add(K);class ${constructor(e){this.renderer=e}init(e){this.screen=new ne(0,0,e.width,e.height),this.element=e.view||S.ADAPTER.createCanvas(),this.resolution=e.resolution||S.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,i){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(i*this.resolution);const o=this.element.width/this.resolution,h=this.element.height/this.resolution;this.screen.width=o,this.screen.height=h,this.autoDensity&&(this.element.style.width=`${o}px`,this.element.style.height=`${h}px`),this.renderer.emit("resize",o,h),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var i;e&&((i=this.element.parentNode)==null||i.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}$.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},$.extension={type:[Qt.RendererSystem,Qt.CanvasRendererSystem],name:"_view"},se.add($),S.PREFER_ENV=yt.WEBGL2,S.STRICT_TEXTURE_CACHE=!1,S.RENDER_OPTIONS=pe(pe(pe(pe({},Bi.defaultOptions),Mi.defaultOptions),$.defaultOptions),xn.defaultOptions),Object.defineProperties(S,{WRAP_MODE:{get(){return oe.defaultOptions.wrapMode},set(s){bt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),oe.defaultOptions.wrapMode=s}},SCALE_MODE:{get(){return oe.defaultOptions.scaleMode},set(s){bt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),oe.defaultOptions.scaleMode=s}},MIPMAP_TEXTURES:{get(){return oe.defaultOptions.mipmap},set(s){bt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),oe.defaultOptions.mipmap=s}},ANISOTROPIC_LEVEL:{get(){return oe.defaultOptions.anisotropicLevel},set(s){bt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),oe.defaultOptions.anisotropicLevel=s}},FILTER_RESOLUTION:{get(){return bt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),sr.defaultResolution},set(s){sr.defaultResolution=s}},FILTER_MULTISAMPLE:{get(){return bt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),sr.defaultMultisample},set(s){sr.defaultMultisample=s}},SPRITE_MAX_TEXTURES:{get(){return pr.defaultMaxTextures},set(s){bt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),pr.defaultMaxTextures=s}},SPRITE_BATCH_SIZE:{get(){return pr.defaultBatchSize},set(s){bt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),pr.defaultBatchSize=s}},CAN_UPLOAD_SAME_BUFFER:{get(){return pr.canUploadSameBuffer},set(s){bt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),pr.canUploadSameBuffer=s}},GC_MODE:{get(){return b.defaultMode},set(s){bt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),b.defaultMode=s}},GC_MAX_IDLE:{get(){return b.defaultMaxIdle},set(s){bt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),b.defaultMaxIdle=s}},GC_MAX_CHECK_COUNT:{get(){return b.defaultCheckCountMax},set(s){bt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),b.defaultCheckCountMax=s}},PRECISION_VERTEX:{get(){return Pr.defaultVertexPrecision},set(s){bt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Pr.defaultVertexPrecision=s}},PRECISION_FRAGMENT:{get(){return Pr.defaultFragmentPrecision},set(s){bt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Pr.defaultFragmentPrecision=s}}});var vt=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(vt||{});class et{constructor(e,i=null,o=0,h=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=i,this.priority=o,this.once=h}match(e,i=null){return this.fn===e&&this.context===i}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const i=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),i}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const i=this.next;return this.next=e?null:i,this.previous=null,i}}const ut=class ze{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new et(null,null,1/0),this.deltaMS=1/ze.targetFPMS,this.elapsedMS=1/ze.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,i,o=vt.NORMAL){return this._addListener(new et(e,i,o))}addOnce(e,i,o=vt.NORMAL){return this._addListener(new et(e,i,o,!0))}_addListener(e){let i=this._head.next,o=this._head;if(!i)e.connect(o);else{for(;i;){if(e.priority>i.priority){e.connect(o);break}o=i,i=i.next}e.previous||e.connect(o)}return this._startIfPossible(),this}remove(e,i){let o=this._head.next;for(;o;)o.match(e,i)?o=o.destroy():o=o.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,i=this._head;for(;i=i.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let i;if(e>this.lastTime){if(i=this.elapsedMS=e-this.lastTime,i>this._maxElapsedMS&&(i=this._maxElapsedMS),i*=this.speed,this._minElapsedMS){const u=e-this._lastFrame|0;if(u<this._minElapsedMS)return;this._lastFrame=e-u%this._minElapsedMS}this.deltaMS=i,this.deltaTime=this.deltaMS*ze.targetFPMS;const o=this._head;let h=o.next;for(;h;)h=h.emit(this.deltaTime);o.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const i=Math.min(this.maxFPS,e),o=Math.min(Math.max(0,i)/1e3,ze.targetFPMS);this._maxElapsedMS=1/o}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const i=Math.max(this.minFPS,e);this._minElapsedMS=1/(i/1e3)}}static get shared(){if(!ze._shared){const e=ze._shared=new ze;e.autoStart=!0,e._protected=!0}return ze._shared}static get system(){if(!ze._system){const e=ze._system=new ze;e.autoStart=!0,e._protected=!0}return ze._system}};ut.targetFPMS=.06;let Mt=ut;Object.defineProperties(S,{TARGET_FPMS:{get(){return Mt.targetFPMS},set(s){bt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Mt.targetFPMS=s}}});class $t{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(i){this._ticker&&this._ticker.remove(this.render,this),this._ticker=i,i&&i.add(this.render,this,vt.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Mt.shared:new Mt,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}$t.extension=Qt.Application,se.add($t);const Dt=[];se.handleByList(Qt.Renderer,Dt);function Bt(s){for(const e of Dt)if(e.test(s))return new e(s);throw new Error("Unable to auto-detect a suitable renderer.")}var Wt=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,jt=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const ue=Wt,Ut=jt;class ft{constructor(e){this.renderer=e}contextChange(e){let i;if(this.renderer.context.webGLVersion===1){const o=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),i=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,o)}else{const o=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),i=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,o)}i>=at.HIGH?this.multisample=at.HIGH:i>=at.MEDIUM?this.multisample=at.MEDIUM:i>=at.LOW?this.multisample=at.LOW:this.multisample=at.NONE}destroy(){}}ft.extension={type:Qt.RendererSystem,name:"_multisample"},se.add(ft);class Rt{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Vt{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:i,CONTEXT_UID:o}=this,h=e._glBuffers[o]||this.createGLBuffer(e);i.bindBuffer(e.type,h.buffer)}unbind(e){const{gl:i}=this;i.bindBuffer(e,null)}bindBufferBase(e,i){const{gl:o,CONTEXT_UID:h}=this;if(this.boundBufferBases[i]!==e){const u=e._glBuffers[h]||this.createGLBuffer(e);this.boundBufferBases[i]=e,o.bindBufferBase(o.UNIFORM_BUFFER,i,u.buffer)}}bindBufferRange(e,i,o){const{gl:h,CONTEXT_UID:u}=this;o=o||0;const m=e._glBuffers[u]||this.createGLBuffer(e);h.bindBufferRange(h.UNIFORM_BUFFER,i||0,m.buffer,o*256,256)}update(e){const{gl:i,CONTEXT_UID:o}=this,h=e._glBuffers[o]||this.createGLBuffer(e);if(e._updateID!==h.updateID)if(h.updateID=e._updateID,i.bindBuffer(e.type,h.buffer),h.byteLength>=e.data.byteLength)i.bufferSubData(e.type,0,e.data);else{const u=e.static?i.STATIC_DRAW:i.DYNAMIC_DRAW;h.byteLength=e.data.byteLength,i.bufferData(e.type,e.data,u)}}dispose(e,i){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const o=e._glBuffers[this.CONTEXT_UID],h=this.gl;e.disposeRunner.remove(this),o&&(i||h.deleteBuffer(o.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const i=Object.keys(this.managedBuffers);for(let o=0;o<i.length;o++)this.dispose(this.managedBuffers[i[o]],e)}createGLBuffer(e){const{CONTEXT_UID:i,gl:o}=this;return e._glBuffers[i]=new Rt(o.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[i]}}Vt.extension={type:Qt.RendererSystem,name:"buffer"},se.add(Vt);class re{constructor(e){this.renderer=e}render(e,i){const o=this.renderer;let h,u,m,v;if(i&&(h=i.renderTexture,u=i.clear,m=i.transform,v=i.skipUpdateTransform),this.renderingToScreen=!h,o.runners.prerender.emit(),o.emit("prerender"),o.projection.transform=m,!o.context.isLost){if(h||(this.lastObjectRendered=e),!v){const w=e.enableTempParent();e.updateTransform(),e.disableTempParent(w)}o.renderTexture.bind(h),o.batch.currentRenderer.start(),(u!=null?u:o.background.clearBeforeRender)&&o.renderTexture.clear(),e.render(o),o.batch.currentRenderer.flush(),h&&(i.blit&&o.framebuffer.blit(),h.baseTexture.update()),o.runners.postrender.emit(),o.projection.transform=null,o.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}re.extension={type:Qt.RendererSystem,name:"objectRenderer"},se.add(re);const Ht=class ro extends y{constructor(e){super(),this.type=nt.WEBGL,e=Object.assign({},S.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new qe({projectionMatrix:new fe},!0);const i={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:ro.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(i),"useContextAlpha"in e&&(bt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=ro.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:qr()}render(e,i){this.objectRenderer.render(e,i)}resize(e,i){this._view.resizeView(e,i)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return bt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return bt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return bt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return bt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){bt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return bt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){bt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return bt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,i){return this.textureGenerator.generateTexture(e,i)}};Ht.extension={type:Qt.Renderer,priority:1},Ht.__plugins={},Ht.__systems={};let Yt=Ht;se.handleByMap(Qt.RendererPlugin,Yt.__plugins),se.handleByMap(Qt.RendererSystem,Yt.__systems),se.add(Yt);class Te extends Ar{constructor(e,i){const{width:o,height:h}=i||{};super(o,h),this.items=[],this.itemDirtyIds=[];for(let u=0;u<e;u++){const m=new oe;this.items.push(m),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,i){for(let o=0;o<this.length;o++)e[o]&&(e[o].castToBaseTexture?this.addBaseTextureAt(e[o].castToBaseTexture(),o):e[o]instanceof Ar?this.addResourceAt(e[o],o):this.addResourceAt(Hs(e[o],i),o))}dispose(){for(let e=0,i=this.length;e<i;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,i){if(!this.items[i])throw new Error(`Index ${i} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[i].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let i=0;i<this.length;i++)this.items[i].parentTextureArray=e,this.items[i].on("update",e.update,e)}unbind(e){super.unbind(e);for(let i=0;i<this.length;i++)this.items[i].parentTextureArray=null,this.items[i].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(e).then(()=>{const{realWidth:i,realHeight:o}=this.items[0];return this.resize(i,o),this.update(),Promise.resolve(this)}),this._load}}class Ae extends Te{constructor(e,i){const{width:o,height:h}=i||{};let u,m;Array.isArray(e)?(u=e,m=e.length):m=e,super(m,{width:o,height:h}),u&&this.initFromArray(u,i)}addBaseTextureAt(e,i){if(e.resource)this.addResourceAt(e.resource,i);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=J.TEXTURE_2D_ARRAY}upload(e,i,o){const{length:h,itemDirtyIds:u,items:m}=this,{gl:v}=e;o.dirtyId<0&&v.texImage3D(v.TEXTURE_2D_ARRAY,0,o.internalFormat,this._width,this._height,h,0,i.format,o.type,null);for(let w=0;w<h;w++){const N=m[w];u[w]<N.dirtyId&&(u[w]=N.dirtyId,N.valid&&v.texSubImage3D(v.TEXTURE_2D_ARRAY,0,0,0,w,N.resource.width,N.resource.height,1,i.format,o.type,N.resource.source))}return!0}}class te extends gr{constructor(e){super(e)}static test(e){const{OffscreenCanvas:i}=globalThis;return i&&e instanceof i?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const Is=class Ms extends Te{constructor(e,i){const{width:o,height:h,autoLoad:u,linkBaseTexture:m}=i||{};if(e&&e.length!==Ms.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:o,height:h});for(let v=0;v<Ms.SIDES;v++)this.items[v].target=J.TEXTURE_CUBE_MAP_POSITIVE_X+v;this.linkBaseTexture=m!==!1,e&&this.initFromArray(e,i),u!==!1&&this.load()}bind(e){super.bind(e),e.target=J.TEXTURE_CUBE_MAP}addBaseTextureAt(e,i,o){if(o===void 0&&(o=this.linkBaseTexture),!this.items[i])throw new Error(`Index ${i} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,i);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=J.TEXTURE_CUBE_MAP_POSITIVE_X+i,e.parentTextureArray=this.baseTexture,this.items[i]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[i]=e,this}upload(e,i,o){const h=this.itemDirtyIds;for(let u=0;u<Ms.SIDES;u++){const m=this.items[u];(h[u]<m.dirtyId||o.dirtyId<i.dirtyId)&&(m.valid&&m.resource?(m.resource.upload(e,m,o),h[u]=m.dirtyId):h[u]<-1&&(e.gl.texImage2D(m.target,0,o.internalFormat,i.realWidth,i.realHeight,0,i.format,o.type,null),h[u]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===Ms.SIDES}};Is.SIDES=6;let ki=Is;class Qe extends gr{constructor(e,i){var m,v;i=i||{};let o,h,u;typeof e=="string"?(o=Qe.EMPTY,h=e,u=!0):(o=e,h=null,u=!1),super(o),this.url=h,this.crossOrigin=(m=i.crossOrigin)!=null?m:!0,this.alphaMode=typeof i.alphaMode=="number"?i.alphaMode:null,this.ownsImageBitmap=(v=i.ownsImageBitmap)!=null?v:u,this._load=null,i.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise((e,i)=>Lt(this,null,function*(){if(this.url===null){e(this);return}try{const o=yield S.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const h=yield o.blob();if(this.destroyed)return;const u=yield createImageBitmap(h,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===k.UNPACK?"premultiply":"none"});if(this.destroyed){u.close();return}this.source=u,this.update(),e(this)}catch(o){if(this.destroyed)return;i(o),this.onError.emit(o)}})),this._load)}upload(e,i,o){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(i.alphaMode=this.alphaMode),super.upload(e,i,o)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){var e;return Qe._EMPTY=(e=Qe._EMPTY)!=null?e:S.ADAPTER.createCanvas(0,0),Qe._EMPTY}}const Gi=class wn extends gr{constructor(e,i){i=i||{},super(S.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=i.scale||1,this._overrideWidth=i.width,this._overrideHeight=i.height,this._resolve=null,this._crossorigin=i.crossorigin,this._load=null,i.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},wn.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;gr.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=i=>{this._resolve&&(e.onerror=null,this.onError.emit(i))},e.onload=()=>{if(!this._resolve)return;const i=e.width,o=e.height;if(!i||!o)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let h=i*this.scale,u=o*this.scale;(this._overrideWidth||this._overrideHeight)&&(h=this._overrideWidth||this._overrideHeight/o*i,u=this._overrideHeight||this._overrideWidth/i*o),h=Math.round(h),u=Math.round(u);const m=this.source;m.width=h,m.height=u,m._pixiId=`canvas_${hr()}`,m.getContext("2d").drawImage(e,0,0,i,o,0,0,h,u),this._resolve(),this._resolve=null}}static getSize(e){const i=wn.SVG_SIZE.exec(e),o={};return i&&(o[i[1]]=Math.round(parseFloat(i[3])),o[i[5]]=Math.round(parseFloat(i[7]))),o}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,i){return i==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&wn.SVG_XML.test(e)}};Gi.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Gi.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let Ps=Gi;const jr=class io extends gr{constructor(e,i){if(i=i||{},!(e instanceof HTMLVideoElement)){const o=document.createElement("video");i.autoLoad!==!1&&o.setAttribute("preload","auto"),i.playsinline!==!1&&(o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline","")),i.muted===!0&&(o.setAttribute("muted",""),o.muted=!0),i.loop===!0&&o.setAttribute("loop",""),i.autoPlay!==!1&&o.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const h=e[0].src||e[0];gr.crossOrigin(o,h,i.crossorigin);for(let u=0;u<e.length;++u){const m=document.createElement("source");let{src:v,mime:w}=e[u];if(v=v||e[u],v.startsWith("data:"))w=v.slice(5,v.indexOf(";"));else if(!v.startsWith("blob:")){const N=v.split("?").shift().toLowerCase(),lt=N.slice(N.lastIndexOf(".")+1);w=w||io.MIME_TYPES[lt]||`video/${lt}`}m.src=v,w&&(m.type=w),o.appendChild(m)}e=o}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=i.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=i.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),i.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const i=Mt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-i)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((i,o)=>{this.valid?i(this):(this._resolve=i,this._reject=o,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const i=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!i&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(Mt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Mt.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Mt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,i){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||io.TYPES.includes(i)}};jr.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],jr.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let fi=jr;Ti.push(Qe,Js,te,fi,Ps,Ai,ki,Ae);class Jn{constructor(){this._glTransformFeedbacks={},this.buffers=[],this.disposeRunner=new Runner("disposeTransformFeedback")}bindBuffer(e,i){this.buffers[e]=i}destroy(){this.disposeRunner.emit(this,!1)}}const Yr="7.3.2"},8121:function(It,Ot,st){"use strict";st.d(Ot,{U:function(){return nt}});var d=st(9774),yt=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class nt extends d.wn{constructor(it=1){super(d.kP,yt,{uAlpha:1}),this.alpha=it}get alpha(){return this.uniforms.uAlpha}set alpha(it){this.uniforms.uAlpha=it}}},6844:function(It,Ot,st){"use strict";st.d(Ot,{T:function(){return J},Y:function(){return H}});var d=st(9774);const yt={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},nt=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function Ct(L){const P=yt[L],z=P.length;let j=nt,tt="";const k="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let mt;for(let ht=0;ht<L;ht++){let B=k.replace("%index%",ht.toString());mt=ht,ht>=z&&(mt=L-ht-1),B=B.replace("%value%",P[mt].toString()),tt+=B,tt+=`
`}return j=j.replace("%blur%",tt),j=j.replace("%size%",L.toString()),j}const it=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function _t(L,P){const z=Math.ceil(L/2);let j=it,tt="",k;P?k="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":k="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let mt=0;mt<L;mt++){let ht=k.replace("%index%",mt.toString());ht=ht.replace("%sampleIndex%",`${mt-(z-1)}.0`),tt+=ht,tt+=`
`}return j=j.replace("%blur%",tt),j=j.replace("%size%",L.toString()),j}class H extends d.wn{constructor(P,z=8,j=4,tt=d.wn.defaultResolution,k=5){const mt=_t(k,P),ht=Ct(k);super(mt,ht),this.horizontal=P,this.resolution=tt,this._quality=0,this.quality=j,this.blur=z}apply(P,z,j,tt){if(j?this.horizontal?this.uniforms.strength=1/j.width*(j.width/z.width):this.uniforms.strength=1/j.height*(j.height/z.height):this.horizontal?this.uniforms.strength=1/P.renderer.width*(P.renderer.width/z.width):this.uniforms.strength=1/P.renderer.height*(P.renderer.height/z.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)P.applyFilter(this,z,j,tt);else{const k=P.getFilterTexture(),mt=P.renderer;let ht=z,B=k;this.state.blend=!1,P.applyFilter(this,ht,B,d.yl.CLEAR);for(let U=1;U<this.passes-1;U++){P.bindAndClear(ht,d.yl.BLIT),this.uniforms.uSampler=B;const q=B;B=ht,ht=q,mt.shader.bind(this),mt.geometry.draw(5)}this.state.blend=!0,P.applyFilter(this,B,j,tt),P.returnFilterTexture(k)}}get blur(){return this.strength}set blur(P){this.padding=1+Math.abs(P)*2,this.strength=P}get quality(){return this._quality}set quality(P){this._quality=P,this.passes=P}}class J extends d.wn{constructor(P=8,z=4,j=d.wn.defaultResolution,tt=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new H(!0,P,z,j,tt),this.blurYFilter=new H(!1,P,z,j,tt),this.resolution=j,this.quality=z,this.blur=P,this.repeatEdgePixels=!1}apply(P,z,j,tt){const k=Math.abs(this.blurXFilter.strength),mt=Math.abs(this.blurYFilter.strength);if(k&&mt){const ht=P.getFilterTexture();this.blurXFilter.apply(P,z,ht,d.yl.CLEAR),this.blurYFilter.apply(P,ht,j,tt),P.returnFilterTexture(ht)}else mt?this.blurYFilter.apply(P,z,j,tt):this.blurXFilter.apply(P,z,j,tt)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(P){this.blurXFilter.blur=this.blurYFilter.blur=P,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(P){this.blurXFilter.quality=this.blurYFilter.quality=P}get blurX(){return this.blurXFilter.blur}set blurX(P){this.blurXFilter.blur=P,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(P){this.blurYFilter.blur=P,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(P){this.blurYFilter.blendMode=P}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(P){this._repeatEdgePixels=P,this.updatePadding()}}},7465:function(It,Ot,st){"use strict";st.d(Ot,{MxU:function(){return Pe},Graphics:function(){return ds}});var d=st(9774);class yt{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?d.Ae.EMPTY:(t=t||new d.Ae(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,r){const{a:n,b:a,c:l,d:c,tx:p,ty:g}=t,y=n*r.x+l*r.y+p,x=a*r.x+c*r.y+g;this.minX=Math.min(this.minX,y),this.maxX=Math.max(this.maxX,y),this.minY=Math.min(this.minY,x),this.maxY=Math.max(this.maxY,x)}addQuad(t){let r=this.minX,n=this.minY,a=this.maxX,l=this.maxY,c=t[0],p=t[1];r=c<r?c:r,n=p<n?p:n,a=c>a?c:a,l=p>l?p:l,c=t[2],p=t[3],r=c<r?c:r,n=p<n?p:n,a=c>a?c:a,l=p>l?p:l,c=t[4],p=t[5],r=c<r?c:r,n=p<n?p:n,a=c>a?c:a,l=p>l?p:l,c=t[6],p=t[7],r=c<r?c:r,n=p<n?p:n,a=c>a?c:a,l=p>l?p:l,this.minX=r,this.minY=n,this.maxX=a,this.maxY=l}addFrame(t,r,n,a,l){this.addFrameMatrix(t.worldTransform,r,n,a,l)}addFrameMatrix(t,r,n,a,l){const c=t.a,p=t.b,g=t.c,y=t.d,x=t.tx,b=t.ty;let A=this.minX,T=this.minY,M=this.maxX,O=this.maxY,K=c*r+g*n+x,$=p*r+y*n+b;A=K<A?K:A,T=$<T?$:T,M=K>M?K:M,O=$>O?$:O,K=c*a+g*n+x,$=p*a+y*n+b,A=K<A?K:A,T=$<T?$:T,M=K>M?K:M,O=$>O?$:O,K=c*r+g*l+x,$=p*r+y*l+b,A=K<A?K:A,T=$<T?$:T,M=K>M?K:M,O=$>O?$:O,K=c*a+g*l+x,$=p*a+y*l+b,A=K<A?K:A,T=$<T?$:T,M=K>M?K:M,O=$>O?$:O,this.minX=A,this.minY=T,this.maxX=M,this.maxY=O}addVertexData(t,r,n){let a=this.minX,l=this.minY,c=this.maxX,p=this.maxY;for(let g=r;g<n;g+=2){const y=t[g],x=t[g+1];a=y<a?y:a,l=x<l?x:l,c=y>c?y:c,p=x>p?x:p}this.minX=a,this.minY=l,this.maxX=c,this.maxY=p}addVertices(t,r,n,a){this.addVerticesMatrix(t.worldTransform,r,n,a)}addVerticesMatrix(t,r,n,a,l=0,c=l){const p=t.a,g=t.b,y=t.c,x=t.d,b=t.tx,A=t.ty;let T=this.minX,M=this.minY,O=this.maxX,K=this.maxY;for(let $=n;$<a;$+=2){const vt=r[$],et=r[$+1],ut=p*vt+y*et+b,Mt=x*et+g*vt+A;T=Math.min(T,ut-l),O=Math.max(O,ut+l),M=Math.min(M,Mt-c),K=Math.max(K,Mt+c)}this.minX=T,this.minY=M,this.maxX=O,this.maxY=K}addBounds(t){const r=this.minX,n=this.minY,a=this.maxX,l=this.maxY;this.minX=t.minX<r?t.minX:r,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>a?t.maxX:a,this.maxY=t.maxY>l?t.maxY:l}addBoundsMask(t,r){const n=t.minX>r.minX?t.minX:r.minX,a=t.minY>r.minY?t.minY:r.minY,l=t.maxX<r.maxX?t.maxX:r.maxX,c=t.maxY<r.maxY?t.maxY:r.maxY;if(n<=l&&a<=c){const p=this.minX,g=this.minY,y=this.maxX,x=this.maxY;this.minX=n<p?n:p,this.minY=a<g?a:g,this.maxX=l>y?l:y,this.maxY=c>x?c:x}}addBoundsMatrix(t,r){this.addFrameMatrix(r,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,r){const n=t.minX>r.x?t.minX:r.x,a=t.minY>r.y?t.minY:r.y,l=t.maxX<r.x+r.width?t.maxX:r.x+r.width,c=t.maxY<r.y+r.height?t.maxY:r.y+r.height;if(n<=l&&a<=c){const p=this.minX,g=this.minY,y=this.maxX,x=this.maxY;this.minX=n<p?n:p,this.minY=a<g?a:g,this.maxX=l>y?l:y,this.maxY=c>x?c:x}}pad(t=0,r=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=r,this.maxY+=r)}addFramePad(t,r,n,a,l,c){t-=l,r-=c,n+=l,a+=c,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>a?this.maxY:a}}class nt extends d.P6.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new d.wx,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new yt,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const r=Object.keys(t);for(let n=0;n<r.length;++n){const a=r[n];Object.defineProperty(nt.prototype,a,Object.getOwnPropertyDescriptor(t,a))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,r){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new d.Ae),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(t){var p;t||(this._localBoundsRect||(this._localBoundsRect=new d.Ae),t=this._localBoundsRect),this._localBounds||(this._localBounds=new yt);const r=this.transform,n=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(p=n==null?void 0:n.worldAlpha)!=null?p:1,this.transform=this._tempDisplayObjectParent.transform;const a=this._bounds,l=this._boundsID;this._bounds=this._localBounds;const c=this.getBounds(!1,t);return this.parent=n,this.transform=r,this._bounds=a,this._bounds.updateID+=this._boundsID-l,c}toGlobal(t,r,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,r)}toLocal(t,r,n,a){return r&&(t=r.toGlobal(t,n,a)),a||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,r=0,n=1,a=1,l=0,c=0,p=0,g=0,y=0){return this.position.x=t,this.position.y=r,this.scale.x=n||1,this.scale.y=a||1,this.rotation=l,this.skew.x=c,this.skew.y=p,this.pivot.x=g,this.pivot.y=y,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Ct),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*d.jl}set angle(t){this.transform.rotation=t*d.ZX}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=t,this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}}class Ct extends nt{constructor(){super(...arguments),this.sortDirty=null}}nt.prototype.displayObjectUpdateTransform=nt.prototype.updateTransform;const it=new d.y3;function _t(f,t){return f.zIndex===t.zIndex?f._lastSortedIndex-t._lastSortedIndex:f.zIndex-t.zIndex}const H=class so extends nt{constructor(){super(),this.children=[],this.sortableChildren=so.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let r=0;r<t.length;r++)this.addChild(t[r]);else{const r=t[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return t[0]}addChildAt(t,r){if(r<0||r>this.children.length)throw new Error(`${t}addChildAt: The index ${r} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(r,0,t),this._boundsID++,this.onChildrenChange(r),t.emit("added",this),this.emit("childAdded",t,this,r),t}swapChildren(t,r){if(t===r)return;const n=this.getChildIndex(t),a=this.getChildIndex(r);this.children[n]=r,this.children[a]=t,this.onChildrenChange(n<a?n:a)}getChildIndex(t){const r=this.children.indexOf(t);if(r===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return r}setChildIndex(t,r){if(r<0||r>=this.children.length)throw new Error(`The index ${r} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(t);d.P6.removeItems(this.children,n,1),this.children.splice(r,0,t),this.onChildrenChange(r)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let r=0;r<t.length;r++)this.removeChild(t[r]);else{const r=t[0],n=this.children.indexOf(r);if(n===-1)return null;r.parent=null,r.transform._parentID=-1,d.P6.removeItems(this.children,n,1),this._boundsID++,this.onChildrenChange(n),r.emit("removed",this),this.emit("childRemoved",r,this,n)}return t[0]}removeChildAt(t){const r=this.getChildAt(t);return r.parent=null,r.transform._parentID=-1,d.P6.removeItems(this.children,t,1),this._boundsID++,this.onChildrenChange(t),r.emit("removed",this),this.emit("childRemoved",r,this,t),r}removeChildren(t=0,r=this.children.length){const n=t,a=r,l=a-n;let c;if(l>0&&l<=a){c=this.children.splice(n,l);for(let p=0;p<c.length;++p)c[p].parent=null,c[p].transform&&(c[p].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let p=0;p<c.length;++p)c[p].emit("removed",this),this.emit("childRemoved",c[p],this,p);return c}else if(l===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let r=0,n=this.children.length;r<n;++r){const a=this.children[r];a._lastSortedIndex=r,!t&&a.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(_t),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,r=this.children.length;t<r;++t){const n=this.children[t];n.visible&&n.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const r=this.children[t];if(!(!r.visible||!r.renderable))if(r.calculateBounds(),r._mask){const n=r._mask.isMaskData?r._mask.maskObject:r._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(r._bounds,n._bounds)):this._bounds.addBounds(r._bounds)}else r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,r=!1){const n=super.getLocalBounds(t);if(!r)for(let a=0,l=this.children.length;a<l;++a){const c=this.children[a];c.visible&&c.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(t){const r=t.renderTexture.sourceFrame;if(!(r.width>0&&r.height>0))return;let n,a;this.cullArea?(n=this.cullArea,a=this.worldTransform):this._render!==so.prototype._render&&(n=this.getBounds(!0));const l=t.projection.transform;if(l&&(a?(a=it.copyFrom(a),a.prepend(l)):a=l),n&&r.intersects(n,a))this._render(t);else if(this.cullArea)return;for(let c=0,p=this.children.length;c<p;++c){const g=this.children[c],y=g.cullable;g.cullable=y||!this.cullArea,g.render(t),g.cullable=y}}render(t){var r;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(r=this.filters)!=null&&r.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let n=0,a=this.children.length;n<a;++n)this.children[n].render(t)}}renderAdvanced(t){var l,c,p;const r=this.filters,n=this._mask;if(r){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let g=0;g<r.length;g++)r[g].enabled&&this._enabledFilters.push(r[g])}const a=r&&((l=this._enabledFilters)==null?void 0:l.length)||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==d.A7.NONE));if(a&&t.batch.flush(),r&&((c=this._enabledFilters)!=null&&c.length)&&t.filter.push(this,this._enabledFilters),n&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let g=0,y=this.children.length;g<y;++g)this.children[g].render(t)}a&&t.batch.flush(),n&&t.mask.pop(this),r&&((p=this._enabledFilters)!=null&&p.length)&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const r=typeof t=="boolean"?t:t==null?void 0:t.children,n=this.removeChildren(0,this.children.length);if(r)for(let a=0;a<n.length;++a)n[a].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const r=this.getLocalBounds().width;r!==0?this.scale.x=t/r:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const r=this.getLocalBounds().height;r!==0?this.scale.y=t/r:this.scale.y=1,this._height=t}};H.defaultSortableChildren=!1;let J=H;J.prototype.containerUpdateTransform=J.prototype.updateTransform,Object.defineProperties(d.Xd,{SORTABLE_CHILDREN:{get(){return J.defaultSortableChildren},set(f){d.P6.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),J.defaultSortableChildren=f}}});const L=new d.E9,P=new Uint16Array([0,1,2,0,2,3]);class z extends J{constructor(t){super(),this._anchor=new d.AB(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new d.Il(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=d.T$.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||d.xE.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=P,this.pluginName="batch",this.isSprite=!0,this._roundPixels=d.Xd.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=d.P6.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=d.P6.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const r=this.transform.worldTransform,n=r.a,a=r.b,l=r.c,c=r.d,p=r.tx,g=r.ty,y=this.vertexData,x=t.trim,b=t.orig,A=this._anchor;let T=0,M=0,O=0,K=0;if(x?(M=x.x-A._x*b.width,T=M+x.width,K=x.y-A._y*b.height,O=K+x.height):(M=-A._x*b.width,T=M+b.width,K=-A._y*b.height,O=K+b.height),y[0]=n*M+l*K+p,y[1]=c*K+a*M+g,y[2]=n*T+l*K+p,y[3]=c*K+a*T+g,y[4]=n*T+l*O+p,y[5]=c*O+a*T+g,y[6]=n*M+l*O+p,y[7]=c*O+a*M+g,this._roundPixels){const $=d.Xd.RESOLUTION;for(let vt=0;vt<y.length;++vt)y[vt]=Math.round(y[vt]*$)/$}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,r=this.vertexTrimmedData,n=t.orig,a=this._anchor,l=this.transform.worldTransform,c=l.a,p=l.b,g=l.c,y=l.d,x=l.tx,b=l.ty,A=-a._x*n.width,T=A+n.width,M=-a._y*n.height,O=M+n.height;if(r[0]=c*A+g*M+x,r[1]=y*M+p*A+b,r[2]=c*T+g*M+x,r[3]=y*M+p*T+b,r[4]=c*T+g*O+x,r[5]=y*O+p*T+b,r[6]=c*A+g*O+x,r[7]=y*O+p*A+b,this._roundPixels){const K=d.Xd.RESOLUTION;for(let $=0;$<r.length;++$)r[$]=Math.round(r[$]*K)/K}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,r=this._texture.orig;!t||t.width===r.width&&t.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new yt),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new d.Ae),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,L);const r=this._texture.orig.width,n=this._texture.orig.height,a=-r*this.anchor.x;let l=0;return L.x>=a&&L.x<a+r&&(l=-n*this.anchor.y,L.y>=l&&L.y<l+n)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const r=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!r)}this._texture=null}static from(t,r){const n=t instanceof d.xE?t:d.xE.from(t,r);return new z(n)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const r=d.P6.sign(this.scale.x)||1;this.scale.x=r*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const r=d.P6.sign(this.scale.y)||1;this.scale.y=r*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||d.xE.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const j=new d.y3;nt.prototype._cacheAsBitmap=!1,nt.prototype._cacheData=null,nt.prototype._cacheAsBitmapResolution=null,nt.prototype._cacheAsBitmapMultisample=null;class tt{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(nt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(f){f!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=f,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(f){f!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=f,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(f){if(this._cacheAsBitmap===f)return;this._cacheAsBitmap=f;let t;f?(this._cacheData||(this._cacheData=new tt),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}}),nt.prototype._renderCached=function(f){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(f),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(f))},nt.prototype._initCachedDisplayObject=function(f){var A,T,M;if((A=this._cacheData)!=null&&A.sprite)return;const t=this.alpha;this.alpha=1,f.batch.flush();const r=this.getLocalBounds(new d.Ae,!0);if((T=this.filters)!=null&&T.length){const O=this.filters[0].padding;r.pad(O)}const n=this.cacheAsBitmapResolution||f.resolution;r.ceil(n),r.width=Math.max(r.width,1/n),r.height=Math.max(r.height,1/n);const a=f.renderTexture.current,l=f.renderTexture.sourceFrame.clone(),c=f.renderTexture.destinationFrame.clone(),p=f.projection.transform,g=d.TI.create({width:r.width,height:r.height,resolution:n,multisample:(M=this.cacheAsBitmapMultisample)!=null?M:f.multisample}),y=`cacheAsBitmap_${d.P6.uid()}`;this._cacheData.textureCacheId=y,d.VL.addToCache(g.baseTexture,y),d.xE.addToCache(g,y);const x=this.transform.localTransform.copyTo(j).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,f.render(this,{renderTexture:g,clear:!0,transform:x,skipUpdateTransform:!1}),f.framebuffer.blit(),f.projection.transform=p,f.renderTexture.bind(a,l,c),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const b=new z(g);b.transform.worldTransform=this.transform.worldTransform,b.anchor.x=-(r.x/r.width),b.anchor.y=-(r.y/r.height),b.alpha=t,b._bounds=this._bounds,this._cacheData.sprite=b,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=b.containsPoint.bind(b)},nt.prototype._renderCachedCanvas=function(f){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(f),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(f))},nt.prototype._initCachedDisplayObjectCanvas=function(f){var x;if((x=this._cacheData)!=null&&x.sprite)return;const t=this.getLocalBounds(new d.Ae,!0),r=this.alpha;this.alpha=1;const n=f.canvasContext.activeContext,a=f._projTransform,l=this.cacheAsBitmapResolution||f.resolution;t.ceil(l),t.width=Math.max(t.width,1/l),t.height=Math.max(t.height,1/l);const c=d.TI.create({width:t.width,height:t.height,resolution:l}),p=`cacheAsBitmap_${d.P6.uid()}`;this._cacheData.textureCacheId=p,d.VL.addToCache(c.baseTexture,p),d.xE.addToCache(c,p);const g=j;this.transform.localTransform.copyTo(g),g.invert(),g.tx-=t.x,g.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,f.render(this,{renderTexture:c,clear:!0,transform:g,skipUpdateTransform:!1}),f.canvasContext.activeContext=n,f._projTransform=a,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const y=new z(c);y.transform.worldTransform=this.transform.worldTransform,y.anchor.x=-(t.x/t.width),y.anchor.y=-(t.y/t.height),y.alpha=r,y._bounds=this._bounds,this._cacheData.sprite=y,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=f._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=y.containsPoint.bind(y)},nt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},nt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},nt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,d.VL.removeFromCache(this._cacheData.textureCacheId),d.xE.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},nt.prototype._cacheAsBitmapDestroy=function(f){this.cacheAsBitmap=!1,this.destroy(f)},nt.prototype.name=null,J.prototype.getChildByName=function(f,t){for(let r=0,n=this.children.length;r<n;r++)if(this.children[r].name===f)return this.children[r];if(t)for(let r=0,n=this.children.length;r<n;r++){const a=this.children[r];if(!a.getChildByName)continue;const l=a.getChildByName(f,!0);if(l)return l}return null},nt.prototype.getGlobalPosition=function(f=new d.E9,t=!1){return this.parent?this.parent.toGlobal(this.position,f,t):(f.x=this.position.x,f.y=this.position.y),f};var k=st(8121),mt=st(6844),ht=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class B extends d.wn{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(d.Y9,ht,t),this.alpha=1}_loadMatrix(t,r=!1){let n=t;r&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(t,r,n){return t[0]=r[0]*n[0]+r[1]*n[5]+r[2]*n[10]+r[3]*n[15],t[1]=r[0]*n[1]+r[1]*n[6]+r[2]*n[11]+r[3]*n[16],t[2]=r[0]*n[2]+r[1]*n[7]+r[2]*n[12]+r[3]*n[17],t[3]=r[0]*n[3]+r[1]*n[8]+r[2]*n[13]+r[3]*n[18],t[4]=r[0]*n[4]+r[1]*n[9]+r[2]*n[14]+r[3]*n[19]+r[4],t[5]=r[5]*n[0]+r[6]*n[5]+r[7]*n[10]+r[8]*n[15],t[6]=r[5]*n[1]+r[6]*n[6]+r[7]*n[11]+r[8]*n[16],t[7]=r[5]*n[2]+r[6]*n[7]+r[7]*n[12]+r[8]*n[17],t[8]=r[5]*n[3]+r[6]*n[8]+r[7]*n[13]+r[8]*n[18],t[9]=r[5]*n[4]+r[6]*n[9]+r[7]*n[14]+r[8]*n[19]+r[9],t[10]=r[10]*n[0]+r[11]*n[5]+r[12]*n[10]+r[13]*n[15],t[11]=r[10]*n[1]+r[11]*n[6]+r[12]*n[11]+r[13]*n[16],t[12]=r[10]*n[2]+r[11]*n[7]+r[12]*n[12]+r[13]*n[17],t[13]=r[10]*n[3]+r[11]*n[8]+r[12]*n[13]+r[13]*n[18],t[14]=r[10]*n[4]+r[11]*n[9]+r[12]*n[14]+r[13]*n[19]+r[14],t[15]=r[15]*n[0]+r[16]*n[5]+r[17]*n[10]+r[18]*n[15],t[16]=r[15]*n[1]+r[16]*n[6]+r[17]*n[11]+r[18]*n[16],t[17]=r[15]*n[2]+r[16]*n[7]+r[17]*n[12]+r[18]*n[17],t[18]=r[15]*n[3]+r[16]*n[8]+r[17]*n[13]+r[18]*n[18],t[19]=r[15]*n[4]+r[16]*n[9]+r[17]*n[14]+r[18]*n[19]+r[19],t}_colorMatrix(t){const r=new Float32Array(t);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(t,r){const n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,r)}tint(t,r){const[n,a,l]=d.Il.shared.setValue(t).toArray(),c=[n,0,0,0,0,0,a,0,0,0,0,0,l,0,0,0,0,0,1,0];this._loadMatrix(c,r)}greyscale(t,r){const n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,r)}blackAndWhite(t){const r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,t)}hue(t,r){t=(t||0)/180*Math.PI;const n=Math.cos(t),a=Math.sin(t),l=Math.sqrt,c=1/3,p=l(c),g=n+(1-n)*c,y=c*(1-n)-p*a,x=c*(1-n)+p*a,b=c*(1-n)+p*a,A=n+c*(1-n),T=c*(1-n)-p*a,M=c*(1-n)-p*a,O=c*(1-n)+p*a,K=n+c*(1-n),$=[g,y,x,0,0,b,A,T,0,0,M,O,K,0,0,0,0,0,1,0];this._loadMatrix($,r)}contrast(t,r){const n=(t||0)+1,a=-.5*(n-1),l=[n,0,0,0,a,0,n,0,0,a,0,0,n,0,a,0,0,0,1,0];this._loadMatrix(l,r)}saturate(t=0,r){const n=t*2/3+1,a=(n-1)*-.5,l=[n,a,a,0,0,a,n,a,0,0,a,a,n,0,0,0,0,0,1,0];this._loadMatrix(l,r)}desaturate(){this.saturate(-1)}negative(t){const r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,t)}sepia(t){const r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,t)}technicolor(t){const r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,t)}polaroid(t){const r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,t)}toBGR(t){const r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,t)}kodachrome(t){const r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,t)}browni(t){const r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,t)}vintage(t){const r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,t)}colorTone(t,r,n,a,l){t=t||.2,r=r||.15,n=n||16770432,a=a||3375104;const c=d.Il.shared,[p,g,y]=c.setValue(n).toArray(),[x,b,A]=c.setValue(a).toArray(),T=[.3,.59,.11,0,0,p,g,y,t,0,x,b,A,r,0,p-x,g-b,y-A,0,0];this._loadMatrix(T,l)}night(t,r){t=t||.1;const n=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(n,r)}predator(t,r){const n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,r)}lsd(t){const r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}B.prototype.grayscale=B.prototype.greyscale;var U=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,q=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class at extends d.wn{constructor(t,r){const n=new d.y3;t.renderable=!1,super(q,U,{mapSampler:t._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=n,r==null&&(r=20),this.scale=new d.E9(r,r)}apply(t,r,n,a){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const l=this.maskSprite.worldTransform,c=Math.sqrt(l.a*l.a+l.b*l.b),p=Math.sqrt(l.c*l.c+l.d*l.d);c!==0&&p!==0&&(this.uniforms.rotation[0]=l.a/c,this.uniforms.rotation[1]=l.b/c,this.uniforms.rotation[2]=l.c/p,this.uniforms.rotation[3]=l.d/p),t.applyFilter(this,r,n,a)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var rt=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,dt=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class S extends d.wn{constructor(){super(dt,rt)}}var F=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class _ extends d.wn{constructor(t=.5,r=Math.random()){super(d.Y9,F,{uNoise:0,uSeed:0}),this.noise=t,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const D={AlphaFilter:k.U,BlurFilter:mt.T,BlurFilterPass:mt.Y,ColorMatrixFilter:B,DisplacementFilter:at,FXAAFilter:S,NoiseFilter:_};Object.entries(D).forEach(([f,t])=>{Object.defineProperty(D,f,{get(){return d.P6.deprecation("7.1.0",`filters.${f} has moved to ${f}`),t}})});class G{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(d.vB.system.add(this.tickerUpdate,this,d.uF.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(d.vB.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const Tt=new G;class wt{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=wt.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new d.E9,this.page=new d.E9,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,r,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,r,n,a,l){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Z extends wt{constructor(){super(...arguments),this.client=new d.E9,this.movement=new d.E9,this.offset=new d.E9,this.global=new d.E9,this.screen=new d.E9}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,r,n){return t.worldTransform.applyInverse(n||this.global,r)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,r,n,a,l,c,p,g,y,x,b,A,T,M,O){throw new Error("Method not implemented.")}}class E extends Z{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class C extends Z{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}C.DOM_DELTA_PIXEL=0,C.DOM_DELTA_LINE=1,C.DOM_DELTA_PAGE=2;const I=2048,X=new d.E9,W=new d.E9;class R{constructor(t){this.dispatch=new d.P6.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,r){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:r,priority:0}),this.mappingTable[t].sort((n,a)=>n.priority-a.priority)}dispatchEvent(t,r){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,r),this.dispatch.emit(r||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const r=this.mappingTable[t.type];if(r)for(let n=0,a=r.length;n<a;n++)r[n].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,r){Tt.pauseUpdate=!0;const n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",a=this[n](this.rootTarget,this.rootTarget.eventMode,X.set(t,r),this.hitTestFn,this.hitPruneFn);return a&&a[0]}propagate(t,r){if(!t.target)return;const n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let a=0,l=n.length-1;a<l;a++)if(t.currentTarget=n[a],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,r),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let a=n.length-2;a>=0;a--)if(t.currentTarget=n[a],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,r,n=this._allInteractiveElements){if(n.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const a=Array.isArray(r)?r:[r];for(let l=n.length-1;l>=0;l--)a.forEach(c=>{t.currentTarget=n[l],this.notifyTarget(t,c)})}propagationPath(t){const r=[t];for(let n=0;n<I&&t!==this.rootTarget;n++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(t.parent),t=t.parent}return r.reverse(),r}hitTestMoveRecursive(t,r,n,a,l,c=!1){let p=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||r==="dynamic")&&(Tt.pauseUpdate=!1),t.interactiveChildren&&t.children){const x=t.children;for(let b=x.length-1;b>=0;b--){const A=x[b],T=this.hitTestMoveRecursive(A,this._isInteractive(r)?r:A.eventMode,n,a,l,c||l(t,n));if(T){if(T.length>0&&!T[T.length-1].parent)continue;const M=t.isInteractive();(T.length>0||M)&&(M&&this._allInteractiveElements.push(t),T.push(t)),this._hitElements.length===0&&(this._hitElements=T),p=!0}}}const g=this._isInteractive(r),y=t.isInteractive();return g&&y&&this._allInteractiveElements.push(t),c||this._hitElements.length>0?null:p?this._hitElements:g&&!l(t,n)&&a(t,n)?y?[t]:[]:null}hitTestRecursive(t,r,n,a,l){if(this._interactivePrune(t)||l(t,n))return null;if((t.eventMode==="dynamic"||r==="dynamic")&&(Tt.pauseUpdate=!1),t.interactiveChildren&&t.children){const g=t.children;for(let y=g.length-1;y>=0;y--){const x=g[y],b=this.hitTestRecursive(x,this._isInteractive(r)?r:x.eventMode,n,a,l);if(b){if(b.length>0&&!b[b.length-1].parent)continue;const A=t.isInteractive();return(b.length>0||A)&&b.push(t),b}}}const c=this._isInteractive(r),p=t.isInteractive();return c&&a(t,n)?p?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,r){var n;if(t.hitArea&&(t.worldTransform.applyInverse(r,W),!t.hitArea.contains(W.x,W.y)))return!0;if(t._mask){const a=t._mask.isMaskData?t._mask.maskObject:t._mask;if(a&&!((n=a.containsPoint)!=null&&n.call(a,r)))return!0}return!1}hitTestFn(t,r){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(r):!1}notifyTarget(t,r){var l,c;r=r!=null?r:t.type;const n=`on${r}`;(c=(l=t.currentTarget)[n])==null||c.call(l,t);const a=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${r}capture`:r;this.notifyListeners(t,a),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,r)}mapPointerDown(t){if(!(t instanceof E)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(t);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const a=r.button===2;this.dispatchEvent(r,a?"rightdown":"mousedown")}const n=this.trackingData(t.pointerId);n.pressTargetsByButton[t.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(t){var g,y,x;if(!(t instanceof E)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const r=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const n=r.pointerType==="mouse"||r.pointerType==="pen",a=this.trackingData(t.pointerId),l=this.findMountedTarget(a.overTargets);if(((g=a.overTargets)==null?void 0:g.length)>0&&l!==r.target){const b=t.type==="mousemove"?"mouseout":"pointerout",A=this.createPointerEvent(t,b,l);if(this.dispatchEvent(A,"pointerout"),n&&this.dispatchEvent(A,"mouseout"),!r.composedPath().includes(l)){const T=this.createPointerEvent(t,"pointerleave",l);for(T.eventPhase=T.AT_TARGET;T.target&&!r.composedPath().includes(T.target);)T.currentTarget=T.target,this.notifyTarget(T),n&&this.notifyTarget(T,"mouseleave"),T.target=T.target.parent;this.freeEvent(T)}this.freeEvent(A)}if(l!==r.target){const b=t.type==="mousemove"?"mouseover":"pointerover",A=this.clonePointerEvent(r,b);this.dispatchEvent(A,"pointerover"),n&&this.dispatchEvent(A,"mouseover");let T=l==null?void 0:l.parent;for(;T&&T!==this.rootTarget.parent&&T!==r.target;)T=T.parent;if(!T||T===this.rootTarget.parent){const M=this.clonePointerEvent(r,"pointerenter");for(M.eventPhase=M.AT_TARGET;M.target&&M.target!==l&&M.target!==this.rootTarget.parent;)M.currentTarget=M.target,this.notifyTarget(M),n&&this.notifyTarget(M,"mouseenter"),M.target=M.target.parent;this.freeEvent(M)}this.freeEvent(A)}const c=[],p=(y=this.enableGlobalMoveEvents)!=null?y:!0;this.moveOnAll?c.push("pointermove"):this.dispatchEvent(r,"pointermove"),p&&c.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?c.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),p&&c.push("globaltouchmove")),n&&(this.moveOnAll?c.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),p&&c.push("globalmousemove"),this.cursor=(x=r.target)==null?void 0:x.cursor),c.length>0&&this.all(r,c),this._allInteractiveElements.length=0,this._hitElements.length=0,a.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(t){var c;if(!(t instanceof E)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(t.pointerId),n=this.createPointerEvent(t),a=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),a&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(c=n.target)==null?void 0:c.cursor);const l=this.clonePointerEvent(n,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==this.rootTarget.parent;)l.currentTarget=l.target,this.notifyTarget(l),a&&this.notifyTarget(l,"mouseenter"),l.target=l.target.parent;r.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(l)}mapPointerOut(t){if(!(t instanceof E)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(t.pointerId);if(r.overTargets){const n=t.pointerType==="mouse"||t.pointerType==="pen",a=this.findMountedTarget(r.overTargets),l=this.createPointerEvent(t,"pointerout",a);this.dispatchEvent(l),n&&this.dispatchEvent(l,"mouseout");const c=this.createPointerEvent(t,"pointerleave",a);for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==this.rootTarget.parent;)c.currentTarget=c.target,this.notifyTarget(c),n&&this.notifyTarget(c,"mouseleave"),c.target=c.target.parent;r.overTargets=null,this.freeEvent(l),this.freeEvent(c)}this.cursor=null}mapPointerUp(t){if(!(t instanceof E)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=performance.now(),n=this.createPointerEvent(t);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const p=n.button===2;this.dispatchEvent(n,p?"rightup":"mouseup")}const a=this.trackingData(t.pointerId),l=this.findMountedTarget(a.pressTargetsByButton[t.button]);let c=l;if(l&&!n.composedPath().includes(l)){let p=l;for(;p&&!n.composedPath().includes(p);){if(n.currentTarget=p,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const g=n.button===2;this.notifyTarget(n,g?"rightupoutside":"mouseupoutside")}p=p.parent}delete a.pressTargetsByButton[t.button],c=p}if(c){const p=this.clonePointerEvent(n,"click");p.target=c,p.path=null,a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:p.target,timeStamp:r});const g=a.clicksByButton[t.button];if(g.target===p.target&&r-g.timeStamp<200?++g.clickCount:g.clickCount=1,g.target=p.target,g.timeStamp=r,p.detail=g.clickCount,p.pointerType==="mouse"){const y=p.button===2;this.dispatchEvent(p,y?"rightclick":"click")}else p.pointerType==="touch"&&this.dispatchEvent(p,"tap");this.dispatchEvent(p,"pointertap"),this.freeEvent(p)}this.freeEvent(n)}mapPointerUpOutside(t){if(!(t instanceof E)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(t.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[t.button]),a=this.createPointerEvent(t);if(n){let l=n;for(;l;)a.currentTarget=l,this.notifyTarget(a,"pointerupoutside"),a.pointerType==="touch"?this.notifyTarget(a,"touchendoutside"):(a.pointerType==="mouse"||a.pointerType==="pen")&&this.notifyTarget(a,a.button===2?"rightupoutside":"mouseupoutside"),l=l.parent;delete r.pressTargetsByButton[t.button]}this.freeEvent(a)}mapWheel(t){if(!(t instanceof C)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const r=this.createWheelEvent(t);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(t){if(!t)return null;let r=t[0];for(let n=1;n<t.length&&t[n].parent===r;n++)r=t[n];return r}createPointerEvent(t,r,n){var l;const a=this.allocateEvent(E);return this.copyPointerData(t,a),this.copyMouseData(t,a),this.copyData(t,a),a.nativeEvent=t.nativeEvent,a.originalEvent=t,a.target=(l=n!=null?n:this.hitTest(a.global.x,a.global.y))!=null?l:this._hitElements[0],typeof r=="string"&&(a.type=r),a}createWheelEvent(t){const r=this.allocateEvent(C);return this.copyWheelData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(t,r){const n=this.allocateEvent(E);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=r!=null?r:n.type,n}copyWheelData(t,r){r.deltaMode=t.deltaMode,r.deltaX=t.deltaX,r.deltaY=t.deltaY,r.deltaZ=t.deltaZ}copyPointerData(t,r){t instanceof E&&r instanceof E&&(r.pointerId=t.pointerId,r.width=t.width,r.height=t.height,r.isPrimary=t.isPrimary,r.pointerType=t.pointerType,r.pressure=t.pressure,r.tangentialPressure=t.tangentialPressure,r.tiltX=t.tiltX,r.tiltY=t.tiltY,r.twist=t.twist)}copyMouseData(t,r){t instanceof Z&&r instanceof Z&&(r.altKey=t.altKey,r.button=t.button,r.buttons=t.buttons,r.client.copyFrom(t.client),r.ctrlKey=t.ctrlKey,r.metaKey=t.metaKey,r.movement.copyFrom(t.movement),r.screen.copyFrom(t.screen),r.shiftKey=t.shiftKey,r.global.copyFrom(t.global))}copyData(t,r){r.isTrusted=t.isTrusted,r.srcElement=t.srcElement,r.timeStamp=performance.now(),r.type=t.type,r.detail=t.detail,r.view=t.view,r.which=t.which,r.layer.copyFrom(t.layer),r.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const r=this.eventPool.get(t).pop()||new t(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const r=t.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(t)}notifyListeners(t,r){const n=t.currentTarget._events[r];if(n&&t.currentTarget.isInteractive())if("fn"in n)n.once&&t.currentTarget.removeListener(r,n.fn,void 0,!0),n.fn.call(n.context,t);else for(let a=0,l=n.length;a<l&&!t.propagationImmediatelyStopped;a++)n[a].once&&t.currentTarget.removeListener(r,n[a].fn,void 0,!0),n[a].fn.call(n[a].context,t)}}const V=1,ot={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},xt=class no{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new R(null),Tt.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new E(null),this.rootWheelEvent=new C(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy(pe({},no.defaultEventFeatures),{set:(r,n,a)=>(n==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=a),r[n]=a,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){var a,l;const{view:r,resolution:n}=this.renderer;this.setTargetElement(r),this.resolution=n,no._defaultEventMode=(a=t.eventMode)!=null?a:"auto",Object.assign(this.features,(l=t.eventFeatures)!=null?l:{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let r=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(r=!1),this.currentCursor===t)return;this.currentCursor=t;const n=this.cursorStyles[t];if(n)switch(typeof n){case"string":r&&(this.domElement.style.cursor=n);break;case"function":n(t);break;case"object":r&&Object.assign(this.domElement.style,n);break}else r&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(t);this.autoPreventDefault&&r[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let n=0,a=r.length;n<a;n++){const l=r[n],c=this.bootstrapEvent(this.rootPointerEvent,l);this.rootBoundary.mapEvent(c)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Tt.pointerMoved();const r=this.normalizeToPointerData(t);for(let n=0,a=r.length;n<a;n++){const l=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(l)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let r=t.target;t.composedPath&&t.composedPath().length>0&&(r=t.composedPath()[0]);const n=r!==this.domElement?"outside":"",a=this.normalizeToPointerData(t);for(let l=0,c=a.length;l<c;l++){const p=this.bootstrapEvent(this.rootPointerEvent,a[l]);p.type+=n,this.rootBoundary.mapEvent(p)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const r=this.normalizeToPointerData(t);for(let n=0,a=r.length;n<a;n++){const l=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(l)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const r=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(r)}setTargetElement(t){this.removeEvents(),this.domElement=t,Tt.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Tt.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Tt.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,r,n){const a=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},l=1/this.resolution;t.x=(r-a.left)*(this.domElement.width/a.width)*l,t.y=(n-a.top)*(this.domElement.height/a.height)*l}normalizeToPointerData(t){const r=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let n=0,a=t.changedTouches.length;n<a;n++){const l=t.changedTouches[n];typeof l.button>"u"&&(l.button=0),typeof l.buttons>"u"&&(l.buttons=1),typeof l.isPrimary>"u"&&(l.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof l.width>"u"&&(l.width=l.radiusX||1),typeof l.height>"u"&&(l.height=l.radiusY||1),typeof l.tiltX>"u"&&(l.tiltX=0),typeof l.tiltY>"u"&&(l.tiltY=0),typeof l.pointerType>"u"&&(l.pointerType="touch"),typeof l.pointerId>"u"&&(l.pointerId=l.identifier||0),typeof l.pressure>"u"&&(l.pressure=l.force||.5),typeof l.twist>"u"&&(l.twist=0),typeof l.tangentialPressure>"u"&&(l.tangentialPressure=0),typeof l.layerX>"u"&&(l.layerX=l.offsetX=l.clientX),typeof l.layerY>"u"&&(l.layerY=l.offsetY=l.clientY),l.isNormalized=!0,l.type=t.type,r.push(l)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const n=t;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=V),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,r.push(n)}else r.push(t);return r}normalizeWheelEvent(t){const r=this.rootWheelEvent;return this.transferMouseData(r,t),r.deltaX=t.deltaX,r.deltaY=t.deltaY,r.deltaZ=t.deltaZ,r.deltaMode=t.deltaMode,this.mapPositionToPoint(r.screen,t.clientX,t.clientY),r.global.copyFrom(r.screen),r.offset.copyFrom(r.screen),r.nativeEvent=t,r.type=t.type,r}bootstrapEvent(t,r){return t.originalEvent=null,t.nativeEvent=r,t.pointerId=r.pointerId,t.width=r.width,t.height=r.height,t.isPrimary=r.isPrimary,t.pointerType=r.pointerType,t.pressure=r.pressure,t.tangentialPressure=r.tangentialPressure,t.tiltX=r.tiltX,t.tiltY=r.tiltY,t.twist=r.twist,this.transferMouseData(t,r),this.mapPositionToPoint(t.screen,r.clientX,r.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=r.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=ot[t.type]||t.type),t}transferMouseData(t,r){t.isTrusted=r.isTrusted,t.srcElement=r.srcElement,t.timeStamp=performance.now(),t.type=r.type,t.altKey=r.altKey,t.button=r.button,t.buttons=r.buttons,t.client.x=r.clientX,t.client.y=r.clientY,t.ctrlKey=r.ctrlKey,t.metaKey=r.metaKey,t.movement.x=r.movementX,t.movement.y=r.movementY,t.page.x=r.pageX,t.page.y=r.pageY,t.relatedTarget=null,t.shiftKey=r.shiftKey}};xt.extension={name:"events",type:[d.nw.RendererSystem,d.nw.CanvasRendererSystem]},xt.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let ct=xt;d.Rw.add(ct);function pt(f){return f==="dynamic"||f==="static"}const At={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){var f;return(f=this._internalInteractive)!=null?f:pt(ct.defaultEventMode)},set interactive(f){d.P6.deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=f,this.eventMode=f?"static":"auto"},_internalEventMode:void 0,get eventMode(){var f;return(f=this._internalEventMode)!=null?f:ct.defaultEventMode},set eventMode(f){this._internalInteractive=pt(f),this._internalEventMode=f},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(f,t,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,a=typeof t=="function"?void 0:t;f=n?`${f}capture`:f,t=typeof t=="function"?t:t.handleEvent,this.on(f,t,a)},removeEventListener(f,t,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,a=typeof t=="function"?void 0:t;f=n?`${f}capture`:f,t=typeof t=="function"?t:t.handleEvent,this.off(f,t,a)},dispatchEvent(f){if(!(f instanceof wt))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return f.defaultPrevented=!1,f.path=null,f.target=this,f.manager.dispatchEvent(f),!f.defaultPrevented}};nt.mixin(At);const Et={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};nt.mixin(Et);const Ft=9,St=100,zt=0,Xt=0,bt=2,he=1,Nt=-1e3,kt=-1e3,ye=2;class Ge{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(d.P6.isMobile.tablet||d.P6.isMobile.phone)&&this.createTouchHook();const r=document.createElement("div");r.style.width=`${St}px`,r.style.height=`${St}px`,r.style.position="absolute",r.style.top=`${zt}px`,r.style.left=`${Xt}px`,r.style.zIndex=bt.toString(),this.div=r,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${he}px`,t.style.height=`${he}px`,t.style.position="absolute",t.style.top=`${Nt}px`,t.style.left=`${kt}px`,t.style.zIndex=ye.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const r=t.children;if(r)for(let n=0;n<r.length;n++)this.updateAccessibleObjects(r[n])}update(){const t=performance.now();if(d.P6.isMobile.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:r,y:n,width:a,height:l}=this.renderer.view.getBoundingClientRect(),{width:c,height:p,resolution:g}=this.renderer,y=a/c*g,x=l/p*g;let b=this.div;b.style.left=`${r}px`,b.style.top=`${n}px`,b.style.width=`${c}px`,b.style.height=`${p}px`;for(let A=0;A<this.children.length;A++){const T=this.children[A];if(T.renderId!==this.renderId)T._accessibleActive=!1,d.P6.removeItems(this.children,A,1),this.div.removeChild(T._accessibleDiv),this.pool.push(T._accessibleDiv),T._accessibleDiv=null,A--;else{b=T._accessibleDiv;let M=T.hitArea;const O=T.worldTransform;T.hitArea?(b.style.left=`${(O.tx+M.x*O.a)*y}px`,b.style.top=`${(O.ty+M.y*O.d)*x}px`,b.style.width=`${M.width*O.a*y}px`,b.style.height=`${M.height*O.d*x}px`):(M=T.getBounds(),this.capHitArea(M),b.style.left=`${M.x*y}px`,b.style.top=`${M.y*x}px`,b.style.width=`${M.width*y}px`,b.style.height=`${M.height*x}px`,b.title!==T.accessibleTitle&&T.accessibleTitle!==null&&(b.title=T.accessibleTitle),b.getAttribute("aria-label")!==T.accessibleHint&&T.accessibleHint!==null&&b.setAttribute("aria-label",T.accessibleHint)),(T.accessibleTitle!==b.title||T.tabIndex!==b.tabIndex)&&(b.title=T.accessibleTitle,b.tabIndex=T.tabIndex,this.debug&&this.updateDebugHTML(b))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:r,height:n}=this.renderer;t.x+t.width>r&&(t.width=r-t.x),t.y+t.height>n&&(t.height=n-t.y)}addChild(t){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${St}px`,r.style.height=`${St}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=bt.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=t.accessiblePointerEvents,r.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?r.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(r.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&r.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(r),t._accessibleActive=!0,t._accessibleDiv=r,r.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,r){const{displayObject:n}=t.target,a=this.renderer.events.rootBoundary,l=Object.assign(new wt(a),{target:n});a.rootTarget=this.renderer.lastObjectRendered,r.forEach(c=>a.dispatchEvent(l,c))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===Ft&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Ge.extension={name:"accessibility",type:[d.nw.RendererPlugin,d.nw.CanvasRendererPlugin]},d.Rw.add(Ge);const Ue=class oo{constructor(t){this.stage=new J,t=Object.assign({forceCanvas:!1},t),this.renderer=(0,d.e6)(t),oo._plugins.forEach(r=>{r.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){var t;return(t=this.renderer)==null?void 0:t.view}get screen(){var t;return(t=this.renderer)==null?void 0:t.screen}destroy(t,r){const n=oo._plugins.slice(0);n.reverse(),n.forEach(a=>{a.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Ue._plugins=[];let Pe=Ue;d.Rw.handleByList(d.nw.Application,Pe._plugins);class ee{static init(t){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,n;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:a,clientHeight:l}=this._resizeTo;r=a,n=l}this.renderer.resize(r,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ee.extension=d.nw.Application,d.Rw.add(ee);const Le={loader:d.nw.LoadParser,resolver:d.nw.ResolveParser,cache:d.nw.CacheParser,detection:d.nw.DetectionParser};d.Rw.handle(d.nw.Asset,f=>{const t=f.ref;Object.entries(Le).filter(([r])=>!!t[r]).forEach(([r,n])=>{var a;return d.Rw.add(Object.assign(t[r],{extension:(a=t[r].extension)!=null?a:n}))})},f=>{const t=f.ref;Object.keys(Le).filter(r=>!!t[r]).forEach(r=>d.Rw.remove(t[r]))});class zi{constructor(t,r=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(t){t.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}_next(){return Lt(this,null,function*(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<r;n++)t.push(this._assetList.pop());yield this._loader.load(t),this._isLoading=!1,this._next()}})}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function $e(f,t){const r=f.split("?")[0],n=d.P6.path.extname(r).toLowerCase();return Array.isArray(t)?t.includes(n):n===t}const Re=(f,t,r=!1)=>(Array.isArray(f)||(f=[f]),t?f.map(n=>typeof n=="string"||r?t(n):n):f);class qr{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const r=this._cache.get(t);return r||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),r}set(t,r){const n=Re(t);let a;for(let p=0;p<this.parsers.length;p++){const g=this.parsers[p];if(g.test(r)){a=g.getCacheableAssets(n,r);break}}a||(a={},n.forEach(p=>{a[p]=r}));const l=Object.keys(a),c={cacheKeys:l,keys:n};if(n.forEach(p=>{this._cacheMap.set(p,c)}),l.forEach(p=>{this._cache.has(p)&&this._cache.get(p)!==r&&console.warn("[Cache] already has key:",p),this._cache.set(p,a[p])}),r instanceof d.xE){const p=r;n.forEach(g=>{p.baseTexture!==d.xE.EMPTY.baseTexture&&d.VL.addToCache(p.baseTexture,g),d.xE.addToCache(p,g)})}}remove(t){if(!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const r=this._cacheMap.get(t);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const Je=new qr,Ee=f=>!Array.isArray(f);class _e{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,r,n)=>(this._parsersValidated=!1,t[r]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,r){const n={promise:null,parser:null};return n.promise=(()=>Lt(this,null,function*(){var c,p;let a=null,l=null;if(r.loadParser&&(l=this._parserHash[r.loadParser],l||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${t}`)),!l){for(let g=0;g<this.parsers.length;g++){const y=this.parsers[g];if(y.load&&((c=y.test)!=null&&c.call(y,t,r,this))){l=y;break}}if(!l)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}a=yield l.load(t,r,this),n.parser=l;for(let g=0;g<this.parsers.length;g++){const y=this.parsers[g];y.parse&&y.parse&&(yield(p=y.testParse)==null?void 0:p.call(y,a,r,this))&&(a=(yield y.parse(a,r,this))||a,n.parser=y)}return a}))(),n}load(t,r){return Lt(this,null,function*(){this._parsersValidated||this._validateParsers();let n=0;const a={},l=Ee(t),c=Re(t,y=>({alias:[y],src:y})),p=c.length,g=c.map(y=>Lt(this,null,function*(){const x=d.P6.path.toAbsolute(y.src);if(!a[y.src])try{this.promiseCache[x]||(this.promiseCache[x]=this._getLoadPromiseAndParser(x,y)),a[y.src]=yield this.promiseCache[x].promise,r&&r(++n/p)}catch(b){throw delete this.promiseCache[x],delete a[y.src],new Error(`[Loader.load] Failed to load ${x}.
${b}`)}}));return yield Promise.all(g),l?a[c[0].src]:a})}unload(t){return Lt(this,null,function*(){const r=Re(t,n=>({alias:[n],src:n})).map(n=>Lt(this,null,function*(){var c,p;const a=d.P6.path.toAbsolute(n.src),l=this.promiseCache[a];if(l){const g=yield l.promise;delete this.promiseCache[a],(p=(c=l.parser)==null?void 0:c.unload)==null||p.call(c,g,n,this)}}));yield Promise.all(r)})}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,r)=>(t[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),pi(pe({},t),{[r.name]:r})),{})}}var de=(f=>(f[f.Low=0]="Low",f[f.Normal=1]="Normal",f[f.High=2]="High",f))(de||{});function tr(f,t){if(Array.isArray(t)){for(const r of t)if(f.startsWith(`data:${r}`))return!0;return!1}return f.startsWith(`data:${t}`)}const mi=".json",vr="application/json",Lr={extension:{type:d.nw.LoadParser,priority:de.Low},name:"loadJson",test(f){return tr(f,vr)||$e(f,mi)},load(f){return Lt(this,null,function*(){return yield(yield d.Xd.ADAPTER.fetch(f)).json()})}};d.Rw.add(Lr);const Y=".txt",Q="text/plain",Jt={name:"loadTxt",extension:{type:d.nw.LoadParser,priority:de.Low},test(f){return tr(f,Q)||$e(f,Y)},load(f){return Lt(this,null,function*(){return yield(yield d.Xd.ADAPTER.fetch(f)).text()})}};d.Rw.add(Jt);const ie=["normal","bold","100","200","300","400","500","600","700","800","900"],me=[".ttf",".otf",".woff",".woff2"],qt=["font/ttf","font/otf","font/woff","font/woff2"],De=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function er(f){const t=d.P6.path.extname(f),r=d.P6.path.basename(f,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1));let n=r.length>0;for(const l of r)if(!l.match(De)){n=!1;break}let a=r.join(" ");return n||(a=`"${a.replace(/[\\"]/g,"\\$&")}"`),a}const Me=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function je(f){return Me.test(f)?f:encodeURI(f)}const Zr={extension:{type:d.nw.LoadParser,priority:de.Low},name:"loadWebFont",test(f){return tr(f,qt)||$e(f,me)},load(f,t){return Lt(this,null,function*(){var n,a,l,c,p,g;const r=d.Xd.ADAPTER.getFontFaceSet();if(r){const y=[],x=(a=(n=t.data)==null?void 0:n.family)!=null?a:er(f),b=(p=(c=(l=t.data)==null?void 0:l.weights)==null?void 0:c.filter(T=>ie.includes(T)))!=null?p:["normal"],A=(g=t.data)!=null?g:{};for(let T=0;T<b.length;T++){const M=b[T],O=new FontFace(x,`url(${je(f)})`,pi(pe({},A),{weight:M}));yield O.load(),r.add(O),y.push(O)}return y.length===1?y[0]:y}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null})},unload(f){(Array.isArray(f)?f:[f]).forEach(t=>d.Xd.ADAPTER.getFontFaceSet().delete(t))}};d.Rw.add(Zr);let He=0,Se;const Qr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",$i={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${Qr}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},Nr={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Xe;class Ur{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const r=URL.createObjectURL(new Blob([$i.code],{type:"application/javascript"})),n=new Worker(r);n.addEventListener("message",a=>{n.terminate(),URL.revokeObjectURL(r),t(a.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}_initWorkers(){return Lt(this,null,function*(){this._initialized||(this._initialized=!0)})}getWorker(){Se===void 0&&(Se=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Se&&(Xe||(Xe=URL.createObjectURL(new Blob([Nr.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Xe),t.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}_run(t,r){return Lt(this,null,function*(){yield this._initWorkers();const n=new Promise((a,l)=>{this.queue.push({id:t,arguments:r,resolve:a,reject:l})});return this.next(),n})}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const r=this.queue.pop(),n=r.id;this.resolveHash[He]={resolve:r.resolve,reject:r.reject},t.postMessage({data:r.arguments,uuid:He++,id:n})}}const Ye=new Ur;function we(f,t,r){f.resource.internal=!0;const n=new d.xE(f),a=()=>{delete t.promiseCache[r],Je.has(r)&&Je.remove(r)};return n.baseTexture.once("destroyed",()=>{r in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),a())}),n.once("destroyed",()=>{f.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),a())}),n}const kr=[".jpeg",".jpg",".png",".webp",".avif"],gi=["image/jpeg","image/png","image/webp","image/avif"];function ji(f){return Lt(this,null,function*(){const t=yield d.Xd.ADAPTER.fetch(f);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${f}: ${t.status} ${t.statusText}`);const r=yield t.blob();return yield createImageBitmap(r)})}const or={name:"loadTextures",extension:{type:d.nw.LoadParser,priority:de.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(f){return tr(f,gi)||$e(f,kr)},load(f,t,r){return Lt(this,null,function*(){var p,g;const n=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let a;n?this.config.preferWorkers&&(yield Ye.isImageBitmapSupported())?a=yield Ye.loadImageBitmap(f):a=yield ji(f):a=yield new Promise((y,x)=>{const b=new Image;b.crossOrigin=this.config.crossOrigin,b.src=f,b.complete?y(b):(b.onload=()=>y(b),b.onerror=A=>x(A))});const l=pe({},t.data);(p=l.resolution)!=null||(l.resolution=d.P6.getResolutionOfUrl(f)),n&&((g=l.resourceOptions)==null?void 0:g.ownsImageBitmap)===void 0&&(l.resourceOptions=pe({},l.resourceOptions),l.resourceOptions.ownsImageBitmap=!0);const c=new d.VL(a,l);return c.resource.src=f,we(c,r,f)})},unload(f){f.destroy(!0)}};d.Rw.add(or);const rr=".svg",Ce="image/svg+xml",yi={extension:{type:d.nw.LoadParser,priority:de.High},name:"loadSVG",test(f){return tr(f,Ce)||$e(f,rr)},testParse(f){return Lt(this,null,function*(){return d.pX.test(f)})},parse(f,t,r){return Lt(this,null,function*(){var l;const n=new d.pX(f,(l=t==null?void 0:t.data)==null?void 0:l.resourceOptions);yield n.load();const a=new d.VL(n,pe({resolution:d.P6.getResolutionOfUrl(f)},t==null?void 0:t.data));return a.resource.src=t.src,we(a,r,t.src)})},load(f,t){return Lt(this,null,function*(){return(yield d.Xd.ADAPTER.fetch(f)).text()})},unload:or.unload};d.Rw.add(yi);const Yi=[".mp4",".m4v",".webm",".ogv"],Jr=["video/mp4","video/webm","video/ogg"],ar={name:"loadVideo",extension:{type:d.nw.LoadParser,priority:de.High},config:{defaultAutoPlay:!0},test(f){return tr(f,Jr)||$e(f,Yi)},load(f,t,r){return Lt(this,null,function*(){var c;let n;const a=yield(yield d.Xd.ADAPTER.fetch(f)).blob(),l=URL.createObjectURL(a);try{const p=pe({autoPlay:this.config.defaultAutoPlay},(c=t==null?void 0:t.data)==null?void 0:c.resourceOptions),g=new d.eH(l,p);yield g.load();const y=new d.VL(g,pe({alphaMode:yield d.P6.detectVideoAlphaMode(),resolution:d.P6.getResolutionOfUrl(f)},t==null?void 0:t.data));y.resource.src=f,n=we(y,r,f),n.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(l)})}catch(p){throw URL.revokeObjectURL(l),p}return n})},unload(f){f.destroy(!0)}};d.Rw.add(ar);function xr(f,t,r,n,a){const l=t[r];for(let c=0;c<l.length;c++){const p=l[c];r<t.length-1?xr(f.replace(n[r],p),t,r+1,n,a):a.push(f.replace(n[r],p))}}function ti(f){const t=/\{(.*?)\}/g,r=f.match(t),n=[];if(r){const a=[];r.forEach(l=>{const c=l.substring(1,l.length-1).split(",");a.push(c)}),xr(f,a,0,r,n)}else n.push(f);return n}class _i{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,r)=>`${t}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(t,r)=>r.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){var r,n,a;if(this._bundleIdConnector=(r=t.connector)!=null?r:this._bundleIdConnector,this._createBundleAssetId=(n=t.createBundleAssetId)!=null?n:this._createBundleAssetId,this._extractAssetIdFromBundle=(a=t.extractAssetIdFromBundle)!=null?a:this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const r=t;this._defaultSearchParams=Object.keys(r).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(r[n])}`).join("&")}}getAlias(t){const{alias:r,name:n,src:a,srcs:l}=t;return Re(r||n||a||l,c=>{var p;return typeof c=="string"?c:Array.isArray(c)?c.map(g=>{var y,x;return(x=(y=g==null?void 0:g.src)!=null?y:g==null?void 0:g.srcs)!=null?x:g}):c!=null&&c.src||c!=null&&c.srcs?(p=c.src)!=null?p:c.srcs:c},!0)}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(t,r){const n=[];Array.isArray(r)?r.forEach(a=>{var g,y;const l=(g=a.src)!=null?g:a.srcs,c=(y=a.alias)!=null?y:a.name;let p;if(typeof c=="string"){const x=this._createBundleAssetId(t,c);n.push(x),p=[c,x]}else{const x=c.map(b=>this._createBundleAssetId(t,b));n.push(...x),p=[...c,...x]}this.add(pi(pe({},a),{alias:p,src:l}))}):Object.keys(r).forEach(a=>{var c;const l=[a,this._createBundleAssetId(t,a)];if(typeof r[a]=="string")this.add({alias:l,src:r[a]});else if(Array.isArray(r[a]))this.add({alias:l,src:r[a]});else{const p=r[a],g=(c=p.src)!=null?c:p.srcs;this.add(pi(pe({},p),{alias:l,src:Array.isArray(g)?g:[g]}))}n.push(...l)}),this._bundles[t]=n}add(t,r,n,a,l){const c=[];typeof t=="string"||Array.isArray(t)&&typeof t[0]=="string"?(d.P6.deprecation("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),c.push({alias:t,src:r,data:n,format:a,loadParser:l})):Array.isArray(t)?c.push(...t):c.push(t);let p;p=g=>{this.hasKey(g)&&console.warn(`[Resolver] already has key: ${g} overwriting`)},Re(c).forEach(g=>{const{src:y,srcs:x}=g;let{data:b,format:A,loadParser:T}=g;const M=Re(y||x).map($=>typeof $=="string"?ti($):Array.isArray($)?$:[$]),O=this.getAlias(g);Array.isArray(O)?O.forEach(p):p(O);const K=[];M.forEach($=>{$.forEach(vt=>{var ut,Mt,$t;let et={};if(typeof vt!="object"){et.src=vt;for(let Dt=0;Dt<this._parsers.length;Dt++){const Bt=this._parsers[Dt];if(Bt.test(vt)){et=Bt.parse(vt);break}}}else b=(ut=vt.data)!=null?ut:b,A=(Mt=vt.format)!=null?Mt:A,T=($t=vt.loadParser)!=null?$t:T,et=pe(pe({},et),vt);if(!O)throw new Error(`[Resolver] alias is undefined for this asset: ${et.src}`);et=this.buildResolvedAsset(et,{aliases:O,data:b,format:A,loadParser:T}),K.push(et)})}),O.forEach($=>{this._assetMap[$]=K})})}resolveBundle(t){const r=Ee(t);t=Re(t);const n={};return t.forEach(a=>{const l=this._bundles[a];if(l){const c=this.resolve(l),p={};for(const g in c){const y=c[g];p[this._extractAssetIdFromBundle(a,g)]=y}n[a]=p}}),r?n[t[0]]:n}resolveUrl(t){const r=this.resolve(t);if(typeof t!="string"){const n={};for(const a in r)n[a]=r[a].src;return n}return r.src}resolve(t){const r=Ee(t);t=Re(t);const n={};return t.forEach(a=>{var l;if(!this._resolverHash[a])if(this._assetMap[a]){let c=this._assetMap[a];const p=c[0],g=this._getPreferredOrder(c);g==null||g.priority.forEach(y=>{g.params[y].forEach(x=>{const b=c.filter(A=>A[y]?A[y]===x:!1);b.length&&(c=b)})}),this._resolverHash[a]=(l=c[0])!=null?l:p}else this._resolverHash[a]=this.buildResolvedAsset({alias:[a],src:a},{});n[a]=this._resolverHash[a]}),r?n[t[0]]:n}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let r=0;r<t.length;r++){const n=t[0],a=this._preferredOrder.find(l=>l.params.format.includes(n.format));if(a)return a}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const r=/\?/.test(t)?"&":"?";return`${t}${r}${this._defaultSearchParams}`}buildResolvedAsset(t,r){var p;const{aliases:n,data:a,loadParser:l,format:c}=r;return(this._basePath||this._rootPath)&&(t.src=d.P6.path.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=(p=n!=null?n:t.alias)!=null?p:[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data=pe(pe({},a||{}),t.data),t.loadParser=l!=null?l:t.loadParser,t.format=c!=null?c:d.P6.path.extname(t.src).slice(1),t.srcs=t.src,t.name=t.alias,t}}class Cn{constructor(){this._detections=[],this._initialized=!1,this.resolver=new _i,this.loader=new _e,this.cache=Je,this._backgroundLoader=new zi(this.loader),this._backgroundLoader.active=!0,this.reset()}init(){return Lt(this,arguments,function*(t={}){var l,c,p;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let g=t.manifest;typeof g=="string"&&(g=yield this.load(g)),this.resolver.addManifest(g)}const r=(c=(l=t.texturePreference)==null?void 0:l.resolution)!=null?c:1,n=typeof r=="number"?[r]:r,a=yield this._detectFormats({preferredFormats:(p=t.texturePreference)==null?void 0:p.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:a,resolution:n}}),t.preferences&&this.setPreferences(t.preferences)})}add(t,r,n,a,l){this.resolver.add(t,r,n,a,l)}load(t,r){return Lt(this,null,function*(){this._initialized||(yield this.init());const n=Ee(t),a=Re(t).map(p=>{if(typeof p!="string"){const g=this.resolver.getAlias(p);return g.some(y=>!this.resolver.hasKey(y))&&this.add(p),Array.isArray(g)?g[0]:g}return this.resolver.hasKey(p)||this.add({alias:p,src:p}),p}),l=this.resolver.resolve(a),c=yield this._mapLoadToResolve(l,r);return n?c[a[0]]:c})}addBundle(t,r){this.resolver.addBundle(t,r)}loadBundle(t,r){return Lt(this,null,function*(){this._initialized||(yield this.init());let n=!1;typeof t=="string"&&(n=!0,t=[t]);const a=this.resolver.resolveBundle(t),l={},c=Object.keys(a);let p=0,g=0;const y=()=>{r==null||r(++p/g)},x=c.map(b=>{const A=a[b];return g+=Object.keys(A).length,this._mapLoadToResolve(A,y).then(T=>{l[b]=T})});return yield Promise.all(x),n?l[t[0]]:l})}backgroundLoad(t){return Lt(this,null,function*(){this._initialized||(yield this.init()),typeof t=="string"&&(t=[t]);const r=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(r))})}backgroundLoadBundle(t){return Lt(this,null,function*(){this._initialized||(yield this.init()),typeof t=="string"&&(t=[t]);const r=this.resolver.resolveBundle(t);Object.values(r).forEach(n=>{this._backgroundLoader.add(Object.values(n))})})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Je.get(t);const r={};for(let n=0;n<t.length;n++)r[n]=Je.get(t[n]);return r}_mapLoadToResolve(t,r){return Lt(this,null,function*(){const n=Object.values(t),a=Object.keys(t);this._backgroundLoader.active=!1;const l=yield this.loader.load(n,r);this._backgroundLoader.active=!0;const c={};return n.forEach((p,g)=>{const y=l[p.src],x=[p.src];p.alias&&x.push(...p.alias),c[a[g]]=y,Je.set(x,y)}),c})}unload(t){return Lt(this,null,function*(){this._initialized||(yield this.init());const r=Re(t).map(a=>typeof a!="string"?a.src:a),n=this.resolver.resolve(r);yield this._unloadFromResolved(n)})}unloadBundle(t){return Lt(this,null,function*(){this._initialized||(yield this.init()),t=Re(t);const r=this.resolver.resolveBundle(t),n=Object.keys(r).map(a=>this._unloadFromResolved(r[a]));yield Promise.all(n)})}_unloadFromResolved(t){return Lt(this,null,function*(){const r=Object.values(t);r.forEach(n=>{Je.remove(n.src)}),yield this.loader.unload(r)})}_detectFormats(t){return Lt(this,null,function*(){let r=[];t.preferredFormats&&(r=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const n of t.detections)t.skipDetections||(yield n.test())?r=yield n.add(r):t.skipDetections||(r=yield n.remove(r));return r=r.filter((n,a)=>r.indexOf(n)===a),r})}get detections(){return this._detections}get preferWorkers(){return or.config.preferWorkers}set preferWorkers(t){d.P6.deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(n=>n in t).forEach(n=>{r.config[n]=t[n]})})}}const vi=new Cn;d.Rw.handleByList(d.nw.LoadParser,vi.loader.parsers).handleByList(d.nw.ResolveParser,vi.resolver.parsers).handleByList(d.nw.CacheParser,vi.cache.parsers).handleByList(d.nw.DetectionParser,vi.detections);const In={extension:d.nw.CacheParser,test:f=>Array.isArray(f)&&f.every(t=>t instanceof d.xE),getCacheableAssets:(f,t)=>{const r={};return f.forEach(n=>{t.forEach((a,l)=>{r[n+(l===0?"":l+1)]=a})}),r}};d.Rw.add(In);function Ki(f){return Lt(this,null,function*(){if("Image"in globalThis)return new Promise(t=>{const r=new Image;r.onload=()=>{t(!0)},r.onerror=()=>{t(!1)},r.src=f});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=yield(yield fetch(f)).blob();yield createImageBitmap(t)}catch(t){return!1}return!0}return!1})}const Pn={extension:{type:d.nw.DetectionParser,priority:1},test:()=>Lt(this,null,function*(){return Ki("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=")}),add:f=>Lt(this,null,function*(){return[...f,"avif"]}),remove:f=>Lt(this,null,function*(){return f.filter(t=>t!=="avif")})};d.Rw.add(Pn);const xi={extension:{type:d.nw.DetectionParser,priority:0},test:()=>Lt(this,null,function*(){return Ki("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=")}),add:f=>Lt(this,null,function*(){return[...f,"webp"]}),remove:f=>Lt(this,null,function*(){return f.filter(t=>t!=="webp")})};d.Rw.add(xi);const Os=["png","jpg","jpeg"],Rn={extension:{type:d.nw.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:f=>Lt(this,null,function*(){return[...f,...Os]}),remove:f=>Lt(this,null,function*(){return f.filter(t=>!Os.includes(t))})};d.Rw.add(Rn);const ei="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function ri(f){return ei?!1:document.createElement("video").canPlayType(f)!==""}const qi={extension:{type:d.nw.DetectionParser,priority:0},test:()=>Lt(this,null,function*(){return ri("video/webm")}),add:f=>Lt(this,null,function*(){return[...f,"webm"]}),remove:f=>Lt(this,null,function*(){return f.filter(t=>t!=="webm")})};d.Rw.add(qi);const Ls={extension:{type:d.nw.DetectionParser,priority:0},test:()=>Lt(this,null,function*(){return ri("video/mp4")}),add:f=>Lt(this,null,function*(){return[...f,"mp4","m4v"]}),remove:f=>Lt(this,null,function*(){return f.filter(t=>t!=="mp4"&&t!=="m4v")})};d.Rw.add(Ls);const Mn={extension:{type:d.nw.DetectionParser,priority:0},test:()=>Lt(this,null,function*(){return ri("video/ogg")}),add:f=>Lt(this,null,function*(){return[...f,"ogv"]}),remove:f=>Lt(this,null,function*(){return f.filter(t=>t!=="ogv")})};d.Rw.add(Mn);const Bn={extension:d.nw.ResolveParser,test:or.test,parse:f=>{var t,r;return{resolution:parseFloat((r=(t=d.Xd.RETINA_PREFIX.exec(f))==null?void 0:t[1])!=null?r:"1"),format:d.P6.path.extname(f).slice(1),src:f}}};d.Rw.add(Bn);const hr=(f,t)=>{const r=t.split("?")[1];return r&&(f+=`?${r}`),f};var Be=(f=>(f[f.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",f[f.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",f[f.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",f[f.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",f[f.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",f[f.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",f[f.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",f[f.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",f[f.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",f[f.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",f[f.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",f[f.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",f[f.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",f[f.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",f[f.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",f[f.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",f[f.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",f[f.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",f[f.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",f[f.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",f[f.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",f[f.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",f[f.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",f[f.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",f[f.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",f[f.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",f[f.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",f))(Be||{});const Gr={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let We,be;function Fe(){be={s3tc:We.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:We.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:We.getExtension("WEBGL_compressed_texture_etc"),etc1:We.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:We.getExtension("WEBGL_compressed_texture_pvrtc")||We.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:We.getExtension("WEBGL_compressed_texture_atc"),astc:We.getExtension("WEBGL_compressed_texture_astc")}}const Dn={extension:{type:d.nw.DetectionParser,priority:2},test:()=>Lt(this,null,function*(){const f=d.Xd.ADAPTER.createCanvas().getContext("webgl");return f?(We=f,!0):(console.warn("WebGL not available for compressed textures."),!1)}),add:f=>Lt(this,null,function*(){be||Fe();const t=[];for(const r in be)be[r]&&t.push(r);return[...t,...f]}),remove:f=>Lt(this,null,function*(){return be||Fe(),f.filter(t=>!(t in be))})};d.Rw.add(Dn);class Fn extends d.qm{constructor(t,r={width:1,height:1,autoLoad:!0}){let n,a;typeof t=="string"?(n=t,a=new Uint8Array):(n=null,a=t),super(a,r),this.origin=n,this.buffer=a?new d.Rv(a):null,this._load=null,this.loaded=!1,this.origin!==null&&r.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new d.Rv(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class br extends Fn{constructor(t,r){super(t,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=br._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||br._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,r,n){const a=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;a.pixelStorei(a.UNPACK_ALIGNMENT,4);for(let l=0,c=this.levels;l<c;l++){const{levelID:p,levelWidth:g,levelHeight:y,levelBuffer:x}=this._levelBuffers[l];a.compressedTexImage2D(a.TEXTURE_2D,p,this.format,g,y,0,x)}return!0}onBlobLoaded(){this._levelBuffers=br._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,r,n,a,l,c,p){const g=new Array(n);let y=t.byteOffset,x=c,b=p,A=x+a-1&~(a-1),T=b+l-1&~(l-1),M=A*T*Gr[r];for(let O=0;O<n;O++)g[O]={levelID:O,levelWidth:n>1?x:A,levelHeight:n>1?b:T,levelBuffer:new Uint8Array(t.buffer,y,M)},y+=M,x=x>>1||1,b=b>>1||1,A=x+a-1&~(a-1),T=b+l-1&~(l-1),M=A*T*Gr[r];return g}}const bi=4,ii=124,Ns=32,Us=20,On=542327876,si={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},Zi={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Qt={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},Qi=1,ks=2,se=4,Gs=64,Ln=512,Nn=131072,Un=827611204,Ji=861165636,ts=894720068,es=808540228,rs=4,is={[Un]:Be.COMPRESSED_RGBA_S3TC_DXT1_EXT,[Ji]:Be.COMPRESSED_RGBA_S3TC_DXT3_EXT,[ts]:Be.COMPRESSED_RGBA_S3TC_DXT5_EXT},ss={70:Be.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Be.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Be.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Be.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Be.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Be.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Be.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Be.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Be.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function Tr(f){const t=new Uint32Array(f);if(t[0]!==On)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(f,0,ii/Uint32Array.BYTES_PER_ELEMENT),n=r[si.HEIGHT],a=r[si.WIDTH],l=r[si.MIPMAP_COUNT],c=new Uint32Array(f,si.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,Ns/Uint32Array.BYTES_PER_ELEMENT),p=c[Qi];if(p&se){const g=c[Zi.FOURCC];if(g!==es){const vt=is[g],et=bi+ii,ut=new Uint8Array(f,et);return[new br(ut,{format:vt,width:a,height:n,levels:l})]}const y=bi+ii,x=new Uint32Array(t.buffer,y,Us/Uint32Array.BYTES_PER_ELEMENT),b=x[Qt.DXGI_FORMAT],A=x[Qt.RESOURCE_DIMENSION],T=x[Qt.MISC_FLAG],M=x[Qt.ARRAY_SIZE],O=ss[b];if(O===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${b}`);if(T===rs)throw new Error("DDSParser does not support cubemap textures");if(A===6)throw new Error("DDSParser does not supported 3D texture data");const K=new Array,$=bi+ii+Us;if(M===1)K.push(new Uint8Array(f,$));else{const vt=Gr[O];let et=0,ut=a,Mt=n;for(let Dt=0;Dt<l;Dt++){const Bt=Math.max(1,ut+3&-4),Wt=Math.max(1,Mt+3&-4),jt=Bt*Wt*vt;et+=jt,ut=ut>>>1,Mt=Mt>>>1}let $t=$;for(let Dt=0;Dt<M;Dt++)K.push(new Uint8Array(f,$t,et)),$t+=et}return K.map(vt=>new br(vt,{format:O,width:a,height:n,levels:l}))}throw p&Gs?new Error("DDSParser does not support uncompressed texture data."):p&Ln?new Error("DDSParser does not supported YUV uncompressed texture data."):p&Nn?new Error("DDSParser does not support single-channel (lumninance) texture data!"):p&ks?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Ti=[171,75,84,88,32,49,49,187,13,10,26,10],Hs=67305985,xe={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Ar=64,Ai={[d.vK.UNSIGNED_BYTE]:1,[d.vK.UNSIGNED_SHORT]:2,[d.vK.INT]:4,[d.vK.UNSIGNED_INT]:4,[d.vK.FLOAT]:4,[d.vK.HALF_FLOAT]:8},kn={[d.I2.RGBA]:4,[d.I2.RGB]:3,[d.I2.RG]:2,[d.I2.RED]:1,[d.I2.LUMINANCE]:1,[d.I2.LUMINANCE_ALPHA]:2,[d.I2.ALPHA]:1},ns={[d.vK.UNSIGNED_SHORT_4_4_4_4]:2,[d.vK.UNSIGNED_SHORT_5_5_5_1]:2,[d.vK.UNSIGNED_SHORT_5_6_5]:2};function oe(f,t,r=!1){const n=new DataView(t);if(!Xs(f,n))return null;const a=n.getUint32(xe.ENDIANNESS,!0)===Hs,l=n.getUint32(xe.GL_TYPE,a),c=n.getUint32(xe.GL_FORMAT,a),p=n.getUint32(xe.GL_INTERNAL_FORMAT,a),g=n.getUint32(xe.PIXEL_WIDTH,a),y=n.getUint32(xe.PIXEL_HEIGHT,a)||1,x=n.getUint32(xe.PIXEL_DEPTH,a)||1,b=n.getUint32(xe.NUMBER_OF_ARRAY_ELEMENTS,a)||1,A=n.getUint32(xe.NUMBER_OF_FACES,a),T=n.getUint32(xe.NUMBER_OF_MIPMAP_LEVELS,a),M=n.getUint32(xe.BYTES_OF_KEY_VALUE_DATA,a);if(y===0||x!==1)throw new Error("Only 2D textures are supported");if(A!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(b!==1)throw new Error("WebGL does not support array textures");const O=4,K=4,$=g+3&-4,vt=y+3&-4,et=new Array(b);let ut=g*y;l===0&&(ut=$*vt);let Mt;if(l!==0?Ai[l]?Mt=Ai[l]*kn[c]:Mt=ns[l]:Mt=Gr[p],Mt===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const $t=r?Ie(n,M,a):null;let Dt=ut*Mt,Bt=g,Wt=y,jt=$,ue=vt,Ut=Ar+M;for(let ft=0;ft<T;ft++){const Rt=n.getUint32(Ut,a);let Vt=Ut+4;for(let re=0;re<b;re++){let Ht=et[re];Ht||(Ht=et[re]=new Array(T)),Ht[ft]={levelID:ft,levelWidth:T>1||l!==0?Bt:jt,levelHeight:T>1||l!==0?Wt:ue,levelBuffer:new Uint8Array(t,Vt,Dt)},Vt+=Dt}Ut+=Rt+4,Ut=Ut%4!==0?Ut+4-Ut%4:Ut,Bt=Bt>>1||1,Wt=Wt>>1||1,jt=Bt+O-1&~(O-1),ue=Wt+K-1&~(K-1),Dt=jt*ue*Mt}return l!==0?{uncompressed:et.map(ft=>{let Rt=ft[0].levelBuffer,Vt=!1;return l===d.vK.FLOAT?Rt=new Float32Array(ft[0].levelBuffer.buffer,ft[0].levelBuffer.byteOffset,ft[0].levelBuffer.byteLength/4):l===d.vK.UNSIGNED_INT?(Vt=!0,Rt=new Uint32Array(ft[0].levelBuffer.buffer,ft[0].levelBuffer.byteOffset,ft[0].levelBuffer.byteLength/4)):l===d.vK.INT&&(Vt=!0,Rt=new Int32Array(ft[0].levelBuffer.buffer,ft[0].levelBuffer.byteOffset,ft[0].levelBuffer.byteLength/4)),{resource:new d.qm(Rt,{width:ft[0].levelWidth,height:ft[0].levelHeight}),type:l,format:Vt?Gn(c):c}}),kvData:$t}:{compressed:et.map(ft=>new br(null,{format:p,width:g,height:y,levels:T,levelBuffers:ft})),kvData:$t}}function Xs(f,t){for(let r=0;r<Ti.length;r++)if(t.getUint8(r)!==Ti[r])return console.error(`${f} is not a valid *.ktx file!`),!1;return!0}function Gn(f){switch(f){case d.I2.RGBA:return d.I2.RGBA_INTEGER;case d.I2.RGB:return d.I2.RGB_INTEGER;case d.I2.RG:return d.I2.RG_INTEGER;case d.I2.RED:return d.I2.RED_INTEGER;default:return f}}function Ie(f,t,r){const n=new Map;let a=0;for(;a<t;){const l=f.getUint32(Ar+a,r),c=Ar+a+4,p=3-(l+3)%4;if(l===0||l>t-a){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let g=0;for(;g<l&&f.getUint8(c+g)!==0;g++);if(g===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const y=new TextDecoder().decode(new Uint8Array(f.buffer,c,g)),x=new DataView(f.buffer,c+g+1,l-g-1);n.set(y,x),a+=4+l+p}return n}const Ei={extension:{type:d.nw.LoadParser,priority:de.High},name:"loadDDS",test(f){return $e(f,".dds")},load(f,t,r){return Lt(this,null,function*(){const n=yield(yield d.Xd.ADAPTER.fetch(f)).arrayBuffer(),a=Tr(n).map(l=>{const c=new d.VL(l,pe({mipmap:d.KI.OFF,alphaMode:d.iw.NO_PREMULTIPLIED_ALPHA,resolution:d.P6.getResolutionOfUrl(f)},t.data));return we(c,r,f)});return a.length===1?a[0]:a})},unload(f){Array.isArray(f)?f.forEach(t=>t.destroy(!0)):f.destroy(!0)}};d.Rw.add(Ei);const Hn={extension:{type:d.nw.LoadParser,priority:de.High},name:"loadKTX",test(f){return $e(f,".ktx")},load(f,t,r){return Lt(this,null,function*(){const n=yield(yield d.Xd.ADAPTER.fetch(f)).arrayBuffer(),{compressed:a,uncompressed:l,kvData:c}=oe(f,n),p=a!=null?a:l,g=pe({mipmap:d.KI.OFF,alphaMode:d.iw.NO_PREMULTIPLIED_ALPHA,resolution:d.P6.getResolutionOfUrl(f)},t.data),y=p.map(x=>{var T;p===l&&Object.assign(g,{type:x.type,format:x.format});const b=(T=x.resource)!=null?T:x,A=new d.VL(b,g);return A.ktxKeyValueData=c,we(A,r,f)});return y.length===1?y[0]:y})},unload(f){Array.isArray(f)?f.forEach(t=>t.destroy(!0)):f.destroy(!0)}};d.Rw.add(Hn);const Xn={extension:d.nw.ResolveParser,test:f=>{const t=d.P6.path.extname(f).slice(1);return["basis","ktx","dds"].includes(t)},parse:f=>{var r,n,a,l;const t=d.P6.path.extname(f).slice(1);if(t==="ktx"){const c=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(c.some(p=>f.endsWith(p)))return{resolution:parseFloat((n=(r=d.Xd.RETINA_PREFIX.exec(f))==null?void 0:r[1])!=null?n:"1"),format:c.find(p=>f.endsWith(p)),src:f}}return{resolution:parseFloat((l=(a=d.Xd.RETINA_PREFIX.exec(f))==null?void 0:a[1])!=null?l:"1"),format:t,src:f}}};d.Rw.add(Xn);const ni=new d.Ae,Wn=4,Ws=class Bs{constructor(t){this.renderer=t,this._rendererPremultipliedAlpha=!1}contextChange(){var r;const t=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}image(t,r,n,a){return Lt(this,null,function*(){const l=new Image;return l.src=yield this.base64(t,r,n,a),l})}base64(t,r,n,a){return Lt(this,null,function*(){const l=this.canvas(t,a);if(l.toBlob!==void 0)return new Promise((c,p)=>{l.toBlob(g=>{if(!g){p(new Error("ICanvas.toBlob failed!"));return}const y=new FileReader;y.onload=()=>c(y.result),y.onerror=p,y.readAsDataURL(g)},r,n)});if(l.toDataURL!==void 0)return l.toDataURL(r,n);if(l.convertToBlob!==void 0){const c=yield l.convertToBlob({type:r,quality:n});return new Promise((p,g)=>{const y=new FileReader;y.onload=()=>p(y.result),y.onerror=g,y.readAsDataURL(c)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")})}canvas(t,r){const{pixels:n,width:a,height:l,flipY:c,premultipliedAlpha:p}=this._rawPixels(t,r);c&&Bs._flipY(n,a,l),p&&Bs._unpremultiplyAlpha(n);const g=new d.P6.CanvasRenderTarget(a,l,1),y=new ImageData(new Uint8ClampedArray(n.buffer),a,l);return g.context.putImageData(y,0,0),g.canvas}pixels(t,r){const{pixels:n,width:a,height:l,flipY:c,premultipliedAlpha:p}=this._rawPixels(t,r);return c&&Bs._flipY(n,a,l),p&&Bs._unpremultiplyAlpha(n),n}_rawPixels(t,r){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let a,l=!1,c=!1,p,g=!1;t&&(t instanceof d.TI?p=t:(p=n.generateTexture(t,{region:r,resolution:n.resolution,multisample:n.multisample}),g=!0,r&&(ni.width=r.width,ni.height=r.height,r=ni)));const y=n.gl;if(p){if(a=p.baseTexture.resolution,r=r!=null?r:p.frame,l=!1,c=p.baseTexture.alphaMode>0&&p.baseTexture.format===d.I2.RGBA,!g){n.renderTexture.bind(p);const T=p.framebuffer.glFramebuffers[n.CONTEXT_UID];T.blitFramebuffer&&n.framebuffer.bind(T.blitFramebuffer)}}else a=n.resolution,r||(r=ni,r.width=n.width/a,r.height=n.height/a),l=!0,c=this._rendererPremultipliedAlpha,n.renderTexture.bind();const x=Math.max(Math.round(r.width*a),1),b=Math.max(Math.round(r.height*a),1),A=new Uint8Array(Wn*x*b);return y.readPixels(Math.round(r.x*a),Math.round(r.y*a),x,b,y.RGBA,y.UNSIGNED_BYTE,A),g&&(p==null||p.destroy(!0)),{pixels:A,width:x,height:b,flipY:l,premultipliedAlpha:c}}destroy(){this.renderer=null}static _flipY(t,r,n){const a=r<<2,l=n>>1,c=new Uint8Array(a);for(let p=0;p<l;p++){const g=p*a,y=(n-p-1)*a;c.set(t.subarray(g,g+a)),t.copyWithin(g,y,y+a),t.set(c,y)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const r=t.length;for(let n=0;n<r;n+=4){const a=t[n+3];if(a!==0){const l=255.001/a;t[n]=t[n]*l+.5,t[n+1]=t[n+1]*l+.5,t[n+2]=t[n+2]*l+.5}}}};Ws.extension={name:"extract",type:d.nw.RendererSystem};let Er=Ws;d.Rw.add(Er);const Hr={build(f){const t=f.points;let r,n,a,l,c,p;if(f.type===d.HS.CIRC){const M=f.shape;r=M.x,n=M.y,c=p=M.radius,a=l=0}else if(f.type===d.HS.ELIP){const M=f.shape;r=M.x,n=M.y,c=M.width,p=M.height,a=l=0}else{const M=f.shape,O=M.width/2,K=M.height/2;r=M.x+O,n=M.y+K,c=p=Math.max(0,Math.min(M.radius,Math.min(O,K))),a=O-c,l=K-p}if(!(c>=0&&p>=0&&a>=0&&l>=0)){t.length=0;return}const g=Math.ceil(2.3*Math.sqrt(c+p)),y=g*8+(a?4:0)+(l?4:0);if(t.length=y,y===0)return;if(g===0){t.length=8,t[0]=t[6]=r+a,t[1]=t[3]=n+l,t[2]=t[4]=r-a,t[5]=t[7]=n-l;return}let x=0,b=g*4+(a?2:0)+2,A=b,T=y;{const M=a+c,O=l,K=r+M,$=r-M,vt=n+O;if(t[x++]=K,t[x++]=vt,t[--b]=vt,t[--b]=$,l){const et=n-O;t[A++]=$,t[A++]=et,t[--T]=et,t[--T]=K}}for(let M=1;M<g;M++){const O=Math.PI/2*(M/g),K=a+Math.cos(O)*c,$=l+Math.sin(O)*p,vt=r+K,et=r-K,ut=n+$,Mt=n-$;t[x++]=vt,t[x++]=ut,t[--b]=ut,t[--b]=et,t[A++]=et,t[A++]=Mt,t[--T]=Mt,t[--T]=vt}{const M=a,O=l+p,K=r+M,$=r-M,vt=n+O,et=n-O;t[x++]=K,t[x++]=vt,t[--T]=et,t[--T]=K,a&&(t[x++]=$,t[x++]=vt,t[--T]=et,t[--T]=$)}},triangulate(f,t){const r=f.points,n=t.points,a=t.indices;if(r.length===0)return;let l=n.length/2;const c=l;let p,g;if(f.type!==d.HS.RREC){const x=f.shape;p=x.x,g=x.y}else{const x=f.shape;p=x.x+x.width/2,g=x.y+x.height/2}const y=f.matrix;n.push(f.matrix?y.a*p+y.c*g+y.tx:p,f.matrix?y.b*p+y.d*g+y.ty:g),l++,n.push(r[0],r[1]);for(let x=2;x<r.length;x+=2)n.push(r[x],r[x+1]),a.push(l++,c,l);a.push(c+1,c,l)}};function os(f,t=!1){const r=f.length;if(r<6)return;let n=0;for(let a=0,l=f[r-2],c=f[r-1];a<r;a+=2){const p=f[a],g=f[a+1];n+=(p-l)*(g+c),l=p,c=g}if(!t&&n>0||t&&n<=0){const a=r/2;for(let l=a+a%2;l<r;l+=2){const c=r-l-2,p=r-l-1,g=l,y=l+1;[f[c],f[g]]=[f[g],f[c]],[f[p],f[y]]=[f[y],f[p]]}}}const as={build(f){f.points=f.shape.points.slice()},triangulate(f,t){let r=f.points;const n=f.holes,a=t.points,l=t.indices;if(r.length>=6){os(r,!1);const c=[];for(let y=0;y<n.length;y++){const x=n[y];os(x.points,!0),c.push(r.length/2),r=r.concat(x.points)}const p=d.P6.earcut(r,c,2);if(!p)return;const g=a.length/2;for(let y=0;y<p.length;y+=3)l.push(p[y]+g),l.push(p[y+1]+g),l.push(p[y+2]+g);for(let y=0;y<r.length;y++)a.push(r[y])}}},Vs={build(f){const t=f.shape,r=t.x,n=t.y,a=t.width,l=t.height,c=f.points;c.length=0,a>=0&&l>=0&&c.push(r,n,r+a,n,r+a,n+l,r,n+l)},triangulate(f,t){const r=f.points,n=t.points;if(r.length===0)return;const a=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(a,a+1,a+2,a+1,a+2,a+3)}},lr={build(f){Hr.build(f)},triangulate(f,t){Hr.triangulate(f,t)}};var le=(f=>(f.MITER="miter",f.BEVEL="bevel",f.ROUND="round",f))(le||{}),Ve=(f=>(f.BUTT="butt",f.ROUND="round",f.SQUARE="square",f))(Ve||{});const ne={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(f,t=20){if(!this.adaptive||!f||isNaN(f))return t;let r=Math.ceil(f/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},hs=null;class Xr{static curveTo(t,r,n,a,l,c){const p=c[c.length-2],g=c[c.length-1]-r,y=p-t,x=a-r,b=n-t,A=Math.abs(g*b-y*x);if(A<1e-8||l===0)return(c[c.length-2]!==t||c[c.length-1]!==r)&&c.push(t,r),null;const T=g*g+y*y,M=x*x+b*b,O=g*x+y*b,K=l*Math.sqrt(T)/A,$=l*Math.sqrt(M)/A,vt=K*O/T,et=$*O/M,ut=K*b+$*y,Mt=K*x+$*g,$t=y*($+vt),Dt=g*($+vt),Bt=b*(K+et),Wt=x*(K+et),jt=Math.atan2(Dt-Mt,$t-ut),ue=Math.atan2(Wt-Mt,Bt-ut);return{cx:ut+t,cy:Mt+r,radius:l,startAngle:jt,endAngle:ue,anticlockwise:y*x>b*g}}static arc(t,r,n,a,l,c,p,g,y){const x=p-c,b=ne._segmentsCount(Math.abs(x)*l,Math.ceil(Math.abs(x)/d._b)*40),A=x/(b*2),T=A*2,M=Math.cos(A),O=Math.sin(A),K=b-1,$=K%1/K;for(let vt=0;vt<=K;++vt){const et=vt+$*vt,ut=A+c+T*et,Mt=Math.cos(ut),$t=-Math.sin(ut);y.push((M*Mt+O*$t)*l+n,(M*-$t+O*Mt)*l+a)}}}class wr{static curveLength(t,r,n,a,l,c,p,g){let y=0,x=0,b=0,A=0,T=0,M=0,O=0,K=0,$=0,vt=0,et=0,ut=t,Mt=r;for(let $t=1;$t<=10;++$t)x=$t/10,b=x*x,A=b*x,T=1-x,M=T*T,O=M*T,K=O*t+3*M*x*n+3*T*b*l+A*p,$=O*r+3*M*x*a+3*T*b*c+A*g,vt=ut-K,et=Mt-$,ut=K,Mt=$,y+=Math.sqrt(vt*vt+et*et);return y}static curveTo(t,r,n,a,l,c,p){const g=p[p.length-2],y=p[p.length-1];p.length-=2;const x=ne._segmentsCount(wr.curveLength(g,y,t,r,n,a,l,c));let b=0,A=0,T=0,M=0,O=0;p.push(g,y);for(let K=1,$=0;K<=x;++K)$=K/x,b=1-$,A=b*b,T=A*b,M=$*$,O=M*$,p.push(T*g+3*A*$*t+3*b*M*n+O*l,T*y+3*A*$*r+3*b*M*a+O*c)}}function oi(f,t,r,n,a,l,c,p){const g=f-r*a,y=t-n*a,x=f+r*l,b=t+n*l;let A,T;c?(A=n,T=-r):(A=-n,T=r);const M=g+A,O=y+T,K=x+A,$=b+T;return p.push(M,O,K,$),2}function fe(f,t,r,n,a,l,c,p){const g=r-f,y=n-t;let x=Math.atan2(g,y),b=Math.atan2(a-f,l-t);p&&x<b?x+=Math.PI*2:!p&&x>b&&(b+=Math.PI*2);let A=x;const T=b-x,M=Math.abs(T),O=Math.sqrt(g*g+y*y),K=(15*M*Math.sqrt(O)/Math.PI>>0)+1,$=T/K;if(A+=$,p){c.push(f,t,r,n);for(let vt=1,et=A;vt<K;vt++,et+=$)c.push(f,t,f+Math.sin(et)*O,t+Math.cos(et)*O);c.push(f,t,a,l)}else{c.push(r,n,f,t);for(let vt=1,et=A;vt<K;vt++,et+=$)c.push(f+Math.sin(et)*O,t+Math.cos(et)*O,f,t);c.push(a,l,f,t)}return K*2}function Sr(f,t){const r=f.shape;let n=f.points||r.points.slice();const a=t.closePointEps;if(n.length===0)return;const l=f.lineStyle,c=new d.E9(n[0],n[1]),p=new d.E9(n[n.length-2],n[n.length-1]),g=r.type!==d.HS.POLY||r.closeStroke,y=Math.abs(c.x-p.x)<a&&Math.abs(c.y-p.y)<a;if(g){n=n.slice(),y&&(n.pop(),n.pop(),p.set(n[n.length-2],n[n.length-1]));const Ht=(c.x+p.x)*.5,Yt=(p.y+c.y)*.5;n.unshift(Ht,Yt),n.push(Ht,Yt)}const x=t.points,b=n.length/2;let A=n.length;const T=x.length/2,M=l.width/2,O=M*M,K=l.miterLimit*l.miterLimit;let $=n[0],vt=n[1],et=n[2],ut=n[3],Mt=0,$t=0,Dt=-(vt-ut),Bt=$-et,Wt=0,jt=0,ue=Math.sqrt(Dt*Dt+Bt*Bt);Dt/=ue,Bt/=ue,Dt*=M,Bt*=M;const Ut=l.alignment,ft=(1-Ut)*2,Rt=Ut*2;g||(l.cap===Ve.ROUND?A+=fe($-Dt*(ft-Rt)*.5,vt-Bt*(ft-Rt)*.5,$-Dt*ft,vt-Bt*ft,$+Dt*Rt,vt+Bt*Rt,x,!0)+2:l.cap===Ve.SQUARE&&(A+=oi($,vt,Dt,Bt,ft,Rt,!0,x))),x.push($-Dt*ft,vt-Bt*ft,$+Dt*Rt,vt+Bt*Rt);for(let Ht=1;Ht<b-1;++Ht){$=n[(Ht-1)*2],vt=n[(Ht-1)*2+1],et=n[Ht*2],ut=n[Ht*2+1],Mt=n[(Ht+1)*2],$t=n[(Ht+1)*2+1],Dt=-(vt-ut),Bt=$-et,ue=Math.sqrt(Dt*Dt+Bt*Bt),Dt/=ue,Bt/=ue,Dt*=M,Bt*=M,Wt=-(ut-$t),jt=et-Mt,ue=Math.sqrt(Wt*Wt+jt*jt),Wt/=ue,jt/=ue,Wt*=M,jt*=M;const Yt=et-$,Te=vt-ut,Ae=et-Mt,te=$t-ut,Is=Yt*Ae+Te*te,ki=Te*Ae-te*Yt,Qe=ki<0;if(Math.abs(ki)<.001*Math.abs(Is)){x.push(et-Dt*ft,ut-Bt*ft,et+Dt*Rt,ut+Bt*Rt),Is>=0&&(l.join===le.ROUND?A+=fe(et,ut,et-Dt*ft,ut-Bt*ft,et-Wt*ft,ut-jt*ft,x,!1)+4:A+=2,x.push(et-Wt*Rt,ut-jt*Rt,et+Wt*ft,ut+jt*ft));continue}const Gi=(-Dt+$)*(-Bt+ut)-(-Dt+et)*(-Bt+vt),Ps=(-Wt+Mt)*(-jt+ut)-(-Wt+et)*(-jt+$t),jr=(Yt*Ps-Ae*Gi)/ki,fi=(te*Gi-Te*Ps)/ki,Jn=(jr-et)*(jr-et)+(fi-ut)*(fi-ut),Yr=et+(jr-et)*ft,yr=ut+(fi-ut)*ft,s=et-(jr-et)*Rt,e=ut-(fi-ut)*Rt,i=Math.min(Yt*Yt+Te*Te,Ae*Ae+te*te),o=Qe?ft:Rt,h=i+o*o*O,u=Jn<=h;let m=l.join;if(m===le.MITER&&Jn/O>K&&(m=le.BEVEL),u)switch(m){case le.MITER:{x.push(Yr,yr,s,e);break}case le.BEVEL:{Qe?x.push(Yr,yr,et+Dt*Rt,ut+Bt*Rt,Yr,yr,et+Wt*Rt,ut+jt*Rt):x.push(et-Dt*ft,ut-Bt*ft,s,e,et-Wt*ft,ut-jt*ft,s,e),A+=2;break}case le.ROUND:{Qe?(x.push(Yr,yr,et+Dt*Rt,ut+Bt*Rt),A+=fe(et,ut,et+Dt*Rt,ut+Bt*Rt,et+Wt*Rt,ut+jt*Rt,x,!0)+4,x.push(Yr,yr,et+Wt*Rt,ut+jt*Rt)):(x.push(et-Dt*ft,ut-Bt*ft,s,e),A+=fe(et,ut,et-Dt*ft,ut-Bt*ft,et-Wt*ft,ut-jt*ft,x,!1)+4,x.push(et-Wt*ft,ut-jt*ft,s,e));break}}else{switch(x.push(et-Dt*ft,ut-Bt*ft,et+Dt*Rt,ut+Bt*Rt),m){case le.MITER:{Qe?x.push(s,e,s,e):x.push(Yr,yr,Yr,yr),A+=2;break}case le.ROUND:{Qe?A+=fe(et,ut,et+Dt*Rt,ut+Bt*Rt,et+Wt*Rt,ut+jt*Rt,x,!0)+2:A+=fe(et,ut,et-Dt*ft,ut-Bt*ft,et-Wt*ft,ut-jt*ft,x,!1)+2;break}}x.push(et-Wt*ft,ut-jt*ft,et+Wt*Rt,ut+jt*Rt),A+=2}}$=n[(b-2)*2],vt=n[(b-2)*2+1],et=n[(b-1)*2],ut=n[(b-1)*2+1],Dt=-(vt-ut),Bt=$-et,ue=Math.sqrt(Dt*Dt+Bt*Bt),Dt/=ue,Bt/=ue,Dt*=M,Bt*=M,x.push(et-Dt*ft,ut-Bt*ft,et+Dt*Rt,ut+Bt*Rt),g||(l.cap===Ve.ROUND?A+=fe(et-Dt*(ft-Rt)*.5,ut-Bt*(ft-Rt)*.5,et-Dt*ft,ut-Bt*ft,et+Dt*Rt,ut+Bt*Rt,x,!1)+2:l.cap===Ve.SQUARE&&(A+=oi(et,ut,Dt,Bt,ft,Rt,!1,x)));const Vt=t.indices,re=ne.epsilon*ne.epsilon;for(let Ht=T;Ht<A+T-2;++Ht)$=x[Ht*2],vt=x[Ht*2+1],et=x[(Ht+1)*2],ut=x[(Ht+1)*2+1],Mt=x[(Ht+2)*2],$t=x[(Ht+2)*2+1],!(Math.abs($*(ut-$t)+et*($t-vt)+Mt*(vt-ut))<re)&&Vt.push(Ht,Ht+1,Ht+2)}function Cr(f,t){let r=0;const n=f.shape,a=f.points||n.points,l=n.type!==d.HS.POLY||n.closeStroke;if(a.length===0)return;const c=t.points,p=t.indices,g=a.length/2,y=c.length/2;let x=y;for(c.push(a[0],a[1]),r=1;r<g;r++)c.push(a[r*2],a[r*2+1]),p.push(x,x+1),x++;l&&p.push(x,y)}function ir(f,t){f.lineStyle.native?Cr(f,t):Sr(f,t)}class Ke{static curveLength(t,r,n,a,l,c){const p=t-2*n+l,g=r-2*a+c,y=2*n-2*t,x=2*a-2*r,b=4*(p*p+g*g),A=4*(p*y+g*x),T=y*y+x*x,M=2*Math.sqrt(b+A+T),O=Math.sqrt(b),K=2*b*O,$=2*Math.sqrt(T),vt=A/O;return(K*M+O*A*(M-$)+(4*T*b-A*A)*Math.log((2*O+vt+M)/(vt+$)))/(4*K)}static curveTo(t,r,n,a,l){const c=l[l.length-2],p=l[l.length-1],g=ne._segmentsCount(Ke.curveLength(c,p,t,r,n,a));let y=0,x=0;for(let b=1;b<=g;++b){const A=b/g;y=c+(t-c)*A,x=p+(r-p)*A,l.push(y+(t+(n-t)*A-y)*A,x+(r+(a-r)*A-x)*A)}}}const Wr={[d.HS.POLY]:as,[d.HS.CIRC]:Hr,[d.HS.ELIP]:Hr,[d.HS.RECT]:Vs,[d.HS.RREC]:lr},wi=[],ur=[];class Si{constructor(t,r=null,n=null,a=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=r,this.matrix=a,this.type=t.type}clone(){return new Si(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}class ge{constructor(){this.reset()}begin(t,r,n){this.reset(),this.style=t,this.start=r,this.attribStart=n}end(t,r){this.attribSize=r-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}const Ne=new d.E9,Ci=class To extends d.JZ{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new yt,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),ur.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const r=this.batches[t];r.reset(),wi.push(r)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,r=null,n=null,a=null){const l=new Si(t,r,n,a);return this.graphicsData.push(l),this.dirty++,this}drawHole(t,r=null){if(!this.graphicsData.length)return null;const n=new Si(t,null,null,r),a=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=a.lineStyle,a.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const r=this.graphicsData;for(let n=0;n<r.length;++n){const a=r[n];if(a.fillStyle.visible&&a.shape&&(a.matrix?a.matrix.applyInverse(t,Ne):Ne.copyFrom(t),a.shape.contains(Ne.x,Ne.y))){let l=!1;if(a.holes){for(let c=0;c<a.holes.length;c++)if(a.holes[c].shape.contains(Ne.x,Ne.y)){l=!0;break}}if(!l)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,r=this.graphicsData;let n=null,a=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],a=n.style);for(let g=this.shapeIndex;g<r.length;g++){this.shapeIndex++;const y=r[g],x=y.fillStyle,b=y.lineStyle;Wr[y.type].build(y),y.matrix&&this.transformPoints(y.points,y.matrix),(x.visible||b.visible)&&this.processHoles(y.holes);for(let A=0;A<2;A++){const T=A===0?x:b;if(!T.visible)continue;const M=T.texture.baseTexture,O=this.indices.length,K=this.points.length/2;M.wrapMode=d.Nt.REPEAT,A===0?this.processFill(y):this.processLine(y);const $=this.points.length/2-K;$!==0&&(n&&!this._compareStyles(a,T)&&(n.end(O,K),n=null),n||(n=wi.pop()||new ge,n.begin(T,O,K),this.batches.push(n),a=T),this.addUvs(this.points,t,T.texture,K,$,T.matrix))}}const l=this.indices.length,c=this.points.length/2;if(n&&n.end(l,c),this.batches.length===0){this.batchable=!0;return}const p=c>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&p===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=p?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,r){return!(!t||!r||t.texture.baseTexture!==r.texture.baseTexture||t.color+t.alpha!==r.color+r.alpha||!!t.native!=!!r.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,r=this.graphicsData.length;t<r;t++){const n=this.graphicsData[t],a=n.fillStyle,l=n.lineStyle;if(a&&!a.texture.baseTexture.valid||l&&!l.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let r=0,n=t.length;r<n;r++){const a=t[r];for(let l=0;l<a.size;l++){const c=a.start+l;this.indicesUint16[c]=this.indicesUint16[c]-a.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const t=this.batches;for(let r=0;r<t.length;r++)if(t[r].style.native)return!1;return this.points.length<To.BATCHABLE_SIZE*2}buildDrawCalls(){let t=++d.VL._globalBatch;for(let b=0;b<this.drawCalls.length;b++)this.drawCalls[b].texArray.clear(),ur.push(this.drawCalls[b]);this.drawCalls.length=0;const r=this.colors,n=this.textureIds;let a=ur.pop();a||(a=new d.a$,a.texArray=new d.Ie),a.texArray.count=0,a.start=0,a.size=0,a.type=d.lg.TRIANGLES;let l=0,c=null,p=0,g=!1,y=d.lg.TRIANGLES,x=0;this.drawCalls.push(a);for(let b=0;b<this.batches.length;b++){const A=this.batches[b],T=8,M=A.style,O=M.texture.baseTexture;g!==!!M.native&&(g=!!M.native,y=g?d.lg.LINES:d.lg.TRIANGLES,c=null,l=T,t++),c!==O&&(c=O,O._batchEnabled!==t&&(l===T&&(t++,l=0,a.size>0&&(a=ur.pop(),a||(a=new d.a$,a.texArray=new d.Ie),this.drawCalls.push(a)),a.start=x,a.size=0,a.texArray.count=0,a.type=y),O.touched=1,O._batchEnabled=t,O._batchLocation=l,O.wrapMode=d.Nt.REPEAT,a.texArray.elements[a.texArray.count++]=O,l++)),a.size+=A.size,x+=A.size,p=O._batchLocation,this.addColors(r,M.color,M.alpha,A.attribSize,A.attribStart),this.addTextureIds(n,p,A.attribSize,A.attribStart)}d.VL._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,r=this.uvs,n=this.colors,a=this.textureIds,l=new ArrayBuffer(t.length*3*4),c=new Float32Array(l),p=new Uint32Array(l);let g=0;for(let y=0;y<t.length/2;y++)c[g++]=t[y*2],c[g++]=t[y*2+1],c[g++]=r[y*2],c[g++]=r[y*2+1],p[g++]=n[y],c[g++]=a[y];this._buffer.update(l),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?as.triangulate(t,this):Wr[t.type].triangulate(t,this)}processLine(t){ir(t,this);for(let r=0;r<t.holes.length;r++)ir(t.holes[r],this)}processHoles(t){for(let r=0;r<t.length;r++){const n=t[r];Wr[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,r){for(let n=0;n<t.length/2;n++){const a=t[n*2],l=t[n*2+1];t[n*2]=r.a*a+r.c*l+r.tx,t[n*2+1]=r.b*a+r.d*l+r.ty}}addColors(t,r,n,a,l=0){const c=d.Il.shared.setValue(r).toLittleEndianNumber(),p=d.Il.shared.setValue(c).toPremultiplied(n);t.length=Math.max(t.length,l+a);for(let g=0;g<a;g++)t[l+g]=p}addTextureIds(t,r,n,a=0){t.length=Math.max(t.length,a+n);for(let l=0;l<n;l++)t[a+l]=r}addUvs(t,r,n,a,l,c=null){let p=0;const g=r.length,y=n.frame;for(;p<l;){let b=t[(a+p)*2],A=t[(a+p)*2+1];if(c){const T=c.a*b+c.c*A+c.tx;A=c.b*b+c.d*A+c.ty,b=T}p++,r.push(b/y.width,A/y.height)}const x=n.baseTexture;(y.width<x.width||y.height<x.height)&&this.adjustUvs(r,n,g,l)}adjustUvs(t,r,n,a){const l=r.baseTexture,c=1e-6,p=n+a*2,g=r.frame,y=g.width/l.width,x=g.height/l.height;let b=g.x/g.width,A=g.y/g.height,T=Math.floor(t[n]+c),M=Math.floor(t[n+1]+c);for(let O=n+2;O<p;O+=2)T=Math.min(T,Math.floor(t[O]+c)),M=Math.min(M,Math.floor(t[O+1]+c));b-=T,A-=M;for(let O=n;O<p;O+=2)t[O]=(t[O]+b)*y,t[O+1]=(t[O+1]+A)*x}};Ci.BATCHABLE_SIZE=100;let ls=Ci;class Ii{constructor(){this.color=16777215,this.alpha=1,this.texture=d.xE.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new Ii;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=d.xE.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class us extends Ii{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Ve.BUTT,this.join=le.MITER,this.miterLimit=10}clone(){const t=new us;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Ve.BUTT,this.join=le.MITER,this.miterLimit=10}}const cr={},cs=class Sn extends J{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Ii,this._lineStyle=new us,this._matrix=null,this._holeMode=!1,this.state=d.ZM.for2d(),this._geometry=t||new ls,this._geometry.refCount++,this._transformID=-1,this._tintColor=new d.Il(16777215),this.blendMode=d.T$.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Sn(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,r=0,n,a=.5,l=!1){return typeof t=="number"&&(t={width:t,color:r,alpha:n,alignment:a,native:l}),this.lineTextureStyle(t)}lineTextureStyle(t){const r={width:0,texture:d.xE.WHITE,color:t!=null&&t.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Ve.BUTT,join:le.MITER,miterLimit:10};t=Object.assign(r,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const n=t.width>0&&t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:n},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new d.mg,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[r-2],t[r-1]))}else this.currentPath=new d.mg,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,r){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=r,this}lineTo(t,r){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,a=n[n.length-2],l=n[n.length-1];return(a!==t||l!==r)&&n.push(t,r),this}_initCurve(t=0,r=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,r]):this.moveTo(t,r)}quadraticCurveTo(t,r,n,a){this._initCurve();const l=this.currentPath.points;return l.length===0&&this.moveTo(0,0),Ke.curveTo(t,r,n,a,l),this}bezierCurveTo(t,r,n,a,l,c){return this._initCurve(),wr.curveTo(t,r,n,a,l,c,this.currentPath.points),this}arcTo(t,r,n,a,l){this._initCurve(t,r);const c=this.currentPath.points,p=Xr.curveTo(t,r,n,a,l,c);if(p){const{cx:g,cy:y,radius:x,startAngle:b,endAngle:A,anticlockwise:T}=p;this.arc(g,y,x,b,A,T)}return this}arc(t,r,n,a,l,c=!1){if(a===l)return this;if(!c&&l<=a?l+=d._b:c&&a<=l&&(a+=d._b),l-a===0)return this;const p=t+Math.cos(a)*n,g=r+Math.sin(a)*n,y=this._geometry.closePointEps;let x=this.currentPath?this.currentPath.points:null;if(x){const b=Math.abs(x[x.length-2]-p),A=Math.abs(x[x.length-1]-g);b<y&&A<y||x.push(p,g)}else this.moveTo(p,g),x=this.currentPath.points;return Xr.arc(p,g,t,r,n,a,l,c,x),this}beginFill(t=0,r){return this.beginTextureFill({texture:d.xE.WHITE,color:t,alpha:r})}normalizeColor(t){var n,a;const r=d.Il.shared.setValue((n=t.color)!=null?n:0);t.color=r.toNumber(),(a=t.alpha)!=null||(t.alpha=r.alpha)}beginTextureFill(t){const r={texture:d.xE.WHITE,color:16777215,matrix:null};t=Object.assign(r,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const n=t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:n},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,r,n,a){return this.drawShape(new d.Ae(t,r,n,a))}drawRoundedRect(t,r,n,a,l){return this.drawShape(new d.c9(t,r,n,a,l))}drawCircle(t,r,n){return this.drawShape(new d.Cd(t,r,n))}drawEllipse(t,r,n,a){return this.drawShape(new d.Pj(t,r,n,a))}drawPolygon(...t){let r,n=!0;const a=t[0];a.points?(n=a.closeStroke,r=a.points):Array.isArray(t[0])?r=t[0]:r=t;const l=new d.mg(r);return l.closeStroke=n,this.drawShape(l),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===d.HS.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const r=this._geometry;r.updateBatches(),r.batchable?(this.batchDirty!==r.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,r=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(let a=0;a<n;a++){const l=t.batches[a],c=l.style.color,p=new Float32Array(this.vertexData.buffer,l.attribStart*4*2,l.attribSize*2),g=new Float32Array(t.uvsFloat32.buffer,l.attribStart*4*2,l.attribSize*2),y=new Uint16Array(t.indicesUint16.buffer,l.start*2,l.size),x={vertexData:p,blendMode:r,indices:y,uvs:g,_batchRGB:d.Il.shared.setValue(c).toRgbArray(),_tintRGB:c,_texture:l.style.texture,alpha:l.style.alpha,worldAlpha:1};this.batches[a]=x}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let r=0,n=this.batches.length;r<n;r++){const a=this.batches[r];a.worldAlpha=this.worldAlpha*a.alpha,t.plugins[this.pluginName].render(a)}}}_renderDirect(t){const r=this._resolveDirectShader(t),n=this._geometry,a=this.worldAlpha,l=r.uniforms,c=n.drawCalls;l.translationMatrix=this.transform.worldTransform,d.Il.shared.setValue(this._tintColor).premultiply(a).toArray(l.tint),t.shader.bind(r),t.geometry.bind(n,r),t.state.set(this.state);for(let p=0,g=c.length;p<g;p++)this._renderDrawCallDirect(t,n.drawCalls[p])}_renderDrawCallDirect(t,r){const{texArray:n,type:a,size:l,start:c}=r,p=n.count;for(let g=0;g<p;g++)t.texture.bind(n.elements[g],g);t.geometry.draw(a,l,c)}_resolveDirectShader(t){let r=this.shader;const n=this.pluginName;if(!r){if(!cr[n]){const{maxTextures:a}=t.plugins[n],l=new Int32Array(a);for(let g=0;g<a;g++)l[g]=g;const c={tint:new Float32Array([1,1,1,1]),translationMatrix:new d.y3,default:d.oo.from({uSamplers:l},!0)},p=t.plugins[n]._shader.program;cr[n]=new d.ex(p,c)}r=cr[n]}return r}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:r,minY:n,maxX:a,maxY:l}=t.bounds;this._bounds.addFrame(this.transform,r,n,a,l)}containsPoint(t){return this.worldTransform.applyInverse(t,Sn._TEMP_POINT),this._geometry.containsPoint(Sn._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const r=this.batches[t];r._tintRGB=d.Il.shared.setValue(this._tintColor).multiply(r._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const r=this.transform.worldTransform,n=r.a,a=r.b,l=r.c,c=r.d,p=r.tx,g=r.ty,y=this._geometry.points,x=this.vertexData;let b=0;for(let A=0;A<y.length;A+=2){const T=y[A],M=y[A+1];x[b++]=n*T+l*M+p,x[b++]=c*M+a*T+g}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};cs.curves=ne,cs._TEMP_POINT=new d.E9;let ds=cs;const ho={buildPoly:as,buildCircle:Hr,buildRectangle:Vs,buildRoundedRectangle:lr,buildLine:ir,ArcUtils:Xr,BezierUtils:wr,QuadraticUtils:Ke,BatchPart:ge,FILL_COMMANDS:Wr,BATCH_POOL:wi,DRAW_CALL_POOL:ur};class zs{constructor(t,r){this.uvBuffer=t,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}}const dr=new d.E9,$s=new d.mg,ai=class Ao extends J{constructor(t,r,n,a=d.lg.TRIANGLES){super(),this.geometry=t,this.shader=r,this.state=n||d.ZM.for2d(),this.drawMode=a,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=d.Xd.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===d.lg.TRIANGLES&&r.length<Ao.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const r=this.shader;r.alpha=this.worldAlpha,r.update&&r.update(),t.batch.flush(),r.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(r),t.state.set(this.state),t.geometry.bind(this.geometry,r),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const r=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=r.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const a=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[a]),t.plugins[a].render(this)}calculateVertices(){const t=this.geometry.buffers[0],r=t.data,n=t._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));const a=this.transform.worldTransform,l=a.a,c=a.b,p=a.c,g=a.d,y=a.tx,x=a.ty,b=this.vertexData;for(let A=0;A<b.length/2;A++){const T=r[A*2],M=r[A*2+1];b[A*2]=l*T+p*M+y,b[A*2+1]=c*T+g*M+x}if(this._roundPixels){const A=d.Xd.RESOLUTION;for(let T=0;T<b.length;++T)b[T]=Math.round(b[T]*A)/A}this.vertexDirty=n}calculateUvs(){const t=this.geometry.buffers[1],r=this.shader;r.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new zs(t,r.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,dr);const r=this.geometry.getBuffer("aVertexPosition").data,n=$s.points,a=this.geometry.getIndex().data,l=a.length,c=this.drawMode===4?3:1;for(let p=0;p+2<l;p+=c){const g=a[p]*2,y=a[p+1]*2,x=a[p+2]*2;if(n[0]=r[g],n[1]=r[g+1],n[2]=r[y],n[3]=r[y+1],n[4]=r[x],n[5]=r[x+1],$s.contains(dr.x,dr.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};ai.BATCHABLE_SIZE=100;let js=ai;class Vn extends d.wG{constructor(t,r,n){super();const a=new d.lW(t),l=new d.lW(r,!0),c=new d.lW(n,!0,!0);this.addAttribute("aVertexPosition",a,2,!1,d.vK.FLOAT).addAttribute("aTextureCoord",l,2,!1,d.vK.FLOAT).addIndex(c),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var Ys=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,Pi=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class fs extends d.ex{constructor(t,r){const n={uSampler:t,alpha:1,uTextureMatrix:d.y3.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(n,r.uniforms),super(r.program||d.$r.from(Pi,Ys),n),this._colorDirty=!1,this.uvMatrix=new d.UX(t),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new d.Il(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;d.Il.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class zn extends null{constructor(t=100,r=100,n=10,a=10){super(),this.segWidth=n,this.segHeight=a,this.width=t,this.height=r,this.build()}build(){const t=this.segWidth*this.segHeight,r=[],n=[],a=[],l=this.segWidth-1,c=this.segHeight-1,p=this.width/l,g=this.height/c;for(let x=0;x<t;x++){const b=x%this.segWidth,A=x/this.segWidth|0;r.push(b*p,A*g),n.push(b/l,A/c)}const y=l*c;for(let x=0;x<y;x++){const b=x%l,A=x/l|0,T=A*this.segWidth+b,M=A*this.segWidth+b+1,O=(A+1)*this.segWidth+b,K=(A+1)*this.segWidth+b+1;a.push(T,M,O,M,K,O)}this.buffers[0].data=new Float32Array(r),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(a),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class $n extends null{constructor(t=200,r,n=0){super(new Float32Array(r.length*4),new Float32Array(r.length*4),new Uint16Array((r.length-1)*6)),this.points=r,this._width=t,this.textureScale=n,this.build()}get width(){return this._width}build(){const t=this.points;if(!t)return;const r=this.getBuffer("aVertexPosition"),n=this.getBuffer("aTextureCoord"),a=this.getIndex();if(t.length<1)return;r.data.length/4!==t.length&&(r.data=new Float32Array(t.length*4),n.data=new Float32Array(t.length*4),a.data=new Uint16Array((t.length-1)*6));const l=n.data,c=a.data;l[0]=0,l[1]=0,l[2]=0,l[3]=1;let p=0,g=t[0];const y=this._width*this.textureScale,x=t.length;for(let A=0;A<x;A++){const T=A*4;if(this.textureScale>0){const M=g.x-t[A].x,O=g.y-t[A].y,K=Math.sqrt(M*M+O*O);g=t[A],p+=K/y}else p=A/(x-1);l[T]=p,l[T+1]=0,l[T+2]=p,l[T+3]=1}let b=0;for(let A=0;A<x-1;A++){const T=A*2;c[b++]=T,c[b++]=T+1,c[b++]=T+2,c[b++]=T+2,c[b++]=T+1,c[b++]=T+3}n.update(),a.update(),this.updateVertices()}updateVertices(){const t=this.points;if(t.length<1)return;let r=t[0],n,a=0,l=0;const c=this.buffers[0].data,p=t.length,g=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let y=0;y<p;y++){const x=t[y],b=y*4;y<t.length-1?n=t[y+1]:n=x,l=-(n.x-r.x),a=n.y-r.y;let A=(1-y/(p-1))*10;A>1&&(A=1);const T=Math.sqrt(a*a+l*l);T<1e-6?(a=0,l=0):(a/=T,l/=T,a*=g,l*=g),c[b]=x.x+a,c[b+1]=x.y+l,c[b+2]=x.x-a,c[b+3]=x.y-l,r=x}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class lo extends null{constructor(t,r,n){const a=new PlaneGeometry(t.width,t.height,r,n),l=new MeshMaterial(Texture.WHITE);super(a,l),this.texture=t,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const t=this.geometry,{width:r,height:n}=this.shader.texture;this.autoResize&&(t.width!==r||t.height!==n)&&(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())}set texture(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(t)}destroy(t){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(t)}}const Ir=10;class Ks extends null{constructor(t,r,n,a,l){var c,p,g,y,x,b,A,T;super(Texture.WHITE,4,4),this._origWidth=t.orig.width,this._origHeight=t.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=(p=r!=null?r:(c=t.defaultBorders)==null?void 0:c.left)!=null?p:Ir,this._rightWidth=(y=a!=null?a:(g=t.defaultBorders)==null?void 0:g.right)!=null?y:Ir,this._topHeight=(b=n!=null?n:(x=t.defaultBorders)==null?void 0:x.top)!=null?b:Ir,this._bottomHeight=(T=l!=null?l:(A=t.defaultBorders)==null?void 0:A.bottom)!=null?T:Ir,this.texture=t}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}updateHorizontalVertices(){const t=this.vertices,r=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*r,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*r,t[25]=t[27]=t[29]=t[31]=this._height}updateVerticalVertices(){const t=this.vertices,r=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*r,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*r,t[6]=t[14]=t[22]=t[30]=this._width}_getMinScale(){const t=this._leftWidth+this._rightWidth,r=this._width>t?1:this._width/t,n=this._topHeight+this._bottomHeight,a=this._height>n?1:this._height/n;return Math.min(r,a)}get width(){return this._width}set width(t){this._width=t,this._refresh()}get height(){return this._height}set height(t){this._height=t,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this._refresh()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this._refresh()}_refresh(){const t=this.texture,r=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;const n=1/this._origWidth,a=1/this._origHeight;r[0]=r[8]=r[16]=r[24]=0,r[1]=r[3]=r[5]=r[7]=0,r[6]=r[14]=r[22]=r[30]=1,r[25]=r[27]=r[29]=r[31]=1,r[2]=r[10]=r[18]=r[26]=n*this._leftWidth,r[4]=r[12]=r[20]=r[28]=1-n*this._rightWidth,r[9]=r[11]=r[13]=r[15]=a*this._topHeight,r[17]=r[19]=r[21]=r[23]=1-a*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class Pr extends null{constructor(t=Texture.EMPTY,r,n,a,l){const c=new MeshGeometry(r,n,a);c.getBuffer("aVertexPosition").static=!1;const p=new MeshMaterial(t);super(c,p,null,l),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}class uo extends null{constructor(t,r,n=0){const a=new RopeGeometry(t.height,r,n),l=new MeshMaterial(t);n>0&&(t.baseTexture.wrapMode=WRAP_MODES.REPEAT),super(a,l),this.autoUpdate=!0}_render(t){const r=this.geometry;(this.autoUpdate||r._width!==this.shader.texture.height)&&(r._width=this.shader.texture.height,r.update()),super._render(t)}}class qe extends null{constructor(t=1500,r,n=16384,a=!1){super();const l=16384;n>l&&(n=l),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=n,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=BLEND_MODES.NORMAL,this.autoResize=a,this.roundPixels=!0,this.baseTexture=null,this.setProperties(r),this._tintColor=new Color(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintColor.toRgbArray(this.tintRgb)}render(t){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",()=>this.onChildrenChange(0))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))}onChildrenChange(t){const r=Math.floor(t/this._batchSize);for(;this._bufferUpdateIDs.length<r;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[r]=++this._updateID}dispose(){if(this._buffers){for(let t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}}destroy(t){super.destroy(t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class Vr{constructor(t,r,n){this.geometry=new d.wG,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let a=0;a<t.length;++a){let l=t[a];l={attributeName:l.attributeName,size:l.size,uploadFunction:l.uploadFunction,type:l.type||d.vK.FLOAT,offset:l.offset},r[a]?this.dynamicProperties.push(l):this.staticProperties.push(l)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let r=0;this.indexBuffer=new d.lW(d.P6.createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let c=0;c<this.dynamicProperties.length;++c){const p=this.dynamicProperties[c];p.offset=r,r+=p.size,this.dynamicStride+=p.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new d.lW(this.dynamicData,!1,!1);let a=0;this.staticStride=0;for(let c=0;c<this.staticProperties.length;++c){const p=this.staticProperties[c];p.offset=a,a+=p.size,this.staticStride+=p.size}const l=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(l),this.staticDataUint32=new Uint32Array(l),this.staticBuffer=new d.lW(this.staticData,!0,!1);for(let c=0;c<this.dynamicProperties.length;++c){const p=this.dynamicProperties[c];t.addAttribute(p.attributeName,this.dynamicBuffer,0,p.type===d.vK.UNSIGNED_BYTE,p.type,this.dynamicStride*4,p.offset*4)}for(let c=0;c<this.staticProperties.length;++c){const p=this.staticProperties[c];t.addAttribute(p.attributeName,this.staticBuffer,0,p.type===d.vK.UNSIGNED_BYTE,p.type,this.staticStride*4,p.offset*4)}}uploadDynamic(t,r,n){for(let a=0;a<this.dynamicProperties.length;a++){const l=this.dynamicProperties[a];l.uploadFunction(t,r,n,l.type===d.vK.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,l.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,r,n){for(let a=0;a<this.staticProperties.length;a++){const l=this.staticProperties[a];l.uploadFunction(t,r,n,l.type===d.vK.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,l.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var jn=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,qs=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class Zs extends d.bO{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new d.y3,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:d.vK.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=d.ex.from(qs,jn,{}),this.state=d.ZM.for2d()}render(t){const r=t.children,n=t._maxSize,a=t._batchSize,l=this.renderer;let c=r.length;if(c===0)return;c>n&&!t.autoResize&&(c=n);let p=t._buffers;p||(p=t._buffers=this.generateBuffers(t));const g=r[0]._texture.baseTexture,y=g.alphaMode>0;this.state.blendMode=d.P6.correctBlendMode(t.blendMode,y),l.state.set(this.state);const x=l.gl,b=t.worldTransform.copyTo(this.tempMatrix);b.prepend(l.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=b.toArray(!0),this.shader.uniforms.uColor=d.Il.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,y).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=g,this.renderer.shader.bind(this.shader);let A=!1;for(let T=0,M=0;T<c;T+=a,M+=1){let O=c-T;O>a&&(O=a),M>=p.length&&p.push(this._generateOneMoreBuffer(t));const K=p[M];K.uploadDynamic(r,T,O);const $=t._bufferUpdateIDs[M]||0;A=A||K._updateID<$,A&&(K._updateID=t._updateID,K.uploadStatic(r,T,O)),l.geometry.bind(K.geometry),x.drawElements(x.TRIANGLES,O*6,x.UNSIGNED_SHORT,0)}}generateBuffers(t){const r=[],n=t._maxSize,a=t._batchSize,l=t._properties;for(let c=0;c<n;c+=a)r.push(new Vr(this.properties,l,a));return r}_generateOneMoreBuffer(t){const r=t._batchSize,n=t._properties;return new Vr(this.properties,n,r)}uploadVertices(t,r,n,a,l,c){let p=0,g=0,y=0,x=0;for(let b=0;b<n;++b){const A=t[r+b],T=A._texture,M=A.scale.x,O=A.scale.y,K=T.trim,$=T.orig;K?(g=K.x-A.anchor.x*$.width,p=g+K.width,x=K.y-A.anchor.y*$.height,y=x+K.height):(p=$.width*(1-A.anchor.x),g=$.width*-A.anchor.x,y=$.height*(1-A.anchor.y),x=$.height*-A.anchor.y),a[c]=g*M,a[c+1]=x*O,a[c+l]=p*M,a[c+l+1]=x*O,a[c+l*2]=p*M,a[c+l*2+1]=y*O,a[c+l*3]=g*M,a[c+l*3+1]=y*O,c+=l*4}}uploadPosition(t,r,n,a,l,c){for(let p=0;p<n;p++){const g=t[r+p].position;a[c]=g.x,a[c+1]=g.y,a[c+l]=g.x,a[c+l+1]=g.y,a[c+l*2]=g.x,a[c+l*2+1]=g.y,a[c+l*3]=g.x,a[c+l*3+1]=g.y,c+=l*4}}uploadRotation(t,r,n,a,l,c){for(let p=0;p<n;p++){const g=t[r+p].rotation;a[c]=g,a[c+l]=g,a[c+l*2]=g,a[c+l*3]=g,c+=l*4}}uploadUvs(t,r,n,a,l,c){for(let p=0;p<n;++p){const g=t[r+p]._texture._uvs;g?(a[c]=g.x0,a[c+1]=g.y0,a[c+l]=g.x1,a[c+l+1]=g.y1,a[c+l*2]=g.x2,a[c+l*2+1]=g.y2,a[c+l*3]=g.x3,a[c+l*3+1]=g.y3,c+=l*4):(a[c]=0,a[c+1]=0,a[c+l]=0,a[c+l+1]=0,a[c+l*2]=0,a[c+l*2+1]=0,a[c+l*3]=0,a[c+l*3+1]=0,c+=l*4)}}uploadTint(t,r,n,a,l,c){for(let p=0;p<n;++p){const g=t[r+p],y=d.Il.shared.setValue(g._tintRGB).toPremultiplied(g.alpha,g.texture.baseTexture.alphaMode>0);a[c]=y,a[c+l]=y,a[c+l*2]=y,a[c+l*3]=y,c+=l*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Zs.extension={name:"particle",type:d.nw.RendererPlugin},d.Rw.add(Zs);var Ri=(f=>(f[f.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",f[f.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",f))(Ri||{});const zr={willReadFrequently:!0},Ze=class Gt{static get experimentalLetterSpacingSupported(){let t=Gt._experimentalLetterSpacingSupported;if(t!==void 0){const r=d.Xd.ADAPTER.getCanvasRenderingContext2D().prototype;t=Gt._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return t}constructor(t,r,n,a,l,c,p,g,y){this.text=t,this.style=r,this.width=n,this.height=a,this.lines=l,this.lineWidths=c,this.lineHeight=p,this.maxLineWidth=g,this.fontProperties=y}static measureText(t,r,n,a=Gt._canvas){n=n!=null?n:r.wordWrap;const l=r.toFontString(),c=Gt.measureFont(l);c.fontSize===0&&(c.fontSize=r.fontSize,c.ascent=r.fontSize);const p=a.getContext("2d",zr);p.font=l;const g=(n?Gt.wordWrap(t,r,a):t).split(/(?:\r\n|\r|\n)/),y=new Array(g.length);let x=0;for(let M=0;M<g.length;M++){const O=Gt._measureText(g[M],r.letterSpacing,p);y[M]=O,x=Math.max(x,O)}let b=x+r.strokeThickness;r.dropShadow&&(b+=r.dropShadowDistance);const A=r.lineHeight||c.fontSize+r.strokeThickness;let T=Math.max(A,c.fontSize+r.strokeThickness*2)+r.leading+(g.length-1)*(A+r.leading);return r.dropShadow&&(T+=r.dropShadowDistance),new Gt(t,r,b,T,g,y,A+r.leading,x,c)}static _measureText(t,r,n){let a=!1;Gt.experimentalLetterSpacingSupported&&(Gt.experimentalLetterSpacing?(n.letterSpacing=`${r}px`,n.textLetterSpacing=`${r}px`,a=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let l=n.measureText(t).width;return l>0&&(a?l-=r:l+=(Gt.graphemeSegmenter(t).length-1)*r),l}static wordWrap(t,r,n=Gt._canvas){const a=n.getContext("2d",zr);let l=0,c="",p="";const g=Object.create(null),{letterSpacing:y,whiteSpace:x}=r,b=Gt.collapseSpaces(x),A=Gt.collapseNewlines(x);let T=!b;const M=r.wordWrapWidth+y,O=Gt.tokenize(t);for(let K=0;K<O.length;K++){let $=O[K];if(Gt.isNewline($)){if(!A){p+=Gt.addLine(c),T=!b,c="",l=0;continue}$=" "}if(b){const et=Gt.isBreakingSpace($),ut=Gt.isBreakingSpace(c[c.length-1]);if(et&&ut)continue}const vt=Gt.getFromCache($,y,g,a);if(vt>M)if(c!==""&&(p+=Gt.addLine(c),c="",l=0),Gt.canBreakWords($,r.breakWords)){const et=Gt.wordWrapSplit($);for(let ut=0;ut<et.length;ut++){let Mt=et[ut],$t=Mt,Dt=1;for(;et[ut+Dt];){const Wt=et[ut+Dt];if(!Gt.canBreakChars($t,Wt,$,ut,r.breakWords))Mt+=Wt;else break;$t=Wt,Dt++}ut+=Dt-1;const Bt=Gt.getFromCache(Mt,y,g,a);Bt+l>M&&(p+=Gt.addLine(c),T=!1,c="",l=0),c+=Mt,l+=Bt}}else{c.length>0&&(p+=Gt.addLine(c),c="",l=0);const et=K===O.length-1;p+=Gt.addLine($,!et),T=!1,c="",l=0}else vt+l>M&&(T=!1,p+=Gt.addLine(c),c="",l=0),(c.length>0||!Gt.isBreakingSpace($)||T)&&(c+=$,l+=vt)}return p+=Gt.addLine(c,!1),p}static addLine(t,r=!0){return t=Gt.trimRight(t),t=r?`${t}
`:t,t}static getFromCache(t,r,n,a){let l=n[t];return typeof l!="number"&&(l=Gt._measureText(t,r,a)+r,n[t]=l),l}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let r=t.length-1;r>=0;r--){const n=t[r];if(!Gt.isBreakingSpace(n))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:Gt._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,r){return typeof t!="string"?!1:Gt._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const r=[];let n="";if(typeof t!="string")return r;for(let a=0;a<t.length;a++){const l=t[a],c=t[a+1];if(Gt.isBreakingSpace(l,c)||Gt.isNewline(l)){n!==""&&(r.push(n),n=""),r.push(l);continue}n+=l}return n!==""&&r.push(n),r}static canBreakWords(t,r){return r}static canBreakChars(t,r,n,a,l){return!0}static wordWrapSplit(t){return Gt.graphemeSegmenter(t)}static measureFont(t){if(Gt._fonts[t])return Gt._fonts[t];const r={ascent:0,descent:0,fontSize:0},n=Gt._canvas,a=Gt._context;a.font=t;const l=Gt.METRICS_STRING+Gt.BASELINE_SYMBOL,c=Math.ceil(a.measureText(l).width);let p=Math.ceil(a.measureText(Gt.BASELINE_SYMBOL).width);const g=Math.ceil(Gt.HEIGHT_MULTIPLIER*p);if(p=p*Gt.BASELINE_MULTIPLIER|0,c===0||g===0)return Gt._fonts[t]=r,r;n.width=c,n.height=g,a.fillStyle="#f00",a.fillRect(0,0,c,g),a.font=t,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText(l,0,p);const y=a.getImageData(0,0,c,g).data,x=y.length,b=c*4;let A=0,T=0,M=!1;for(A=0;A<p;++A){for(let O=0;O<b;O+=4)if(y[T+O]!==255){M=!0;break}if(!M)T+=b;else break}for(r.ascent=p-A,T=x-b,M=!1,A=g;A>p;--A){for(let O=0;O<b;O+=4)if(y[T+O]!==255){M=!0;break}if(!M)T-=b;else break}return r.descent=A-p,r.fontSize=r.ascent+r.descent,Gt._fonts[t]=r,r}static clearMetrics(t=""){t?delete Gt._fonts[t]:Gt._fonts={}}static get _canvas(){var t;if(!Gt.__canvas){let r;try{const n=new OffscreenCanvas(0,0);if((t=n.getContext("2d",zr))!=null&&t.measureText)return Gt.__canvas=n,n;r=d.Xd.ADAPTER.createCanvas()}catch(n){r=d.Xd.ADAPTER.createCanvas()}r.width=r.height=10,Gt.__canvas=r}return Gt.__canvas}static get _context(){return Gt.__context||(Gt.__context=Gt._canvas.getContext("2d",zr)),Gt.__context}};Ze.METRICS_STRING="|\xC9q\xC5",Ze.BASELINE_SYMBOL="M",Ze.BASELINE_MULTIPLIER=1.4,Ze.HEIGHT_MULTIPLIER=2,Ze.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const f=new Intl.Segmenter;return t=>[...f.segment(t)].map(r=>r.segment)}return f=>[...f]})(),Ze.experimentalLetterSpacing=!1,Ze._fonts={},Ze._newlines=[10,13],Ze._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let fr=Ze;const hi=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],pr=class Ds{constructor(t){this.styleID=0,this.reset(),sr(this,t,t)}clone(){const t={};return sr(t,this,Ds.defaultStyle),new Ds(t)}reset(){sr(this,Ds.defaultStyle,Ds.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const r=ps(t);this._dropShadowColor!==r&&(this._dropShadowColor=r,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const r=ps(t);this._fill!==r&&(this._fill=r,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){ms(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const r=ps(t);this._stroke!==r&&(this._stroke=r,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let r=this.fontFamily;Array.isArray(this.fontFamily)||(r=this.fontFamily.split(","));for(let n=r.length-1;n>=0;n--){let a=r[n].trim();!/([\"\'])[^\'\"]+\1/.test(a)&&!hi.includes(a)&&(a=`"${a}"`),r[n]=a}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${r.join(",")}`}};pr.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Ri.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let mr=pr;function ps(f){const t=d.Il.shared,r=n=>{const a=t.setValue(n);return a.alpha===1?a.toHex():a.toRgbaString()};return Array.isArray(f)?f.map(r):r(f)}function ms(f,t){if(!Array.isArray(f)||!Array.isArray(t)||f.length!==t.length)return!1;for(let r=0;r<f.length;++r)if(f[r]!==t[r])return!1;return!0}function sr(f,t,r){for(const n in r)Array.isArray(t[n])?f[n]=t[n].slice():f[n]=t[n]}const Mi={texture:!0,children:!1,baseTexture:!0},gs=class ao extends z{constructor(t,r,n){var c;let a=!1;n||(n=d.Xd.ADAPTER.createCanvas(),a=!0),n.width=3,n.height=3;const l=d.xE.from(n);l.orig=new d.Ae,l.trim=new d.Ae,super(l),this._ownCanvas=a,this.canvas=n,this.context=n.getContext("2d",{willReadFrequently:!0}),this._resolution=(c=ao.defaultResolution)!=null?c:d.Xd.RESOLUTION,this._autoResolution=ao.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=r,this.localStyleID=-1}static get experimentalLetterSpacing(){return fr.experimentalLetterSpacing}static set experimentalLetterSpacing(t){d.P6.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),fr.experimentalLetterSpacing=t}updateText(t){const r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const n=this.context,a=fr.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),l=a.width,c=a.height,p=a.lines,g=a.lineHeight,y=a.lineWidths,x=a.maxLineWidth,b=a.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,l)+r.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,c)+r.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=r.strokeThickness,n.textBaseline=r.textBaseline,n.lineJoin=r.lineJoin,n.miterLimit=r.miterLimit;let A,T;const M=r.dropShadow?2:1;for(let O=0;O<M;++O){const K=r.dropShadow&&O===0,$=K?Math.ceil(Math.max(1,c)+r.padding*2):0,vt=$*this._resolution;if(K){n.fillStyle="black",n.strokeStyle="black";const ut=r.dropShadowColor,Mt=r.dropShadowBlur*this._resolution,$t=r.dropShadowDistance*this._resolution;n.shadowColor=d.Il.shared.setValue(ut).setAlpha(r.dropShadowAlpha).toRgbaString(),n.shadowBlur=Mt,n.shadowOffsetX=Math.cos(r.dropShadowAngle)*$t,n.shadowOffsetY=Math.sin(r.dropShadowAngle)*$t+vt}else n.fillStyle=this._generateFillStyle(r,p,a),n.strokeStyle=r.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let et=(g-b.fontSize)/2;g-b.fontSize<0&&(et=0);for(let ut=0;ut<p.length;ut++)A=r.strokeThickness/2,T=r.strokeThickness/2+ut*g+b.ascent+et,r.align==="right"?A+=x-y[ut]:r.align==="center"&&(A+=(x-y[ut])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(p[ut],A+r.padding,T+r.padding-$,!0),r.fill&&this.drawLetterSpacing(p[ut],A+r.padding,T+r.padding-$)}this.updateTexture()}drawLetterSpacing(t,r,n,a=!1){const l=this._style.letterSpacing;let c=!1;if(fr.experimentalLetterSpacingSupported&&(fr.experimentalLetterSpacing?(this.context.letterSpacing=`${l}px`,this.context.textLetterSpacing=`${l}px`,c=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),l===0||c){a?this.context.strokeText(t,r,n):this.context.fillText(t,r,n);return}let p=r;const g=fr.graphemeSegmenter(t);let y=this.context.measureText(t).width,x=0;for(let b=0;b<g.length;++b){const A=g[b];a?this.context.strokeText(A,p,n):this.context.fillText(A,p,n);let T="";for(let M=b+1;M<g.length;++M)T+=g[M];x=this.context.measureText(T).width,p+=y-x+l,y=x}}updateTexture(){const t=this.canvas;if(this._style.trim){const c=d.P6.trimCanvas(t);c.data&&(t.width=c.width,t.height=c.height,this.context.putImageData(c.data,0,0))}const r=this._texture,n=this._style,a=n.trim?0:n.padding,l=r.baseTexture;r.trim.width=r._frame.width=t.width/this._resolution,r.trim.height=r._frame.height=t.height/this._resolution,r.trim.x=-a,r.trim.y=-a,r.orig.width=r._frame.width-a*2,r.orig.height=r._frame.height-a*2,this._onTextureUpdate(),l.setRealSize(t.width,t.height,this._resolution),r.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,r){return this.updateText(!0),this._textureID===-1&&(t=!1),super.getBounds(t,r)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,r,n){const a=t.fill;if(Array.isArray(a)){if(a.length===1)return a[0]}else return a;let l;const c=t.dropShadow?t.dropShadowDistance:0,p=t.padding||0,g=this.canvas.width/this._resolution-c-p*2,y=this.canvas.height/this._resolution-c-p*2,x=a.slice(),b=t.fillGradientStops.slice();if(!b.length){const A=x.length+1;for(let T=1;T<A;++T)b.push(T/A)}if(x.unshift(a[0]),b.unshift(0),x.push(a[a.length-1]),b.push(1),t.fillGradientType===Ri.LINEAR_VERTICAL){l=this.context.createLinearGradient(g/2,p,g/2,y+p);const A=n.fontProperties.fontSize+t.strokeThickness;for(let T=0;T<r.length;T++){const M=n.lineHeight*(T-1)+A,O=n.lineHeight*T;let K=O;T>0&&M>O&&(K=(O+M)/2);const $=O+A,vt=n.lineHeight*(T+1);let et=$;T+1<r.length&&vt<$&&(et=($+vt)/2);const ut=(et-K)/y;for(let Mt=0;Mt<x.length;Mt++){let $t=0;typeof b[Mt]=="number"?$t=b[Mt]:$t=Mt/x.length;let Dt=Math.min(1,Math.max(0,K/y+$t*ut));Dt=Number(Dt.toFixed(5)),l.addColorStop(Dt,x[Mt])}}}else{l=this.context.createLinearGradient(p,y/2,g+p,y/2);const A=x.length+1;let T=1;for(let M=0;M<x.length;M++){let O;typeof b[M]=="number"?O=b[M]:O=T/A,l.addColorStop(O,x[M]),T++}}return l}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},Mi,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const r=d.P6.sign(this.scale.x)||1;this.scale.x=r*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const r=d.P6.sign(this.scale.y)||1;this.scale.y=r*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},t instanceof mr?this._style=t:this._style=new mr(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t!=null?t:""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};gs.defaultAutoResolution=!0;let ys=gs;class Bi{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function _s(f,t){var n;let r=!1;if((n=f==null?void 0:f._textures)!=null&&n.length){for(let a=0;a<f._textures.length;a++)if(f._textures[a]instanceof d.xE){const l=f._textures[a].baseTexture;t.includes(l)||(t.push(l),r=!0)}}return r}function Qs(f,t){if(f.baseTexture instanceof d.VL){const r=f.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function gr(f,t){if(f._texture&&f._texture instanceof d.xE){const r=f._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function Js(f,t){return t instanceof ys?(t.updateText(!0),!0):!1}function vs(f,t){if(t instanceof mr){const r=t.toFontString();return fr.measureFont(r),!0}return!1}function tn(f,t){if(f instanceof ys){t.includes(f.style)||t.push(f.style),t.includes(f)||t.push(f);const r=f._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function Di(f,t){return f instanceof mr?(t.includes(f)||t.push(f),!0):!1}const ae=class Eo{constructor(t){this.limiter=new Bi(Eo.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(tn),this.registerFindHook(Di),this.registerFindHook(_s),this.registerFindHook(Qs),this.registerFindHook(gr),this.registerUploadHook(Js),this.registerUploadHook(vs)}upload(t){return new Promise(r=>{t&&this.add(t),this.queue.length?(this.completes.push(r),this.ticking||(this.ticking=!0,d.vB.system.addOnce(this.tick,this,d.uF.UTILITY))):r()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let r=!1;if(t&&!t._destroyed){for(let n=0,a=this.uploadHooks.length;n<a;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),r=!0;break}}r||this.queue.shift()}if(this.queue.length)d.vB.system.addOnce(this.tick,this,d.uF.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let r=0,n=t.length;r<n;r++)t[r]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let r=0,n=this.addHooks.length;r<n&&!this.addHooks[r](t,this.queue);r++);if(t instanceof J)for(let r=t.children.length-1;r>=0;r--)this.add(t.children[r]);return this}destroy(){this.ticking&&d.vB.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};ae.uploadsPerFrame=4;let Rr=ae;Object.defineProperties(d.Xd,{UPLOADS_PER_FRAME:{get(){return Rr.uploadsPerFrame},set(f){d.P6.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Rr.uploadsPerFrame=f}}});function xs(f,t){return t instanceof d.VL?(t._glTextures[f.CONTEXT_UID]||f.texture.bind(t),!0):!1}function Yn(f,t){if(!(t instanceof ds))return!1;const{geometry:r}=t;t.finishPoly(),r.updateBatches();const{batches:n}=r;for(let a=0;a<n.length;a++){const{texture:l}=n[a].style;l&&xs(f,l.baseTexture)}return r.batchable||f.geometry.bind(r,t._resolveDirectShader(f)),!0}function en(f,t){return f instanceof ds?(t.push(f),!0):!1}class rn extends Rr{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(en),this.registerUploadHook(xs),this.registerUploadHook(Yn)}}rn.extension={name:"prepare",type:d.nw.RendererSystem},d.Rw.add(rn);class $r extends null{constructor(t,r=!0){super(t[0]instanceof Texture?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=r,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Ticker.shared.add(this.update,this,UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const r=this.animationSpeed*t,n=this.currentFrame;if(this._durations!==null){let a=this._currentTime%1*this._durations[this.currentFrame];for(a+=r/60*1e3;a<0;)this._currentTime--,a+=this._durations[this.currentFrame];const l=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);a>=this._durations[this.currentFrame];)a-=this._durations[this.currentFrame]*l,this._currentTime+=l;this._currentTime+=a/this._durations[this.currentFrame]}else this._currentTime+=r;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())}updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const r=[];for(let n=0;n<t.length;++n)r.push(Texture.from(t[n]));return new $r(r)}static fromImages(t){const r=[];for(let n=0;n<t.length;++n)r.push(Texture.from(t[n]));return new $r(r)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let r=0;r<t.length;r++)this._textures.push(t[r].texture),this._durations.push(t[r].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const r=this.currentFrame;this._currentTime=t,r!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const Mr=new d.E9;class bs extends null{constructor(t,r=100,n=100){super(t),this.tileTransform=new Transform,this._width=r,this._height=n,this.uvMatrix=this.texture.uvMatrix||new TextureMatrix(t),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(t){this.tileTransform.scale.copyFrom(t)}get tilePosition(){return this.tileTransform.position}set tilePosition(t){this.tileTransform.position.copyFrom(t)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(t){const r=this._texture;!r||!r.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))}_calculateBounds(){const t=this._width*-this._anchor._x,r=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),a=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,r,n,a)}getLocalBounds(t){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),t=this._localBoundsRect),this._bounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Mr);const r=this._width,n=this._height,a=-r*this.anchor._x;if(Mr.x>=a&&Mr.x<a+r){const l=-n*this.anchor._y;if(Mr.y>=l&&Mr.y<l+n)return!0}return!1}destroy(t){super.destroy(t),this.tileTransform=null,this.uvMatrix=null}static from(t,r){const n=t instanceof Texture?t:Texture.from(t,r);return new bs(n,r.width,r.height)}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}}var Kn=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,qn=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,sn=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,Fi=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,nn=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const li=new d.y3;class Ts extends d.bO{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new d.ud,this.state=d.ZM.for2d()}contextChange(){const t=this.renderer,r={globals:t.globalUniforms};this.simpleShader=d.ex.from(Fi,nn,r),this.shader=t.context.webGLVersion>1?d.ex.from(qn,Kn,r):d.ex.from(Fi,sn,r)}render(t){const r=this.renderer,n=this.quad;let a=n.vertices;a[0]=a[6]=t._width*-t.anchor.x,a[1]=a[3]=t._height*-t.anchor.y,a[2]=a[4]=t._width*(1-t.anchor.x),a[5]=a[7]=t._height*(1-t.anchor.y);const l=t.uvRespectAnchor?t.anchor.x:0,c=t.uvRespectAnchor?t.anchor.y:0;a=n.uvs,a[0]=a[6]=-l,a[1]=a[3]=-c,a[2]=a[4]=1-l,a[5]=a[7]=1-c,n.invalidate();const p=t._texture,g=p.baseTexture,y=g.alphaMode>0,x=t.tileTransform.localTransform,b=t.uvMatrix;let A=g.isPowerOfTwo&&p.frame.width===g.width&&p.frame.height===g.height;A&&(g._glTextures[r.CONTEXT_UID]?A=g.wrapMode!==d.Nt.CLAMP:g.wrapMode===d.Nt.CLAMP&&(g.wrapMode=d.Nt.REPEAT));const T=A?this.simpleShader:this.shader,M=p.width,O=p.height,K=t._width,$=t._height;li.set(x.a*M/K,x.b*M/$,x.c*O/K,x.d*O/$,x.tx/K,x.ty/$),li.invert(),A?li.prepend(b.mapCoord):(T.uniforms.uMapCoord=b.mapCoord.toArray(!0),T.uniforms.uClampFrame=b.uClampFrame,T.uniforms.uClampOffset=b.uClampOffset),T.uniforms.uTransform=li.toArray(!0),T.uniforms.uColor=d.Il.shared.setValue(t.tint).premultiply(t.worldAlpha,y).toArray(T.uniforms.uColor),T.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),T.uniforms.uSampler=p,r.shader.bind(T),r.geometry.bind(n),this.state.blendMode=d.P6.correctBlendMode(t.blendMode,y),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}Ts.extension={name:"tilingSprite",type:d.nw.RendererPlugin},d.Rw.add(Ts);const on=class Fs{constructor(t,r,n=null){this.linkedSheets=[],this._texture=t instanceof d.xE?t:null,this.baseTexture=t instanceof d.VL?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=r;const a=this.baseTexture.resource;this.resolution=this._updateResolution(n||(a?a.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:r}=this.data.meta;let n=d.P6.getResolutionOfUrl(t,null);return n===null&&(n=parseFloat(r!=null?r:"1")),n!==1&&this.baseTexture.setResolution(n),n}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=Fs.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let r=t;const n=Fs.BATCH_SIZE;for(;r-t<n&&r<this._frameKeys.length;){const a=this._frameKeys[r],l=this._frames[a],c=l.frame;if(c){let p=null,g=null;const y=l.trimmed!==!1&&l.sourceSize?l.sourceSize:l.frame,x=new d.Ae(0,0,Math.floor(y.w)/this.resolution,Math.floor(y.h)/this.resolution);l.rotated?p=new d.Ae(Math.floor(c.x)/this.resolution,Math.floor(c.y)/this.resolution,Math.floor(c.h)/this.resolution,Math.floor(c.w)/this.resolution):p=new d.Ae(Math.floor(c.x)/this.resolution,Math.floor(c.y)/this.resolution,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution),l.trimmed!==!1&&l.spriteSourceSize&&(g=new d.Ae(Math.floor(l.spriteSourceSize.x)/this.resolution,Math.floor(l.spriteSourceSize.y)/this.resolution,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution)),this.textures[a]=new d.xE(this.baseTexture,p,x,g,l.rotated?2:0,l.anchor,l.borders),d.xE.addToCache(this.textures[a],a.toString())}r++}}_processAnimations(){const t=this.data.animations||{};for(const r in t){this.animations[r]=[];for(let n=0;n<t[r].length;n++){const a=t[r][n];this.animations[r].push(this.textures[a])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Fs.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Fs.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var r;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((r=this._texture)==null||r.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};on.BATCH_SIZE=1e3;let an=on;const Zn=["jpg","png","jpeg","avif","webp"];function hn(f,t,r){const n={};if(f.forEach(a=>{n[a]=t}),Object.keys(t.textures).forEach(a=>{n[a]=t.textures[a]}),!r){const a=d.P6.path.dirname(f[0]);t.linkedSheets.forEach((l,c)=>{const p=hn([`${a}/${t.data.meta.related_multi_packs[c]}`],l,!0);Object.assign(n,p)})}return n}const ln={extension:d.nw.Asset,cache:{test:f=>f instanceof an,getCacheableAssets:(f,t)=>hn(f,t,!1)},resolver:{test:f=>{const t=f.split("?")[0].split("."),r=t.pop(),n=t.pop();return r==="json"&&Zn.includes(n)},parse:f=>{var r,n;const t=f.split(".");return{resolution:parseFloat((n=(r=d.Xd.RETINA_PREFIX.exec(f))==null?void 0:r[1])!=null?n:"1"),format:t[t.length-2],src:f}}},loader:{name:"spritesheetLoader",extension:{type:d.nw.LoadParser,priority:de.Normal},testParse(f,t){return Lt(this,null,function*(){return d.P6.path.extname(t.src).toLowerCase()===".json"&&!!f.frames})},parse(f,t,r){return Lt(this,null,function*(){var g,y;let n=d.P6.path.dirname(t.src);n&&n.lastIndexOf("/")!==n.length-1&&(n+="/");let a=n+f.meta.image;a=hr(a,t.src);const l=(yield r.load([a]))[a],c=new an(l.baseTexture,f,t.src);yield c.parse();const p=(g=f==null?void 0:f.meta)==null?void 0:g.related_multi_packs;if(Array.isArray(p)){const x=[];for(const A of p){if(typeof A!="string")continue;let T=n+A;(y=t.data)!=null&&y.ignoreMultiPack||(T=hr(T,t.src),x.push(r.load({src:T,data:{ignoreMultiPack:!0}})))}const b=yield Promise.all(x);c.linkedSheets=b,b.forEach(A=>{A.linkedSheets=[c].concat(c.linkedSheets.filter(T=>T!==A))})}return c})},unload(f){f.destroy(!0)}}};d.Rw.add(ln);class ui{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class ci{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const r=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const l in r){const c=r[l].match(/^[a-z]+/gm)[0],p=r[l].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),g={};for(const y in p){const x=p[y].split("="),b=x[0],A=x[1].replace(/"/gm,""),T=parseFloat(A),M=isNaN(T)?A:T;g[b]=M}n[c].push(g)}const a=new ui;return n.info.forEach(l=>a.info.push({face:l.face,size:parseInt(l.size,10)})),n.common.forEach(l=>a.common.push({lineHeight:parseInt(l.lineHeight,10)})),n.page.forEach(l=>a.page.push({id:parseInt(l.id,10),file:l.file})),n.char.forEach(l=>a.char.push({id:parseInt(l.id,10),page:parseInt(l.page,10),x:parseInt(l.x,10),y:parseInt(l.y,10),width:parseInt(l.width,10),height:parseInt(l.height,10),xoffset:parseInt(l.xoffset,10),yoffset:parseInt(l.yoffset,10),xadvance:parseInt(l.xadvance,10)})),n.kerning.forEach(l=>a.kerning.push({first:parseInt(l.first,10),second:parseInt(l.second,10),amount:parseInt(l.amount,10)})),n.distanceField.forEach(l=>a.distanceField.push({distanceRange:parseInt(l.distanceRange,10),fieldType:l.fieldType})),a}}class Oi{static test(t){const r=t;return typeof t!="string"&&"getElementsByTagName"in t&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const r=new ui,n=t.getElementsByTagName("info"),a=t.getElementsByTagName("common"),l=t.getElementsByTagName("page"),c=t.getElementsByTagName("char"),p=t.getElementsByTagName("kerning"),g=t.getElementsByTagName("distanceField");for(let y=0;y<n.length;y++)r.info.push({face:n[y].getAttribute("face"),size:parseInt(n[y].getAttribute("size"),10)});for(let y=0;y<a.length;y++)r.common.push({lineHeight:parseInt(a[y].getAttribute("lineHeight"),10)});for(let y=0;y<l.length;y++)r.page.push({id:parseInt(l[y].getAttribute("id"),10)||0,file:l[y].getAttribute("file")});for(let y=0;y<c.length;y++){const x=c[y];r.char.push({id:parseInt(x.getAttribute("id"),10),page:parseInt(x.getAttribute("page"),10)||0,x:parseInt(x.getAttribute("x"),10),y:parseInt(x.getAttribute("y"),10),width:parseInt(x.getAttribute("width"),10),height:parseInt(x.getAttribute("height"),10),xoffset:parseInt(x.getAttribute("xoffset"),10),yoffset:parseInt(x.getAttribute("yoffset"),10),xadvance:parseInt(x.getAttribute("xadvance"),10)})}for(let y=0;y<p.length;y++)r.kerning.push({first:parseInt(p[y].getAttribute("first"),10),second:parseInt(p[y].getAttribute("second"),10),amount:parseInt(p[y].getAttribute("amount"),10)});for(let y=0;y<g.length;y++)r.distanceField.push({fieldType:g[y].getAttribute("fieldType"),distanceRange:parseInt(g[y].getAttribute("distanceRange"),10)});return r}}class Li{static test(t){return typeof t=="string"&&t.includes("<font>")?Oi.test(d.Xd.ADAPTER.parseXML(t)):!1}static parse(t){return Oi.parse(d.Xd.ADAPTER.parseXML(t))}}const As=[ci,Oi,Li];function un(f){for(let t=0;t<As.length;t++)if(As[t].test(f))return As[t];return null}function cn(f,t,r,n,a,l){const c=r.fill;if(Array.isArray(c)){if(c.length===1)return c[0]}else return c;let p;const g=r.dropShadow?r.dropShadowDistance:0,y=r.padding||0,x=f.width/n-g-y*2,b=f.height/n-g-y*2,A=c.slice(),T=r.fillGradientStops.slice();if(!T.length){const M=A.length+1;for(let O=1;O<M;++O)T.push(O/M)}if(A.unshift(c[0]),T.unshift(0),A.push(c[c.length-1]),T.push(1),r.fillGradientType===Ri.LINEAR_VERTICAL){p=t.createLinearGradient(x/2,y,x/2,b+y);let M=0;const O=(l.fontProperties.fontSize+r.strokeThickness)/b;for(let K=0;K<a.length;K++){const $=l.lineHeight*K;for(let vt=0;vt<A.length;vt++){let et=0;typeof T[vt]=="number"?et=T[vt]:et=vt/A.length;const ut=$/b+et*O;let Mt=Math.max(M,ut);Mt=Math.min(Mt,1),p.addColorStop(Mt,A[vt]),M=Mt}}}else{p=t.createLinearGradient(y,b/2,x+y,b/2);const M=A.length+1;let O=1;for(let K=0;K<A.length;K++){let $;typeof T[K]=="number"?$=T[K]:$=O/M,p.addColorStop($,A[K]),O++}}return p}function dn(f,t,r,n,a,l,c){const p=r.text,g=r.fontProperties;t.translate(n,a),t.scale(l,l);const y=c.strokeThickness/2,x=-(c.strokeThickness/2);if(t.font=c.toFontString(),t.lineWidth=c.strokeThickness,t.textBaseline=c.textBaseline,t.lineJoin=c.lineJoin,t.miterLimit=c.miterLimit,t.fillStyle=cn(f,t,c,l,[p],r),t.strokeStyle=c.stroke,c.dropShadow){const b=c.dropShadowColor,A=c.dropShadowBlur*l,T=c.dropShadowDistance*l;t.shadowColor=d.Il.shared.setValue(b).setAlpha(c.dropShadowAlpha).toRgbaString(),t.shadowBlur=A,t.shadowOffsetX=Math.cos(c.dropShadowAngle)*T,t.shadowOffsetY=Math.sin(c.dropShadowAngle)*T}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;c.stroke&&c.strokeThickness&&t.strokeText(p,y,x+r.lineHeight-g.descent),c.fill&&t.fillText(p,y,x+r.lineHeight-g.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function fn(f){return Array.from?Array.from(f):f.split("")}function pn(f){typeof f=="string"&&(f=[f]);const t=[];for(let r=0,n=f.length;r<n;r++){const a=f[r];if(Array.isArray(a)){if(a.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${a.length}.`);const l=a[0].charCodeAt(0),c=a[1].charCodeAt(0);if(c<l)throw new Error("[BitmapFont]: Invalid character range.");for(let p=l,g=c;p<=g;p++)t.push(String.fromCharCode(p))}else t.push(...fn(a))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}function di(f){return f.codePointAt?f.codePointAt(0):f.charCodeAt(0)}const Oe=class _r{constructor(t,r,n){var x,b;const[a]=t.info,[l]=t.common,[c]=t.page,[p]=t.distanceField,g=d.P6.getResolutionOfUrl(c.file),y={};this._ownsTextures=n,this.font=a.face,this.size=a.size,this.lineHeight=l.lineHeight/g,this.chars={},this.pageTextures=y;for(let A=0;A<t.page.length;A++){const{id:T,file:M}=t.page[A];y[T]=r instanceof Array?r[A]:r[M],p!=null&&p.fieldType&&p.fieldType!=="none"&&(y[T].baseTexture.alphaMode=d.iw.NO_PREMULTIPLIED_ALPHA,y[T].baseTexture.mipmap=d.KI.OFF)}for(let A=0;A<t.char.length;A++){const{id:T,page:M}=t.char[A];let{x:O,y:K,width:$,height:vt,xoffset:et,yoffset:ut,xadvance:Mt}=t.char[A];O/=g,K/=g,$/=g,vt/=g,et/=g,ut/=g,Mt/=g;const $t=new d.Ae(O+y[M].frame.x/g,K+y[M].frame.y/g,$,vt);this.chars[T]={xOffset:et,yOffset:ut,xAdvance:Mt,kerning:{},texture:new d.xE(y[M].baseTexture,$t),page:M}}for(let A=0;A<t.kerning.length;A++){let{first:T,second:M,amount:O}=t.kerning[A];T/=g,M/=g,O/=g,this.chars[M]&&(this.chars[M].kerning[T]=O)}this.distanceFieldRange=p==null?void 0:p.distanceRange,this.distanceFieldType=(b=(x=p==null?void 0:p.fieldType)==null?void 0:x.toLowerCase())!=null?b:"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,r,n){let a;if(t instanceof ui)a=t;else{const c=un(t);if(!c)throw new Error("Unrecognized data format for font.");a=c.parse(t)}r instanceof d.xE&&(r=[r]);const l=new _r(a,r,n);return _r.available[l.font]=l,l}static uninstall(t){const r=_r.available[t];if(!r)throw new Error(`No font found named '${t}'`);r.destroy(),delete _r.available[t]}static from(t,r,n){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const Dt=Object.assign({},_r.defaultOptions,n),{chars:a,padding:l,resolution:c,textureWidth:p,textureHeight:g}=Dt,y=to(Dt,["chars","padding","resolution","textureWidth","textureHeight"]),x=pn(a),b=r instanceof mr?r:new mr(r),A=p,T=new ui;T.info[0]={face:b.fontFamily,size:b.fontSize},T.common[0]={lineHeight:b.fontSize};let M=0,O=0,K,$,vt,et=0;const ut=[],Mt=[];for(let Bt=0;Bt<x.length;Bt++){K||(K=d.Xd.ADAPTER.createCanvas(),K.width=p,K.height=g,$=K.getContext("2d"),vt=new d.VL(K,pe({resolution:c},y)),ut.push(vt),Mt.push(new d.xE(vt)),T.page.push({id:Mt.length-1,file:""}));const Wt=x[Bt],jt=fr.measureText(Wt,b,!1,K),ue=jt.width,Ut=Math.ceil(jt.height),ft=Math.ceil((b.fontStyle==="italic"?2:1)*ue);if(O>=g-Ut*c){if(O===0)throw new Error(`[BitmapFont] textureHeight ${g}px is too small (fontFamily: '${b.fontFamily}', fontSize: ${b.fontSize}px, char: '${Wt}')`);--Bt,K=null,$=null,vt=null,O=0,M=0,et=0;continue}if(et=Math.max(Ut+jt.fontProperties.descent,et),ft*c+M>=A){if(M===0)throw new Error(`[BitmapFont] textureWidth ${p}px is too small (fontFamily: '${b.fontFamily}', fontSize: ${b.fontSize}px, char: '${Wt}')`);--Bt,O+=et*c,O=Math.ceil(O),M=0,et=0;continue}dn(K,$,jt,M,O,c,b);const Rt=di(jt.text);T.char.push({id:Rt,page:Mt.length-1,x:M/c,y:O/c,width:ft,height:Ut,xoffset:0,yoffset:0,xadvance:ue-(b.dropShadow?b.dropShadowDistance:0)-(b.stroke?b.strokeThickness:0)}),M+=(ft+2*l)*c,M=Math.ceil(M)}if(!(n!=null&&n.skipKerning))for(let Bt=0,Wt=x.length;Bt<Wt;Bt++){const jt=x[Bt];for(let ue=0;ue<Wt;ue++){const Ut=x[ue],ft=$.measureText(jt).width,Rt=$.measureText(Ut).width,Vt=$.measureText(jt+Ut).width-(ft+Rt);Vt&&T.kerning.push({first:di(jt),second:di(Ut),amount:Vt})}}const $t=new _r(T,Mt,!0);return _r.available[t]!==void 0&&_r.uninstall(t),_r.available[t]=$t,$t}};Oe.ALPHA=[["a","z"],["A","Z"]," "],Oe.NUMERIC=[["0","9"]],Oe.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Oe.ASCII=[[" ","~"]],Oe.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Oe.ALPHANUMERIC},Oe.available={};let ke=Oe;var mn=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,co=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const gn=[],Es=[],Ni=[],yn=class wo extends J{constructor(t,r={}){super();const{align:n,tint:a,maxWidth:l,letterSpacing:c,fontName:p,fontSize:g}=Object.assign({},wo.styleDefaults,r);if(!ke.available[p])throw new Error(`Missing BitmapFont "${p}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=n,this._tintColor=new d.Il(a),this._font=void 0,this._fontName=p,this._fontSize=g,this.text=t,this._maxWidth=l,this._maxLineHeight=0,this._letterSpacing=c,this._anchor=new d.AB(()=>{this.dirty=!0},this,0,0),this._roundPixels=d.Xd.ROUND_PIXELS,this.dirty=!0,this._resolution=d.Xd.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var ue;const t=ke.available[this._fontName],r=this.fontSize,n=r/t.size,a=new d.E9,l=[],c=[],p=[],g=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",y=fn(g),x=this._maxWidth*t.size/r,b=t.distanceFieldType==="none"?gn:Es;let A=null,T=0,M=0,O=0,K=-1,$=0,vt=0,et=0,ut=0;for(let Ut=0;Ut<y.length;Ut++){const ft=y[Ut],Rt=di(ft);if(/(?:\s)/.test(ft)&&(K=Ut,$=T,ut++),ft==="\r"||ft===`
`){c.push(T),p.push(-1),M=Math.max(M,T),++O,++vt,a.x=0,a.y+=t.lineHeight,A=null,ut=0;continue}const Vt=t.chars[Rt];if(!Vt)continue;A&&Vt.kerning[A]&&(a.x+=Vt.kerning[A]);const re=Ni.pop()||{texture:d.xE.EMPTY,line:0,charCode:0,prevSpaces:0,position:new d.E9};re.texture=Vt.texture,re.line=O,re.charCode=Rt,re.position.x=Math.round(a.x+Vt.xOffset+this._letterSpacing/2),re.position.y=Math.round(a.y+Vt.yOffset),re.prevSpaces=ut,l.push(re),T=re.position.x+Math.max(Vt.xAdvance-Vt.xOffset,Vt.texture.orig.width),a.x+=Vt.xAdvance+this._letterSpacing,et=Math.max(et,Vt.yOffset+Vt.texture.height),A=Rt,K!==-1&&x>0&&a.x>x&&(++vt,d.P6.removeItems(l,1+K-vt,1+Ut-K),Ut=K,K=-1,c.push($),p.push(l.length>0?l[l.length-1].prevSpaces:0),M=Math.max(M,$),O++,a.x=0,a.y+=t.lineHeight,A=null,ut=0)}const Mt=y[y.length-1];Mt!=="\r"&&Mt!==`
`&&(/(?:\s)/.test(Mt)&&(T=$),c.push(T),M=Math.max(M,T),p.push(-1));const $t=[];for(let Ut=0;Ut<=O;Ut++){let ft=0;this._align==="right"?ft=M-c[Ut]:this._align==="center"?ft=(M-c[Ut])/2:this._align==="justify"&&(ft=p[Ut]<0?0:(M-c[Ut])/p[Ut]),$t.push(ft)}const Dt=l.length,Bt={},Wt=[],jt=this._activePagesMeshData;b.push(...jt);for(let Ut=0;Ut<Dt;Ut++){const ft=l[Ut].texture,Rt=ft.baseTexture.uid;if(!Bt[Rt]){let Vt=b.pop();if(!Vt){const Ht=new Vn;let Yt,Te;t.distanceFieldType==="none"?(Yt=new fs(d.xE.EMPTY),Te=d.T$.NORMAL):(Yt=new fs(d.xE.EMPTY,{program:d.$r.from(co,mn),uniforms:{uFWidth:0}}),Te=d.T$.NORMAL_NPM);const Ae=new js(Ht,Yt);Ae.blendMode=Te,Vt={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Ae,vertices:null,uvs:null,indices:null}}Vt.index=0,Vt.indexCount=0,Vt.vertexCount=0,Vt.uvsCount=0,Vt.total=0;const{_textureCache:re}=this;re[Rt]=re[Rt]||new d.xE(ft.baseTexture),Vt.mesh.texture=re[Rt],Vt.mesh.tint=this._tintColor.value,Wt.push(Vt),Bt[Rt]=Vt}Bt[Rt].total++}for(let Ut=0;Ut<jt.length;Ut++)Wt.includes(jt[Ut])||this.removeChild(jt[Ut].mesh);for(let Ut=0;Ut<Wt.length;Ut++)Wt[Ut].mesh.parent!==this&&this.addChild(Wt[Ut].mesh);this._activePagesMeshData=Wt;for(const Ut in Bt){const ft=Bt[Ut],Rt=ft.total;if(!(((ue=ft.indices)==null?void 0:ue.length)>6*Rt)||ft.vertices.length<js.BATCHABLE_SIZE*2)ft.vertices=new Float32Array(4*2*Rt),ft.uvs=new Float32Array(4*2*Rt),ft.indices=new Uint16Array(6*Rt);else{const Vt=ft.total,re=ft.vertices;for(let Ht=Vt*4*2;Ht<re.length;Ht++)re[Ht]=0}ft.mesh.size=6*Rt}for(let Ut=0;Ut<Dt;Ut++){const ft=l[Ut];let Rt=ft.position.x+$t[ft.line]*(this._align==="justify"?ft.prevSpaces:1);this._roundPixels&&(Rt=Math.round(Rt));const Vt=Rt*n,re=ft.position.y*n,Ht=ft.texture,Yt=Bt[Ht.baseTexture.uid],Te=Ht.frame,Ae=Ht._uvs,te=Yt.index++;Yt.indices[te*6+0]=0+te*4,Yt.indices[te*6+1]=1+te*4,Yt.indices[te*6+2]=2+te*4,Yt.indices[te*6+3]=0+te*4,Yt.indices[te*6+4]=2+te*4,Yt.indices[te*6+5]=3+te*4,Yt.vertices[te*8+0]=Vt,Yt.vertices[te*8+1]=re,Yt.vertices[te*8+2]=Vt+Te.width*n,Yt.vertices[te*8+3]=re,Yt.vertices[te*8+4]=Vt+Te.width*n,Yt.vertices[te*8+5]=re+Te.height*n,Yt.vertices[te*8+6]=Vt,Yt.vertices[te*8+7]=re+Te.height*n,Yt.uvs[te*8+0]=Ae.x0,Yt.uvs[te*8+1]=Ae.y0,Yt.uvs[te*8+2]=Ae.x1,Yt.uvs[te*8+3]=Ae.y1,Yt.uvs[te*8+4]=Ae.x2,Yt.uvs[te*8+5]=Ae.y2,Yt.uvs[te*8+6]=Ae.x3,Yt.uvs[te*8+7]=Ae.y3}this._textWidth=M*n,this._textHeight=(a.y+t.lineHeight)*n;for(const Ut in Bt){const ft=Bt[Ut];if(this.anchor.x!==0||this.anchor.y!==0){let Ht=0;const Yt=this._textWidth*this.anchor.x,Te=this._textHeight*this.anchor.y;for(let Ae=0;Ae<ft.total;Ae++)ft.vertices[Ht++]-=Yt,ft.vertices[Ht++]-=Te,ft.vertices[Ht++]-=Yt,ft.vertices[Ht++]-=Te,ft.vertices[Ht++]-=Yt,ft.vertices[Ht++]-=Te,ft.vertices[Ht++]-=Yt,ft.vertices[Ht++]-=Te}this._maxLineHeight=et*n;const Rt=ft.mesh.geometry.getBuffer("aVertexPosition"),Vt=ft.mesh.geometry.getBuffer("aTextureCoord"),re=ft.mesh.geometry.getIndex();Rt.data=ft.vertices,Vt.data=ft.uvs,re.data=ft.indices,Rt.update(),Vt.update(),re.update()}for(let Ut=0;Ut<l.length;Ut++)Ni.push(l[Ut]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:r,distanceFieldType:n,size:a}=ke.available[this._fontName];if(n!=="none"){const{a:l,b:c,c:p,d:g}=this.worldTransform,y=Math.sqrt(l*l+c*c),x=Math.sqrt(p*p+g*g),b=(Math.abs(y)+Math.abs(x))/2,A=this.fontSize/a,T=t._view.resolution;for(const M of this._activePagesMeshData)M.mesh.shader.uniforms.uFWidth=b*r*A*T}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=ke.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let r=0;r<this._activePagesMeshData.length;r++)this._activePagesMeshData[r].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!ke.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){var t;return(t=this._fontSize)!=null?t:ke.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t!=null?t:""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:r}=this,n=ke.available[this._fontName].distanceFieldType==="none"?gn:Es;n.push(...this._activePagesMeshData);for(const a of this._activePagesMeshData)this.removeChild(a.mesh);this._activePagesMeshData=[],n.filter(a=>r[a.mesh.texture.baseTexture.uid]).forEach(a=>{a.mesh.texture=d.xE.EMPTY});for(const a in r)r[a].destroy(),delete r[a];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}};yn.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};let fo=null;const Qn=[".xml",".fnt"],_n={extension:{type:d.nw.LoadParser,priority:de.Normal},name:"loadBitmapFont",test(f){return Qn.includes(d.P6.path.extname(f).toLowerCase())},testParse(f){return Lt(this,null,function*(){return ci.test(f)||Li.test(f)})},parse(f,t,r){return Lt(this,null,function*(){const n=ci.test(f)?ci.parse(f):Li.parse(f),{src:a}=t,{page:l}=n,c=[];for(let y=0;y<l.length;++y){const x=l[y].file;let b=d.P6.path.join(d.P6.path.dirname(a),x);b=hr(b,a),c.push(b)}const p=yield r.load(c),g=c.map(y=>p[y]);return ke.install(n,g,!0)})},load(f,t){return Lt(this,null,function*(){return(yield d.Xd.ADAPTER.fetch(f)).text()})},unload(f){f.destroy()}};d.Rw.add(_n);const ws=class Wi extends mr{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new Wi(Object.keys(Wi.defaultOptions).reduce((r,n)=>pi(pe({},r),{[n]:t[n]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(t=>{URL.revokeObjectURL(t.src),t.refs--,t.refs===0&&(t.fontFace&&document.fonts.delete(t.fontFace),delete Wi.availableFonts[t.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,r={}){const{availableFonts:n}=Wi;if(n[t]){const a=n[t];return this._fonts.push(a),a.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return d.Xd.ADAPTER.fetch(t).then(a=>a.blob()).then(a=>Lt(this,null,function*(){return new Promise((l,c)=>{const p=URL.createObjectURL(a),g=new FileReader;g.onload=()=>l([p,g.result]),g.onerror=c,g.readAsDataURL(a)})})).then(c=>Lt(this,[c],function*([a,l]){const p=Object.assign({family:d.P6.path.basename(t,d.P6.path.extname(t)),weight:"normal",style:"normal",display:"auto",src:a,dataSrc:l,refs:1,originalUrl:t,fontFace:null},r);n[t]=p,this._fonts.push(p),this.styleID++;const g=new FontFace(p.family,`url(${p.src})`,{weight:p.weight,style:p.style,display:p.display});p.fontFace=g,yield g.load(),document.fonts.add(g),yield document.fonts.ready,this.styleID++,this.fontsDirty=!0}))}addOverride(...t){const r=t.filter(n=>!this._overrides.includes(n));r.length>0&&(this._overrides.push(...r),this.styleID++)}removeOverride(...t){const r=t.filter(n=>this._overrides.includes(n));r.length>0&&(this._overrides=this._overrides.filter(n=>!r.includes(n)),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((t,r)=>`${t}
            @font-face {
                font-family: "${r.family}";
                src: url('${r.dataSrc}');
                font-weight: ${r.weight};
                font-style: ${r.style};
                font-display: ${r.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=d.P6.rgb2hex(t)),typeof t=="number"?d.P6.hex2string(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const r=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),a=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&r<1&&(t+=(r*255|0).toString(16).padStart(2,"0"));const l=`${n}px ${a}px`;return this.dropShadowBlur>0?`text-shadow: ${l} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${l} ${t}`}reset(){Object.assign(this,Wi.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise(r=>setTimeout(r,100)):Promise.resolve()}get isSafari(){const{userAgent:t}=d.Xd.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};ws.availableFonts={},ws.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Ss=ws;const Ui=class Vi extends z{constructor(t="",r={}){var b;super(d.xE.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const n=new Image,a=d.xE.from(n,{scaleMode:d.Xd.SCALE_MODE,resourceOptions:{autoLoad:!1}});a.orig=new d.Ae,a.trim=new d.Ae,this.texture=a;const l="http://www.w3.org/2000/svg",c="http://www.w3.org/1999/xhtml",p=document.createElementNS(l,"svg"),g=document.createElementNS(l,"foreignObject"),y=document.createElementNS(c,"div"),x=document.createElementNS(c,"style");g.setAttribute("width","10000"),g.setAttribute("height","10000"),g.style.overflow="hidden",p.appendChild(g),this.maxWidth=Vi.defaultMaxWidth,this.maxHeight=Vi.defaultMaxHeight,this._domElement=y,this._styleElement=x,this._svgRoot=p,this._foreignObject=g,this._foreignObject.appendChild(x),this._foreignObject.appendChild(y),this._image=n,this._loadImage=new Image,this._autoResolution=Vi.defaultAutoResolution,this._resolution=(b=Vi.defaultResolution)!=null?b:d.Xd.RESOLUTION,this.text=t,this.style=r}measureText(t){var x,b;const{text:r,style:n,resolution:a}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:r,style:n.toCSS(a)}),this._styleElement.textContent=n.toGlobalCSS(),document.body.appendChild(this._svgRoot);const l=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:c,height:p}=l;(c>this.maxWidth||p>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const g=Math.min(this.maxWidth,Math.ceil(c)),y=Math.min(this.maxHeight,Math.ceil(p));return this._svgRoot.setAttribute("width",g.toString()),this._svgRoot.setAttribute("height",y.toString()),r!==this._text&&(this._domElement.innerHTML=this._text),n!==this._style&&(Object.assign(this._domElement,{style:(x=this._style)==null?void 0:x.toCSS(a)}),this._styleElement.textContent=(b=this._style)==null?void 0:b.toGlobalCSS()),{width:g+n.padding*2,height:y+n.padding*2}}updateText(t=!0){return Lt(this,null,function*(){const{style:r,_image:n,_loadImage:a}=this;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),!this.dirty&&t)return;const{width:l,height:c}=this.measureText();n.width=a.width=Math.ceil(Math.max(1,l)),n.height=a.height=Math.ceil(Math.max(1,c)),this._updateID++;const p=this._updateID;yield new Promise(g=>{a.onload=()=>Lt(this,null,function*(){if(p<this._updateID){g();return}yield r.onBeforeDraw(),n.src=a.src,a.onload=null,a.src="",this.updateTexture(),g()});const y=new XMLSerializer().serializeToString(this._svgRoot);a.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(y)}`})})}get source(){return this._image}updateTexture(){const{style:t,texture:r,_image:n,resolution:a}=this,{padding:l}=t,{baseTexture:c}=r;r.trim.width=r._frame.width=n.width/a,r.trim.height=r._frame.height=n.height/a,r.trim.x=-l,r.trim.y=-l,r.orig.width=r._frame.width-l*2,r.orig.height=r._frame.height-l*2,this._onTextureUpdate(),c.setRealSize(n.width,n.height,a),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){var n,a,l,c,p;typeof t=="boolean"&&(t={children:t}),t=Object.assign({},Vi.defaultDestroyOptions,t),super.destroy(t);const r=null;this.ownsStyle&&((n=this._style)==null||n.cleanFonts()),this._style=r,(a=this._svgRoot)==null||a.remove(),this._svgRoot=r,(l=this._domElement)==null||l.remove(),this._domElement=r,(c=this._foreignObject)==null||c.remove(),this._foreignObject=r,(p=this._styleElement)==null||p.remove(),this._styleElement=r,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=r,this._image.src="",this._image=r}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const r=d.P6.sign(this.scale.x)||1;this.scale.x=r*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const r=d.P6.sign(this.scale.y)||1;this.scale.y=r*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&(t=t||{},t instanceof Ss?(this.ownsStyle=!1,this._style=t):t instanceof mr?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Ss.from(t)):(this.ownsStyle=!0,this._style=new Ss(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(t===""||t===null||t===void 0?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};Ui.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Ui.defaultMaxWidth=2024,Ui.defaultMaxHeight=2024,Ui.defaultAutoResolution=!0;let po=null}}]);
