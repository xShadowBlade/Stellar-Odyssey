var Qo=Object.defineProperty,Jo=Object.defineProperties;var ta=Object.getOwnPropertyDescriptors;var lo=Object.getOwnPropertySymbols;var Uo=Object.prototype.hasOwnProperty,Go=Object.prototype.propertyIsEnumerable;var ko=(cr,mr,$e)=>mr in cr?Qo(cr,mr,{enumerable:!0,configurable:!0,writable:!0,value:$e}):cr[mr]=$e,Qe=(cr,mr)=>{for(var $e in mr||(mr={}))Uo.call(mr,$e)&&ko(cr,$e,mr[$e]);if(lo)for(var $e of lo(mr))Go.call(mr,$e)&&ko(cr,$e,mr[$e]);return cr},Ni=(cr,mr)=>Jo(cr,ta(mr));var wo=(cr,mr)=>{var $e={};for(var Xr in cr)Uo.call(cr,Xr)&&mr.indexOf(Xr)<0&&($e[Xr]=cr[Xr]);if(cr!=null&&lo)for(var Xr of lo(cr))mr.indexOf(Xr)<0&&Go.call(cr,Xr)&&($e[Xr]=cr[Xr]);return $e};var ce=(cr,mr,$e)=>new Promise((Xr,Wt)=>{var Kt=ct=>{try{S($e.next(ct))}catch(xt){Wt(xt)}},dt=ct=>{try{S($e.throw(ct))}catch(xt){Wt(xt)}},S=ct=>ct.done?Xr(ct.value):Promise.resolve(ct.value).then(Kt,dt);S(($e=$e.apply(cr,mr)).next())});(function(){var cr={924:function(Wt,Kt,dt){"use strict";var S=dt(210),ct=dt(559),xt=ct(S("String.prototype.indexOf"));Wt.exports=function(vt,Ft){var nt=S(vt,!!Ft);return typeof nt=="function"&&xt(vt,".prototype.")>-1?ct(nt):nt}},559:function(Wt,Kt,dt){"use strict";var S=dt(612),ct=dt(210),xt=dt(771),Lt=ct("%TypeError%"),vt=ct("%Function.prototype.apply%"),Ft=ct("%Function.prototype.call%"),nt=ct("%Reflect.apply%",!0)||S.call(Ft,vt),mt=ct("%Object.defineProperty%",!0),at=ct("%Math.max%");if(mt)try{mt({},"a",{value:1})}catch($){mt=null}Wt.exports=function(tt){if(typeof tt!="function")throw new Lt("a function is required");var it=nt(S,Ft,arguments);return xt(it,1+at(0,tt.length-(arguments.length-1)),!0)};var L=function(){return nt(S,vt,arguments)};mt?mt(Wt.exports,"apply",{value:L}):Wt.exports.apply=L},340:function(Wt,Kt,dt){"use strict";dt.r(Kt);var S=dt(81),ct=dt.n(S),xt=dt(645),Lt=dt.n(xt),vt=Lt()(ct());vt.push([Wt.id,`body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}
`,""]),Kt.default=vt},645:function(Wt){"use strict";Wt.exports=function(Kt){var dt=[];return dt.toString=function(){return this.map(function(ct){var xt="",Lt=typeof ct[5]!="undefined";return ct[4]&&(xt+="@supports (".concat(ct[4],") {")),ct[2]&&(xt+="@media ".concat(ct[2]," {")),Lt&&(xt+="@layer".concat(ct[5].length>0?" ".concat(ct[5]):""," {")),xt+=Kt(ct),Lt&&(xt+="}"),ct[2]&&(xt+="}"),ct[4]&&(xt+="}"),xt}).join("")},dt.i=function(ct,xt,Lt,vt,Ft){typeof ct=="string"&&(ct=[[null,ct,void 0]]);var nt={};if(Lt)for(var mt=0;mt<this.length;mt++){var at=this[mt][0];at!=null&&(nt[at]=!0)}for(var L=0;L<ct.length;L++){var $=[].concat(ct[L]);Lt&&nt[$[0]]||(typeof Ft!="undefined"&&(typeof $[5]=="undefined"||($[1]="@layer".concat($[5].length>0?" ".concat($[5]):""," {").concat($[1],"}")),$[5]=Ft),xt&&($[2]&&($[1]="@media ".concat($[2]," {").concat($[1],"}")),$[2]=xt),vt&&($[4]?($[1]="@supports (".concat($[4],") {").concat($[1],"}"),$[4]=vt):$[4]="".concat(vt)),dt.push($))}},dt}},81:function(Wt){"use strict";Wt.exports=function(Kt){return Kt[1]}},296:function(Wt,Kt,dt){"use strict";var S=dt(44)(),ct=dt(210),xt=S&&ct("%Object.defineProperty%",!0);if(xt)try{xt({},"a",{value:1})}catch(nt){xt=!1}var Lt=ct("%SyntaxError%"),vt=ct("%TypeError%"),Ft=dt(275);Wt.exports=function(mt,at,L){if(!mt||typeof mt!="object"&&typeof mt!="function")throw new vt("`obj` must be an object or a function`");if(typeof at!="string"&&typeof at!="symbol")throw new vt("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new vt("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new vt("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new vt("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new vt("`loose`, if provided, must be a boolean");var $=arguments.length>3?arguments[3]:null,tt=arguments.length>4?arguments[4]:null,it=arguments.length>5?arguments[5]:null,Z=arguments.length>6?arguments[6]:!1,ft=!!Ft&&Ft(mt,at);if(xt)xt(mt,at,{configurable:it===null&&ft?ft.configurable:!it,enumerable:$===null&&ft?ft.enumerable:!$,value:L,writable:tt===null&&ft?ft.writable:!tt});else if(Z||!$&&!tt&&!it)mt[at]=L;else throw new Lt("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}},187:function(Wt){"use strict";Wt.exports=Kt,Wt.exports.default=Kt;function Kt(z,st,rt){rt=rt||2;var Pt=st&&st.length,St=Pt?st[0]*rt:z.length,ut=dt(z,0,St,rt,!0),bt=[];if(!ut||ut.next===ut.prev)return bt;var Nt,Vt,Bt,Ht,Qt,ee,le;if(Pt&&(ut=nt(z,st,ut,rt)),z.length>80*rt){Nt=Bt=z[0],Vt=Ht=z[1];for(var he=rt;he<St;he+=rt)Qt=z[he],ee=z[he+1],Qt<Nt&&(Nt=Qt),ee<Vt&&(Vt=ee),Qt>Bt&&(Bt=Qt),ee>Ht&&(Ht=ee);le=Math.max(Bt-Nt,Ht-Vt),le=le!==0?32767/le:0}return ct(ut,bt,rt,Nt,Vt,le,0),bt}function dt(z,st,rt,Pt,St){var ut,bt;if(St===zt(z,st,rt,Pt)>0)for(ut=st;ut<rt;ut+=Pt)bt=ve(ut,z[ut],z[ut+1],bt);else for(ut=rt-Pt;ut>=st;ut-=Pt)bt=ve(ut,z[ut],z[ut+1],bt);return bt&&_t(bt,bt.next)&&(_e(bt),bt=bt.next),bt}function S(z,st){if(!z)return z;st||(st=z);var rt=z,Pt;do if(Pt=!1,!rt.steiner&&(_t(rt,rt.next)||lt(rt.prev,rt,rt.next)===0)){if(_e(rt),rt=st=rt.prev,rt===rt.next)break;Pt=!0}else rt=rt.next;while(Pt||rt!==st);return st}function ct(z,st,rt,Pt,St,ut,bt){if(z){!bt&&ut&&tt(z,Pt,St,ut);for(var Nt=z,Vt,Bt;z.prev!==z.next;){if(Vt=z.prev,Bt=z.next,ut?Lt(z,Pt,St,ut):xt(z)){st.push(Vt.i/rt|0),st.push(z.i/rt|0),st.push(Bt.i/rt|0),_e(z),z=Bt.next,Nt=Bt.next;continue}if(z=Bt,z===Nt){bt?bt===1?(z=vt(S(z),st,rt),ct(z,st,rt,Pt,St,ut,2)):bt===2&&Ft(z,st,rt,Pt,St,ut):ct(S(z),st,rt,Pt,St,ut,1);break}}}}function xt(z){var st=z.prev,rt=z,Pt=z.next;if(lt(st,rt,Pt)>=0)return!1;for(var St=st.x,ut=rt.x,bt=Pt.x,Nt=st.y,Vt=rt.y,Bt=Pt.y,Ht=St<ut?St<bt?St:bt:ut<bt?ut:bt,Qt=Nt<Vt?Nt<Bt?Nt:Bt:Vt<Bt?Vt:Bt,ee=St>ut?St>bt?St:bt:ut>bt?ut:bt,le=Nt>Vt?Nt>Bt?Nt:Bt:Vt>Bt?Vt:Bt,he=Pt.next;he!==st;){if(he.x>=Ht&&he.x<=ee&&he.y>=Qt&&he.y<=le&&yt(St,Nt,ut,Vt,bt,Bt,he.x,he.y)&&lt(he.prev,he,he.next)>=0)return!1;he=he.next}return!0}function Lt(z,st,rt,Pt){var St=z.prev,ut=z,bt=z.next;if(lt(St,ut,bt)>=0)return!1;for(var Nt=St.x,Vt=ut.x,Bt=bt.x,Ht=St.y,Qt=ut.y,ee=bt.y,le=Nt<Vt?Nt<Bt?Nt:Bt:Vt<Bt?Vt:Bt,he=Ht<Qt?Ht<ee?Ht:ee:Qt<ee?Qt:ee,Xe=Nt>Vt?Nt>Bt?Nt:Bt:Vt>Bt?Vt:Bt,Ee=Ht>Qt?Ht>ee?Ht:ee:Qt>ee?Qt:ee,te=Z(le,he,st,rt,Pt),We=Z(Xe,Ee,st,rt,Pt),ue=z.prevZ,fe=z.nextZ;ue&&ue.z>=te&&fe&&fe.z<=We;){if(ue.x>=le&&ue.x<=Xe&&ue.y>=he&&ue.y<=Ee&&ue!==St&&ue!==bt&&yt(Nt,Ht,Vt,Qt,Bt,ee,ue.x,ue.y)&&lt(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,fe.x>=le&&fe.x<=Xe&&fe.y>=he&&fe.y<=Ee&&fe!==St&&fe!==bt&&yt(Nt,Ht,Vt,Qt,Bt,ee,fe.x,fe.y)&&lt(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;ue&&ue.z>=te;){if(ue.x>=le&&ue.x<=Xe&&ue.y>=he&&ue.y<=Ee&&ue!==St&&ue!==bt&&yt(Nt,Ht,Vt,Qt,Bt,ee,ue.x,ue.y)&&lt(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;fe&&fe.z<=We;){if(fe.x>=le&&fe.x<=Xe&&fe.y>=he&&fe.y<=Ee&&fe!==St&&fe!==bt&&yt(Nt,Ht,Vt,Qt,Bt,ee,fe.x,fe.y)&&lt(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function vt(z,st,rt){var Pt=z;do{var St=Pt.prev,ut=Pt.next.next;!_t(St,ut)&&It(St,Pt,Pt.next,ut)&&At(St,ut)&&At(ut,St)&&(st.push(St.i/rt|0),st.push(Pt.i/rt|0),st.push(ut.i/rt|0),_e(Pt),_e(Pt.next),Pt=z=ut),Pt=Pt.next}while(Pt!==z);return S(Pt)}function Ft(z,st,rt,Pt,St,ut){var bt=z;do{for(var Nt=bt.next.next;Nt!==bt.prev;){if(bt.i!==Nt.i&&K(bt,Nt)){var Vt=qt(bt,Nt);bt=S(bt,bt.next),Vt=S(Vt,Vt.next),ct(bt,st,rt,Pt,St,ut,0),ct(Vt,st,rt,Pt,St,ut,0);return}Nt=Nt.next}bt=bt.next}while(bt!==z)}function nt(z,st,rt,Pt){var St=[],ut,bt,Nt,Vt,Bt;for(ut=0,bt=st.length;ut<bt;ut++)Nt=st[ut]*Pt,Vt=ut<bt-1?st[ut+1]*Pt:z.length,Bt=dt(z,Nt,Vt,Pt,!1),Bt===Bt.next&&(Bt.steiner=!0),St.push(ft(Bt));for(St.sort(mt),ut=0;ut<St.length;ut++)rt=at(St[ut],rt);return rt}function mt(z,st){return z.x-st.x}function at(z,st){var rt=L(z,st);if(!rt)return st;var Pt=qt(rt,z);return S(Pt,Pt.next),S(rt,rt.next)}function L(z,st){var rt=st,Pt=z.x,St=z.y,ut=-1/0,bt;do{if(St<=rt.y&&St>=rt.next.y&&rt.next.y!==rt.y){var Nt=rt.x+(St-rt.y)*(rt.next.x-rt.x)/(rt.next.y-rt.y);if(Nt<=Pt&&Nt>ut&&(ut=Nt,bt=rt.x<rt.next.x?rt:rt.next,Nt===Pt))return bt}rt=rt.next}while(rt!==st);if(!bt)return null;var Vt=bt,Bt=bt.x,Ht=bt.y,Qt=1/0,ee;rt=bt;do Pt>=rt.x&&rt.x>=Bt&&Pt!==rt.x&&yt(St<Ht?Pt:ut,St,Bt,Ht,St<Ht?ut:Pt,St,rt.x,rt.y)&&(ee=Math.abs(St-rt.y)/(Pt-rt.x),At(rt,z)&&(ee<Qt||ee===Qt&&(rt.x>bt.x||rt.x===bt.x&&$(bt,rt)))&&(bt=rt,Qt=ee)),rt=rt.next;while(rt!==Vt);return bt}function $(z,st){return lt(z.prev,z,st.prev)<0&&lt(st.next,z,z.next)<0}function tt(z,st,rt,Pt){var St=z;do St.z===0&&(St.z=Z(St.x,St.y,st,rt,Pt)),St.prevZ=St.prev,St.nextZ=St.next,St=St.next;while(St!==z);St.prevZ.nextZ=null,St.prevZ=null,it(St)}function it(z){var st,rt,Pt,St,ut,bt,Nt,Vt,Bt=1;do{for(rt=z,z=null,ut=null,bt=0;rt;){for(bt++,Pt=rt,Nt=0,st=0;st<Bt&&(Nt++,Pt=Pt.nextZ,!!Pt);st++);for(Vt=Bt;Nt>0||Vt>0&&Pt;)Nt!==0&&(Vt===0||!Pt||rt.z<=Pt.z)?(St=rt,rt=rt.nextZ,Nt--):(St=Pt,Pt=Pt.nextZ,Vt--),ut?ut.nextZ=St:z=St,St.prevZ=ut,ut=St;rt=Pt}ut.nextZ=null,Bt*=2}while(bt>1);return z}function Z(z,st,rt,Pt,St){return z=(z-rt)*St|0,st=(st-Pt)*St|0,z=(z|z<<8)&16711935,z=(z|z<<4)&252645135,z=(z|z<<2)&858993459,z=(z|z<<1)&1431655765,st=(st|st<<8)&16711935,st=(st|st<<4)&252645135,st=(st|st<<2)&858993459,st=(st|st<<1)&1431655765,z|st<<1}function ft(z){var st=z,rt=z;do(st.x<rt.x||st.x===rt.x&&st.y<rt.y)&&(rt=st),st=st.next;while(st!==z);return rt}function yt(z,st,rt,Pt,St,ut,bt,Nt){return(St-bt)*(st-Nt)>=(z-bt)*(ut-Nt)&&(z-bt)*(Pt-Nt)>=(rt-bt)*(st-Nt)&&(rt-bt)*(ut-Nt)>=(St-bt)*(Pt-Nt)}function K(z,st){return z.next.i!==st.i&&z.prev.i!==st.i&&!q(z,st)&&(At(z,st)&&At(st,z)&&ot(z,st)&&(lt(z.prev,z,st.prev)||lt(z,st.prev,st))||_t(z,st)&&lt(z.prev,z,z.next)>0&&lt(st.prev,st,st.next)>0)}function lt(z,st,rt){return(st.y-z.y)*(rt.x-st.x)-(st.x-z.x)*(rt.y-st.y)}function _t(z,st){return z.x===st.x&&z.y===st.y}function It(z,st,rt,Pt){var St=Dt(lt(z,st,rt)),ut=Dt(lt(z,st,Pt)),bt=Dt(lt(rt,Pt,z)),Nt=Dt(lt(rt,Pt,st));return!!(St!==ut&&bt!==Nt||St===0&&Et(z,rt,st)||ut===0&&Et(z,Pt,st)||bt===0&&Et(rt,z,Pt)||Nt===0&&Et(rt,st,Pt))}function Et(z,st,rt){return st.x<=Math.max(z.x,rt.x)&&st.x>=Math.min(z.x,rt.x)&&st.y<=Math.max(z.y,rt.y)&&st.y>=Math.min(z.y,rt.y)}function Dt(z){return z>0?1:z<0?-1:0}function q(z,st){var rt=z;do{if(rt.i!==z.i&&rt.next.i!==z.i&&rt.i!==st.i&&rt.next.i!==st.i&&It(rt,rt.next,z,st))return!0;rt=rt.next}while(rt!==z);return!1}function At(z,st){return lt(z.prev,z,z.next)<0?lt(z,st,z.next)>=0&&lt(z,z.prev,st)>=0:lt(z,st,z.prev)<0||lt(z,z.next,st)<0}function ot(z,st){var rt=z,Pt=!1,St=(z.x+st.x)/2,ut=(z.y+st.y)/2;do rt.y>ut!=rt.next.y>ut&&rt.next.y!==rt.y&&St<(rt.next.x-rt.x)*(ut-rt.y)/(rt.next.y-rt.y)+rt.x&&(Pt=!Pt),rt=rt.next;while(rt!==z);return Pt}function qt(z,st){var rt=new ye(z.i,z.x,z.y),Pt=new ye(st.i,st.x,st.y),St=z.next,ut=st.prev;return z.next=st,st.prev=z,rt.next=St,St.prev=rt,Pt.next=rt,rt.prev=Pt,ut.next=Pt,Pt.prev=ut,Pt}function ve(z,st,rt,Pt){var St=new ye(z,st,rt);return Pt?(St.next=Pt.next,St.prev=Pt,Pt.next.prev=St,Pt.next=St):(St.prev=St,St.next=St),St}function _e(z){z.next.prev=z.prev,z.prev.next=z.next,z.prevZ&&(z.prevZ.nextZ=z.nextZ),z.nextZ&&(z.nextZ.prevZ=z.prevZ)}function ye(z,st,rt){this.i=z,this.x=st,this.y=rt,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Kt.deviation=function(z,st,rt,Pt){var St=st&&st.length,ut=St?st[0]*rt:z.length,bt=Math.abs(zt(z,0,ut,rt));if(St)for(var Nt=0,Vt=st.length;Nt<Vt;Nt++){var Bt=st[Nt]*rt,Ht=Nt<Vt-1?st[Nt+1]*rt:z.length;bt-=Math.abs(zt(z,Bt,Ht,rt))}var Qt=0;for(Nt=0;Nt<Pt.length;Nt+=3){var ee=Pt[Nt]*rt,le=Pt[Nt+1]*rt,he=Pt[Nt+2]*rt;Qt+=Math.abs((z[ee]-z[he])*(z[le+1]-z[ee+1])-(z[ee]-z[le])*(z[he+1]-z[ee+1]))}return bt===0&&Qt===0?0:Math.abs((Qt-bt)/bt)};function zt(z,st,rt,Pt){for(var St=0,ut=st,bt=rt-Pt;ut<rt;ut+=Pt)St+=(z[bt]-z[ut])*(z[ut+1]+z[bt+1]),bt=ut;return St}Kt.flatten=function(z){for(var st=z[0][0].length,rt={vertices:[],holes:[],dimensions:st},Pt=0,St=0;St<z.length;St++){for(var ut=0;ut<z[St].length;ut++)for(var bt=0;bt<st;bt++)rt.vertices.push(z[St][ut][bt]);St>0&&(Pt+=z[St-1].length,rt.holes.push(Pt))}return rt}},922:function(Wt,Kt,dt){"use strict";var S=(nt,mt,at)=>new Promise((L,$)=>{var tt=ft=>{try{Z(at.next(ft))}catch(yt){$(yt)}},it=ft=>{try{Z(at.throw(ft))}catch(yt){$(yt)}},Z=ft=>ft.done?L(ft.value):Promise.resolve(ft.value).then(tt,it);Z((at=at.apply(nt,mt)).next())});const ct=[()=>S(this,null,function*(){return Promise.resolve().then(dt.bind(dt,96))}),()=>S(this,null,function*(){return Promise.resolve().then(dt.bind(dt,506))}),()=>S(this,null,function*(){return Promise.resolve().then(dt.bind(dt,678))}),()=>S(this,null,function*(){return Promise.resolve().then(dt.bind(dt,956))}),()=>S(this,null,function*(){return Promise.resolve().then(dt.bind(dt,295))})],xt=[()=>S(this,null,function*(){return Promise.resolve().then(dt.bind(dt,340))})];let Lt=0,vt=0;(()=>S(this,null,function*(){var nt,mt;const at=document.getElementsByClassName("loading-progress")[0],L=document.getElementsByClassName("loading-text")[0],$=Date.now();console.group("Loading..."),console.time("Loading Ended"),console.log(`${$} | Loading Started`);for(let it=0;it<ct.length;it++){const Z=(nt=ct[it].toString().match(/("|'|`).*?("|'|`)/))==null?void 0:nt[0].replace(/("|'|`)/g,"").replace(/_/g,"/");Z&&(at.innerHTML=`${Lt}/${ct.length}`,L.innerHTML=`Loading: ${Z}`,console.time(Z),console.group(`${Z}`),yield ct[it]().then(()=>{console.log(`${Date.now()} | Script ${Z} has run`),Lt++}).catch(ft=>{console.error(`${Date.now()} | Failed to run script ${Z}:`,ft)}),console.timeEnd(Z),console.groupEnd())}for(let it=0;it<xt.length;it++){const Z=(mt=xt[it].toString().match(/("|'|`).*?("|'|`)/))==null?void 0:mt[0].replace(/("|'|`)/g,"").replace(/_/g,"/");Z&&(at.innerHTML=`${vt}/${xt.length}`,L.innerHTML=`Loading: ${Z}`,console.time(Z),console.group(`${Z}`),yield xt[it]().then(()=>{console.log(`${Date.now()} | Stylesheet ${Z} has run`),vt++}).catch(ft=>{console.error(`${Date.now()} | Failed to run Stylesheet ${Z}:`,ft)}),console.timeEnd(Z),console.groupEnd())}console.timeEnd("Loading Ended"),console.groupEnd();const tt=document.querySelector(".loading-screen");tt&&document.body.removeChild(tt)}))()},956:function(Wt,Kt,dt){"use strict";dt.r(Kt);var S=dt(96),ct=dt(108),xt=dt(465),Lt=dt(479),vt=dt(667),Ft=dt.n(vt);const{Graphics:nt}=xt,{app:mt}=S.default.PIXI;function at($,tt){const it=new nt;return it.beginFill(16777215),it.drawCircle(0,0,45),it.endFill(),it.x=$,it.y=tt,new ct.E(it,"Circle")}function L(){const it=mt.screen.width/2-300,Z=mt.screen.width/2+600/2,ft=mt.screen.height/2-400/2,yt=mt.screen.height/2+400/2,K=Math.random()*(Z-it)+it,lt=Math.random()*(yt-ft)+ft;return at(K,lt)}Lt.X.addEvent("Mass Spawn","interval",(0,vt.E)(1e3).div(S.default.data.quarks.regenRate),()=>{S.default.data.quarks.maxParticles.gt(S.default.static.massParticles.length)&&S.default.static.massParticles.push(L())})},678:function(Wt,Kt,dt){"use strict";dt.r(Kt);var S=dt(465),ct=dt(774);/*!
 * @pixi/filter-adjustment - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-adjustment is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var xt=null,Lt=null;class vt extends null{constructor(M){super(xt,Lt),this.gamma=1,this.saturation=1,this.contrast=1,this.brightness=1,this.red=1,this.green=1,this.blue=1,this.alpha=1,Object.assign(this,M)}apply(M,Y,pt,Ct){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,M.applyFilter(this,Y,pt,Ct)}}/*!
 * @pixi/filter-kawase-blur - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-kawase-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ft=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,nt=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}`,mt=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;
uniform vec4 filterClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample top right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}
`;class at extends ct.wn{constructor(M=4,Y=3,pt=!1){super(Ft,pt?mt:nt),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new ct.E9,this.pixelSize=1,this._clamp=pt,Array.isArray(M)?this.kernels=M:(this._blur=M,this.quality=Y)}apply(M,Y,pt,Ct){const Mt=this._pixelSize.x/Y._frame.width,Yt=this._pixelSize.y/Y._frame.height;let me;if(this._quality===1||this._blur===0)me=this._kernels[0]+.5,this.uniforms.uOffset[0]=me*Mt,this.uniforms.uOffset[1]=me*Yt,M.applyFilter(this,Y,pt,Ct);else{const de=M.getFilterTexture();let tr=Y,Le=de,ar;const rr=this._quality-1;for(let Br=0;Br<rr;Br++)me=this._kernels[Br]+.5,this.uniforms.uOffset[0]=me*Mt,this.uniforms.uOffset[1]=me*Yt,M.applyFilter(this,tr,Le,1),ar=tr,tr=Le,Le=ar;me=this._kernels[rr]+.5,this.uniforms.uOffset[0]=me*Mt,this.uniforms.uOffset[1]=me*Yt,M.applyFilter(this,tr,pt,Ct),M.returnFilterTexture(de)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((M,Y)=>M+Y+.5,0))}_generateKernels(){const M=this._blur,Y=this._quality,pt=[M];if(M>0){let Ct=M;const Mt=M/Y;for(let Yt=1;Yt<Y;Yt++)Ct-=Mt,pt.push(Ct)}this._kernels=pt,this._updatePadding()}get kernels(){return this._kernels}set kernels(M){Array.isArray(M)&&M.length>0?(this._kernels=M,this._quality=M.length,this._blur=Math.max(...M)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(M){typeof M=="number"?(this._pixelSize.x=M,this._pixelSize.y=M):Array.isArray(M)?(this._pixelSize.x=M[0],this._pixelSize.y=M[1]):M instanceof ct.E9?(this._pixelSize.x=M.x,this._pixelSize.y=M.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(M){this._quality=Math.max(1,Math.round(M)),this._generateKernels()}get blur(){return this._blur}set blur(M){this._blur=M,this._generateKernels()}}/*!
 * @pixi/filter-advanced-bloom - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-advanced-bloom is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var L=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,$=`
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform float threshold;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);

    // A simple & fast algorithm for getting brightness.
    // It's inaccuracy , but good enought for this feature.
    float _max = max(max(color.r, color.g), color.b);
    float _min = min(min(color.r, color.g), color.b);
    float brightness = (_max + _min) * 0.5;

    if(brightness > threshold) {
        gl_FragColor = color;
    } else {
        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
}
`;class tt extends ct.wn{constructor(M=.5){super(L,$),this.threshold=M}get threshold(){return this.uniforms.threshold}set threshold(M){this.uniforms.threshold=M}}var it=`uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform sampler2D bloomTexture;
uniform float bloomScale;
uniform float brightness;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);
    color.rgb *= brightness;
    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);
    bloomColor.rgb *= bloomScale;
    gl_FragColor = color + bloomColor;
}
`;const Z=class extends ct.wn{constructor(I){super(L,it),this.bloomScale=1,this.brightness=1,this._resolution=ct.Xd.FILTER_RESOLUTION,typeof I=="number"&&(I={threshold:I});const M=Object.assign(Z.defaults,I);this.bloomScale=M.bloomScale,this.brightness=M.brightness;const{kernels:Y,blur:pt,quality:Ct,pixelSize:Mt,resolution:Yt}=M;this._extractFilter=new tt(M.threshold),this._extractFilter.resolution=Yt,this._blurFilter=Y?new at(Y):new at(pt,Ct),this.pixelSize=Mt,this.resolution=Yt}apply(I,M,Y,pt,Ct){const Mt=I.getFilterTexture();this._extractFilter.apply(I,M,Mt,1,Ct);const Yt=I.getFilterTexture();this._blurFilter.apply(I,Mt,Yt,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=Yt,I.applyFilter(this,M,Y,pt),I.returnFilterTexture(Yt),I.returnFilterTexture(Mt)}get resolution(){return this._resolution}set resolution(I){this._resolution=I,this._extractFilter&&(this._extractFilter.resolution=I),this._blurFilter&&(this._blurFilter.resolution=I)}get threshold(){return this._extractFilter.threshold}set threshold(I){this._extractFilter.threshold=I}get kernels(){return this._blurFilter.kernels}set kernels(I){this._blurFilter.kernels=I}get blur(){return this._blurFilter.blur}set blur(I){this._blurFilter.blur=I}get quality(){return this._blurFilter.quality}set quality(I){this._blurFilter.quality=I}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(I){this._blurFilter.pixelSize=I}};let ft=Z;ft.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:ct.Xd.FILTER_RESOLUTION};/*!
 * @pixi/filter-ascii - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-ascii is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var yt=null,K=null;class lt extends null{constructor(M=8){super(yt,K),this.size=M}get size(){return this.uniforms.pixelSize}set size(M){this.uniforms.pixelSize=M}}/*!
 * @pixi/filter-bevel - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-bevel is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var _t=null,It=null;class Et extends null{constructor(M){super(_t,It),this._thickness=2,this._angle=0,this.uniforms.lightColor=new Float32Array(3),this.uniforms.shadowColor=new Float32Array(3),Object.assign(this,{rotation:45,thickness:2,lightColor:16777215,lightAlpha:.7,shadowColor:0,shadowAlpha:.7},M),this.padding=1}_updateTransform(){this.uniforms.transformX=this._thickness*Math.cos(this._angle),this.uniforms.transformY=this._thickness*Math.sin(this._angle)}get rotation(){return this._angle/t}set rotation(M){this._angle=M*t,this._updateTransform()}get thickness(){return this._thickness}set thickness(M){this._thickness=M,this._updateTransform()}get lightColor(){return r.rgb2hex(this.uniforms.lightColor)}set lightColor(M){r.hex2rgb(M,this.uniforms.lightColor)}get lightAlpha(){return this.uniforms.lightAlpha}set lightAlpha(M){this.uniforms.lightAlpha=M}get shadowColor(){return r.rgb2hex(this.uniforms.shadowColor)}set shadowColor(M){r.hex2rgb(M,this.uniforms.shadowColor)}get shadowAlpha(){return this.uniforms.shadowAlpha}set shadowAlpha(M){this.uniforms.shadowAlpha=M}}var Dt=dt(121),q=dt(844);/*!
 * @pixi/filter-bloom - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-bloom is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */class At extends null{constructor(M=2,Y=4,pt=n.FILTER_RESOLUTION,Ct=5){super();let Mt,Yt;typeof M=="number"?(Mt=M,Yt=M):M instanceof F?(Mt=M.x,Yt=M.y):Array.isArray(M)&&(Mt=M[0],Yt=M[1]),this.blurXFilter=new s(!0,Mt,Y,pt,Ct),this.blurYFilter=new s(!1,Yt,Y,pt,Ct),this.blurYFilter.blendMode=o.SCREEN,this.defaultFilter=new h}apply(M,Y,pt,Ct){const Mt=M.getFilterTexture();this.defaultFilter.apply(M,Y,pt,Ct),this.blurXFilter.apply(M,Y,Mt,1),this.blurYFilter.apply(M,Mt,pt,0),M.returnFilterTexture(Mt)}get blur(){return this.blurXFilter.blur}set blur(M){this.blurXFilter.blur=this.blurYFilter.blur=M}get blurX(){return this.blurXFilter.blur}set blurX(M){this.blurXFilter.blur=M}get blurY(){return this.blurYFilter.blur}set blurY(M){this.blurYFilter.blur=M}}/*!
 * @pixi/filter-bulge-pinch - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-bulge-pinch is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ot=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,qt=`uniform float radius;
uniform float strength;
uniform vec2 center;
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

void main()
{
    vec2 coord = vTextureCoord * filterArea.xy;
    coord -= center * dimensions.xy;
    float distance = length(coord);
    if (distance < radius) {
        float percent = distance / radius;
        if (strength > 0.0) {
            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);
        } else {
            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);
        }
    }
    coord += center * dimensions.xy;
    coord /= filterArea.xy;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    gl_FragColor = color;
}
`;const ve=class extends ct.wn{constructor(I){super(ot,qt),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,ve.defaults,I)}apply(I,M,Y,pt){const{width:Ct,height:Mt}=M.filterFrame;this.uniforms.dimensions[0]=Ct,this.uniforms.dimensions[1]=Mt,I.applyFilter(this,M,Y,pt)}get radius(){return this.uniforms.radius}set radius(I){this.uniforms.radius=I}get strength(){return this.uniforms.strength}set strength(I){this.uniforms.strength=I}get center(){return this.uniforms.center}set center(I){this.uniforms.center=I}};let _e=ve;_e.defaults={center:[.5,.5],radius:100,strength:1};/*!
 * @pixi/filter-color-gradient - v5.2.0
 * Compiled Tue, 28 Feb 2023 14:24:35 UTC
 *
 * @pixi/filter-color-gradient is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ye=`const float PI = 3.1415926538;
const float PI_2 = PI*2.;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;
uniform sampler2D uSampler;

const int TYPE_LINEAR = 0;
const int TYPE_RADIAL = 1;
const int TYPE_CONIC = 2;
const int MAX_STOPS = 32;

uniform int uNumStops;
uniform float uAlphas[3*MAX_STOPS];
uniform vec3 uColors[MAX_STOPS];
uniform float uOffsets[MAX_STOPS];
uniform int uType;
uniform float uAngle;
uniform float uAlpha;
uniform int uMaxColors;

struct ColorStop {
    float offset;
    vec3 color;
    float alpha;
};

mat2 rotate2d(float angle){
    return mat2(cos(angle), -sin(angle),
    sin(angle), cos(angle));
}

float projectLinearPosition(vec2 pos, float angle){
    vec2 center = vec2(0.5);
    vec2 result = pos - center;
    result = rotate2d(angle) * result;
    result = result + center;
    return clamp(result.x, 0., 1.);
}

float projectRadialPosition(vec2 pos) {
    float r = distance(vFilterCoord, vec2(0.5));
    return clamp(2.*r, 0., 1.);
}

float projectAnglePosition(vec2 pos, float angle) {
    vec2 center = pos - vec2(0.5);
    float polarAngle=atan(-center.y, center.x);
    return mod(polarAngle + angle, PI_2) / PI_2;
}

float projectPosition(vec2 pos, int type, float angle) {
    if (type == TYPE_LINEAR) {
        return projectLinearPosition(pos, angle);
    } else if (type == TYPE_RADIAL) {
        return projectRadialPosition(pos);
    } else if (type == TYPE_CONIC) {
        return projectAnglePosition(pos, angle);
    }

    return pos.y;
}

void main(void) {
    // current/original color
    vec4 currentColor = texture2D(uSampler, vTextureCoord);

    // skip calculations if gradient alpha is 0
    if (0.0 == uAlpha) {
        gl_FragColor = currentColor;
        return;
    }

    // project position
    float y = projectPosition(vFilterCoord, uType, radians(uAngle));

    // check gradient bounds
    float offsetMin = uOffsets[0];
    float offsetMax = 0.0;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (i == uNumStops-1){ // last index
            offsetMax = uOffsets[i];
        }
    }

    if (y  < offsetMin || y > offsetMax) {
        gl_FragColor = currentColor;
        return;
    }

    // limit colors
    if (uMaxColors > 0) {
        float stepSize = 1./float(uMaxColors);
        float stepNumber = float(floor(y/stepSize));
        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment
    }

    // find color stops
    ColorStop from;
    ColorStop to;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (y >= uOffsets[i]) {
            from = ColorStop(uOffsets[i], uColors[i], uAlphas[i]);
            to = ColorStop(uOffsets[i+1], uColors[i+1], uAlphas[i+1]);
        }

        if (i == uNumStops-1){ // last index
            break;
        }
    }

    // mix colors from stops
    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);
    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);

    float segmentHeight = to.offset - from.offset;
    float relativePos = y - from.offset;// position from 0 to [segmentHeight]
    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].

    float gradientAlpha = uAlpha * currentColor.a;
    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

    // mix resulting color with current color
    gl_FragColor = gradientColor + currentColor*(1.-gradientColor.a);
}
`,zt=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform vec4 inputSize;
uniform vec4 outputFrame;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
    vFilterCoord = vTextureCoord * inputSize.xy / outputFrame.zw;
}
`,z=z||{};z.stringify=function(){var I={"visit_linear-gradient":function(M){return I.visit_gradient(M)},"visit_repeating-linear-gradient":function(M){return I.visit_gradient(M)},"visit_radial-gradient":function(M){return I.visit_gradient(M)},"visit_repeating-radial-gradient":function(M){return I.visit_gradient(M)},visit_gradient:function(M){var Y=I.visit(M.orientation);return Y&&(Y+=", "),M.type+"("+Y+I.visit(M.colorStops)+")"},visit_shape:function(M){var Y=M.value,pt=I.visit(M.at),Ct=I.visit(M.style);return Ct&&(Y+=" "+Ct),pt&&(Y+=" at "+pt),Y},"visit_default-radial":function(M){var Y="",pt=I.visit(M.at);return pt&&(Y+=pt),Y},"visit_extent-keyword":function(M){var Y=M.value,pt=I.visit(M.at);return pt&&(Y+=" at "+pt),Y},"visit_position-keyword":function(M){return M.value},visit_position:function(M){return I.visit(M.value.x)+" "+I.visit(M.value.y)},"visit_%":function(M){return M.value+"%"},visit_em:function(M){return M.value+"em"},visit_px:function(M){return M.value+"px"},visit_literal:function(M){return I.visit_color(M.value,M)},visit_hex:function(M){return I.visit_color("#"+M.value,M)},visit_rgb:function(M){return I.visit_color("rgb("+M.value.join(", ")+")",M)},visit_rgba:function(M){return I.visit_color("rgba("+M.value.join(", ")+")",M)},visit_color:function(M,Y){var pt=M,Ct=I.visit(Y.length);return Ct&&(pt+=" "+Ct),pt},visit_angular:function(M){return M.value+"deg"},visit_directional:function(M){return"to "+M.value},visit_array:function(M){var Y="",pt=M.length;return M.forEach(function(Ct,Mt){Y+=I.visit(Ct),Mt<pt-1&&(Y+=", ")}),Y},visit:function(M){if(!M)return"";var Y="";if(M instanceof Array)return I.visit_array(M,Y);if(M.type){var pt=I["visit_"+M.type];if(pt)return pt(M);throw Error("Missing visitor visit_"+M.type)}else throw Error("Invalid node.")}};return function(M){return I.visit(M)}}();var z=z||{};z.parse=function(){var I={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},M="";function Y(xe){var Oe=new Error(M+": "+xe);throw Oe.source=M,Oe}function pt(){var xe=Ct();return M.length>0&&Y("Invalid input not EOF"),xe}function Ct(){return ds(Mt)}function Mt(){return Yt("linear-gradient",I.linearGradient,de)||Yt("repeating-linear-gradient",I.repeatingLinearGradient,de)||Yt("radial-gradient",I.radialGradient,ar)||Yt("repeating-radial-gradient",I.repeatingRadialGradient,ar)}function Yt(xe,Oe,lr){return me(Oe,function(pr){var li=lr();return li&&(ai(I.comma)||Y("Missing comma before color stops")),{type:xe,orientation:li,colorStops:ds(Fs)}})}function me(xe,Oe){var lr=ai(xe);if(lr){ai(I.startCall)||Y("Missing (");var pr=Oe(lr);return ai(I.endCall)||Y("Missing )"),pr}}function de(){return tr()||Le()}function tr(){return Cr("directional",I.sideOrCorner,1)}function Le(){return Cr("angular",I.angleValue,1)}function ar(){var xe,Oe=rr(),lr;return Oe&&(xe=[],xe.push(Oe),lr=M,ai(I.comma)&&(Oe=rr(),Oe?xe.push(Oe):M=lr)),xe}function rr(){var xe=Br()||Wi();if(xe)xe.at=Vr();else{var Oe=Si();if(Oe){xe=Oe;var lr=Vr();lr&&(xe.at=lr)}else{var pr=$i();pr&&(xe={type:"default-radial",at:pr})}}return xe}function Br(){var xe=Cr("shape",/^(circle)/i,0);return xe&&(xe.style=Bs()||Si()),xe}function Wi(){var xe=Cr("shape",/^(ellipse)/i,0);return xe&&(xe.style=oi()||Si()),xe}function Si(){return Cr("extent-keyword",I.extentKeywords,1)}function Vr(){if(Cr("position",/^at/,0)){var xe=$i();return xe||Y("Missing positioning value"),xe}}function $i(){var xe=cs();if(xe.x||xe.y)return{type:"position",value:xe}}function cs(){return{x:oi(),y:oi()}}function ds(xe){var Oe=xe(),lr=[];if(Oe)for(lr.push(Oe);ai(I.comma);)Oe=xe(),Oe?lr.push(Oe):Y("One extra comma");return lr}function Fs(){var xe=qr();return xe||Y("Expected color definition"),xe.length=oi(),xe}function qr(){return Ci()||pn()||Ns()||Ds()}function Ds(){return Cr("literal",I.literalColor,0)}function Ci(){return Cr("hex",I.hexColor,1)}function Ns(){return me(I.rgbColor,function(){return{type:"rgb",value:ds(fs)}})}function pn(){return me(I.rgbaColor,function(){return{type:"rgba",value:ds(fs)}})}function fs(){return ai(I.number)[1]}function oi(){return Cr("%",I.percentageValue,1)||ps()||Bs()}function ps(){return Cr("position-keyword",I.positionKeywords,1)}function Bs(){return Cr("px",I.pixelValue,1)||Cr("em",I.emValue,1)}function Cr(xe,Oe,lr){var pr=ai(Oe);if(pr)return{type:xe,value:pr[lr]}}function ai(xe){var Oe,lr;return lr=/^[\n\r\t\s]+/.exec(M),lr&&Kr(lr[0].length),Oe=xe.exec(M),Oe&&Kr(Oe[0].length),Oe}function Kr(xe){M=M.substr(xe)}return function(xe){return M=xe.toString(),pt()}}();var st=z.parse;z.stringify;var rt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Pt={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function St(I){var M,Y=[],pt=1,Ct;if(typeof I=="string")if(rt[I])Y=rt[I].slice(),Ct="rgb";else if(I==="transparent")pt=0,Ct="rgb",Y=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(I)){var Mt=I.slice(1),Yt=Mt.length,me=Yt<=4;pt=1,me?(Y=[parseInt(Mt[0]+Mt[0],16),parseInt(Mt[1]+Mt[1],16),parseInt(Mt[2]+Mt[2],16)],Yt===4&&(pt=parseInt(Mt[3]+Mt[3],16)/255)):(Y=[parseInt(Mt[0]+Mt[1],16),parseInt(Mt[2]+Mt[3],16),parseInt(Mt[4]+Mt[5],16)],Yt===8&&(pt=parseInt(Mt[6]+Mt[7],16)/255)),Y[0]||(Y[0]=0),Y[1]||(Y[1]=0),Y[2]||(Y[2]=0),Ct="rgb"}else if(M=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(I)){var de=M[1],tr=de==="rgb",Mt=de.replace(/a$/,"");Ct=Mt;var Yt=Mt==="cmyk"?4:Mt==="gray"?1:3;Y=M[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(rr,Br){if(/%$/.test(rr))return Br===Yt?parseFloat(rr)/100:Mt==="rgb"?parseFloat(rr)*255/100:parseFloat(rr);if(Mt[Br]==="h"){if(/deg$/.test(rr))return parseFloat(rr);if(Pt[rr]!==void 0)return Pt[rr]}return parseFloat(rr)}),de===Mt&&Y.push(1),pt=tr||Y[Yt]===void 0?1:Y[Yt],Y=Y.slice(0,Yt)}else I.length>10&&/[0-9](?:\s|\/)/.test(I)&&(Y=I.match(/([0-9]+)/g).map(function(Le){return parseFloat(Le)}),Ct=I.match(/([a-z])/ig).join("").toLowerCase());else isNaN(I)?Array.isArray(I)||I.length?(Y=[I[0],I[1],I[2]],Ct="rgb",pt=I.length===4?I[3]:1):I instanceof Object&&(I.r!=null||I.red!=null||I.R!=null?(Ct="rgb",Y=[I.r||I.red||I.R||0,I.g||I.green||I.G||0,I.b||I.blue||I.B||0]):(Ct="hsl",Y=[I.h||I.hue||I.H||0,I.s||I.saturation||I.S||0,I.l||I.lightness||I.L||I.b||I.brightness]),pt=I.a||I.alpha||I.opacity||1,I.opacity!=null&&(pt/=100)):(Ct="rgb",Y=[I>>>16,(I&65280)>>>8,I&255]);return{space:Ct,values:Y,alpha:pt}}var ut={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},bt={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(I){var M=I[0]/360,Y=I[1]/100,pt=I[2]/100,Ct,Mt,Yt,me,de;if(Y===0)return de=pt*255,[de,de,de];pt<.5?Mt=pt*(1+Y):Mt=pt+Y-pt*Y,Ct=2*pt-Mt,me=[0,0,0];for(var tr=0;tr<3;tr++)Yt=M+1/3*-(tr-1),Yt<0?Yt++:Yt>1&&Yt--,6*Yt<1?de=Ct+(Mt-Ct)*6*Yt:2*Yt<1?de=Mt:3*Yt<2?de=Ct+(Mt-Ct)*(2/3-Yt)*6:de=Ct,me[tr]=de*255;return me}};ut.hsl=function(I){var M=I[0]/255,Y=I[1]/255,pt=I[2]/255,Ct=Math.min(M,Y,pt),Mt=Math.max(M,Y,pt),Yt=Mt-Ct,me,de,tr;return Mt===Ct?me=0:M===Mt?me=(Y-pt)/Yt:Y===Mt?me=2+(pt-M)/Yt:pt===Mt&&(me=4+(M-Y)/Yt),me=Math.min(me*60,360),me<0&&(me+=360),tr=(Ct+Mt)/2,Mt===Ct?de=0:tr<=.5?de=Yt/(Mt+Ct):de=Yt/(2-Mt-Ct),[me,de*100,tr*100]};function Nt(I){Array.isArray(I)&&I.raw&&(I=String.raw(...arguments));var M,Y=St(I);if(!Y.space)return[];const pt=Y.space[0]==="h"?bt.min:ut.min,Ct=Y.space[0]==="h"?bt.max:ut.max;return M=Array(3),M[0]=Math.min(Math.max(Y.values[0],pt[0]),Ct[0]),M[1]=Math.min(Math.max(Y.values[1],pt[1]),Ct[1]),M[2]=Math.min(Math.max(Y.values[2],pt[2]),Ct[2]),Y.space[0]==="h"&&(M=bt.rgb(M)),M.push(Math.min(Math.max(Y.alpha,0),1)),M}function Vt(I){switch(typeof I){case"string":return Bt(I);case"number":return ct.P6.hex2rgb(I);default:return I}}function Bt(I){const M=Nt(I);if(!M)throw new Error(`Unable to parse color "${I}" as RGBA.`);return[M[0]/255,M[1]/255,M[2]/255,M[3]]}function Ht(I){const M=st(ue(I));if(M.length===0)throw new Error("Invalid CSS gradient.");if(M.length!==1)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");const Y=M[0],pt=Qt(Y.type),Ct=ee(Y.colorStops),Mt=te(Y.orientation);return{type:pt,stops:Ct,angle:Mt}}function Qt(I){const M={"linear-gradient":0,"radial-gradient":1};if(!(I in M))throw new Error(`Unsupported gradient type "${I}"`);return M[I]}function ee(I){const M=Xe(I),Y=[];for(let pt=0;pt<I.length;pt++){const Ct=le(I[pt]);Y.push({offset:M[pt],color:Ct.slice(0,3),alpha:Ct[3]})}return Y}function le(I){return Vt(he(I))}function he(I){switch(I.type){case"hex":return`#${I.value}`;case"literal":return I.value;default:return`${I.type}(${I.value.join(",")})`}}function Xe(I){const M=[];for(let Ct=0;Ct<I.length;Ct++){const Mt=I[Ct];let Yt=-1;Mt.type==="literal"&&Mt.length&&"type"in Mt.length&&Mt.length.type==="%"&&"value"in Mt.length&&(Yt=parseFloat(Mt.length.value)/100),M.push(Yt)}const Y=Ct=>{for(let Mt=Ct;Mt<M.length;Mt++)if(M[Mt]!==-1)return{indexDelta:Mt-Ct,offset:M[Mt]};return{indexDelta:M.length-1-Ct,offset:1}};let pt=0;for(let Ct=0;Ct<M.length;Ct++){const Mt=M[Ct];if(Mt!==-1)pt=Mt;else if(Ct===0)M[Ct]=0;else if(Ct+1===M.length)M[Ct]=1;else{const Yt=Y(Ct),me=(Yt.offset-pt)/(1+Yt.indexDelta);for(let de=0;de<=Yt.indexDelta;de++)M[Ct+de]=pt+(de+1)*me;Ct+=Yt.indexDelta,pt=M[Ct]}}return M.map(Ee)}function Ee(I){return I.toString().length>6?parseFloat(I.toString().substring(0,6)):I}function te(I){if(typeof I=="undefined")return 0;if("type"in I&&"value"in I)switch(I.type){case"angular":return parseFloat(I.value);case"directional":return We(I.value)}return 0}function We(I){const M={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(I in M))throw new Error(`Unsupported directional value "${I}"`);return M[I]}function ue(I){let M=I.replace(/\s{2,}/gu," ");return M=M.replace(/;/g,""),M=M.replace(/ ,/g,","),M=M.replace(/\( /g,"("),M=M.replace(/ \)/g,")"),M.trim()}var fe=Object.defineProperty,Se=Object.defineProperties,Er=Object.getOwnPropertyDescriptors,vr=Object.getOwnPropertySymbols,Tr=Object.prototype.hasOwnProperty,wr=Object.prototype.propertyIsEnumerable,jr=(I,M,Y)=>M in I?fe(I,M,{enumerable:!0,configurable:!0,writable:!0,value:Y}):I[M]=Y,Lr=(I,M)=>{for(var Y in M||(M={}))Tr.call(M,Y)&&jr(I,Y,M[Y]);if(vr)for(var Y of vr(M))wr.call(M,Y)&&jr(I,Y,M[Y]);return I},Ar=(I,M)=>Se(I,Er(M));const sr=90;function Wr(I){return[...I].sort((M,Y)=>M.offset-Y.offset)}const xr=class extends ct.wn{constructor(I){I&&"css"in I&&(I=Ar(Lr({},Ht(I.css||"")),{alpha:I.alpha,maxColors:I.maxColors}));const M=Lr(Lr({},xr.defaults),I);if(!M.stops||M.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");super(zt,ye),this._stops=[],this.autoFit=!1,Object.assign(this,M)}get stops(){return this._stops}set stops(I){const M=Wr(I),Y=new Float32Array(M.length*3),pt=0,Ct=1,Mt=2;for(let Yt=0;Yt<M.length;Yt++){const me=Vt(M[Yt].color),de=Yt*3;Y[de+pt]=me[pt],Y[de+Ct]=me[Ct],Y[de+Mt]=me[Mt]}this.uniforms.uColors=Y,this.uniforms.uOffsets=M.map(Yt=>Yt.offset),this.uniforms.uAlphas=M.map(Yt=>Yt.alpha),this.uniforms.uNumStops=M.length,this._stops=M}set type(I){this.uniforms.uType=I}get type(){return this.uniforms.uType}set angle(I){this.uniforms.uAngle=I-sr}get angle(){return this.uniforms.uAngle+sr}set alpha(I){this.uniforms.uAlpha=I}get alpha(){return this.uniforms.uAlpha}set maxColors(I){this.uniforms.uMaxColors=I}get maxColors(){return this.uniforms.uMaxColors}};let Je=xr;Je.LINEAR=0,Je.RADIAL=1,Je.CONIC=2,Je.defaults={type:xr.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0};/*!
 * @pixi/filter-color-map - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-color-map is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var N=null,k=null;class x extends null{constructor(M,Y=!1,pt=1){super(N,k),this.mix=1,this._size=0,this._sliceSize=0,this._slicePixelSize=0,this._sliceInnerSize=0,this._nearest=!1,this._scaleMode=null,this._colorMap=null,this._scaleMode=null,this.nearest=Y,this.mix=pt,this.colorMap=M}apply(M,Y,pt,Ct){this.uniforms._mix=this.mix,M.applyFilter(this,Y,pt,Ct)}get colorSize(){return this._size}get colorMap(){return this._colorMap}set colorMap(M){!M||(M instanceof s||(M=s.from(M)),M!=null&&M.baseTexture&&(M.baseTexture.scaleMode=this._scaleMode,M.baseTexture.mipmap=o.OFF,this._size=M.height,this._sliceSize=1/this._size,this._slicePixelSize=this._sliceSize/this._size,this._sliceInnerSize=this._slicePixelSize*(this._size-1),this.uniforms._size=this._size,this.uniforms._sliceSize=this._sliceSize,this.uniforms._slicePixelSize=this._slicePixelSize,this.uniforms._sliceInnerSize=this._sliceInnerSize,this.uniforms.colorMap=M),this._colorMap=M)}get nearest(){return this._nearest}set nearest(M){this._nearest=M,this._scaleMode=M?r.NEAREST:r.LINEAR;const Y=this._colorMap;Y&&Y.baseTexture&&(Y.baseTexture._glTextures={},Y.baseTexture.scaleMode=this._scaleMode,Y.baseTexture.mipmap=o.OFF,Y._updateID++,Y.baseTexture.emit("update",Y.baseTexture))}updateColorMap(){const M=this._colorMap;M&&M.baseTexture&&(M._updateID++,M.baseTexture.emit("update",M.baseTexture),this.colorMap=M)}destroy(M=!1){this._colorMap&&this._colorMap.destroy(M),super.destroy()}}/*!
 * @pixi/filter-color-overlay - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-color-overlay is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var w=null,O=null;class H extends null{constructor(M=0,Y=1){super(w,O),this._color=0,this._alpha=1,this.uniforms.color=new Float32Array(3),this.color=M,this.alpha=Y}set color(M){const Y=this.uniforms.color;typeof M=="number"?(t.hex2rgb(M,Y),this._color=M):(Y[0]=M[0],Y[1]=M[1],Y[2]=M[2],this._color=t.rgb2hex(Y))}get color(){return this._color}set alpha(M){this.uniforms.alpha=M,this._alpha=M}get alpha(){return this._alpha}}/*!
 * @pixi/filter-color-replace - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-color-replace is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var V=null,Q=null;class Gt extends null{constructor(M=16711680,Y=0,pt=.4){super(V,Q),this._originalColor=16711680,this._newColor=0,this.uniforms.originalColor=new Float32Array(3),this.uniforms.newColor=new Float32Array(3),this.originalColor=M,this.newColor=Y,this.epsilon=pt}set originalColor(M){const Y=this.uniforms.originalColor;typeof M=="number"?(e.hex2rgb(M,Y),this._originalColor=M):(Y[0]=M[0],Y[1]=M[1],Y[2]=M[2],this._originalColor=e.rgb2hex(Y))}get originalColor(){return this._originalColor}set newColor(M){const Y=this.uniforms.newColor;typeof M=="number"?(e.hex2rgb(M,Y),this._newColor=M):(Y[0]=M[0],Y[1]=M[1],Y[2]=M[2],this._newColor=e.rgb2hex(Y))}get newColor(){return this._newColor}set epsilon(M){this.uniforms.epsilon=M}get epsilon(){return this.uniforms.epsilon}}/*!
 * @pixi/filter-convolution - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-convolution is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var $t=null,Zt=null;class se extends null{constructor(M,Y=200,pt=200){super($t,Zt),this.uniforms.texelSize=new Float32Array(2),this.uniforms.matrix=new Float32Array(9),M!==void 0&&(this.matrix=M),this.width=Y,this.height=pt}get matrix(){return this.uniforms.matrix}set matrix(M){M.forEach((Y,pt)=>{this.uniforms.matrix[pt]=Y})}get width(){return 1/this.uniforms.texelSize[0]}set width(M){this.uniforms.texelSize[0]=1/M}get height(){return 1/this.uniforms.texelSize[1]}set height(M){this.uniforms.texelSize[1]=1/M}}/*!
 * @pixi/filter-cross-hatch - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-cross-hatch is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ae=null,Be=null;class Ue extends null{constructor(){super(Ae,Be)}}/*!
 * @pixi/filter-crt - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-crt is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var dr=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Ie=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec2 dimensions;

const float SQRT_2 = 1.414213;

const float light = 1.0;

uniform float curvature;
uniform float lineWidth;
uniform float lineContrast;
uniform bool verticalLine;
uniform float noise;
uniform float noiseSize;

uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;

uniform float seed;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));
    
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 rgb = gl_FragColor.rgb;

    if (noise > 0.0 && noiseSize > 0.0)
    {
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        rgb += _noise * noise;
    }

    if (lineWidth > 0.0)
    {
        float _c = curvature > 0. ? curvature : 1.;
        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
        vec2 uv = dir * k;

        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;
        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;
        rgb *= j;
        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);
        rgb *= 0.99 + ceil(segment) * 0.015;
    }

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    gl_FragColor.rgb = rgb;
}
`;const Ne=class extends ct.wn{constructor(I){super(dr,Ie),this.time=0,this.seed=0,this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Ne.defaults,I)}apply(I,M,Y,pt){const{width:Ct,height:Mt}=M.filterFrame;this.uniforms.dimensions[0]=Ct,this.uniforms.dimensions[1]=Mt,this.uniforms.seed=this.seed,this.uniforms.time=this.time,I.applyFilter(this,M,Y,pt)}set curvature(I){this.uniforms.curvature=I}get curvature(){return this.uniforms.curvature}set lineWidth(I){this.uniforms.lineWidth=I}get lineWidth(){return this.uniforms.lineWidth}set lineContrast(I){this.uniforms.lineContrast=I}get lineContrast(){return this.uniforms.lineContrast}set verticalLine(I){this.uniforms.verticalLine=I}get verticalLine(){return this.uniforms.verticalLine}set noise(I){this.uniforms.noise=I}get noise(){return this.uniforms.noise}set noiseSize(I){this.uniforms.noiseSize=I}get noiseSize(){return this.uniforms.noiseSize}set vignetting(I){this.uniforms.vignetting=I}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(I){this.uniforms.vignettingAlpha=I}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(I){this.uniforms.vignettingBlur=I}get vignettingBlur(){return this.uniforms.vignettingBlur}};let Ge=Ne;Ge.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0};/*!
 * @pixi/filter-dot - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-dot is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var yr=null,Mr=null;class Ti extends null{constructor(M=1,Y=5,pt=!0){super(yr,Mr),this.scale=M,this.angle=Y,this.grayscale=pt}get scale(){return this.uniforms.scale}set scale(M){this.uniforms.scale=M}get angle(){return this.uniforms.angle}set angle(M){this.uniforms.angle=M}get grayscale(){return this.uniforms.grayscale}set grayscale(M){this.uniforms.grayscale=M}}/*!
 * @pixi/filter-drop-shadow - v5.2.0
 * Compiled Tue, 28 Feb 2023 14:24:35 UTC
 *
 * @pixi/filter-drop-shadow is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ir=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ci=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float alpha;
uniform vec3 color;

uniform vec2 shift;
uniform vec4 inputSize;

void main(void){
    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);

    // Premultiply alpha
    sample.rgb = color.rgb * sample.a;

    // alpha user alpha
    sample *= alpha;

    gl_FragColor = sample;
}`,Dr=Object.defineProperty,nr=Object.getOwnPropertySymbols,di=Object.prototype.hasOwnProperty,Bi=Object.prototype.propertyIsEnumerable,Oi=(I,M,Y)=>M in I?Dr(I,M,{enumerable:!0,configurable:!0,writable:!0,value:Y}):I[M]=Y,kr=(I,M)=>{for(var Y in M||(M={}))di.call(M,Y)&&Oi(I,Y,M[Y]);if(nr)for(var Y of nr(M))Bi.call(M,Y)&&Oi(I,Y,M[Y]);return I};const Rr=class extends ct.wn{constructor(I){super(),this.angle=45,this._distance=5,this._resolution=ct.Xd.FILTER_RESOLUTION;const M=I?kr(kr({},Rr.defaults),I):Rr.defaults,{kernels:Y,blur:pt,quality:Ct,pixelSize:Mt,resolution:Yt}=M;this._offset=new ct.AB(this._updatePadding,this),this._tintFilter=new ct.wn(Ir,ci),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=this._offset,this._tintFilter.resolution=Yt,this._blurFilter=Y?new at(Y):new at(pt,Ct),this.pixelSize=Mt,this.resolution=Yt;const{shadowOnly:me,rotation:de,distance:tr,offset:Le,alpha:ar,color:rr}=M;this.shadowOnly=me,de!==void 0&&tr!==void 0?(this.rotation=de,this.distance=tr):this.offset=Le,this.alpha=ar,this.color=rr}apply(I,M,Y,pt){const Ct=I.getFilterTexture();this._tintFilter.apply(I,M,Ct,1),this._blurFilter.apply(I,Ct,Y,pt),this.shadowOnly!==!0&&I.applyFilter(this,M,Y,0),I.returnFilterTexture(Ct)}_updatePadding(){const I=Math.max(Math.abs(this._offset.x),Math.abs(this._offset.y));this.padding=I+this.blur*2}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}set offset(I){this._offset.copyFrom(I),this._updatePadding()}get offset(){return this._offset}get resolution(){return this._resolution}set resolution(I){this._resolution=I,this._tintFilter&&(this._tintFilter.resolution=I),this._blurFilter&&(this._blurFilter.resolution=I)}get distance(){return this._distance}set distance(I){ct.P6.deprecation("5.3.0","DropShadowFilter distance is deprecated, use offset"),this._distance=I,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/ct.ZX}set rotation(I){ct.P6.deprecation("5.3.0","DropShadowFilter rotation is deprecated, use offset"),this.angle=I*ct.ZX,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(I){this._tintFilter.uniforms.alpha=I}get color(){return ct.P6.rgb2hex(this._tintFilter.uniforms.color)}set color(I){ct.P6.hex2rgb(I,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(I){this._blurFilter.kernels=I}get blur(){return this._blurFilter.blur}set blur(I){this._blurFilter.blur=I,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(I){this._blurFilter.quality=I}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(I){this._blurFilter.pixelSize=I}};let gr=Rr;gr.defaults={offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:ct.Xd.FILTER_RESOLUTION};/*!
 * @pixi/filter-emboss - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-emboss is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Li=null,Ji=null;class ki extends null{constructor(M=5){super(Li,Ji),this.strength=M}get strength(){return this.uniforms.strength}set strength(M){this.uniforms.strength=M}}/*!
 * @pixi/filter-glitch - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-glitch is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var $r=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Jr=`// precision highp float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;
uniform float aspect;

uniform sampler2D displacementMap;
uniform float offset;
uniform float sinDir;
uniform float cosDir;
uniform int fillMode;

uniform float seed;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

const int TRANSPARENT = 0;
const int ORIGINAL = 1;
const int LOOP = 2;
const int CLAMP = 3;
const int MIRROR = 4;

void main(void)
{
    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
        return;
    }

    float cx = coord.x - 0.5;
    float cy = (coord.y - 0.5) * aspect;
    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;

    // displacementMap: repeat
    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);

    // displacementMap: mirror
    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);

    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));

    float displacement = (dc.r - dc.g) * (offset / filterArea.x);

    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);

    if (fillMode == CLAMP) {
        coord = clamp(coord, filterClamp.xy, filterClamp.zw);
    } else {
        if( coord.x > filterClamp.z ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x -= filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x = filterClamp.z * 2.0 - coord.x;
            }
        } else if( coord.x < filterClamp.x ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x += filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x *= -filterClamp.z;
            }
        }

        if( coord.y > filterClamp.w ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y -= filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y = filterClamp.w * 2.0 - coord.y;
            }
        } else if( coord.y < filterClamp.y ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y += filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y *= -filterClamp.w;
            }
        }
    }

    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;
    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;
    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;
    gl_FragColor.a = texture2D(uSampler, coord).a;
}
`;const ti=class extends ct.wn{constructor(I){super($r,Jr),this.offset=100,this.fillMode=ti.TRANSPARENT,this.average=!1,this.seed=0,this.minSize=8,this.sampleSize=512,this._slices=0,this._offsets=new Float32Array(1),this._sizes=new Float32Array(1),this._direction=-1,this.uniforms.dimensions=new Float32Array(2),this._canvas=document.createElement("canvas"),this._canvas.width=4,this._canvas.height=this.sampleSize,this.texture=ct.xE.from(this._canvas,{scaleMode:ct.aH.NEAREST}),Object.assign(this,ti.defaults,I)}apply(I,M,Y,pt){const{width:Ct,height:Mt}=M.filterFrame;this.uniforms.dimensions[0]=Ct,this.uniforms.dimensions[1]=Mt,this.uniforms.aspect=Mt/Ct,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,I.applyFilter(this,M,Y,pt)}_randomizeSizes(){const I=this._sizes,M=this._slices-1,Y=this.sampleSize,pt=Math.min(this.minSize/Y,.9/this._slices);if(this.average){const Ct=this._slices;let Mt=1;for(let Yt=0;Yt<M;Yt++){const me=Mt/(Ct-Yt),de=Math.max(me*(1-Math.random()*.6),pt);I[Yt]=de,Mt-=de}I[M]=Mt}else{let Ct=1;const Mt=Math.sqrt(1/this._slices);for(let Yt=0;Yt<M;Yt++){const me=Math.max(Mt*Ct*Math.random(),pt);I[Yt]=me,Ct-=me}I[M]=Ct}this.shuffle()}shuffle(){const I=this._sizes,M=this._slices-1;for(let Y=M;Y>0;Y--){const pt=Math.random()*Y>>0,Ct=I[Y];I[Y]=I[pt],I[pt]=Ct}}_randomizeOffsets(){for(let I=0;I<this._slices;I++)this._offsets[I]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){const I=this.sampleSize,M=this.texture,Y=this._canvas.getContext("2d");Y.clearRect(0,0,8,I);let pt,Ct=0;for(let Mt=0;Mt<this._slices;Mt++){pt=Math.floor(this._offsets[Mt]*256);const Yt=this._sizes[Mt]*I,me=pt>0?pt:0,de=pt<0?-pt:0;Y.fillStyle=`rgba(${me}, ${de}, 0, 1)`,Y.fillRect(0,Ct>>0,I,Yt+1>>0),Ct+=Yt}M.baseTexture.update(),this.uniforms.displacementMap=M}set sizes(I){const M=Math.min(this._slices,I.length);for(let Y=0;Y<M;Y++)this._sizes[Y]=I[Y]}get sizes(){return this._sizes}set offsets(I){const M=Math.min(this._slices,I.length);for(let Y=0;Y<M;Y++)this._offsets[Y]=I[Y]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(I){this._slices!==I&&(this._slices=I,this.uniforms.slices=I,this._sizes=this.uniforms.slicesWidth=new Float32Array(I),this._offsets=this.uniforms.slicesOffset=new Float32Array(I),this.refresh())}get direction(){return this._direction}set direction(I){if(this._direction===I)return;this._direction=I;const M=I*ct.ZX;this.uniforms.sinDir=Math.sin(M),this.uniforms.cosDir=Math.cos(M)}get red(){return this.uniforms.red}set red(I){this.uniforms.red=I}get green(){return this.uniforms.green}set green(I){this.uniforms.green=I}get blue(){return this.uniforms.blue}set blue(I){this.uniforms.blue=I}destroy(){var I;(I=this.texture)==null||I.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};let Ur=ti;Ur.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},Ur.TRANSPARENT=0,Ur.ORIGINAL=1,Ur.LOOP=2,Ur.CLAMP=3,Ur.MIRROR=4;/*!
 * @pixi/filter-glow - v5.2.1
 * Compiled Fri, 24 Mar 2023 22:12:11 UTC
 *
 * @pixi/filter-glow is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Qs=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Ui=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

uniform float outerStrength;
uniform float innerStrength;

uniform vec4 glowColor;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform bool knockout;
uniform float alpha;

const float PI = 3.14159265358979323846264;

const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);
const float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);

const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;

void main(void) {
    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);

    float totalAlpha = 0.0;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {
       direction = vec2(cos(angle), sin(angle)) * px;

       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {
           displaced = clamp(vTextureCoord + direction * 
                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);

           curColor = texture2D(uSampler, displaced);

           totalAlpha += (DIST - curDistance) * curColor.a;
       }
    }
    
    curColor = texture2D(uSampler, vTextureCoord);

    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);

    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;
    float innerGlowStrength = min(1.0, innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);

    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);
    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);

    if (knockout) {
      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;
      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;
      gl_FragColor = innerColor + outerGlowColor;
    }
}
`;const bs=class extends ct.wn{constructor(I){const M=Object.assign({},bs.defaults,I),{outerStrength:Y,innerStrength:pt,color:Ct,knockout:Mt,quality:Yt,alpha:me}=M,de=Math.round(M.distance);super(Qs,Ui.replace(/__ANGLE_STEP_SIZE__/gi,`${(1/Yt/de).toFixed(7)}`).replace(/__DIST__/gi,`${de.toFixed(0)}.0`)),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:Ct,outerStrength:Y,innerStrength:pt,padding:de,knockout:Mt,alpha:me})}get color(){return ct.P6.rgb2hex(this.uniforms.glowColor)}set color(I){ct.P6.hex2rgb(I,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(I){this.uniforms.outerStrength=I}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(I){this.uniforms.innerStrength=I}get knockout(){return this.uniforms.knockout}set knockout(I){this.uniforms.knockout=I}get alpha(){return this.uniforms.alpha}set alpha(I){this.uniforms.alpha=I}};let Gi=bs;Gi.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};/*!
 * @pixi/filter-godray - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-godray is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Js=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,zi=`vec3 mod289(vec3 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x)
{
    return mod289(((x * 34.0) + 1.0) * x);
}
vec4 taylorInvSqrt(vec4 r)
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
vec3 fade(vec3 t)
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289(Pi0);
    Pi1 = mod289(Pi1);
    vec3 Pf0 = fract(P); // Fractional part for interpolation
    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;
    vec4 ixy = permute(permute(ix) + iy);
    vec4 ixy0 = permute(ixy + iz0);
    vec4 ixy1 = permute(ixy + iz1);
    vec4 gx0 = ixy0 * (1.0 / 7.0);
    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);
    vec4 gx1 = ixy1 * (1.0 / 7.0);
    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);
    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);
    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);
    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);
    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);
    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);
    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);
    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);
    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);
    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);
    vec3 fade_xyz = fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float turb(vec3 P, vec3 rep, float lacunarity, float gain)
{
    float sum = 0.0;
    float sc = 1.0;
    float totalgain = 1.0;
    for (float i = 0.0; i < 6.0; i++)
    {
        sum += totalgain * pnoise(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}
`,Ts=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform vec2 light;
uniform bool parallel;
uniform float aspect;

uniform float gain;
uniform float lacunarity;
uniform float time;
uniform float alpha;

\${perlin}

void main(void) {
    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    float d;

    if (parallel) {
        float _cos = light.x;
        float _sin = light.y;
        d = (_cos * coord.x) + (_sin * coord.y * aspect);
    } else {
        float dx = coord.x - light.x / dimensions.x;
        float dy = (coord.y - light.y / dimensions.y) * aspect;
        float dis = sqrt(dx * dx + dy * dy) + 0.00001;
        d = dy / dis;
    }

    vec3 dir = vec3(d, d, 0.0);

    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);
    noise = mix(noise, 0.0, 0.3);
    //fade vertically.
    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);
    mist.a = 1.0;
    // apply user alpha
    mist *= alpha;

    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;

}
`;const ws=class extends ct.wn{constructor(I){super(Js,Ts.replace("${perlin}",zi)),this.parallel=!0,this.time=0,this._angle=0,this.uniforms.dimensions=new Float32Array(2);const M=Object.assign(ws.defaults,I);this._angleLight=new ct.E9,this.angle=M.angle,this.gain=M.gain,this.lacunarity=M.lacunarity,this.alpha=M.alpha,this.parallel=M.parallel,this.center=M.center,this.time=M.time}apply(I,M,Y,pt){const{width:Ct,height:Mt}=M.filterFrame;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=Ct,this.uniforms.dimensions[1]=Mt,this.uniforms.aspect=Mt/Ct,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,I.applyFilter(this,M,Y,pt)}get angle(){return this._angle}set angle(I){this._angle=I;const M=I*ct.ZX;this._angleLight.x=Math.cos(M),this._angleLight.y=Math.sin(M)}get gain(){return this.uniforms.gain}set gain(I){this.uniforms.gain=I}get lacunarity(){return this.uniforms.lacunarity}set lacunarity(I){this.uniforms.lacunarity=I}get alpha(){return this.uniforms.alpha}set alpha(I){this.uniforms.alpha=I}};let wi=ws;wi.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1};/*!
 * @pixi/filter-grayscale - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-grayscale is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ai=null,ts=null;class tn extends null{constructor(){super(Ai,ts)}}/*!
 * @pixi/filter-hsl-adjustment - v5.2.0
 * Compiled Tue, 28 Feb 2023 14:24:35 UTC
 *
 * @pixi/filter-hsl-adjustment is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var en=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,rn=`precision mediump float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float uHue;
uniform float uAlpha;
uniform bool uColorize;
uniform float uSaturation;
uniform float uLightness;

// https://en.wikipedia.org/wiki/Luma_(video)
const vec3 weight = vec3(0.299, 0.587, 0.114);

float getWeightedAverage(vec3 rgb) {
    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const vec3 k = vec3(0.57735, 0.57735, 0.57735);

vec3 hueShift(vec3 color, float angle) {
    float cosAngle = cos(angle);
    return vec3(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    vec4 result = color;

    // colorize
    if (uColorize) {
        result.rgb = vec3(getWeightedAverage(result.rgb), 0., 0.);
    }

    // hue
    result.rgb = hueShift(result.rgb, uHue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    float average = (result.r + result.g + result.b) / 3.0;

    if (uSaturation > 0.) {
        result.rgb += (average - result.rgb) * (1. - 1. / (1.001 - uSaturation));
    } else {
        result.rgb -= (average - result.rgb) * uSaturation;
    }

    // lightness
    result.rgb = mix(result.rgb, vec3(ceil(uLightness)) * color.a, abs(uLightness));

    // alpha
    gl_FragColor = mix(color, result, uAlpha);
}
`;const Gr=class extends ct.wn{constructor(I){super(en,rn),this._hue=0;const M=Object.assign({},Gr.defaults,I);Object.assign(this,M)}get hue(){return this._hue}set hue(I){this._hue=I,this.uniforms.uHue=this._hue*(Math.PI/180)}get alpha(){return this.uniforms.uAlpha}set alpha(I){this.uniforms.uAlpha=I}get colorize(){return this.uniforms.uColorize}set colorize(I){this.uniforms.uColorize=I}get lightness(){return this.uniforms.uLightness}set lightness(I){this.uniforms.uLightness=I}get saturation(){return this.uniforms.uSaturation}set saturation(I){this.uniforms.uSaturation=I}};let _r=Gr;_r.defaults={hue:0,saturation:0,lightness:0,colorize:!1,alpha:1};/*!
 * @pixi/filter-motion-blur - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-motion-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var fi=null,Fr=null;class or extends null{constructor(M=[0,0],Y=5,pt=0){super(fi,Fr),this.kernelSize=5,this.uniforms.uVelocity=new Float32Array(2),this._velocity=new s(this.velocityChanged,this),this.setVelocity(M),this.kernelSize=Y,this.offset=pt}apply(M,Y,pt,Ct){const{x:Mt,y:Yt}=this.velocity;this.uniforms.uKernelSize=Mt!==0||Yt!==0?this.kernelSize:0,M.applyFilter(this,Y,pt,Ct)}set velocity(M){this.setVelocity(M)}get velocity(){return this._velocity}setVelocity(M){if(Array.isArray(M)){const[Y,pt]=M;this._velocity.set(Y,pt)}else this._velocity.copyFrom(M)}velocityChanged(){this.uniforms.uVelocity[0]=this._velocity.x,this.uniforms.uVelocity[1]=this._velocity.y,this.padding=(Math.max(Math.abs(this._velocity.x),Math.abs(this._velocity.y))>>0)+1}set offset(M){this.uniforms.uOffset=M}get offset(){return this.uniforms.uOffset}}/*!
 * @pixi/filter-multi-color-replace - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-multi-color-replace is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var br=null,sn=null;class On extends null{constructor(M,Y=.05,pt=M.length){super(br,sn.replace(/%maxColors%/g,pt.toFixed(0))),this._replacements=[],this._maxColors=0,this.epsilon=Y,this._maxColors=pt,this.uniforms.originalColors=new Float32Array(pt*3),this.uniforms.targetColors=new Float32Array(pt*3),this.replacements=M}set replacements(M){const Y=this.uniforms.originalColors,pt=this.uniforms.targetColors,Ct=M.length;if(Ct>this._maxColors)throw new Error(`Length of replacements (${Ct}) exceeds the maximum colors length (${this._maxColors})`);Y[Ct*3]=-1;for(let Mt=0;Mt<Ct;Mt++){const Yt=M[Mt];let me=Yt[0];typeof me=="number"?me=a.hex2rgb(me):Yt[0]=a.rgb2hex(me),Y[Mt*3]=me[0],Y[Mt*3+1]=me[1],Y[Mt*3+2]=me[2];let de=Yt[1];typeof de=="number"?de=a.hex2rgb(de):Yt[1]=a.rgb2hex(de),pt[Mt*3]=de[0],pt[Mt*3+1]=de[1],pt[Mt*3+2]=de[2]}this._replacements=M}get replacements(){return this._replacements}refresh(){this.replacements=this._replacements}get maxColors(){return this._maxColors}set epsilon(M){this.uniforms.epsilon=M}get epsilon(){return this.uniforms.epsilon}}/*!
 * @pixi/filter-old-film - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-old-film is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ei=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Vi=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform float sepia;
uniform float noise;
uniform float noiseSize;
uniform float scratch;
uniform float scratchDensity;
uniform float scratchWidth;
uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;
uniform float seed;

const float SQRT_2 = 1.414213;
const vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 Overlay(vec3 src, vec3 dst)
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)
    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),
                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),
                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));
}


void main()
{
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 color = gl_FragColor.rgb;

    if (sepia > 0.0)
    {
        float gray = (color.x + color.y + color.z) / 3.0;
        vec3 grayscale = vec3(gray);

        color = Overlay(SEPIA_RGB, grayscale);

        color = grayscale + sepia * (color - grayscale);
    }

    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        vec2 dir = vec2(vec2(0.5, 0.5) - coord);
        dir.y *= dimensions.y / dimensions.x;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    if (scratchDensity > seed && scratch != 0.0)
    {
        float phase = seed * 256.0;
        float s = mod(floor(phase), 2.0);
        float dist = 1.0 / scratchDensity;
        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));
        if (d < seed * 0.6 + 0.4)
        {
            highp float period = scratchDensity * 10.0;

            float xx = coord.x * period + phase;
            float aa = abs(mod(xx, 0.5) * 4.0);
            float bb = mod(floor(xx / 0.5), 2.0);
            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);

            float kk = 2.0 * period;
            float dw = scratchWidth / dimensions.x * (0.75 + seed);
            float dh = dw * kk;

            float tine = (yy - (2.0 - dh));

            if (tine > 0.0) {
                float _sign = sign(scratch);

                tine = s * tine / period + scratch + 0.1;
                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

                color.rgb *= tine;
            }
        }
    }

    if (noise > 0.0 && noiseSize > 0.0)
    {
        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);
        // float _noise = snoise(d) * 0.5;
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        color += _noise * noise;
    }

    gl_FragColor.rgb = color;
}
`;const pi=class extends ct.wn{constructor(I,M=0){super(ei,Vi),this.seed=0,this.uniforms.dimensions=new Float32Array(2),typeof I=="number"?(this.seed=I,I=void 0):this.seed=M,Object.assign(this,pi.defaults,I)}apply(I,M,Y,pt){var Ct,Mt;this.uniforms.dimensions[0]=(Ct=M.filterFrame)==null?void 0:Ct.width,this.uniforms.dimensions[1]=(Mt=M.filterFrame)==null?void 0:Mt.height,this.uniforms.seed=this.seed,I.applyFilter(this,M,Y,pt)}set sepia(I){this.uniforms.sepia=I}get sepia(){return this.uniforms.sepia}set noise(I){this.uniforms.noise=I}get noise(){return this.uniforms.noise}set noiseSize(I){this.uniforms.noiseSize=I}get noiseSize(){return this.uniforms.noiseSize}set scratch(I){this.uniforms.scratch=I}get scratch(){return this.uniforms.scratch}set scratchDensity(I){this.uniforms.scratchDensity=I}get scratchDensity(){return this.uniforms.scratchDensity}set scratchWidth(I){this.uniforms.scratchWidth=I}get scratchWidth(){return this.uniforms.scratchWidth}set vignetting(I){this.uniforms.vignetting=I}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(I){this.uniforms.vignettingAlpha=I}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(I){this.uniforms.vignettingBlur=I}get vignettingBlur(){return this.uniforms.vignettingBlur}};let As=pi;As.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3};/*!
 * @pixi/filter-outline - v5.2.0
 * Compiled Tue, 28 Feb 2023 14:24:35 UTC
 *
 * @pixi/filter-outline is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Es=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,nn=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterClamp;

uniform float uAlpha;
uniform vec2 uThickness;
uniform vec4 uColor;
uniform bool uKnockout;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${angleStep};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture2D(uSampler, vTextureCoord);
    vec4 contentColor = sourceColor * float(!uKnockout);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    gl_FragColor = contentColor + outlineColor;
}
`;const Yr=class extends ct.wn{constructor(I=1,M=0,Y=.1,pt=1,Ct=!1){super(Es,nn.replace(/\$\{angleStep\}/,Yr.getAngleStep(Y))),this._thickness=1,this._alpha=1,this._knockout=!1,this.uniforms.uThickness=new Float32Array([0,0]),this.uniforms.uColor=new Float32Array([0,0,0,1]),this.uniforms.uAlpha=pt,this.uniforms.uKnockout=Ct,Object.assign(this,{thickness:I,color:M,quality:Y,alpha:pt,knockout:Ct})}static getAngleStep(I){const M=Math.max(I*Yr.MAX_SAMPLES,Yr.MIN_SAMPLES);return(Math.PI*2/M).toFixed(7)}apply(I,M,Y,pt){this.uniforms.uThickness[0]=this._thickness/M._frame.width,this.uniforms.uThickness[1]=this._thickness/M._frame.height,this.uniforms.uAlpha=this._alpha,this.uniforms.uKnockout=this._knockout,I.applyFilter(this,M,Y,pt)}get alpha(){return this._alpha}set alpha(I){this._alpha=I}get color(){return ct.P6.rgb2hex(this.uniforms.uColor)}set color(I){ct.P6.hex2rgb(I,this.uniforms.uColor)}get knockout(){return this._knockout}set knockout(I){this._knockout=I}get thickness(){return this._thickness}set thickness(I){this._thickness=I,this.padding=I}};let Hi=Yr;Hi.MIN_SAMPLES=1,Hi.MAX_SAMPLES=100;/*!
 * @pixi/filter-pixelate - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-pixelate is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Fe=null,es=null;class on extends null{constructor(M=10){super(Fe,es),this.size=M}get size(){return this.uniforms.size}set size(M){typeof M=="number"&&(M=[M,M]),this.uniforms.size=M}}/*!
 * @pixi/filter-radial-blur - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-radial-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ze=null,Ss=null;class Ln extends null{constructor(M=0,Y=[0,0],pt=5,Ct=-1){super(ze,Ss),this._angle=0,this.angle=M,this.center=Y,this.kernelSize=pt,this.radius=Ct}apply(M,Y,pt,Ct){this.uniforms.uKernelSize=this._angle!==0?this.kernelSize:0,M.applyFilter(this,Y,pt,Ct)}set angle(M){this._angle=M,this.uniforms.uRadian=M*Math.PI/180}get angle(){return this._angle}get center(){return this.uniforms.uCenter}set center(M){this.uniforms.uCenter=M}get radius(){return this.uniforms.uRadius}set radius(M){(M<0||M===1/0)&&(M=-1),this.uniforms.uRadius=M}}/*!
 * @pixi/filter-reflection - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-reflection is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var an=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ln=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

uniform bool mirror;
uniform float boundary;
uniform vec2 amplitude;
uniform vec2 waveLength;
uniform vec2 alpha;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 coord = pixelCoord / dimensions;

    if (coord.y < boundary) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    float k = (coord.y - boundary) / (1. - boundary + 0.0001);
    float areaY = boundary * dimensions.y / filterArea.y;
    float v = areaY + areaY - vTextureCoord.y;
    float y = mirror ? v : vTextureCoord.y;

    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;
    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;
    float _alpha = (alpha.y - alpha.x) * k + alpha.x;

    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;
    x = clamp(x, filterClamp.x, filterClamp.z);

    vec4 color = texture2D(uSampler, vec2(x, y));

    gl_FragColor = color * _alpha;
}
`;const Xi=class extends ct.wn{constructor(I){super(an,ln),this.time=0,this.uniforms.amplitude=new Float32Array(2),this.uniforms.waveLength=new Float32Array(2),this.uniforms.alpha=new Float32Array(2),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Xi.defaults,I)}apply(I,M,Y,pt){var Ct,Mt;this.uniforms.dimensions[0]=(Ct=M.filterFrame)==null?void 0:Ct.width,this.uniforms.dimensions[1]=(Mt=M.filterFrame)==null?void 0:Mt.height,this.uniforms.time=this.time,I.applyFilter(this,M,Y,pt)}set mirror(I){this.uniforms.mirror=I}get mirror(){return this.uniforms.mirror}set boundary(I){this.uniforms.boundary=I}get boundary(){return this.uniforms.boundary}set amplitude(I){this.uniforms.amplitude[0]=I[0],this.uniforms.amplitude[1]=I[1]}get amplitude(){return this.uniforms.amplitude}set waveLength(I){this.uniforms.waveLength[0]=I[0],this.uniforms.waveLength[1]=I[1]}get waveLength(){return this.uniforms.waveLength}set alpha(I){this.uniforms.alpha[0]=I[0],this.uniforms.alpha[1]=I[1]}get alpha(){return this.uniforms.alpha}};let rs=Xi;rs.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0};/*!
 * @pixi/filter-rgb-split - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-rgb-split is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var is=null,ss=null;class Cs extends null{constructor(M=[-10,0],Y=[0,10],pt=[0,0]){super(is,ss),this.red=M,this.green=Y,this.blue=pt}get red(){return this.uniforms.red}set red(M){this.uniforms.red=M}get green(){return this.uniforms.green}set green(M){this.uniforms.green=M}get blue(){return this.uniforms.blue}set blue(M){this.uniforms.blue=M}}/*!
 * @pixi/filter-shockwave - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-shockwave is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ns=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ri=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec4 filterClamp;

uniform vec2 center;

uniform float amplitude;
uniform float wavelength;
// uniform float power;
uniform float brightness;
uniform float speed;
uniform float radius;

uniform float time;

const float PI = 3.14159;

void main()
{
    float halfWavelength = wavelength * 0.5 / filterArea.x;
    float maxRadius = radius / filterArea.x;
    float currentRadius = time * speed / filterArea.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);
    dir.y *= filterArea.y / filterArea.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );

    vec2 offset = diffUV * powDiff / filterArea.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);

    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;

    gl_FragColor = color;
}
`;const Ei=class extends ct.wn{constructor(I=[0,0],M,Y=0){super(ns,ri),this.center=I,Object.assign(this,Ei.defaults,M),this.time=Y}apply(I,M,Y,pt){this.uniforms.time=this.time,I.applyFilter(this,M,Y,pt)}get center(){return this.uniforms.center}set center(I){this.uniforms.center=I}get amplitude(){return this.uniforms.amplitude}set amplitude(I){this.uniforms.amplitude=I}get wavelength(){return this.uniforms.wavelength}set wavelength(I){this.uniforms.wavelength=I}get brightness(){return this.uniforms.brightness}set brightness(I){this.uniforms.brightness=I}get speed(){return this.uniforms.speed}set speed(I){this.uniforms.speed=I}get radius(){return this.uniforms.radius}set radius(I){this.uniforms.radius=I}};let Ps=Ei;Ps.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1};/*!
 * @pixi/filter-simple-lightmap - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-simple-lightmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var er=null,ii=null;class os extends null{constructor(M,Y=0,pt=1){super(er,ii),this._color=0,this.uniforms.dimensions=new Float32Array(2),this.uniforms.ambientColor=new Float32Array([0,0,0,pt]),this.texture=M,this.color=Y}apply(M,Y,pt,Ct){var Mt,Yt;this.uniforms.dimensions[0]=(Mt=Y.filterFrame)==null?void 0:Mt.width,this.uniforms.dimensions[1]=(Yt=Y.filterFrame)==null?void 0:Yt.height,M.applyFilter(this,Y,pt,Ct)}get texture(){return this.uniforms.uLightmap}set texture(M){this.uniforms.uLightmap=M}set color(M){const Y=this.uniforms.ambientColor;typeof M=="number"?(n.hex2rgb(M,Y),this._color=M):(Y[0]=M[0],Y[1]=M[1],Y[2]=M[2],Y[3]=M[3],this._color=n.rgb2hex(Y))}get color(){return this._color}get alpha(){return this.uniforms.ambientColor[3]}set alpha(M){this.uniforms.ambientColor[3]=M}}/*!
 * @pixi/filter-tilt-shift - v5.2.0
 * Compiled Tue, 28 Feb 2023 14:24:35 UTC
 *
 * @pixi/filter-tilt-shift is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var hn=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,as=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float blur;
uniform float gradientBlur;
uniform vec2 start;
uniform vec2 end;
uniform vec2 delta;
uniform vec2 texSize;

float random(vec3 scale, float seed)
{
    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}

void main(void)
{
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));
    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;

    for (float t = -30.0; t <= 30.0; t++)
    {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);
        sample.rgb *= sample.a;
        color += sample * weight;
        total += weight;
    }

    color /= total;
    color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`;class Ve extends ct.wn{constructor(M){var Y,pt;super(hn,as),this.uniforms.blur=M.blur,this.uniforms.gradientBlur=M.gradientBlur,this.uniforms.start=(Y=M.start)!=null?Y:new ct.E9(0,window.innerHeight/2),this.uniforms.end=(pt=M.end)!=null?pt:new ct.E9(600,window.innerHeight/2),this.uniforms.delta=new ct.E9(30,30),this.uniforms.texSize=new ct.E9(window.innerWidth,window.innerHeight),this.updateDelta()}updateDelta(){this.uniforms.delta.x=0,this.uniforms.delta.y=0}get blur(){return this.uniforms.blur}set blur(M){this.uniforms.blur=M}get gradientBlur(){return this.uniforms.gradientBlur}set gradientBlur(M){this.uniforms.gradientBlur=M}get start(){return this.uniforms.start}set start(M){this.uniforms.start=M,this.updateDelta()}get end(){return this.uniforms.end}set end(M){this.uniforms.end=M,this.updateDelta()}}class Ms extends Ve{updateDelta(){const M=this.uniforms.end.x-this.uniforms.start.x,Y=this.uniforms.end.y-this.uniforms.start.y,pt=Math.sqrt(M*M+Y*Y);this.uniforms.delta.x=M/pt,this.uniforms.delta.y=Y/pt}}class un extends Ve{updateDelta(){const M=this.uniforms.end.x-this.uniforms.start.x,Y=this.uniforms.end.y-this.uniforms.start.y,pt=Math.sqrt(M*M+Y*Y);this.uniforms.delta.x=-Y/pt,this.uniforms.delta.y=M/pt}}const fr=class extends ct.wn{constructor(I,M,Y,pt){super(),typeof I=="number"&&(ct.P6.deprecation("5.3.0","TiltShiftFilter constructor arguments is deprecated, use options."),I={blur:I,gradientBlur:M,start:Y,end:pt}),I=Object.assign({},fr.defaults,I),this.tiltShiftXFilter=new Ms(I),this.tiltShiftYFilter=new un(I)}apply(I,M,Y,pt){const Ct=I.getFilterTexture();this.tiltShiftXFilter.apply(I,M,Ct,1),this.tiltShiftYFilter.apply(I,Ct,Y,pt),I.returnFilterTexture(Ct)}get blur(){return this.tiltShiftXFilter.blur}set blur(I){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=I}get gradientBlur(){return this.tiltShiftXFilter.gradientBlur}set gradientBlur(I){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=I}get start(){return this.tiltShiftXFilter.start}set start(I){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=I}get end(){return this.tiltShiftXFilter.end}set end(I){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=I}};let ji=fr;ji.defaults={blur:100,gradientBlur:600,start:void 0,end:void 0};/*!
 * @pixi/filter-twist - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-twist is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var cn=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,dn=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform vec4 filterArea;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 twist(vec2 coord)
{
    coord -= offset;

    float dist = length(coord);

    if (dist < radius)
    {
        float ratioDist = (radius - dist) / radius;
        float angleMod = ratioDist * ratioDist * angle;
        float s = sin(angleMod);
        float c = cos(angleMod);
        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);
    }

    coord += offset;

    return coord;
}

void main(void)
{

    vec2 coord = mapCoord(vTextureCoord);

    coord = twist(coord);

    coord = unmapCoord(coord);

    gl_FragColor = texture2D(uSampler, coord );

}
`;const mi=class extends ct.wn{constructor(I){super(cn,dn),Object.assign(this,mi.defaults,I)}get offset(){return this.uniforms.offset}set offset(I){this.uniforms.offset=I}get radius(){return this.uniforms.radius}set radius(I){this.uniforms.radius=I}get angle(){return this.uniforms.angle}set angle(I){this.uniforms.angle=I}};let fn=mi;fn.defaults={radius:200,angle:4,padding:20,offset:new ct.E9};/*!
 * @pixi/filter-zoom-blur - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-zoom-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Is=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,si=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform vec2 uCenter;
uniform float uStrength;
uniform float uInnerRadius;
uniform float uRadius;

const float MAX_KERNEL_SIZE = \${maxKernelSize};

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand(vec2 co, float seed) {
    const highp float a = 12.9898, b = 78.233, c = 43758.5453;
    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);
    return fract(sin(sn) * c + seed);
}

void main() {

    float minGradient = uInnerRadius * 0.3;
    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;

    float gradient = uRadius * 0.3;
    float radius = (uRadius - gradient * 0.5) / filterArea.x;

    float countLimit = MAX_KERNEL_SIZE;

    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);
    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));

    float strength = uStrength;

    float delta = 0.0;
    float gap;
    if (dist < innerRadius) {
        delta = innerRadius - dist;
        gap = minGradient;
    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
        delta = dist - radius;
        gap = gradient;
    }

    if (delta > 0.0) {
        float normalCount = gap / filterArea.x;
        delta = (normalCount - delta) / normalCount;
        countLimit *= delta;
        strength *= delta;
        if (countLimit < 1.0)
        {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
    }

    // randomize the lookup values to hide the fixed number of samples
    float offset = rand(vTextureCoord, 0.0);

    float total = 0.0;
    vec4 color = vec4(0.0);

    dir *= strength;

    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {
        float percent = (t + offset) / MAX_KERNEL_SIZE;
        float weight = 4.0 * (percent - percent * percent);
        vec2 p = vTextureCoord + dir * percent;
        vec4 sample = texture2D(uSampler, p);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample * weight;
        total += weight;

        if (t > countLimit){
            break;
        }
    }

    color /= total;
    // switch back from pre-multiplied alpha
    // color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,ni=Object.getOwnPropertySymbols,ls=Object.prototype.hasOwnProperty,hs=Object.prototype.propertyIsEnumerable,Rs=(I,M)=>{var Y={};for(var pt in I)ls.call(I,pt)&&M.indexOf(pt)<0&&(Y[pt]=I[pt]);if(I!=null&&ni)for(var pt of ni(I))M.indexOf(pt)<0&&hs.call(I,pt)&&(Y[pt]=I[pt]);return Y};const zr=class extends ct.wn{constructor(I){const M=Object.assign(zr.defaults,I),{maxKernelSize:Y}=M,pt=Rs(M,["maxKernelSize"]);super(Is,si.replace("${maxKernelSize}",Y.toFixed(1))),Object.assign(this,pt)}get center(){return this.uniforms.uCenter}set center(I){this.uniforms.uCenter=I}get strength(){return this.uniforms.uStrength}set strength(I){this.uniforms.uStrength=I}get innerRadius(){return this.uniforms.uInnerRadius}set innerRadius(I){this.uniforms.uInnerRadius=I}get radius(){return this.uniforms.uRadius}set radius(I){(I<0||I===1/0)&&(I=-1),this.uniforms.uRadius=I}};let Ye=zr;Ye.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32};/*!
 * pixi-filters - v5.2.1
 * Compiled Fri, 24 Mar 2023 22:12:11 UTC
 *
 * pixi-filters is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var He=dt(667),Jt=dt(96),us=dt(108);const{app:Sr}=Jt.default.PIXI;Jt.default.player={sprite:function(){const I=new S.Graphics;return I.lineStyle(2,16777215),I.drawCircle(0,0,50),I.x=Sr.screen.width/2,I.y=Sr.screen.height/2,I.filters=[new Gi({quality:.1})],new us.E(I,"Circle")}(),acceleration:.2,velocity:{x:0,y:0},restoringForce:.005,friction:.95,position:{x:0,y:0,_x:0,_y:0},state:["idle"]};const Nr=()=>!Jt.default.settings.clickToMove&&Jt.default.player.state[0]==="idle";Jt.default.keys.addKeys([{name:"Move Up",key:"w",fn:()=>Jt.default.player.velocity.y-=Nr()?Jt.default.player.acceleration:0},{name:"Move Left",key:"a",fn:()=>Jt.default.player.velocity.x-=Nr()?Jt.default.player.acceleration:0},{name:"Move Down",key:"s",fn:()=>Jt.default.player.velocity.y+=Nr()?Jt.default.player.acceleration:0},{name:"Move Right",key:"d",fn:()=>Jt.default.player.velocity.x+=Nr()?Jt.default.player.acceleration:0}]),Jt.default.functions.updateCamera=function(I){Jt.default.camera.x=He.E.smoothDamp((0,He.E)(Jt.default.camera.x),(0,He.E)(Jt.default.player.position.x),(0,He.E)(Jt.default.camera.smoothDamp),(0,He.E)(I)).toNumber(),Jt.default.camera.y=He.E.smoothDamp((0,He.E)(Jt.default.camera.y),(0,He.E)(Jt.default.player.position.y),(0,He.E)(Jt.default.camera.smoothDamp),(0,He.E)(I)).toNumber()},Sr.ticker.add(I=>{switch(Jt.default.player.position.x+=Jt.default.player.velocity.x,Jt.default.player.position.y+=Jt.default.player.velocity.y,Jt.default.player.sprite.x+=Jt.default.player.velocity.x,Jt.default.player.sprite.y+=Jt.default.player.velocity.y,Jt.default.player.velocity.x*=Jt.default.player.friction,Jt.default.player.velocity.y*=Jt.default.player.friction,Jt.default.player.state[0]){case"lockedToMass":const M=Jt.default.player.state[1];Jt.default.player.position.x=Jt.default.player.sprite.x=He.E.smoothDamp((0,He.E)(Jt.default.player.sprite.x),(0,He.E)(M.x),(0,He.E)(.15),(0,He.E)(I)).toNumber(),Jt.default.player.position.y=Jt.default.player.sprite.y=He.E.smoothDamp((0,He.E)(Jt.default.player.sprite.y),(0,He.E)(M.y),(0,He.E)(.15),(0,He.E)(I)).toNumber(),Jt.default.camera.x=Jt.default.player.sprite.x-Sr.screen.width/2,Jt.default.camera.y=Jt.default.player.sprite.y-Sr.screen.height/2;break;case"lockedToMassExit":Jt.default.player.position.x-=Sr.screen.width/2,Jt.default.player.position.y-=Sr.screen.height/2,Jt.default.functions.updateCamera(I),Jt.default.player.state=["idle"];break;case"idle":default:Jt.default.functions.updateCamera(I);break}})},108:function(Wt,Kt,dt){"use strict";dt.d(Kt,{E:function(){return Lt}});var ct=function(){class vt{constructor(L){this.article=L}update(){}AABBs(L){const $=this.AABB;return!(L[2]<$[0]||$[2]<L[0]||L[3]<$[1]||$[3]<L[1])}collidesPoint(L){const $=this.vertices,tt=$.length;let it=!1;for(let Z=0,ft=tt-2;Z<tt;Z+=2)$[Z+1]>L.y!=$[ft+1]>L.y&&L.x<($[ft]-$[Z])*(L.y-$[Z+1])/($[ft+1]-$[Z+1])+$[Z]&&(it=!it),ft=Z;return it}collidesCircle(){}collidesRectangle(){}collidesPolygon(L,$){const tt=this.vertices,it=$?L:L.vertices,Z=[tt,it];let ft,yt,K,lt,_t;for(let It=0;It<Z.length;It++){const Et=Z[It];for(let Dt=0;Dt<Et.length;Dt+=2){const q=(Dt+2)%Et.length,At={x:Et[q+1]-Et[Dt+1],y:Et[Dt]-Et[q]};ft=yt=null;for(let ot=0;ot<tt.length;ot+=2)K=At.x*tt[ot]+At.y*tt[ot+1],(ft===null||K<ft)&&(ft=K),(yt===null||K>yt)&&(yt=K);lt=_t=null;for(let ot=0;ot<it.length;ot+=2)K=At.x*it[ot]+At.y*it[ot+1],(lt===null||K<lt)&&(lt=K),(_t===null||K>_t)&&(_t=K);if(yt<lt||_t<ft)return!1}}return!0}collidesLine(L,$){const tt=this.vertices,it=tt.length;if(this.collidesPoint(L))return!0;for(let Z=0;Z<it;Z+=2){const ft=(Z+2)%it;if(vt.lineLine(L,$,{x:tt[Z],y:tt[Z+1]},{x:tt[ft],y:tt[ft+1]}))return!0}return!1}collides(L){return this["collides"+L.SHAPE](L)}static lineLine(L,$,tt,it){const Z=L.x,ft=L.y,yt=$.x,K=$.y,lt=tt.x,_t=tt.y,It=it.x,Et=it.y,Dt=yt-Z,q=K-ft,At=It-lt,ot=Et-_t,qt=(-q*(Z-lt)+Dt*(ft-_t))/(-At*q+Dt*ot),ve=(At*(ft-_t)-ot*(Z-lt))/(-At*q+Dt*ot);return qt>=0&&qt<=1&&ve>=0&&ve<=1}}class Ft extends vt{constructor(L,$){super(L),this.SHAPE="Rectangle",$=$||{},this._vertices=[],this.AABB=[0,0,0,0],this.set($)}set(L){this.center=L.center||this.article,this.rotation=L.rotation?L.rotation:L.center?L.center:this.article,typeof L.square!="undefined"?this._width=this._height=L.square:(this._width=L.width||this.article.width,this._height=L.height||this.article.height),this.noRotate=L.noRotate,this.hw=this._width/2,this.hh=this._height/2,this.update()}get width(){return this._width}set width(L){this._width=L,this.hw=L/2}get height(){return this._height}set height(L){this._height=L,this.hh=L/2}update(){const L=this.AABB,$=this.center;if(this.noRotate){const tt=this.hw,it=this.hh;L[0]=$.x-tt,L[1]=$.y-it,L[2]=$.x+tt,L[3]=$.y+it}else{const tt=Math.abs(Math.sin(this.rotation.rotation)/2),it=Math.abs(Math.cos(this.rotation.rotation)/2),Z=this._width,ft=this._height,yt=ft*tt+Z*it,K=ft*it+Z*tt;L[0]=$.x-yt,L[1]=$.y-K,L[2]=$.x+yt,L[3]=$.y+K}this.verticesDirty=!0}updateVertices(){const L=this._vertices,$=this.center,tt=this.hw,it=this.hh;if(this.noRotate){const Z=this.AABB;L[0]=Z[0],L[1]=Z[1],L[2]=Z[2],L[3]=Z[1],L[4]=Z[2],L[5]=Z[3],L[6]=Z[0],L[7]=Z[3]}else{const Z=this.rotation.rotation,ft=Math.sin(Z),yt=Math.cos(Z);L[0]=$.x-tt*yt+it*ft,L[1]=$.y-tt*ft-it*yt,L[2]=$.x+tt*yt+it*ft,L[3]=$.y+tt*ft-it*yt,L[4]=$.x+tt*yt-it*ft,L[5]=$.y+tt*ft+it*yt,L[6]=$.x-tt*yt-it*ft,L[7]=$.y-tt*ft+it*yt}this.verticesDirty=!1}get vertices(){return this.verticesDirty&&this.updateVertices(),this._vertices}collidesRectangle(L){return this.noRotate&&L.noRotate?this.AABBs(L.AABB):this.collidesPolygon(L)}collidesCircle(L){return L.collidesRectangle(this)}static fromRectangle(L,$,tt,it){const Z={x:L+tt/2,y:$+it/2};return new Ft(Z,{width:tt,height:it,noRotate:!0})}}class nt extends vt{constructor(L,$,tt){super(L),this.SHAPE="Polygon",tt=tt||{},this.points=$,this.vertices=[],this.AABB=[],this.set(tt)}set(L){L.point&&(this.points=L.points),this.center=L.center||this.article,this.rotation=L.rotation?L.rotation:L.center?L.center:this.article,this.update()}update(){const L=this.rotation.rotation,$=Math.sin(L),tt=Math.cos(L);let it=1/0,Z=0,ft=1/0,yt=0;const K=this.points,lt=K.length,_t=this.vertices,It=this.center;for(let Et=0;Et<lt;Et+=2){const Dt=K[Et],q=K[Et+1],At=_t[Et]=It.x+Dt*tt-q*$,ot=_t[Et+1]=It.y+Dt*$+q*tt;it=At<it?At:it,Z=At>Z?At:Z,ft=ot<ft?ot:ft,yt=ot>yt?ot:yt}this.AABB[0]=it,this.AABB[1]=ft,this.AABB[2]=Z,this.AABB[3]=yt,this.width=Z-it,this.height=yt-ft,this.hw=(Z-it)/2,this.hh=(yt-ft)/2}collidesRectangle(L){return this.collidesPolygon(L)}collidesCircle(L){return L.collidesPolygon(this)}}class mt extends vt{constructor(L,$){super(L),this.SHAPE="Circle",this.AABB=[],$=$||{},this.set($)}set(L){this.radius=L.radius||this.article.width/2,this.radiusSquared=this.radius*this.radius,this.center=L.positionObject?L.positionObject:this.article,this.update()}update(){const L=this.AABB,$=this.radius,tt=this.center;L[0]=tt.x-$,L[1]=tt.y-$,L[2]=tt.x+$,L[3]=tt.y+$}collidesCircle(L){const $=this.center,tt=L.center,it=tt.x-$.x,Z=tt.y-$.y,ft=L.radius+this.radius;return it*it+Z*Z<=ft*ft}collidesPoint(L){const $=L.x-this.center.x,tt=L.y-this.center.y;return $*$+tt*tt<=this.radiusSquared}collidesLine(L,$){function tt(Et,Dt){return Et[0]*Dt[0]+Et[1]*Dt[1]}const it=this.center,Z=[it.x-L.x,it.y-L.y],ft=[$.x-L.x,$.y-L.y],yt=tt(ft,ft);let lt=tt(Z,ft)/yt;lt=lt<0?0:lt,lt=lt>1?1:lt;const _t=[ft[0]*lt+L.x-it.x,ft[1]*lt+L.y-it.y];return tt(_t,_t)<=this.radiusSquared}collidesRectangle(L){if(L.noRotate){const $=L.AABB,tt=($[2]-$[0])/2,it=($[3]-$[1])/2,Z=this.center,ft=this.radius,yt=Math.abs(Z.x-$[0]),K=Math.abs(Z.y-$[1]);if(yt>tt+ft||K>it+ft)return!1;if(yt<=tt||K<=it)return!0;const lt=yt-tt,_t=K-it;return lt*lt+_t*_t<=this.radiusSquared}else{const $=this.center;if(L.collidesPoint($))return!0;const tt=L.vertices;return this.collidesLine({x:tt[0],y:tt[1]},{x:tt[2],y:tt[3]})||this.collidesLine({x:tt[2],y:tt[3]},{x:tt[4],y:tt[5]})||this.collidesLine({x:tt[4],y:tt[5]},{x:tt[6],y:tt[7]})||this.collidesLine({x:tt[6],y:tt[7]},{x:tt[0],y:tt[1]})}}collidesPolygon(L){const $=this.center;if(L.collidesPoint($))return!0;const tt=L.vertices,it=tt.length;for(let Z=0;Z<it-2;Z+=2)if(this.collidesLine({x:tt[Z],y:tt[Z+1]},{x:tt[Z+2],y:tt[Z+3]}))return!0;return this.collidesLine({x:tt[0],y:tt[1]},{x:tt[it-2],y:tt[it-1]})}}return{Shape:vt,Rectangle:Ft,Polygon:nt,Circle:mt}}(),xt=dt(96);class Lt{constructor(Ft,nt="Rectangle"){this.sprite=xt.default.PIXI.app.stage.addChild(Ft),this.x=this.sprite.x,this.y=this.sprite.y,this.collisionShape=nt,this.intersects=new ct[this.collisionShape](this.sprite),xt.default.PIXI.app.ticker.add(this.tickerFn,this)}tickerFn(){this.sprite.x=this.x-xt.default.camera.x,this.sprite.y=this.y-xt.default.camera.y}collides(Ft){return this.intersects[`collides${Ft.collisionShape}`](Ft.intersects)}remove(Ft){if(this.x=this.y=1/0,this.sprite.parent.removeChild(this.sprite),Array.isArray(Ft)){const nt=Ft.indexOf(this);nt!==-1&&Ft.splice(nt,1)}else typeof Ft=="object"&&delete this}}},506:function(Wt,Kt,dt){"use strict";dt.r(Kt);var S=dt(667),ct=dt.n(S),xt=dt(96),Lt=dt(479);console.log(xt.default.static.quarks.currency),xt.default.keys.addKey("Collect Quarks"," ",function(){if(xt.default.player.state[0]==="idle")for(let vt=0;vt<xt.default.static.massParticles.length;vt++){const Ft=xt.default.static.massParticles[vt];if(xt.default.player.sprite.collides(Ft)){xt.default.player.state=["lockedToMass",Ft],Lt.X.addEvent("massCollect","timeout",(0,S.E)(1e3).div(xt.default.data.quarks.absorbRate),function(){xt.default.player.state=["lockedToMassExit"],console.log("gainMass");const nt=xt.default.static.massParticles.indexOf(Ft);xt.default.static.massParticles[nt].remove(),xt.default.static.massParticles.splice(nt,1),xt.default.static.quarks.currency.gain(),console.log(xt.default.data.quarks.currency.value.toString())});break}}})},96:function(Wt,Kt,dt){"use strict";dt.r(Kt),dt.d(Kt,{default:function(){return at}});var S=dt(465);const ct={app:new S.MxU({background:0,resizeTo:window})};ct.app.stage.eventMode="static",document.body.appendChild(ct.app.view),console.log("PIXI Setup complete."),window.addEventListener("resize",()=>{const L=window.innerWidth,$=window.innerHeight;ct.app.renderer.resize(L,$)});var xt=ct;const Lt={keysPressed:[],binds:[],isPressing(L){for(let $=0;$<Lt.binds.length;$++){const tt=Lt.binds[$];if(tt.name===L)return Lt.keysPressed.includes(tt.key)}return!1},addKey(L,$,tt){for(let it=0;it<Lt.binds.length;it++){const Z=Lt.binds[it];if(Z.name===L){Z.key=$;return}}Lt.binds.push({name:L,key:$,fn:tt}),typeof tt=="function"&&xt.app.ticker.add(it=>{Lt.isPressing(L)&&tt(it)})},addKeys(L){for(const $ of L)this.addKey($.name,$.key,$.fn)}},vt=function(L,$){const tt=L.key;$&&!Lt.keysPressed.includes(tt)?Lt.keysPressed.push(tt):!$&&Lt.keysPressed.includes(tt)&&Lt.keysPressed.splice(Lt.keysPressed.indexOf(tt),1)};document.addEventListener("keydown",L=>vt(L,!0)),document.addEventListener("keyup",L=>vt(L,!1)),Lt.addKey("Debug - Reload","`",()=>window.location.reload());var Ft=Lt,nt=dt(667);console.log("test: ",nt.E,nt.currency);const mt={keys:Ft,PIXI:xt,camera:{x:0,y:0,smoothDamp:.15},player:{sprite:null,acceleration:.2,velocity:{x:0,y:0},restoringForce:.005,friction:.95,position:{x:0,y:0,_x:0,_y:0},state:["idle"]},version:{saveAPI:1,phase:"alpha",mode:"production"},data:{playtime:{tActive:new nt.currency,tPassive:new nt.currency,timewarp:(0,nt.E)(),active:new nt.currency,passive:new nt.currency,points:new nt.currency,timeLastPlayed:(0,nt.E)()},quarks:{currency:new nt.currency,regenRate:(0,nt.E)(2),absorbRate:(0,nt.E)(2),maxParticles:(0,nt.E)(10)},chronos:{currency:new nt.currency,lastReward:(0,nt.E)(0)}},static:{massParticles:[],playtime:{tActive:new nt.currencyStatic(()=>mt.data.playtime.tActive),tPassive:new nt.currencyStatic(()=>mt.data.playtime.tPassive),active:new nt.currencyStatic(()=>mt.data.playtime.active),passive:new nt.currencyStatic(()=>mt.data.playtime.passive),points:new nt.currencyStatic(()=>mt.data.playtime.points)},quarks:{currency:new nt.currencyStatic(()=>mt.data.quarks.currency),regenRate:new nt.attribute(2),absorbRate:new nt.attribute(2),maxParticles:new nt.attribute(10)},chronos:{currency:new nt.currencyStatic(()=>mt.data.chronos.currency)}},functions:{start:{},startF:()=>Object.values(mt.functions.start).forEach(L=>L()),loop:{},loopF:L=>Object.values(mt.functions.loop).forEach($=>$(L)),timewarp:L=>mt.data.playtime.timewarp=(0,nt.E)(L),claimDailyReward:function(L=!1){return L||mt.data.chronos.lastReward.sub(Date.now()).mul(-1).gte((0,nt.E)(432e5))?(mt.data.chronos.lastReward=(0,nt.E)(Date.now()),mt.static.chronos.currency.gain(),!0):!1},updateCamera:function(L){mt.camera.x=nt.E.smoothDamp(mt.camera.x,mt.player.position.x,mt.camera.smoothDamp,L).toNumber(),mt.camera.y=nt.E.smoothDamp(mt.camera.y,mt.player.position.y,mt.camera.smoothDamp,L).toNumber()}},settings:{framerate:30,c2:!1,clickToMove:!1},features:{}};console.log(mt),mt.version.mode==="development"&&(window.Game=mt);var at=mt},479:function(Wt,Kt,dt){"use strict";dt.d(Kt,{X:function(){return Lt}});var S=dt(667),ct=dt.n(S),xt=dt(96);const Lt={events:[],addEvent:function(vt,Ft,nt,mt){this.events.push((()=>{switch(Ft){case"interval":return{name:vt,type:Ft,delay:(0,S.E)(nt),callbackFn:mt,timeCreated:(0,S.E)(Date.now()),intervalLast:(0,S.E)(Date.now())};case"timeout":default:return{name:vt,type:Ft,delay:(0,S.E)(nt),callbackFn:mt,timeCreated:(0,S.E)(Date.now())}}})())}};xt.default.PIXI.app.ticker.add(function(){const vt=(0,S.E)(Date.now());for(let Ft=0;Ft<Lt.events.length;Ft++){const nt=Lt.events[Ft];nt.type==="interval"?vt.sub(nt.intervalLast).gte(nt.delay)&&(nt.callbackFn(),nt.intervalLast=vt):nt.type==="timeout"&&vt.sub(nt.timeCreated).gte(nt.delay)&&(nt.callbackFn(),Lt.events.splice(Ft,1),Ft--)}}),xt.default.PIXI.app.ticker.add(function(vt){xt.default.data.playtime.timewarp=(0,S.E)(),xt.default.static.playtime.tActive.gain(vt),xt.default.static.playtime.tPassive.gain(vt),xt.default.static.playtime.active.gain(vt),xt.default.static.playtime.passive.gain(vt),xt.default.static.playtime.points.gain(vt)})},295:function(Wt,Kt,dt){"use strict";dt.r(Kt);var S=dt(961),ct=dt.n(S),xt=dt(667),Lt=dt.n(xt),vt=dt(96);vt.default.dataManagement=function(){const Ft=vt.default.data,nt=(it=vt.default.data)=>ct().compressToBase64(JSON.stringify(it)),mt=(it=localStorage.getItem("data"))=>it?JSON.parse(ct().decompressFromBase64(it)):null,at=(it=!1)=>{vt.default.data=Ft,L(),it&&window.location.reload()},L=()=>{vt.default.data&&(vt.default.data.playtime.timeLastPlayed=(0,xt.E)(Date.now()),localStorage.setItem("data",nt()),console.log("Game Saved"))};return{resetData:at,compileData:nt,decompileData:mt,saveData:L,exportData:()=>{const it=nt();if(console.log(it),prompt("Download save data?:",it)!=null){const Z=new Blob([it],{type:"text/plain"}),ft=document.createElement("a");ft.href=URL.createObjectURL(Z),ft.download="stellar-odyssey-data.txt",ft.textContent="Download .txt file",document.body.appendChild(ft),ft.click(),document.body.removeChild(ft)}},loadData:()=>{if(!vt.default.data)return;function it(yt){for(const K in yt)if(typeof yt[K]=="string")try{const lt=(0,xt.E)(yt[K]);yt[K]=lt}catch(lt){console.error(`Error processing value: ${yt[K]}`)}else typeof yt[K]=="object"&&yt[K]!==null&&it(yt[K]);return yt}let Z=mt();console.log(Z),console.log(Z=it(Z));function ft(yt,K){for(const lt in yt)yt.hasOwnProperty(lt)&&(K.hasOwnProperty(lt)?typeof yt[lt]=="object"&&typeof K[lt]=="object"&&ft(yt[lt],K[lt]):K[lt]=yt[lt])}console.log(ft(Ft,Z))}}}()},729:function(Wt){"use strict";var Kt=Object.prototype.hasOwnProperty,dt="~";function S(){}Object.create&&(S.prototype=Object.create(null),new S().__proto__||(dt=!1));function ct(Ft,nt,mt){this.fn=Ft,this.context=nt,this.once=mt||!1}function xt(Ft,nt,mt,at,L){if(typeof mt!="function")throw new TypeError("The listener must be a function");var $=new ct(mt,at||Ft,L),tt=dt?dt+nt:nt;return Ft._events[tt]?Ft._events[tt].fn?Ft._events[tt]=[Ft._events[tt],$]:Ft._events[tt].push($):(Ft._events[tt]=$,Ft._eventsCount++),Ft}function Lt(Ft,nt){--Ft._eventsCount===0?Ft._events=new S:delete Ft._events[nt]}function vt(){this._events=new S,this._eventsCount=0}vt.prototype.eventNames=function(){var nt=[],mt,at;if(this._eventsCount===0)return nt;for(at in mt=this._events)Kt.call(mt,at)&&nt.push(dt?at.slice(1):at);return Object.getOwnPropertySymbols?nt.concat(Object.getOwnPropertySymbols(mt)):nt},vt.prototype.listeners=function(nt){var mt=dt?dt+nt:nt,at=this._events[mt];if(!at)return[];if(at.fn)return[at.fn];for(var L=0,$=at.length,tt=new Array($);L<$;L++)tt[L]=at[L].fn;return tt},vt.prototype.listenerCount=function(nt){var mt=dt?dt+nt:nt,at=this._events[mt];return at?at.fn?1:at.length:0},vt.prototype.emit=function(nt,mt,at,L,$,tt){var it=dt?dt+nt:nt;if(!this._events[it])return!1;var Z=this._events[it],ft=arguments.length,yt,K;if(Z.fn){switch(Z.once&&this.removeListener(nt,Z.fn,void 0,!0),ft){case 1:return Z.fn.call(Z.context),!0;case 2:return Z.fn.call(Z.context,mt),!0;case 3:return Z.fn.call(Z.context,mt,at),!0;case 4:return Z.fn.call(Z.context,mt,at,L),!0;case 5:return Z.fn.call(Z.context,mt,at,L,$),!0;case 6:return Z.fn.call(Z.context,mt,at,L,$,tt),!0}for(K=1,yt=new Array(ft-1);K<ft;K++)yt[K-1]=arguments[K];Z.fn.apply(Z.context,yt)}else{var lt=Z.length,_t;for(K=0;K<lt;K++)switch(Z[K].once&&this.removeListener(nt,Z[K].fn,void 0,!0),ft){case 1:Z[K].fn.call(Z[K].context);break;case 2:Z[K].fn.call(Z[K].context,mt);break;case 3:Z[K].fn.call(Z[K].context,mt,at);break;case 4:Z[K].fn.call(Z[K].context,mt,at,L);break;default:if(!yt)for(_t=1,yt=new Array(ft-1);_t<ft;_t++)yt[_t-1]=arguments[_t];Z[K].fn.apply(Z[K].context,yt)}}return!0},vt.prototype.on=function(nt,mt,at){return xt(this,nt,mt,at,!1)},vt.prototype.once=function(nt,mt,at){return xt(this,nt,mt,at,!0)},vt.prototype.removeListener=function(nt,mt,at,L){var $=dt?dt+nt:nt;if(!this._events[$])return this;if(!mt)return Lt(this,$),this;var tt=this._events[$];if(tt.fn)tt.fn===mt&&(!L||tt.once)&&(!at||tt.context===at)&&Lt(this,$);else{for(var it=0,Z=[],ft=tt.length;it<ft;it++)(tt[it].fn!==mt||L&&!tt[it].once||at&&tt[it].context!==at)&&Z.push(tt[it]);Z.length?this._events[$]=Z.length===1?Z[0]:Z:Lt(this,$)}return this},vt.prototype.removeAllListeners=function(nt){var mt;return nt?(mt=dt?dt+nt:nt,this._events[mt]&&Lt(this,mt)):(this._events=new S,this._eventsCount=0),this},vt.prototype.off=vt.prototype.removeListener,vt.prototype.addListener=vt.prototype.on,vt.prefixed=dt,vt.EventEmitter=vt,Wt.exports=vt},648:function(Wt){"use strict";var Kt="Function.prototype.bind called on incompatible ",dt=Object.prototype.toString,S=Math.max,ct="[object Function]",xt=function(nt,mt){for(var at=[],L=0;L<nt.length;L+=1)at[L]=nt[L];for(var $=0;$<mt.length;$+=1)at[$+nt.length]=mt[$];return at},Lt=function(nt,mt){for(var at=[],L=mt||0,$=0;L<nt.length;L+=1,$+=1)at[$]=nt[L];return at},vt=function(Ft,nt){for(var mt="",at=0;at<Ft.length;at+=1)mt+=Ft[at],at+1<Ft.length&&(mt+=nt);return mt};Wt.exports=function(nt){var mt=this;if(typeof mt!="function"||dt.apply(mt)!==ct)throw new TypeError(Kt+mt);for(var at=Lt(arguments,1),L,$=function(){if(this instanceof L){var yt=mt.apply(this,xt(at,arguments));return Object(yt)===yt?yt:this}return mt.apply(nt,xt(at,arguments))},tt=S(0,mt.length-at.length),it=[],Z=0;Z<tt;Z++)it[Z]="$"+Z;if(L=Function("binder","return function ("+vt(it,",")+"){ return binder.apply(this,arguments); }")($),mt.prototype){var ft=function(){};ft.prototype=mt.prototype,L.prototype=new ft,ft.prototype=null}return L}},612:function(Wt,Kt,dt){"use strict";var S=dt(648);Wt.exports=Function.prototype.bind||S},210:function(Wt,Kt,dt){"use strict";var S,ct=SyntaxError,xt=Function,Lt=TypeError,vt=function(ye){try{return xt('"use strict"; return ('+ye+").constructor;")()}catch(zt){}},Ft=Object.getOwnPropertyDescriptor;if(Ft)try{Ft({},"")}catch(ye){Ft=null}var nt=function(){throw new Lt},mt=Ft?function(){try{return arguments.callee,nt}catch(ye){try{return Ft(arguments,"callee").get}catch(zt){return nt}}}():nt,at=dt(405)(),L=dt(185)(),$=Object.getPrototypeOf||(L?function(ye){return ye.__proto__}:null),tt={},it=typeof Uint8Array=="undefined"||!$?S:$(Uint8Array),Z={"%AggregateError%":typeof AggregateError=="undefined"?S:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?S:ArrayBuffer,"%ArrayIteratorPrototype%":at&&$?$([][Symbol.iterator]()):S,"%AsyncFromSyncIteratorPrototype%":S,"%AsyncFunction%":tt,"%AsyncGenerator%":tt,"%AsyncGeneratorFunction%":tt,"%AsyncIteratorPrototype%":tt,"%Atomics%":typeof Atomics=="undefined"?S:Atomics,"%BigInt%":typeof BigInt=="undefined"?S:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?S:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?S:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?S:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?S:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?S:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?S:FinalizationRegistry,"%Function%":xt,"%GeneratorFunction%":tt,"%Int8Array%":typeof Int8Array=="undefined"?S:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?S:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?S:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":at&&$?$($([][Symbol.iterator]())):S,"%JSON%":typeof JSON=="object"?JSON:S,"%Map%":typeof Map=="undefined"?S:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!at||!$?S:$(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?S:Promise,"%Proxy%":typeof Proxy=="undefined"?S:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?S:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?S:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!at||!$?S:$(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?S:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":at&&$?$(""[Symbol.iterator]()):S,"%Symbol%":at?Symbol:S,"%SyntaxError%":ct,"%ThrowTypeError%":mt,"%TypedArray%":it,"%TypeError%":Lt,"%Uint8Array%":typeof Uint8Array=="undefined"?S:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?S:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?S:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?S:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?S:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?S:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?S:WeakSet};if($)try{null.error}catch(ye){var ft=$($(ye));Z["%Error.prototype%"]=ft}var yt=function ye(zt){var z;if(zt==="%AsyncFunction%")z=vt("async function () {}");else if(zt==="%GeneratorFunction%")z=vt("function* () {}");else if(zt==="%AsyncGeneratorFunction%")z=vt("async function* () {}");else if(zt==="%AsyncGenerator%"){var st=ye("%AsyncGeneratorFunction%");st&&(z=st.prototype)}else if(zt==="%AsyncIteratorPrototype%"){var rt=ye("%AsyncGenerator%");rt&&$&&(z=$(rt.prototype))}return Z[zt]=z,z},K={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},lt=dt(612),_t=dt(824),It=lt.call(Function.call,Array.prototype.concat),Et=lt.call(Function.apply,Array.prototype.splice),Dt=lt.call(Function.call,String.prototype.replace),q=lt.call(Function.call,String.prototype.slice),At=lt.call(Function.call,RegExp.prototype.exec),ot=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,qt=/\\(\\)?/g,ve=function(zt){var z=q(zt,0,1),st=q(zt,-1);if(z==="%"&&st!=="%")throw new ct("invalid intrinsic syntax, expected closing `%`");if(st==="%"&&z!=="%")throw new ct("invalid intrinsic syntax, expected opening `%`");var rt=[];return Dt(zt,ot,function(Pt,St,ut,bt){rt[rt.length]=ut?Dt(bt,qt,"$1"):St||Pt}),rt},_e=function(zt,z){var st=zt,rt;if(_t(K,st)&&(rt=K[st],st="%"+rt[0]+"%"),_t(Z,st)){var Pt=Z[st];if(Pt===tt&&(Pt=yt(st)),typeof Pt=="undefined"&&!z)throw new Lt("intrinsic "+zt+" exists, but is not available. Please file an issue!");return{alias:rt,name:st,value:Pt}}throw new ct("intrinsic "+zt+" does not exist!")};Wt.exports=function(zt,z){if(typeof zt!="string"||zt.length===0)throw new Lt("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof z!="boolean")throw new Lt('"allowMissing" argument must be a boolean');if(At(/^%?[^%]*%?$/,zt)===null)throw new ct("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var st=ve(zt),rt=st.length>0?st[0]:"",Pt=_e("%"+rt+"%",z),St=Pt.name,ut=Pt.value,bt=!1,Nt=Pt.alias;Nt&&(rt=Nt[0],Et(st,It([0,1],Nt)));for(var Vt=1,Bt=!0;Vt<st.length;Vt+=1){var Ht=st[Vt],Qt=q(Ht,0,1),ee=q(Ht,-1);if((Qt==='"'||Qt==="'"||Qt==="`"||ee==='"'||ee==="'"||ee==="`")&&Qt!==ee)throw new ct("property names with quotes must have matching quotes");if((Ht==="constructor"||!Bt)&&(bt=!0),rt+="."+Ht,St="%"+rt+"%",_t(Z,St))ut=Z[St];else if(ut!=null){if(!(Ht in ut)){if(!z)throw new Lt("base intrinsic for "+zt+" exists, but the property is not available.");return}if(Ft&&Vt+1>=st.length){var le=Ft(ut,Ht);Bt=!!le,Bt&&"get"in le&&!("originalValue"in le.get)?ut=le.get:ut=ut[Ht]}else Bt=_t(ut,Ht),ut=ut[Ht];Bt&&!bt&&(Z[St]=ut)}}return ut}},275:function(Wt,Kt,dt){"use strict";var S=dt(210),ct=S("%Object.getOwnPropertyDescriptor%",!0);if(ct)try{ct([],"length")}catch(xt){ct=null}Wt.exports=ct},44:function(Wt,Kt,dt){"use strict";var S=dt(210),ct=S("%Object.defineProperty%",!0),xt=function(){if(ct)try{return ct({},"a",{value:1}),!0}catch(vt){return!1}return!1};xt.hasArrayLengthDefineBug=function(){if(!xt())return null;try{return ct([],"length",{value:1}).length!==1}catch(vt){return!0}},Wt.exports=xt},185:function(Wt){"use strict";var Kt={foo:{}},dt=Object;Wt.exports=function(){return{__proto__:Kt}.foo===Kt.foo&&!({__proto__:null}instanceof dt)}},405:function(Wt,Kt,dt){"use strict";var S=typeof Symbol!="undefined"&&Symbol,ct=dt(419);Wt.exports=function(){return typeof S!="function"||typeof Symbol!="function"||typeof S("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:ct()}},419:function(Wt){"use strict";Wt.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var dt={},S=Symbol("test"),ct=Object(S);if(typeof S=="string"||Object.prototype.toString.call(S)!=="[object Symbol]"||Object.prototype.toString.call(ct)!=="[object Symbol]")return!1;var xt=42;dt[S]=xt;for(S in dt)return!1;if(typeof Object.keys=="function"&&Object.keys(dt).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(dt).length!==0)return!1;var Lt=Object.getOwnPropertySymbols(dt);if(Lt.length!==1||Lt[0]!==S||!Object.prototype.propertyIsEnumerable.call(dt,S))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var vt=Object.getOwnPropertyDescriptor(dt,S);if(vt.value!==xt||vt.enumerable!==!0)return!1}return!0}},824:function(Wt,Kt,dt){"use strict";var S=Function.prototype.call,ct=Object.prototype.hasOwnProperty,xt=dt(612);Wt.exports=xt.call(S,ct)},961:function(Wt,Kt,dt){var S,ct=function(){var xt=String.fromCharCode,Lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",vt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",Ft={};function nt(at,L){if(!Ft[at]){Ft[at]={};for(var $=0;$<at.length;$++)Ft[at][at.charAt($)]=$}return Ft[at][L]}var mt={compressToBase64:function(at){if(at==null)return"";var L=mt._compress(at,6,function($){return Lt.charAt($)});switch(L.length%4){default:case 0:return L;case 1:return L+"===";case 2:return L+"==";case 3:return L+"="}},decompressFromBase64:function(at){return at==null?"":at==""?null:mt._decompress(at.length,32,function(L){return nt(Lt,at.charAt(L))})},compressToUTF16:function(at){return at==null?"":mt._compress(at,15,function(L){return xt(L+32)})+" "},decompressFromUTF16:function(at){return at==null?"":at==""?null:mt._decompress(at.length,16384,function(L){return at.charCodeAt(L)-32})},compressToUint8Array:function(at){for(var L=mt.compress(at),$=new Uint8Array(L.length*2),tt=0,it=L.length;tt<it;tt++){var Z=L.charCodeAt(tt);$[tt*2]=Z>>>8,$[tt*2+1]=Z%256}return $},decompressFromUint8Array:function(at){if(at==null)return mt.decompress(at);for(var L=new Array(at.length/2),$=0,tt=L.length;$<tt;$++)L[$]=at[$*2]*256+at[$*2+1];var it=[];return L.forEach(function(Z){it.push(xt(Z))}),mt.decompress(it.join(""))},compressToEncodedURIComponent:function(at){return at==null?"":mt._compress(at,6,function(L){return vt.charAt(L)})},decompressFromEncodedURIComponent:function(at){return at==null?"":at==""?null:(at=at.replace(/ /g,"+"),mt._decompress(at.length,32,function(L){return nt(vt,at.charAt(L))}))},compress:function(at){return mt._compress(at,16,function(L){return xt(L)})},_compress:function(at,L,$){if(at==null)return"";var tt,it,Z={},ft={},yt="",K="",lt="",_t=2,It=3,Et=2,Dt=[],q=0,At=0,ot;for(ot=0;ot<at.length;ot+=1)if(yt=at.charAt(ot),Object.prototype.hasOwnProperty.call(Z,yt)||(Z[yt]=It++,ft[yt]=!0),K=lt+yt,Object.prototype.hasOwnProperty.call(Z,K))lt=K;else{if(Object.prototype.hasOwnProperty.call(ft,lt)){if(lt.charCodeAt(0)<256){for(tt=0;tt<Et;tt++)q=q<<1,At==L-1?(At=0,Dt.push($(q)),q=0):At++;for(it=lt.charCodeAt(0),tt=0;tt<8;tt++)q=q<<1|it&1,At==L-1?(At=0,Dt.push($(q)),q=0):At++,it=it>>1}else{for(it=1,tt=0;tt<Et;tt++)q=q<<1|it,At==L-1?(At=0,Dt.push($(q)),q=0):At++,it=0;for(it=lt.charCodeAt(0),tt=0;tt<16;tt++)q=q<<1|it&1,At==L-1?(At=0,Dt.push($(q)),q=0):At++,it=it>>1}_t--,_t==0&&(_t=Math.pow(2,Et),Et++),delete ft[lt]}else for(it=Z[lt],tt=0;tt<Et;tt++)q=q<<1|it&1,At==L-1?(At=0,Dt.push($(q)),q=0):At++,it=it>>1;_t--,_t==0&&(_t=Math.pow(2,Et),Et++),Z[K]=It++,lt=String(yt)}if(lt!==""){if(Object.prototype.hasOwnProperty.call(ft,lt)){if(lt.charCodeAt(0)<256){for(tt=0;tt<Et;tt++)q=q<<1,At==L-1?(At=0,Dt.push($(q)),q=0):At++;for(it=lt.charCodeAt(0),tt=0;tt<8;tt++)q=q<<1|it&1,At==L-1?(At=0,Dt.push($(q)),q=0):At++,it=it>>1}else{for(it=1,tt=0;tt<Et;tt++)q=q<<1|it,At==L-1?(At=0,Dt.push($(q)),q=0):At++,it=0;for(it=lt.charCodeAt(0),tt=0;tt<16;tt++)q=q<<1|it&1,At==L-1?(At=0,Dt.push($(q)),q=0):At++,it=it>>1}_t--,_t==0&&(_t=Math.pow(2,Et),Et++),delete ft[lt]}else for(it=Z[lt],tt=0;tt<Et;tt++)q=q<<1|it&1,At==L-1?(At=0,Dt.push($(q)),q=0):At++,it=it>>1;_t--,_t==0&&(_t=Math.pow(2,Et),Et++)}for(it=2,tt=0;tt<Et;tt++)q=q<<1|it&1,At==L-1?(At=0,Dt.push($(q)),q=0):At++,it=it>>1;for(;;)if(q=q<<1,At==L-1){Dt.push($(q));break}else At++;return Dt.join("")},decompress:function(at){return at==null?"":at==""?null:mt._decompress(at.length,32768,function(L){return at.charCodeAt(L)})},_decompress:function(at,L,$){var tt=[],it,Z=4,ft=4,yt=3,K="",lt=[],_t,It,Et,Dt,q,At,ot,qt={val:$(0),position:L,index:1};for(_t=0;_t<3;_t+=1)tt[_t]=_t;for(Et=0,q=Math.pow(2,2),At=1;At!=q;)Dt=qt.val&qt.position,qt.position>>=1,qt.position==0&&(qt.position=L,qt.val=$(qt.index++)),Et|=(Dt>0?1:0)*At,At<<=1;switch(it=Et){case 0:for(Et=0,q=Math.pow(2,8),At=1;At!=q;)Dt=qt.val&qt.position,qt.position>>=1,qt.position==0&&(qt.position=L,qt.val=$(qt.index++)),Et|=(Dt>0?1:0)*At,At<<=1;ot=xt(Et);break;case 1:for(Et=0,q=Math.pow(2,16),At=1;At!=q;)Dt=qt.val&qt.position,qt.position>>=1,qt.position==0&&(qt.position=L,qt.val=$(qt.index++)),Et|=(Dt>0?1:0)*At,At<<=1;ot=xt(Et);break;case 2:return""}for(tt[3]=ot,It=ot,lt.push(ot);;){if(qt.index>at)return"";for(Et=0,q=Math.pow(2,yt),At=1;At!=q;)Dt=qt.val&qt.position,qt.position>>=1,qt.position==0&&(qt.position=L,qt.val=$(qt.index++)),Et|=(Dt>0?1:0)*At,At<<=1;switch(ot=Et){case 0:for(Et=0,q=Math.pow(2,8),At=1;At!=q;)Dt=qt.val&qt.position,qt.position>>=1,qt.position==0&&(qt.position=L,qt.val=$(qt.index++)),Et|=(Dt>0?1:0)*At,At<<=1;tt[ft++]=xt(Et),ot=ft-1,Z--;break;case 1:for(Et=0,q=Math.pow(2,16),At=1;At!=q;)Dt=qt.val&qt.position,qt.position>>=1,qt.position==0&&(qt.position=L,qt.val=$(qt.index++)),Et|=(Dt>0?1:0)*At,At<<=1;tt[ft++]=xt(Et),ot=ft-1,Z--;break;case 2:return lt.join("")}if(Z==0&&(Z=Math.pow(2,yt),yt++),tt[ot])K=tt[ot];else if(ot===ft)K=It+It.charAt(0);else return null;lt.push(K),tt[ft++]=It+K.charAt(0),Z--,It=K,Z==0&&(Z=Math.pow(2,yt),yt++)}}};return mt}();S=function(){return ct}.call(Kt,dt,Kt,Wt),S!==void 0&&(Wt.exports=S)},631:function(Wt,Kt,dt){var S=typeof Map=="function"&&Map.prototype,ct=Object.getOwnPropertyDescriptor&&S?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,xt=S&&ct&&typeof ct.get=="function"?ct.get:null,Lt=S&&Map.prototype.forEach,vt=typeof Set=="function"&&Set.prototype,Ft=Object.getOwnPropertyDescriptor&&vt?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,nt=vt&&Ft&&typeof Ft.get=="function"?Ft.get:null,mt=vt&&Set.prototype.forEach,at=typeof WeakMap=="function"&&WeakMap.prototype,L=at?WeakMap.prototype.has:null,$=typeof WeakSet=="function"&&WeakSet.prototype,tt=$?WeakSet.prototype.has:null,it=typeof WeakRef=="function"&&WeakRef.prototype,Z=it?WeakRef.prototype.deref:null,ft=Boolean.prototype.valueOf,yt=Object.prototype.toString,K=Function.prototype.toString,lt=String.prototype.match,_t=String.prototype.slice,It=String.prototype.replace,Et=String.prototype.toUpperCase,Dt=String.prototype.toLowerCase,q=RegExp.prototype.test,At=Array.prototype.concat,ot=Array.prototype.join,qt=Array.prototype.slice,ve=Math.floor,_e=typeof BigInt=="function"?BigInt.prototype.valueOf:null,ye=Object.getOwnPropertySymbols,zt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,z=typeof Symbol=="function"&&typeof Symbol.iterator=="object",st=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===z||"symbol")?Symbol.toStringTag:null,rt=Object.prototype.propertyIsEnumerable,Pt=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(V){return V.__proto__}:null);function St(V,Q){if(V===1/0||V===-1/0||V!==V||V&&V>-1e3&&V<1e3||q.call(/e/,Q))return Q;var Gt=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof V=="number"){var $t=V<0?-ve(-V):ve(V);if($t!==V){var Zt=String($t),se=_t.call(Q,Zt.length+1);return It.call(Zt,Gt,"$&_")+"."+It.call(It.call(se,/([0-9]{3})/g,"$&_"),/_$/,"")}}return It.call(Q,Gt,"$&_")}var ut=dt(654),bt=ut.custom,Nt=te(bt)?bt:null;Wt.exports=function V(Q,Gt,$t,Zt){var se=Gt||{};if(fe(se,"quoteStyle")&&se.quoteStyle!=="single"&&se.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(fe(se,"maxStringLength")&&(typeof se.maxStringLength=="number"?se.maxStringLength<0&&se.maxStringLength!==1/0:se.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Ae=fe(se,"customInspect")?se.customInspect:!0;if(typeof Ae!="boolean"&&Ae!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(fe(se,"indent")&&se.indent!==null&&se.indent!=="	"&&!(parseInt(se.indent,10)===se.indent&&se.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(fe(se,"numericSeparator")&&typeof se.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var Be=se.numericSeparator;if(typeof Q=="undefined")return"undefined";if(Q===null)return"null";if(typeof Q=="boolean")return Q?"true":"false";if(typeof Q=="string")return Wr(Q,se);if(typeof Q=="number"){if(Q===0)return 1/0/Q>0?"0":"-0";var Ue=String(Q);return Be?St(Q,Ue):Ue}if(typeof Q=="bigint"){var dr=String(Q)+"n";return Be?St(Q,dr):dr}var Ie=typeof se.depth=="undefined"?5:se.depth;if(typeof $t=="undefined"&&($t=0),$t>=Ie&&Ie>0&&typeof Q=="object")return Ht(Q)?"[Array]":"[Object]";var Ne=w(se,$t);if(typeof Zt=="undefined")Zt=[];else if(vr(Zt,Q)>=0)return"[Circular]";function Ge($r,Jr,ti){if(Jr&&(Zt=qt.call(Zt),Zt.push(Jr)),ti){var Ur={depth:se.depth};return fe(se,"quoteStyle")&&(Ur.quoteStyle=se.quoteStyle),V($r,Ur,$t+1,Zt)}return V($r,se,$t+1,Zt)}if(typeof Q=="function"&&!ee(Q)){var yr=Er(Q),Mr=H(Q,Ge);return"[Function"+(yr?": "+yr:" (anonymous)")+"]"+(Mr.length>0?" { "+ot.call(Mr,", ")+" }":"")}if(te(Q)){var Ti=z?It.call(String(Q),/^(Symbol\(.*\))_[^)]*$/,"$1"):zt.call(Q);return typeof Q=="object"&&!z?Je(Ti):Ti}if(sr(Q)){for(var Ir="<"+Dt.call(String(Q.nodeName)),ci=Q.attributes||[],Dr=0;Dr<ci.length;Dr++)Ir+=" "+ci[Dr].name+"="+Vt(Bt(ci[Dr].value),"double",se);return Ir+=">",Q.childNodes&&Q.childNodes.length&&(Ir+="..."),Ir+="</"+Dt.call(String(Q.nodeName))+">",Ir}if(Ht(Q)){if(Q.length===0)return"[]";var nr=H(Q,Ge);return Ne&&!x(nr)?"["+O(nr,Ne)+"]":"[ "+ot.call(nr,", ")+" ]"}if(le(Q)){var di=H(Q,Ge);return!("cause"in Error.prototype)&&"cause"in Q&&!rt.call(Q,"cause")?"{ ["+String(Q)+"] "+ot.call(At.call("[cause]: "+Ge(Q.cause),di),", ")+" }":di.length===0?"["+String(Q)+"]":"{ ["+String(Q)+"] "+ot.call(di,", ")+" }"}if(typeof Q=="object"&&Ae){if(Nt&&typeof Q[Nt]=="function"&&ut)return ut(Q,{depth:Ie-$t});if(Ae!=="symbol"&&typeof Q.inspect=="function")return Q.inspect()}if(Tr(Q)){var Bi=[];return Lt&&Lt.call(Q,function($r,Jr){Bi.push(Ge(Jr,Q,!0)+" => "+Ge($r,Q))}),k("Map",xt.call(Q),Bi,Ne)}if(Lr(Q)){var Oi=[];return mt&&mt.call(Q,function($r){Oi.push(Ge($r,Q))}),k("Set",nt.call(Q),Oi,Ne)}if(wr(Q))return N("WeakMap");if(Ar(Q))return N("WeakSet");if(jr(Q))return N("WeakRef");if(Xe(Q))return Je(Ge(Number(Q)));if(We(Q))return Je(Ge(_e.call(Q)));if(Ee(Q))return Je(ft.call(Q));if(he(Q))return Je(Ge(String(Q)));if(typeof window!="undefined"&&Q===window)return"{ [object Window] }";if(Q===dt.g)return"{ [object globalThis] }";if(!Qt(Q)&&!ee(Q)){var kr=H(Q,Ge),Rr=Pt?Pt(Q)===Object.prototype:Q instanceof Object||Q.constructor===Object,gr=Q instanceof Object?"":"null prototype",Li=!Rr&&st&&Object(Q)===Q&&st in Q?_t.call(Se(Q),8,-1):gr?"Object":"",Ji=Rr||typeof Q.constructor!="function"?"":Q.constructor.name?Q.constructor.name+" ":"",ki=Ji+(Li||gr?"["+ot.call(At.call([],Li||[],gr||[]),": ")+"] ":"");return kr.length===0?ki+"{}":Ne?ki+"{"+O(kr,Ne)+"}":ki+"{ "+ot.call(kr,", ")+" }"}return String(Q)};function Vt(V,Q,Gt){var $t=(Gt.quoteStyle||Q)==="double"?'"':"'";return $t+V+$t}function Bt(V){return It.call(String(V),/"/g,"&quot;")}function Ht(V){return Se(V)==="[object Array]"&&(!st||!(typeof V=="object"&&st in V))}function Qt(V){return Se(V)==="[object Date]"&&(!st||!(typeof V=="object"&&st in V))}function ee(V){return Se(V)==="[object RegExp]"&&(!st||!(typeof V=="object"&&st in V))}function le(V){return Se(V)==="[object Error]"&&(!st||!(typeof V=="object"&&st in V))}function he(V){return Se(V)==="[object String]"&&(!st||!(typeof V=="object"&&st in V))}function Xe(V){return Se(V)==="[object Number]"&&(!st||!(typeof V=="object"&&st in V))}function Ee(V){return Se(V)==="[object Boolean]"&&(!st||!(typeof V=="object"&&st in V))}function te(V){if(z)return V&&typeof V=="object"&&V instanceof Symbol;if(typeof V=="symbol")return!0;if(!V||typeof V!="object"||!zt)return!1;try{return zt.call(V),!0}catch(Q){}return!1}function We(V){if(!V||typeof V!="object"||!_e)return!1;try{return _e.call(V),!0}catch(Q){}return!1}var ue=Object.prototype.hasOwnProperty||function(V){return V in this};function fe(V,Q){return ue.call(V,Q)}function Se(V){return yt.call(V)}function Er(V){if(V.name)return V.name;var Q=lt.call(K.call(V),/^function\s*([\w$]+)/);return Q?Q[1]:null}function vr(V,Q){if(V.indexOf)return V.indexOf(Q);for(var Gt=0,$t=V.length;Gt<$t;Gt++)if(V[Gt]===Q)return Gt;return-1}function Tr(V){if(!xt||!V||typeof V!="object")return!1;try{xt.call(V);try{nt.call(V)}catch(Q){return!0}return V instanceof Map}catch(Q){}return!1}function wr(V){if(!L||!V||typeof V!="object")return!1;try{L.call(V,L);try{tt.call(V,tt)}catch(Q){return!0}return V instanceof WeakMap}catch(Q){}return!1}function jr(V){if(!Z||!V||typeof V!="object")return!1;try{return Z.call(V),!0}catch(Q){}return!1}function Lr(V){if(!nt||!V||typeof V!="object")return!1;try{nt.call(V);try{xt.call(V)}catch(Q){return!0}return V instanceof Set}catch(Q){}return!1}function Ar(V){if(!tt||!V||typeof V!="object")return!1;try{tt.call(V,tt);try{L.call(V,L)}catch(Q){return!0}return V instanceof WeakSet}catch(Q){}return!1}function sr(V){return!V||typeof V!="object"?!1:typeof HTMLElement!="undefined"&&V instanceof HTMLElement?!0:typeof V.nodeName=="string"&&typeof V.getAttribute=="function"}function Wr(V,Q){if(V.length>Q.maxStringLength){var Gt=V.length-Q.maxStringLength,$t="... "+Gt+" more character"+(Gt>1?"s":"");return Wr(_t.call(V,0,Q.maxStringLength),Q)+$t}var Zt=It.call(It.call(V,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,xr);return Vt(Zt,"single",Q)}function xr(V){var Q=V.charCodeAt(0),Gt={8:"b",9:"t",10:"n",12:"f",13:"r"}[Q];return Gt?"\\"+Gt:"\\x"+(Q<16?"0":"")+Et.call(Q.toString(16))}function Je(V){return"Object("+V+")"}function N(V){return V+" { ? }"}function k(V,Q,Gt,$t){var Zt=$t?O(Gt,$t):ot.call(Gt,", ");return V+" ("+Q+") {"+Zt+"}"}function x(V){for(var Q=0;Q<V.length;Q++)if(vr(V[Q],`
`)>=0)return!1;return!0}function w(V,Q){var Gt;if(V.indent==="	")Gt="	";else if(typeof V.indent=="number"&&V.indent>0)Gt=ot.call(Array(V.indent+1)," ");else return null;return{base:Gt,prev:ot.call(Array(Q+1),Gt)}}function O(V,Q){if(V.length===0)return"";var Gt=`
`+Q.prev+Q.base;return Gt+ot.call(V,","+Gt)+`
`+Q.prev}function H(V,Q){var Gt=Ht(V),$t=[];if(Gt){$t.length=V.length;for(var Zt=0;Zt<V.length;Zt++)$t[Zt]=fe(V,Zt)?Q(V[Zt],V):""}var se=typeof ye=="function"?ye(V):[],Ae;if(z){Ae={};for(var Be=0;Be<se.length;Be++)Ae["$"+se[Be]]=se[Be]}for(var Ue in V)fe(V,Ue)&&(Gt&&String(Number(Ue))===Ue&&Ue<V.length||z&&Ae["$"+Ue]instanceof Symbol||(q.call(/[^\w$]/,Ue)?$t.push(Q(Ue,V)+": "+Q(V[Ue],V)):$t.push(Ue+": "+Q(V[Ue],V))));if(typeof ye=="function")for(var dr=0;dr<se.length;dr++)rt.call(V,se[dr])&&$t.push("["+Q(se[dr])+"]: "+Q(V[se[dr]],V));return $t}},798:function(Wt){"use strict";var Kt=String.prototype.replace,dt=/%20/g,S={RFC1738:"RFC1738",RFC3986:"RFC3986"};Wt.exports={default:S.RFC3986,formatters:{RFC1738:function(ct){return Kt.call(ct,dt,"+")},RFC3986:function(ct){return String(ct)}},RFC1738:S.RFC1738,RFC3986:S.RFC3986}},129:function(Wt,Kt,dt){"use strict";var S=dt(261),ct=dt(235),xt=dt(798);Wt.exports={formats:xt,parse:ct,stringify:S}},235:function(Wt,Kt,dt){"use strict";var S=dt(769),ct=Object.prototype.hasOwnProperty,xt=Array.isArray,Lt={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:S.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},vt=function(it){return it.replace(/&#(\d+);/g,function(Z,ft){return String.fromCharCode(parseInt(ft,10))})},Ft=function(it,Z){return it&&typeof it=="string"&&Z.comma&&it.indexOf(",")>-1?it.split(","):it},nt="utf8=%26%2310003%3B",mt="utf8=%E2%9C%93",at=function(Z,ft){var yt={__proto__:null},K=ft.ignoreQueryPrefix?Z.replace(/^\?/,""):Z,lt=ft.parameterLimit===1/0?void 0:ft.parameterLimit,_t=K.split(ft.delimiter,lt),It=-1,Et,Dt=ft.charset;if(ft.charsetSentinel)for(Et=0;Et<_t.length;++Et)_t[Et].indexOf("utf8=")===0&&(_t[Et]===mt?Dt="utf-8":_t[Et]===nt&&(Dt="iso-8859-1"),It=Et,Et=_t.length);for(Et=0;Et<_t.length;++Et)if(Et!==It){var q=_t[Et],At=q.indexOf("]="),ot=At===-1?q.indexOf("="):At+1,qt,ve;ot===-1?(qt=ft.decoder(q,Lt.decoder,Dt,"key"),ve=ft.strictNullHandling?null:""):(qt=ft.decoder(q.slice(0,ot),Lt.decoder,Dt,"key"),ve=S.maybeMap(Ft(q.slice(ot+1),ft),function(_e){return ft.decoder(_e,Lt.decoder,Dt,"value")})),ve&&ft.interpretNumericEntities&&Dt==="iso-8859-1"&&(ve=vt(ve)),q.indexOf("[]=")>-1&&(ve=xt(ve)?[ve]:ve),ct.call(yt,qt)?yt[qt]=S.combine(yt[qt],ve):yt[qt]=ve}return yt},L=function(it,Z,ft,yt){for(var K=yt?Z:Ft(Z,ft),lt=it.length-1;lt>=0;--lt){var _t,It=it[lt];if(It==="[]"&&ft.parseArrays)_t=[].concat(K);else{_t=ft.plainObjects?Object.create(null):{};var Et=It.charAt(0)==="["&&It.charAt(It.length-1)==="]"?It.slice(1,-1):It,Dt=parseInt(Et,10);!ft.parseArrays&&Et===""?_t={0:K}:!isNaN(Dt)&&It!==Et&&String(Dt)===Et&&Dt>=0&&ft.parseArrays&&Dt<=ft.arrayLimit?(_t=[],_t[Dt]=K):Et!=="__proto__"&&(_t[Et]=K)}K=_t}return K},$=function(Z,ft,yt,K){if(Z){var lt=yt.allowDots?Z.replace(/\.([^.[]+)/g,"[$1]"):Z,_t=/(\[[^[\]]*])/,It=/(\[[^[\]]*])/g,Et=yt.depth>0&&_t.exec(lt),Dt=Et?lt.slice(0,Et.index):lt,q=[];if(Dt){if(!yt.plainObjects&&ct.call(Object.prototype,Dt)&&!yt.allowPrototypes)return;q.push(Dt)}for(var At=0;yt.depth>0&&(Et=It.exec(lt))!==null&&At<yt.depth;){if(At+=1,!yt.plainObjects&&ct.call(Object.prototype,Et[1].slice(1,-1))&&!yt.allowPrototypes)return;q.push(Et[1])}return Et&&q.push("["+lt.slice(Et.index)+"]"),L(q,ft,yt,K)}},tt=function(Z){if(!Z)return Lt;if(Z.decoder!==null&&Z.decoder!==void 0&&typeof Z.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof Z.charset!="undefined"&&Z.charset!=="utf-8"&&Z.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var ft=typeof Z.charset=="undefined"?Lt.charset:Z.charset;return{allowDots:typeof Z.allowDots=="undefined"?Lt.allowDots:!!Z.allowDots,allowPrototypes:typeof Z.allowPrototypes=="boolean"?Z.allowPrototypes:Lt.allowPrototypes,allowSparse:typeof Z.allowSparse=="boolean"?Z.allowSparse:Lt.allowSparse,arrayLimit:typeof Z.arrayLimit=="number"?Z.arrayLimit:Lt.arrayLimit,charset:ft,charsetSentinel:typeof Z.charsetSentinel=="boolean"?Z.charsetSentinel:Lt.charsetSentinel,comma:typeof Z.comma=="boolean"?Z.comma:Lt.comma,decoder:typeof Z.decoder=="function"?Z.decoder:Lt.decoder,delimiter:typeof Z.delimiter=="string"||S.isRegExp(Z.delimiter)?Z.delimiter:Lt.delimiter,depth:typeof Z.depth=="number"||Z.depth===!1?+Z.depth:Lt.depth,ignoreQueryPrefix:Z.ignoreQueryPrefix===!0,interpretNumericEntities:typeof Z.interpretNumericEntities=="boolean"?Z.interpretNumericEntities:Lt.interpretNumericEntities,parameterLimit:typeof Z.parameterLimit=="number"?Z.parameterLimit:Lt.parameterLimit,parseArrays:Z.parseArrays!==!1,plainObjects:typeof Z.plainObjects=="boolean"?Z.plainObjects:Lt.plainObjects,strictNullHandling:typeof Z.strictNullHandling=="boolean"?Z.strictNullHandling:Lt.strictNullHandling}};Wt.exports=function(it,Z){var ft=tt(Z);if(it===""||it===null||typeof it=="undefined")return ft.plainObjects?Object.create(null):{};for(var yt=typeof it=="string"?at(it,ft):it,K=ft.plainObjects?Object.create(null):{},lt=Object.keys(yt),_t=0;_t<lt.length;++_t){var It=lt[_t],Et=$(It,yt[It],ft,typeof it=="string");K=S.merge(K,Et,ft)}return ft.allowSparse===!0?K:S.compact(K)}},261:function(Wt,Kt,dt){"use strict";var S=dt(478),ct=dt(769),xt=dt(798),Lt=Object.prototype.hasOwnProperty,vt={brackets:function(K){return K+"[]"},comma:"comma",indices:function(K,lt){return K+"["+lt+"]"},repeat:function(K){return K}},Ft=Array.isArray,nt=Array.prototype.push,mt=function(yt,K){nt.apply(yt,Ft(K)?K:[K])},at=Date.prototype.toISOString,L=xt.default,$={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:ct.encode,encodeValuesOnly:!1,format:L,formatter:xt.formatters[L],indices:!1,serializeDate:function(K){return at.call(K)},skipNulls:!1,strictNullHandling:!1},tt=function(K){return typeof K=="string"||typeof K=="number"||typeof K=="boolean"||typeof K=="symbol"||typeof K=="bigint"},it={},Z=function yt(K,lt,_t,It,Et,Dt,q,At,ot,qt,ve,_e,ye,zt,z,st){for(var rt=K,Pt=st,St=0,ut=!1;(Pt=Pt.get(it))!==void 0&&!ut;){var bt=Pt.get(K);if(St+=1,typeof bt!="undefined"){if(bt===St)throw new RangeError("Cyclic object value");ut=!0}typeof Pt.get(it)=="undefined"&&(St=0)}if(typeof At=="function"?rt=At(lt,rt):rt instanceof Date?rt=ve(rt):_t==="comma"&&Ft(rt)&&(rt=ct.maybeMap(rt,function(te){return te instanceof Date?ve(te):te})),rt===null){if(Et)return q&&!zt?q(lt,$.encoder,z,"key",_e):lt;rt=""}if(tt(rt)||ct.isBuffer(rt)){if(q){var Nt=zt?lt:q(lt,$.encoder,z,"key",_e);return[ye(Nt)+"="+ye(q(rt,$.encoder,z,"value",_e))]}return[ye(lt)+"="+ye(String(rt))]}var Vt=[];if(typeof rt=="undefined")return Vt;var Bt;if(_t==="comma"&&Ft(rt))zt&&q&&(rt=ct.maybeMap(rt,q)),Bt=[{value:rt.length>0?rt.join(",")||null:void 0}];else if(Ft(At))Bt=At;else{var Ht=Object.keys(rt);Bt=ot?Ht.sort(ot):Ht}for(var Qt=It&&Ft(rt)&&rt.length===1?lt+"[]":lt,ee=0;ee<Bt.length;++ee){var le=Bt[ee],he=typeof le=="object"&&typeof le.value!="undefined"?le.value:rt[le];if(!(Dt&&he===null)){var Xe=Ft(rt)?typeof _t=="function"?_t(Qt,le):Qt:Qt+(qt?"."+le:"["+le+"]");st.set(K,St);var Ee=S();Ee.set(it,st),mt(Vt,yt(he,Xe,_t,It,Et,Dt,_t==="comma"&&zt&&Ft(rt)?null:q,At,ot,qt,ve,_e,ye,zt,z,Ee))}}return Vt},ft=function(K){if(!K)return $;if(K.encoder!==null&&typeof K.encoder!="undefined"&&typeof K.encoder!="function")throw new TypeError("Encoder has to be a function.");var lt=K.charset||$.charset;if(typeof K.charset!="undefined"&&K.charset!=="utf-8"&&K.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var _t=xt.default;if(typeof K.format!="undefined"){if(!Lt.call(xt.formatters,K.format))throw new TypeError("Unknown format option provided.");_t=K.format}var It=xt.formatters[_t],Et=$.filter;return(typeof K.filter=="function"||Ft(K.filter))&&(Et=K.filter),{addQueryPrefix:typeof K.addQueryPrefix=="boolean"?K.addQueryPrefix:$.addQueryPrefix,allowDots:typeof K.allowDots=="undefined"?$.allowDots:!!K.allowDots,charset:lt,charsetSentinel:typeof K.charsetSentinel=="boolean"?K.charsetSentinel:$.charsetSentinel,delimiter:typeof K.delimiter=="undefined"?$.delimiter:K.delimiter,encode:typeof K.encode=="boolean"?K.encode:$.encode,encoder:typeof K.encoder=="function"?K.encoder:$.encoder,encodeValuesOnly:typeof K.encodeValuesOnly=="boolean"?K.encodeValuesOnly:$.encodeValuesOnly,filter:Et,format:_t,formatter:It,serializeDate:typeof K.serializeDate=="function"?K.serializeDate:$.serializeDate,skipNulls:typeof K.skipNulls=="boolean"?K.skipNulls:$.skipNulls,sort:typeof K.sort=="function"?K.sort:null,strictNullHandling:typeof K.strictNullHandling=="boolean"?K.strictNullHandling:$.strictNullHandling}};Wt.exports=function(yt,K){var lt=yt,_t=ft(K),It,Et;typeof _t.filter=="function"?(Et=_t.filter,lt=Et("",lt)):Ft(_t.filter)&&(Et=_t.filter,It=Et);var Dt=[];if(typeof lt!="object"||lt===null)return"";var q;K&&K.arrayFormat in vt?q=K.arrayFormat:K&&"indices"in K?q=K.indices?"indices":"repeat":q="indices";var At=vt[q];if(K&&"commaRoundTrip"in K&&typeof K.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var ot=At==="comma"&&K&&K.commaRoundTrip;It||(It=Object.keys(lt)),_t.sort&&It.sort(_t.sort);for(var qt=S(),ve=0;ve<It.length;++ve){var _e=It[ve];_t.skipNulls&&lt[_e]===null||mt(Dt,Z(lt[_e],_e,At,ot,_t.strictNullHandling,_t.skipNulls,_t.encode?_t.encoder:null,_t.filter,_t.sort,_t.allowDots,_t.serializeDate,_t.format,_t.formatter,_t.encodeValuesOnly,_t.charset,qt))}var ye=Dt.join(_t.delimiter),zt=_t.addQueryPrefix===!0?"?":"";return _t.charsetSentinel&&(_t.charset==="iso-8859-1"?zt+="utf8=%26%2310003%3B&":zt+="utf8=%E2%9C%93&"),ye.length>0?zt+ye:""}},769:function(Wt,Kt,dt){"use strict";var S=dt(798),ct=Object.prototype.hasOwnProperty,xt=Array.isArray,Lt=function(){for(var yt=[],K=0;K<256;++K)yt.push("%"+((K<16?"0":"")+K.toString(16)).toUpperCase());return yt}(),vt=function(K){for(;K.length>1;){var lt=K.pop(),_t=lt.obj[lt.prop];if(xt(_t)){for(var It=[],Et=0;Et<_t.length;++Et)typeof _t[Et]!="undefined"&&It.push(_t[Et]);lt.obj[lt.prop]=It}}},Ft=function(K,lt){for(var _t=lt&&lt.plainObjects?Object.create(null):{},It=0;It<K.length;++It)typeof K[It]!="undefined"&&(_t[It]=K[It]);return _t},nt=function yt(K,lt,_t){if(!lt)return K;if(typeof lt!="object"){if(xt(K))K.push(lt);else if(K&&typeof K=="object")(_t&&(_t.plainObjects||_t.allowPrototypes)||!ct.call(Object.prototype,lt))&&(K[lt]=!0);else return[K,lt];return K}if(!K||typeof K!="object")return[K].concat(lt);var It=K;return xt(K)&&!xt(lt)&&(It=Ft(K,_t)),xt(K)&&xt(lt)?(lt.forEach(function(Et,Dt){if(ct.call(K,Dt)){var q=K[Dt];q&&typeof q=="object"&&Et&&typeof Et=="object"?K[Dt]=yt(q,Et,_t):K.push(Et)}else K[Dt]=Et}),K):Object.keys(lt).reduce(function(Et,Dt){var q=lt[Dt];return ct.call(Et,Dt)?Et[Dt]=yt(Et[Dt],q,_t):Et[Dt]=q,Et},It)},mt=function(K,lt){return Object.keys(lt).reduce(function(_t,It){return _t[It]=lt[It],_t},K)},at=function(yt,K,lt){var _t=yt.replace(/\+/g," ");if(lt==="iso-8859-1")return _t.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(_t)}catch(It){return _t}},L=function(K,lt,_t,It,Et){if(K.length===0)return K;var Dt=K;if(typeof K=="symbol"?Dt=Symbol.prototype.toString.call(K):typeof K!="string"&&(Dt=String(K)),_t==="iso-8859-1")return escape(Dt).replace(/%u[0-9a-f]{4}/gi,function(qt){return"%26%23"+parseInt(qt.slice(2),16)+"%3B"});for(var q="",At=0;At<Dt.length;++At){var ot=Dt.charCodeAt(At);if(ot===45||ot===46||ot===95||ot===126||ot>=48&&ot<=57||ot>=65&&ot<=90||ot>=97&&ot<=122||Et===S.RFC1738&&(ot===40||ot===41)){q+=Dt.charAt(At);continue}if(ot<128){q=q+Lt[ot];continue}if(ot<2048){q=q+(Lt[192|ot>>6]+Lt[128|ot&63]);continue}if(ot<55296||ot>=57344){q=q+(Lt[224|ot>>12]+Lt[128|ot>>6&63]+Lt[128|ot&63]);continue}At+=1,ot=65536+((ot&1023)<<10|Dt.charCodeAt(At)&1023),q+=Lt[240|ot>>18]+Lt[128|ot>>12&63]+Lt[128|ot>>6&63]+Lt[128|ot&63]}return q},$=function(K){for(var lt=[{obj:{o:K},prop:"o"}],_t=[],It=0;It<lt.length;++It)for(var Et=lt[It],Dt=Et.obj[Et.prop],q=Object.keys(Dt),At=0;At<q.length;++At){var ot=q[At],qt=Dt[ot];typeof qt=="object"&&qt!==null&&_t.indexOf(qt)===-1&&(lt.push({obj:Dt,prop:ot}),_t.push(qt))}return vt(lt),K},tt=function(K){return Object.prototype.toString.call(K)==="[object RegExp]"},it=function(K){return!K||typeof K!="object"?!1:!!(K.constructor&&K.constructor.isBuffer&&K.constructor.isBuffer(K))},Z=function(K,lt){return[].concat(K,lt)},ft=function(K,lt){if(xt(K)){for(var _t=[],It=0;It<K.length;It+=1)_t.push(lt(K[It]));return _t}return lt(K)};Wt.exports={arrayToObject:Ft,assign:mt,combine:Z,compact:$,decode:at,encode:L,isBuffer:it,isRegExp:tt,maybeMap:ft,merge:nt}},771:function(Wt,Kt,dt){"use strict";var S=dt(210),ct=dt(296),xt=dt(44)(),Lt=dt(275),vt=S("%TypeError%"),Ft=S("%Math.floor%");Wt.exports=function(mt,at){if(typeof mt!="function")throw new vt("`fn` is not a function");if(typeof at!="number"||at<0||at>4294967295||Ft(at)!==at)throw new vt("`length` must be a positive 32-bit integer");var L=arguments.length>2&&!!arguments[2],$=!0,tt=!0;if("length"in mt&&Lt){var it=Lt(mt,"length");it&&!it.configurable&&($=!1),it&&!it.writable&&(tt=!1)}return($||tt||!L)&&(xt?ct(mt,"length",at,!0,!0):ct(mt,"length",at)),mt}},478:function(Wt,Kt,dt){"use strict";var S=dt(210),ct=dt(924),xt=dt(631),Lt=S("%TypeError%"),vt=S("%WeakMap%",!0),Ft=S("%Map%",!0),nt=ct("WeakMap.prototype.get",!0),mt=ct("WeakMap.prototype.set",!0),at=ct("WeakMap.prototype.has",!0),L=ct("Map.prototype.get",!0),$=ct("Map.prototype.set",!0),tt=ct("Map.prototype.has",!0),it=function(K,lt){for(var _t=K,It;(It=_t.next)!==null;_t=It)if(It.key===lt)return _t.next=It.next,It.next=K.next,K.next=It,It},Z=function(K,lt){var _t=it(K,lt);return _t&&_t.value},ft=function(K,lt,_t){var It=it(K,lt);It?It.value=_t:K.next={key:lt,next:K.next,value:_t}},yt=function(K,lt){return!!it(K,lt)};Wt.exports=function(){var lt,_t,It,Et={assert:function(Dt){if(!Et.has(Dt))throw new Lt("Side channel does not contain "+xt(Dt))},get:function(Dt){if(vt&&Dt&&(typeof Dt=="object"||typeof Dt=="function")){if(lt)return nt(lt,Dt)}else if(Ft){if(_t)return L(_t,Dt)}else if(It)return Z(It,Dt)},has:function(Dt){if(vt&&Dt&&(typeof Dt=="object"||typeof Dt=="function")){if(lt)return at(lt,Dt)}else if(Ft){if(_t)return tt(_t,Dt)}else if(It)return yt(It,Dt);return!1},set:function(Dt,q){vt&&Dt&&(typeof Dt=="object"||typeof Dt=="function")?(lt||(lt=new vt),mt(lt,Dt,q)):Ft?(_t||(_t=new Ft),$(_t,Dt,q)):(It||(It={key:{},next:null}),ft(It,Dt,q))}};return Et}},511:function(Wt,Kt,dt){Wt=dt.nmd(Wt);var S;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(ct){var xt=Kt&&!Kt.nodeType&&Kt,Lt=Wt&&!Wt.nodeType&&Wt,vt=typeof dt.g=="object"&&dt.g;(vt.global===vt||vt.window===vt||vt.self===vt)&&(ct=vt);var Ft,nt=2147483647,mt=36,at=1,L=26,$=38,tt=700,it=72,Z=128,ft="-",yt=/^xn--/,K=/[^\x20-\x7E]/,lt=/[\x2E\u3002\uFF0E\uFF61]/g,_t={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},It=mt-at,Et=Math.floor,Dt=String.fromCharCode,q;function At(ut){throw new RangeError(_t[ut])}function ot(ut,bt){for(var Nt=ut.length,Vt=[];Nt--;)Vt[Nt]=bt(ut[Nt]);return Vt}function qt(ut,bt){var Nt=ut.split("@"),Vt="";Nt.length>1&&(Vt=Nt[0]+"@",ut=Nt[1]),ut=ut.replace(lt,".");var Bt=ut.split("."),Ht=ot(Bt,bt).join(".");return Vt+Ht}function ve(ut){for(var bt=[],Nt=0,Vt=ut.length,Bt,Ht;Nt<Vt;)Bt=ut.charCodeAt(Nt++),Bt>=55296&&Bt<=56319&&Nt<Vt?(Ht=ut.charCodeAt(Nt++),(Ht&64512)==56320?bt.push(((Bt&1023)<<10)+(Ht&1023)+65536):(bt.push(Bt),Nt--)):bt.push(Bt);return bt}function _e(ut){return ot(ut,function(bt){var Nt="";return bt>65535&&(bt-=65536,Nt+=Dt(bt>>>10&1023|55296),bt=56320|bt&1023),Nt+=Dt(bt),Nt}).join("")}function ye(ut){return ut-48<10?ut-22:ut-65<26?ut-65:ut-97<26?ut-97:mt}function zt(ut,bt){return ut+22+75*(ut<26)-((bt!=0)<<5)}function z(ut,bt,Nt){var Vt=0;for(ut=Nt?Et(ut/tt):ut>>1,ut+=Et(ut/bt);ut>It*L>>1;Vt+=mt)ut=Et(ut/It);return Et(Vt+(It+1)*ut/(ut+$))}function st(ut){var bt=[],Nt=ut.length,Vt,Bt=0,Ht=Z,Qt=it,ee,le,he,Xe,Ee,te,We,ue,fe;for(ee=ut.lastIndexOf(ft),ee<0&&(ee=0),le=0;le<ee;++le)ut.charCodeAt(le)>=128&&At("not-basic"),bt.push(ut.charCodeAt(le));for(he=ee>0?ee+1:0;he<Nt;){for(Xe=Bt,Ee=1,te=mt;he>=Nt&&At("invalid-input"),We=ye(ut.charCodeAt(he++)),(We>=mt||We>Et((nt-Bt)/Ee))&&At("overflow"),Bt+=We*Ee,ue=te<=Qt?at:te>=Qt+L?L:te-Qt,!(We<ue);te+=mt)fe=mt-ue,Ee>Et(nt/fe)&&At("overflow"),Ee*=fe;Vt=bt.length+1,Qt=z(Bt-Xe,Vt,Xe==0),Et(Bt/Vt)>nt-Ht&&At("overflow"),Ht+=Et(Bt/Vt),Bt%=Vt,bt.splice(Bt++,0,Ht)}return _e(bt)}function rt(ut){var bt,Nt,Vt,Bt,Ht,Qt,ee,le,he,Xe,Ee,te=[],We,ue,fe,Se;for(ut=ve(ut),We=ut.length,bt=Z,Nt=0,Ht=it,Qt=0;Qt<We;++Qt)Ee=ut[Qt],Ee<128&&te.push(Dt(Ee));for(Vt=Bt=te.length,Bt&&te.push(ft);Vt<We;){for(ee=nt,Qt=0;Qt<We;++Qt)Ee=ut[Qt],Ee>=bt&&Ee<ee&&(ee=Ee);for(ue=Vt+1,ee-bt>Et((nt-Nt)/ue)&&At("overflow"),Nt+=(ee-bt)*ue,bt=ee,Qt=0;Qt<We;++Qt)if(Ee=ut[Qt],Ee<bt&&++Nt>nt&&At("overflow"),Ee==bt){for(le=Nt,he=mt;Xe=he<=Ht?at:he>=Ht+L?L:he-Ht,!(le<Xe);he+=mt)Se=le-Xe,fe=mt-Xe,te.push(Dt(zt(Xe+Se%fe,0))),le=Et(Se/fe);te.push(Dt(zt(le,0))),Ht=z(Nt,ue,Vt==Bt),Nt=0,++Vt}++Nt,++bt}return te.join("")}function Pt(ut){return qt(ut,function(bt){return yt.test(bt)?st(bt.slice(4).toLowerCase()):bt})}function St(ut){return qt(ut,function(bt){return K.test(bt)?"xn--"+rt(bt):bt})}Ft={version:"1.4.1",ucs2:{decode:ve,encode:_e},decode:st,encode:rt,toASCII:St,toUnicode:Pt},S=function(){return Ft}.call(Kt,dt,Kt,Wt),S!==void 0&&(Wt.exports=S)})(this)},575:function(Wt,Kt,dt){"use strict";var S,ct=dt(511);function xt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Lt=/^([a-z0-9.+-]+:)/i,vt=/:[0-9]*$/,Ft=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,nt=["<",">",'"',"`"," ","\r",`
`,"	"],mt=["{","}","|","\\","^","`"].concat(nt),at=["'"].concat(mt),L=["%","/","?",";","#"].concat(at),$=["/","?","#"],tt=255,it=/^[+a-z0-9A-Z_-]{0,63}$/,Z=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,ft={javascript:!0,"javascript:":!0},yt={javascript:!0,"javascript:":!0},K={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},lt=dt(129);function _t(q,At,ot){if(q&&typeof q=="object"&&q instanceof xt)return q;var qt=new xt;return qt.parse(q,At,ot),qt}xt.prototype.parse=function(q,At,ot){if(typeof q!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof q);var qt=q.indexOf("?"),ve=qt!==-1&&qt<q.indexOf("#")?"?":"#",_e=q.split(ve),ye=/\\/g;_e[0]=_e[0].replace(ye,"/"),q=_e.join(ve);var zt=q;if(zt=zt.trim(),!ot&&q.split("#").length===1){var z=Ft.exec(zt);if(z)return this.path=zt,this.href=zt,this.pathname=z[1],z[2]?(this.search=z[2],At?this.query=lt.parse(this.search.substr(1)):this.query=this.search.substr(1)):At&&(this.search="",this.query={}),this}var st=Lt.exec(zt);if(st){st=st[0];var rt=st.toLowerCase();this.protocol=rt,zt=zt.substr(st.length)}if(ot||st||zt.match(/^\/\/[^@/]+@[^@/]+/)){var Pt=zt.substr(0,2)==="//";Pt&&!(st&&yt[st])&&(zt=zt.substr(2),this.slashes=!0)}if(!yt[st]&&(Pt||st&&!K[st])){for(var St=-1,ut=0;ut<$.length;ut++){var bt=zt.indexOf($[ut]);bt!==-1&&(St===-1||bt<St)&&(St=bt)}var Nt,Vt;St===-1?Vt=zt.lastIndexOf("@"):Vt=zt.lastIndexOf("@",St),Vt!==-1&&(Nt=zt.slice(0,Vt),zt=zt.slice(Vt+1),this.auth=decodeURIComponent(Nt)),St=-1;for(var ut=0;ut<L.length;ut++){var bt=zt.indexOf(L[ut]);bt!==-1&&(St===-1||bt<St)&&(St=bt)}St===-1&&(St=zt.length),this.host=zt.slice(0,St),zt=zt.slice(St),this.parseHost(),this.hostname=this.hostname||"";var Bt=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!Bt)for(var Ht=this.hostname.split(/\./),ut=0,Qt=Ht.length;ut<Qt;ut++){var ee=Ht[ut];if(ee&&!ee.match(it)){for(var le="",he=0,Xe=ee.length;he<Xe;he++)ee.charCodeAt(he)>127?le+="x":le+=ee[he];if(!le.match(it)){var Ee=Ht.slice(0,ut),te=Ht.slice(ut+1),We=ee.match(Z);We&&(Ee.push(We[1]),te.unshift(We[2])),te.length&&(zt="/"+te.join(".")+zt),this.hostname=Ee.join(".");break}}}this.hostname.length>tt?this.hostname="":this.hostname=this.hostname.toLowerCase(),Bt||(this.hostname=ct.toASCII(this.hostname));var ue=this.port?":"+this.port:"",fe=this.hostname||"";this.host=fe+ue,this.href+=this.host,Bt&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),zt[0]!=="/"&&(zt="/"+zt))}if(!ft[rt])for(var ut=0,Qt=at.length;ut<Qt;ut++){var Se=at[ut];if(zt.indexOf(Se)!==-1){var Er=encodeURIComponent(Se);Er===Se&&(Er=escape(Se)),zt=zt.split(Se).join(Er)}}var vr=zt.indexOf("#");vr!==-1&&(this.hash=zt.substr(vr),zt=zt.slice(0,vr));var Tr=zt.indexOf("?");if(Tr!==-1?(this.search=zt.substr(Tr),this.query=zt.substr(Tr+1),At&&(this.query=lt.parse(this.query)),zt=zt.slice(0,Tr)):At&&(this.search="",this.query={}),zt&&(this.pathname=zt),K[rt]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var ue=this.pathname||"",wr=this.search||"";this.path=ue+wr}return this.href=this.format(),this};function It(q){return typeof q=="string"&&(q=_t(q)),q instanceof xt?q.format():xt.prototype.format.call(q)}xt.prototype.format=function(){var q=this.auth||"";q&&(q=encodeURIComponent(q),q=q.replace(/%3A/i,":"),q+="@");var At=this.protocol||"",ot=this.pathname||"",qt=this.hash||"",ve=!1,_e="";this.host?ve=q+this.host:this.hostname&&(ve=q+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(ve+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(_e=lt.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var ye=this.search||_e&&"?"+_e||"";return At&&At.substr(-1)!==":"&&(At+=":"),this.slashes||(!At||K[At])&&ve!==!1?(ve="//"+(ve||""),ot&&ot.charAt(0)!=="/"&&(ot="/"+ot)):ve||(ve=""),qt&&qt.charAt(0)!=="#"&&(qt="#"+qt),ye&&ye.charAt(0)!=="?"&&(ye="?"+ye),ot=ot.replace(/[?#]/g,function(zt){return encodeURIComponent(zt)}),ye=ye.replace("#","%23"),At+ve+ot+ye+qt};function Et(q,At){return _t(q,!1,!0).resolve(At)}xt.prototype.resolve=function(q){return this.resolveObject(_t(q,!1,!0)).format()};function Dt(q,At){return q?_t(q,!1,!0).resolveObject(At):At}xt.prototype.resolveObject=function(q){if(typeof q=="string"){var At=new xt;At.parse(q,!1,!0),q=At}for(var ot=new xt,qt=Object.keys(this),ve=0;ve<qt.length;ve++){var _e=qt[ve];ot[_e]=this[_e]}if(ot.hash=q.hash,q.href==="")return ot.href=ot.format(),ot;if(q.slashes&&!q.protocol){for(var ye=Object.keys(q),zt=0;zt<ye.length;zt++){var z=ye[zt];z!=="protocol"&&(ot[z]=q[z])}return K[ot.protocol]&&ot.hostname&&!ot.pathname&&(ot.pathname="/",ot.path=ot.pathname),ot.href=ot.format(),ot}if(q.protocol&&q.protocol!==ot.protocol){if(!K[q.protocol]){for(var st=Object.keys(q),rt=0;rt<st.length;rt++){var Pt=st[rt];ot[Pt]=q[Pt]}return ot.href=ot.format(),ot}if(ot.protocol=q.protocol,!q.host&&!yt[q.protocol]){for(var Qt=(q.pathname||"").split("/");Qt.length&&!(q.host=Qt.shift()););q.host||(q.host=""),q.hostname||(q.hostname=""),Qt[0]!==""&&Qt.unshift(""),Qt.length<2&&Qt.unshift(""),ot.pathname=Qt.join("/")}else ot.pathname=q.pathname;if(ot.search=q.search,ot.query=q.query,ot.host=q.host||"",ot.auth=q.auth,ot.hostname=q.hostname||q.host,ot.port=q.port,ot.pathname||ot.search){var St=ot.pathname||"",ut=ot.search||"";ot.path=St+ut}return ot.slashes=ot.slashes||q.slashes,ot.href=ot.format(),ot}var bt=ot.pathname&&ot.pathname.charAt(0)==="/",Nt=q.host||q.pathname&&q.pathname.charAt(0)==="/",Vt=Nt||bt||ot.host&&q.pathname,Bt=Vt,Ht=ot.pathname&&ot.pathname.split("/")||[],Qt=q.pathname&&q.pathname.split("/")||[],ee=ot.protocol&&!K[ot.protocol];if(ee&&(ot.hostname="",ot.port=null,ot.host&&(Ht[0]===""?Ht[0]=ot.host:Ht.unshift(ot.host)),ot.host="",q.protocol&&(q.hostname=null,q.port=null,q.host&&(Qt[0]===""?Qt[0]=q.host:Qt.unshift(q.host)),q.host=null),Vt=Vt&&(Qt[0]===""||Ht[0]==="")),Nt)ot.host=q.host||q.host===""?q.host:ot.host,ot.hostname=q.hostname||q.hostname===""?q.hostname:ot.hostname,ot.search=q.search,ot.query=q.query,Ht=Qt;else if(Qt.length)Ht||(Ht=[]),Ht.pop(),Ht=Ht.concat(Qt),ot.search=q.search,ot.query=q.query;else if(q.search!=null){if(ee){ot.host=Ht.shift(),ot.hostname=ot.host;var le=ot.host&&ot.host.indexOf("@")>0?ot.host.split("@"):!1;le&&(ot.auth=le.shift(),ot.hostname=le.shift(),ot.host=ot.hostname)}return ot.search=q.search,ot.query=q.query,(ot.pathname!==null||ot.search!==null)&&(ot.path=(ot.pathname?ot.pathname:"")+(ot.search?ot.search:"")),ot.href=ot.format(),ot}if(!Ht.length)return ot.pathname=null,ot.search?ot.path="/"+ot.search:ot.path=null,ot.href=ot.format(),ot;for(var he=Ht.slice(-1)[0],Xe=(ot.host||q.host||Ht.length>1)&&(he==="."||he==="..")||he==="",Ee=0,te=Ht.length;te>=0;te--)he=Ht[te],he==="."?Ht.splice(te,1):he===".."?(Ht.splice(te,1),Ee++):Ee&&(Ht.splice(te,1),Ee--);if(!Vt&&!Bt)for(;Ee--;Ee)Ht.unshift("..");Vt&&Ht[0]!==""&&(!Ht[0]||Ht[0].charAt(0)!=="/")&&Ht.unshift(""),Xe&&Ht.join("/").substr(-1)!=="/"&&Ht.push("");var We=Ht[0]===""||Ht[0]&&Ht[0].charAt(0)==="/";if(ee){ot.hostname=We?"":Ht.length?Ht.shift():"",ot.host=ot.hostname;var le=ot.host&&ot.host.indexOf("@")>0?ot.host.split("@"):!1;le&&(ot.auth=le.shift(),ot.hostname=le.shift(),ot.host=ot.hostname)}return Vt=Vt||ot.host&&Ht.length,Vt&&!We&&Ht.unshift(""),Ht.length>0?ot.pathname=Ht.join("/"):(ot.pathname=null,ot.path=null),(ot.pathname!==null||ot.search!==null)&&(ot.path=(ot.pathname?ot.pathname:"")+(ot.search?ot.search:"")),ot.auth=q.auth||ot.auth,ot.slashes=ot.slashes||q.slashes,ot.href=ot.format(),ot},xt.prototype.parseHost=function(){var q=this.host,At=vt.exec(q);At&&(At=At[0],At!==":"&&(this.port=At.substr(1)),q=q.substr(0,q.length-At.length)),q&&(this.hostname=q)},Kt.Qc=_t,Kt.DB=Et,S=Dt,Kt.WU=It,S=xt},654:function(){},667:function(Wt){"use strict";var N;var Kt=Object.defineProperty,dt=Object.getOwnPropertyDescriptor,S=Object.getOwnPropertyNames,ct=Object.prototype.hasOwnProperty,xt=(k,x)=>{for(var w in x)Kt(k,w,{get:x[w],enumerable:!0})},Lt=(k,x,w,O)=>{if(x&&typeof x=="object"||typeof x=="function")for(let H of S(x))!ct.call(k,H)&&H!==w&&Kt(k,H,{get:()=>x[H],enumerable:!(O=dt(x,H))||O.enumerable});return k},vt=k=>Lt(Kt({},"__esModule",{value:!0}),k),Ft={};xt(Ft,{E:()=>Se,EArray:()=>Wr,EObject:()=>xr,EString:()=>fe,attribute:()=>jr,boost:()=>vr,currency:()=>Tr,currencyStatic:()=>wr,eMath:()=>Je,grid:()=>Ar,gridCell:()=>Lr,obb:()=>sr}),Wt.exports=vt(Ft);var nt=class{constructor(k){this.map=new Map,this.first=void 0,this.last=void 0,this.maxSize=k}get size(){return this.map.size}get(k){const x=this.map.get(k);if(x!==void 0)return x!==this.first&&(x===this.last?(this.last=x.prev,this.last.next=void 0):(x.prev.next=x.next,x.next.prev=x.prev),x.next=this.first,this.first.prev=x,this.first=x),x.value}set(k,x){if(this.maxSize<1)return;if(this.map.has(k))throw new Error("Cannot update existing keys in the cache");const w=new mt(k,x);for(this.first===void 0?(this.first=w,this.last=w):(w.next=this.first,this.first.prev=w,this.first=w),this.map.set(k,w);this.map.size>this.maxSize;){const O=this.last;this.map.delete(O.key),this.last=O.prev,this.last.next=void 0}}},mt=class{constructor(k,x){this.next=void 0,this.prev=void 0,this.key=k,this.value=x}},at=17,L=9e15,$=Math.log10(9e15),tt=1/9e15,it=308,Z=-324,ft=5,yt=1024-1,K=!0,lt=!1,_t=function(){const k=[];for(let w=Z+1;w<=it;w++)k.push(+("1e"+w));const x=323;return function(w){return k[w+x]}}(),It=[2,Math.E,3,4,5,6,7,8,9,10],Et=[[1,1.0891180521811203,1.1789767925673957,1.2701455431742086,1.3632090180450092,1.4587818160364217,1.5575237916251419,1.6601571006859253,1.767485818836978,1.8804192098842727,2],[1,1.1121114330934079,1.231038924931609,1.3583836963111375,1.4960519303993531,1.6463542337511945,1.8121385357018724,1.996971324618307,2.2053895545527546,2.4432574483385254,Math.E],[1,1.1187738849693603,1.2464963939368214,1.38527004705667,1.5376664685821402,1.7068895236551784,1.897001227148399,2.1132403089001035,2.362480153784171,2.6539010333870774,3],[1,1.1367350847096405,1.2889510672956703,1.4606478703324786,1.6570295196661111,1.8850062585672889,2.1539465047453485,2.476829779693097,2.872061932789197,3.3664204535587183,4],[1,1.1494592900767588,1.319708228183931,1.5166291280087583,1.748171114438024,2.0253263297298045,2.3636668498288547,2.7858359149579424,3.3257226212448145,4.035730287722532,5],[1,1.159225940787673,1.343712473580932,1.5611293155111927,1.8221199554561318,2.14183924486326,2.542468319282638,3.0574682501653316,3.7390572020926873,4.6719550537360774,6],[1,1.1670905356972596,1.3632807444991446,1.5979222279405536,1.8842640123816674,2.2416069644878687,2.69893426559423,3.3012632110403577,4.121250340630164,5.281493033448316,7],[1,1.1736630594087796,1.379783782386201,1.6292821855668218,1.9378971836180754,2.3289975651071977,2.8384347394720835,3.5232708454565906,4.478242031114584,5.868592169644505,8],[1,1.1793017514670474,1.394054150657457,1.65664127441059,1.985170999970283,2.4069682290577457,2.9647310119960752,3.7278665320924946,4.814462547283592,6.436522247411611,9],[1,1.1840100246247336,1.4061375836156955,1.6802272208863964,2.026757028388619,2.4770056063449646,3.080525271755482,3.9191964192627284,5.135152840833187,6.989961179534715,10]],Dt=[[-1,-.9194161097107025,-.8335625019330468,-.7425599821143978,-.6466611521029437,-.5462617907227869,-.4419033816638769,-.3342645487554494,-.224140440909962,-.11241087890006762,0],[-1,-.90603157029014,-.80786507256596,-.7064666939634,-.60294836853664,-.49849837513117,-.39430303318768,-.29147201034755,-.19097820800866,-.09361896280296,0],[-1,-.9021579584316141,-.8005762598234203,-.6964780623319391,-.5911906810998454,-.486050182576545,-.3823089430815083,-.28106046722897615,-.1831906535795894,-.08935809204418144,0],[-1,-.8917227442365535,-.781258746326964,-.6705130326902455,-.5612813129406509,-.4551067709033134,-.35319256652135966,-.2563741554088552,-.1651412821106526,-.0796919581982668,0],[-1,-.8843387974366064,-.7678744063886243,-.6529563724510552,-.5415870994657841,-.4352842206588936,-.33504449124791424,-.24138853420685147,-.15445285440944467,-.07409659641336663,0],[-1,-.8786709358426346,-.7577735191184886,-.6399546189952064,-.527284921869926,-.4211627631006314,-.3223479611761232,-.23107655627789858,-.1472057700818259,-.07035171210706326,0],[-1,-.8740862815291583,-.7497032990976209,-.6297119746181752,-.5161838335958787,-.41036238255751956,-.31277212146489963,-.2233976621705518,-.1418697367979619,-.06762117662323441,0],[-1,-.8702632331800649,-.7430366914122081,-.6213373075161548,-.5072025698095242,-.40171437727184167,-.30517930701410456,-.21736343968190863,-.137710238299109,-.06550774483471955,0],[-1,-.8670016295947213,-.7373984232432306,-.6143173985094293,-.49973884395492807,-.394584953527678,-.2989649949848695,-.21245647317021688,-.13434688362382652,-.0638072667348083,0],[-1,-.8641642839543857,-.732534623168535,-.6083127477059322,-.4934049257184696,-.3885773075899922,-.29376029055315767,-.2083678561173622,-.13155653399373268,-.062401588652553186,0]],q=function(x,w){const O=w+1,H=Math.ceil(Math.log10(Math.abs(x))),V=Math.round(x*Math.pow(10,O-H))*Math.pow(10,H-O);return parseFloat(V.toFixed(Math.max(O-H,0)))},At=function(k){return Math.sign(k)*Math.log10(Math.abs(k))},ot=function(k){if(!isFinite(k))return k;if(k<-50)return k===Math.trunc(k)?Number.NEGATIVE_INFINITY:0;let x=1;for(;k<10;)x=x*k,++k;k-=1;let w=.9189385332046727;w=w+(k+.5)*Math.log(k),w=w-k;const O=k*k;let H=k;return w=w+1/(12*H),H=H*O,w=w+1/(360*H),H=H*O,w=w+1/(1260*H),H=H*O,w=w+1/(1680*H),H=H*O,w=w+1/(1188*H),H=H*O,w=w+691/(360360*H),H=H*O,w=w+7/(1092*H),H=H*O,w=w+3617/(122400*H),Math.exp(w)/x},qt=6.283185307179586,ve=.36787944117144233,_e=.5671432904097838,ye=function(k,x=1e-10){let w,O;if(!Number.isFinite(k)||k===0)return k;if(k===1)return _e;k<10?w=0:w=Math.log(k)-Math.log(Math.log(k));for(let H=0;H<100;++H){if(O=(k*Math.exp(-w)+w*w)/(w+1),Math.abs(O-w)<x*Math.abs(O))return O;w=O}throw Error(`Iteration failed to converge: ${k.toString()}`)};function zt(k,x=1e-10){let w,O,H,V;if(!Number.isFinite(k.mag)||k.eq(z.dZero))return k;if(k.eq(z.dOne))return z.fromNumber(_e);w=z.ln(k);for(let Q=0;Q<100;++Q){if(O=w.neg().exp(),H=w.sub(k.mul(O)),V=w.sub(H.div(w.add(1).sub(w.add(2).mul(H).div(z.mul(2,w).add(2))))),z.abs(V.sub(w)).lt(z.abs(V).mul(x)))return V;w=V}throw Error(`Iteration failed to converge: ${k.toString()}`)}var z=(N=class{constructor(x){this.sign=0,this.mag=0,this.layer=0,x instanceof N?this.fromDecimal(x):typeof x=="number"?this.fromNumber(x):typeof x=="string"&&this.fromString(x)}get m(){if(this.sign===0)return 0;if(this.layer===0){const x=Math.floor(Math.log10(this.mag));let w;return this.mag===5e-324?w=5:w=this.mag/_t(x),this.sign*w}else if(this.layer===1){const x=this.mag-Math.floor(this.mag);return this.sign*Math.pow(10,x)}else return this.sign}set m(x){this.layer<=2?this.fromMantissaExponent(x,this.e):(this.sign=Math.sign(x),this.sign===0&&(this.layer=0,this.exponent=0))}get e(){return this.sign===0?0:this.layer===0?Math.floor(Math.log10(this.mag)):this.layer===1?Math.floor(this.mag):this.layer===2?Math.floor(Math.sign(this.mag)*Math.pow(10,Math.abs(this.mag))):this.mag*Number.POSITIVE_INFINITY}set e(x){this.fromMantissaExponent(this.m,x)}get s(){return this.sign}set s(x){x===0?(this.sign=0,this.layer=0,this.mag=0):this.sign=x}get mantissa(){return this.m}set mantissa(x){this.m=x}get exponent(){return this.e}set exponent(x){this.e=x}static fromComponents(x,w,O){return new N().fromComponents(x,w,O)}static fromComponents_noNormalize(x,w,O){return new N().fromComponents_noNormalize(x,w,O)}static fromMantissaExponent(x,w){return new N().fromMantissaExponent(x,w)}static fromMantissaExponent_noNormalize(x,w){return new N().fromMantissaExponent_noNormalize(x,w)}static fromDecimal(x){return new N().fromDecimal(x)}static fromNumber(x){return new N().fromNumber(x)}static fromString(x){return new N().fromString(x)}static fromValue(x){return new N().fromValue(x)}static fromValue_noAlloc(x){if(x instanceof N)return x;if(typeof x=="string"){const w=N.fromStringCache.get(x);return w!==void 0?w:N.fromString(x)}else return typeof x=="number"?N.fromNumber(x):N.dZero}static abs(x){return N.fromValue_noAlloc(x).abs()}static neg(x){return N.fromValue_noAlloc(x).neg()}static negate(x){return N.fromValue_noAlloc(x).neg()}static negated(x){return N.fromValue_noAlloc(x).neg()}static sign(x){return N.fromValue_noAlloc(x).sign}static sgn(x){return N.fromValue_noAlloc(x).sign}static round(x){return N.fromValue_noAlloc(x).round()}static floor(x){return N.fromValue_noAlloc(x).floor()}static ceil(x){return N.fromValue_noAlloc(x).ceil()}static trunc(x){return N.fromValue_noAlloc(x).trunc()}static add(x,w){return N.fromValue_noAlloc(x).add(w)}static plus(x,w){return N.fromValue_noAlloc(x).add(w)}static sub(x,w){return N.fromValue_noAlloc(x).sub(w)}static subtract(x,w){return N.fromValue_noAlloc(x).sub(w)}static minus(x,w){return N.fromValue_noAlloc(x).sub(w)}static mul(x,w){return N.fromValue_noAlloc(x).mul(w)}static multiply(x,w){return N.fromValue_noAlloc(x).mul(w)}static times(x,w){return N.fromValue_noAlloc(x).mul(w)}static div(x,w){return N.fromValue_noAlloc(x).div(w)}static divide(x,w){return N.fromValue_noAlloc(x).div(w)}static recip(x){return N.fromValue_noAlloc(x).recip()}static reciprocal(x){return N.fromValue_noAlloc(x).recip()}static reciprocate(x){return N.fromValue_noAlloc(x).reciprocate()}static cmp(x,w){return N.fromValue_noAlloc(x).cmp(w)}static cmpabs(x,w){return N.fromValue_noAlloc(x).cmpabs(w)}static compare(x,w){return N.fromValue_noAlloc(x).cmp(w)}static isNaN(x){return x=N.fromValue_noAlloc(x),isNaN(x.sign)||isNaN(x.layer)||isNaN(x.mag)}static isFinite(x){return x=N.fromValue_noAlloc(x),isFinite(x.sign)&&isFinite(x.layer)&&isFinite(x.mag)}static eq(x,w){return N.fromValue_noAlloc(x).eq(w)}static equals(x,w){return N.fromValue_noAlloc(x).eq(w)}static neq(x,w){return N.fromValue_noAlloc(x).neq(w)}static notEquals(x,w){return N.fromValue_noAlloc(x).notEquals(w)}static lt(x,w){return N.fromValue_noAlloc(x).lt(w)}static lte(x,w){return N.fromValue_noAlloc(x).lte(w)}static gt(x,w){return N.fromValue_noAlloc(x).gt(w)}static gte(x,w){return N.fromValue_noAlloc(x).gte(w)}static max(x,w){return N.fromValue_noAlloc(x).max(w)}static min(x,w){return N.fromValue_noAlloc(x).min(w)}static minabs(x,w){return N.fromValue_noAlloc(x).minabs(w)}static maxabs(x,w){return N.fromValue_noAlloc(x).maxabs(w)}static clamp(x,w,O){return N.fromValue_noAlloc(x).clamp(w,O)}static clampMin(x,w){return N.fromValue_noAlloc(x).clampMin(w)}static clampMax(x,w){return N.fromValue_noAlloc(x).clampMax(w)}static cmp_tolerance(x,w,O){return N.fromValue_noAlloc(x).cmp_tolerance(w,O)}static compare_tolerance(x,w,O){return N.fromValue_noAlloc(x).cmp_tolerance(w,O)}static eq_tolerance(x,w,O){return N.fromValue_noAlloc(x).eq_tolerance(w,O)}static equals_tolerance(x,w,O){return N.fromValue_noAlloc(x).eq_tolerance(w,O)}static neq_tolerance(x,w,O){return N.fromValue_noAlloc(x).neq_tolerance(w,O)}static notEquals_tolerance(x,w,O){return N.fromValue_noAlloc(x).notEquals_tolerance(w,O)}static lt_tolerance(x,w,O){return N.fromValue_noAlloc(x).lt_tolerance(w,O)}static lte_tolerance(x,w,O){return N.fromValue_noAlloc(x).lte_tolerance(w,O)}static gt_tolerance(x,w,O){return N.fromValue_noAlloc(x).gt_tolerance(w,O)}static gte_tolerance(x,w,O){return N.fromValue_noAlloc(x).gte_tolerance(w,O)}static pLog10(x){return N.fromValue_noAlloc(x).pLog10()}static absLog10(x){return N.fromValue_noAlloc(x).absLog10()}static log10(x){return N.fromValue_noAlloc(x).log10()}static log(x,w){return N.fromValue_noAlloc(x).log(w)}static log2(x){return N.fromValue_noAlloc(x).log2()}static ln(x){return N.fromValue_noAlloc(x).ln()}static logarithm(x,w){return N.fromValue_noAlloc(x).logarithm(w)}static pow(x,w){return N.fromValue_noAlloc(x).pow(w)}static pow10(x){return N.fromValue_noAlloc(x).pow10()}static root(x,w){return N.fromValue_noAlloc(x).root(w)}static factorial(x,w){return N.fromValue_noAlloc(x).factorial()}static gamma(x,w){return N.fromValue_noAlloc(x).gamma()}static lngamma(x,w){return N.fromValue_noAlloc(x).lngamma()}static exp(x){return N.fromValue_noAlloc(x).exp()}static sqr(x){return N.fromValue_noAlloc(x).sqr()}static sqrt(x){return N.fromValue_noAlloc(x).sqrt()}static cube(x){return N.fromValue_noAlloc(x).cube()}static cbrt(x){return N.fromValue_noAlloc(x).cbrt()}static tetrate(x,w=2,O=N.fromComponents_noNormalize(1,0,1)){return N.fromValue_noAlloc(x).tetrate(w,O)}static iteratedexp(x,w=2,O=N.fromComponents_noNormalize(1,0,1)){return N.fromValue_noAlloc(x).iteratedexp(w,O)}static iteratedlog(x,w=10,O=1){return N.fromValue_noAlloc(x).iteratedlog(w,O)}static layeradd10(x,w){return N.fromValue_noAlloc(x).layeradd10(w)}static layeradd(x,w,O=10){return N.fromValue_noAlloc(x).layeradd(w,O)}static slog(x,w=10){return N.fromValue_noAlloc(x).slog(w)}static lambertw(x){return N.fromValue_noAlloc(x).lambertw()}static ssqrt(x){return N.fromValue_noAlloc(x).ssqrt()}static pentate(x,w=2,O=N.fromComponents_noNormalize(1,0,1)){return N.fromValue_noAlloc(x).pentate(w,O)}static affordGeometricSeries(x,w,O,H){return this.affordGeometricSeries_core(N.fromValue_noAlloc(x),N.fromValue_noAlloc(w),N.fromValue_noAlloc(O),H)}static sumGeometricSeries(x,w,O,H){return this.sumGeometricSeries_core(x,N.fromValue_noAlloc(w),N.fromValue_noAlloc(O),H)}static affordArithmeticSeries(x,w,O,H){return this.affordArithmeticSeries_core(N.fromValue_noAlloc(x),N.fromValue_noAlloc(w),N.fromValue_noAlloc(O),N.fromValue_noAlloc(H))}static sumArithmeticSeries(x,w,O,H){return this.sumArithmeticSeries_core(N.fromValue_noAlloc(x),N.fromValue_noAlloc(w),N.fromValue_noAlloc(O),N.fromValue_noAlloc(H))}static efficiencyOfPurchase(x,w,O){return this.efficiencyOfPurchase_core(N.fromValue_noAlloc(x),N.fromValue_noAlloc(w),N.fromValue_noAlloc(O))}static randomDecimalForTesting(x){if(Math.random()*20<1)return N.fromComponents_noNormalize(0,0,0);const w=Math.random()>.5?1:-1;if(Math.random()*20<1)return N.fromComponents_noNormalize(w,0,1);const O=Math.floor(Math.random()*(x+1));let H=O===0?Math.random()*616-308:Math.random()*16;Math.random()>.9&&(H=Math.trunc(H));let V=Math.pow(10,H);return Math.random()>.9&&(V=Math.trunc(V)),N.fromComponents(w,O,V)}static affordGeometricSeries_core(x,w,O,H){const V=w.mul(O.pow(H));return N.floor(x.div(V).mul(O.sub(1)).add(1).log10().div(O.log10()))}static sumGeometricSeries_core(x,w,O,H){return w.mul(O.pow(H)).mul(N.sub(1,O.pow(x))).div(N.sub(1,O))}static affordArithmeticSeries_core(x,w,O,H){const Q=w.add(H.mul(O)).sub(O.div(2)),Gt=Q.pow(2);return Q.neg().add(Gt.add(O.mul(x).mul(2)).sqrt()).div(O).floor()}static sumArithmeticSeries_core(x,w,O,H){const V=w.add(H.mul(O));return x.div(2).mul(V.mul(2).plus(x.sub(1).mul(O)))}static efficiencyOfPurchase_core(x,w,O){return x.div(w).add(x.div(O))}normalize(){if(this.sign===0||this.mag===0&&this.layer===0)return this.sign=0,this.mag=0,this.layer=0,this;if(this.layer===0&&this.mag<0&&(this.mag=-this.mag,this.sign=-this.sign),this.layer===0&&this.mag<tt)return this.layer+=1,this.mag=Math.log10(this.mag),this;let x=Math.abs(this.mag),w=Math.sign(this.mag);if(x>=L)return this.layer+=1,this.mag=w*Math.log10(x),this;for(;x<$&&this.layer>0;)this.layer-=1,this.layer===0?this.mag=Math.pow(10,this.mag):(this.mag=w*Math.pow(10,x),x=Math.abs(this.mag),w=Math.sign(this.mag));return this.layer===0&&(this.mag<0?(this.mag=-this.mag,this.sign=-this.sign):this.mag===0&&(this.sign=0)),this}fromComponents(x,w,O){return this.sign=x,this.layer=w,this.mag=O,this.normalize(),this}fromComponents_noNormalize(x,w,O){return this.sign=x,this.layer=w,this.mag=O,this}fromMantissaExponent(x,w){return this.layer=1,this.sign=Math.sign(x),x=Math.abs(x),this.mag=w+Math.log10(x),this.normalize(),this}fromMantissaExponent_noNormalize(x,w){return this.fromMantissaExponent(x,w),this}fromDecimal(x){return this.sign=x.sign,this.layer=x.layer,this.mag=x.mag,this}fromNumber(x){return this.mag=Math.abs(x),this.sign=Math.sign(x),this.layer=0,this.normalize(),this}fromString(x){const w=x,O=N.fromStringCache.get(w);if(O!==void 0)return this.fromDecimal(O);K?x=x.replace(",",""):lt&&(x=x.replace(",","."));const H=x.split("^^^");if(H.length===2){const Ie=parseFloat(H[0]),Ne=parseFloat(H[1]),Ge=H[1].split(";");let yr=1;if(Ge.length===2&&(yr=parseFloat(Ge[1]),isFinite(yr)||(yr=1)),isFinite(Ie)&&isFinite(Ne)){const Mr=N.pentate(Ie,Ne,yr);return this.sign=Mr.sign,this.layer=Mr.layer,this.mag=Mr.mag,N.fromStringCache.maxSize>=1&&N.fromStringCache.set(w,N.fromDecimal(this)),this}}const V=x.split("^^");if(V.length===2){const Ie=parseFloat(V[0]),Ne=parseFloat(V[1]),Ge=V[1].split(";");let yr=1;if(Ge.length===2&&(yr=parseFloat(Ge[1]),isFinite(yr)||(yr=1)),isFinite(Ie)&&isFinite(Ne)){const Mr=N.tetrate(Ie,Ne,yr);return this.sign=Mr.sign,this.layer=Mr.layer,this.mag=Mr.mag,N.fromStringCache.maxSize>=1&&N.fromStringCache.set(w,N.fromDecimal(this)),this}}const Q=x.split("^");if(Q.length===2){const Ie=parseFloat(Q[0]),Ne=parseFloat(Q[1]);if(isFinite(Ie)&&isFinite(Ne)){const Ge=N.pow(Ie,Ne);return this.sign=Ge.sign,this.layer=Ge.layer,this.mag=Ge.mag,N.fromStringCache.maxSize>=1&&N.fromStringCache.set(w,N.fromDecimal(this)),this}}x=x.trim().toLowerCase();let Gt,$t,Zt=x.split("pt");if(Zt.length===2){Gt=10,$t=parseFloat(Zt[0]),Zt[1]=Zt[1].replace("(",""),Zt[1]=Zt[1].replace(")","");let Ie=parseFloat(Zt[1]);if(isFinite(Ie)||(Ie=1),isFinite(Gt)&&isFinite($t)){const Ne=N.tetrate(Gt,$t,Ie);return this.sign=Ne.sign,this.layer=Ne.layer,this.mag=Ne.mag,N.fromStringCache.maxSize>=1&&N.fromStringCache.set(w,N.fromDecimal(this)),this}}if(Zt=x.split("p"),Zt.length===2){Gt=10,$t=parseFloat(Zt[0]),Zt[1]=Zt[1].replace("(",""),Zt[1]=Zt[1].replace(")","");let Ie=parseFloat(Zt[1]);if(isFinite(Ie)||(Ie=1),isFinite(Gt)&&isFinite($t)){const Ne=N.tetrate(Gt,$t,Ie);return this.sign=Ne.sign,this.layer=Ne.layer,this.mag=Ne.mag,N.fromStringCache.maxSize>=1&&N.fromStringCache.set(w,N.fromDecimal(this)),this}}const se=x.split("e"),Ae=se.length-1;if(Ae===0){const Ie=parseFloat(x);if(isFinite(Ie))return this.fromNumber(Ie),N.fromStringCache.size>=1&&N.fromStringCache.set(w,N.fromDecimal(this)),this}else if(Ae===1){const Ie=parseFloat(x);if(isFinite(Ie)&&Ie!==0)return this.fromNumber(Ie),N.fromStringCache.maxSize>=1&&N.fromStringCache.set(w,N.fromDecimal(this)),this}const Be=x.split("e^");if(Be.length===2){this.sign=1,Be[0].charAt(0)=="-"&&(this.sign=-1);let Ie="";for(let Ne=0;Ne<Be[1].length;++Ne){const Ge=Be[1].charCodeAt(Ne);if(Ge>=43&&Ge<=57||Ge===101)Ie+=Be[1].charAt(Ne);else return this.layer=parseFloat(Ie),this.mag=parseFloat(Be[1].substr(Ne+1)),this.normalize(),N.fromStringCache.maxSize>=1&&N.fromStringCache.set(w,N.fromDecimal(this)),this}}if(Ae<1)return this.sign=0,this.layer=0,this.mag=0,N.fromStringCache.maxSize>=1&&N.fromStringCache.set(w,N.fromDecimal(this)),this;const Ue=parseFloat(se[0]);if(Ue===0)return this.sign=0,this.layer=0,this.mag=0,N.fromStringCache.maxSize>=1&&N.fromStringCache.set(w,N.fromDecimal(this)),this;let dr=parseFloat(se[se.length-1]);if(Ae>=2){const Ie=parseFloat(se[se.length-2]);isFinite(Ie)&&(dr*=Math.sign(Ie),dr+=At(Ie))}if(!isFinite(Ue))this.sign=se[0]==="-"?-1:1,this.layer=Ae,this.mag=dr;else if(Ae===1)this.sign=Math.sign(Ue),this.layer=1,this.mag=dr+Math.log10(Math.abs(Ue));else if(this.sign=Math.sign(Ue),this.layer=Ae,Ae===2){const Ie=N.mul(N.fromComponents(1,2,dr),N.fromValue_noAlloc(Ue));return this.sign=Ie.sign,this.layer=Ie.layer,this.mag=Ie.mag,N.fromStringCache.maxSize>=1&&N.fromStringCache.set(w,N.fromDecimal(this)),this}else this.mag=dr;return this.normalize(),N.fromStringCache.maxSize>=1&&N.fromStringCache.set(w,N.fromDecimal(this)),this}fromValue(x){return x instanceof N?this.fromDecimal(x):typeof x=="number"?this.fromNumber(x):typeof x=="string"?this.fromString(x):(this.sign=0,this.layer=0,this.mag=0,this)}toNumber(){return Number.isFinite(this.layer)?this.layer===0?this.sign*this.mag:this.layer===1?this.sign*Math.pow(10,this.mag):this.mag>0?this.sign>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:0:Number.NaN}mantissaWithDecimalPlaces(x){return isNaN(this.m)?Number.NaN:this.m===0?0:q(this.m,x)}magnitudeWithDecimalPlaces(x){return isNaN(this.mag)?Number.NaN:this.mag===0?0:q(this.mag,x)}toString(){return isNaN(this.layer)||isNaN(this.sign)||isNaN(this.mag)?"NaN":this.mag===Number.POSITIVE_INFINITY||this.layer===Number.POSITIVE_INFINITY?this.sign===1?"Infinity":"-Infinity":this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toString():this.m+"e"+this.e:this.layer===1?this.m+"e"+this.e:this.layer<=ft?(this.sign===-1?"-":"")+"e".repeat(this.layer)+this.mag:(this.sign===-1?"-":"")+"(e^"+this.layer+")"+this.mag}toExponential(x){return this.layer===0?(this.sign*this.mag).toExponential(x):this.toStringWithDecimalPlaces(x)}toFixed(x){return this.layer===0?(this.sign*this.mag).toFixed(x):this.toStringWithDecimalPlaces(x)}toPrecision(x){return this.e<=-7?this.toExponential(x-1):x>this.e?this.toFixed(x-this.exponent-1):this.toExponential(x-1)}valueOf(){return this.toString()}toJSON(){return this.toString()}toStringWithDecimalPlaces(x){return this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toFixed(x):q(this.m,x)+"e"+q(this.e,x):this.layer===1?q(this.m,x)+"e"+q(this.e,x):this.layer<=ft?(this.sign===-1?"-":"")+"e".repeat(this.layer)+q(this.mag,x):(this.sign===-1?"-":"")+"(e^"+this.layer+")"+q(this.mag,x)}abs(){return N.fromComponents_noNormalize(this.sign===0?0:1,this.layer,this.mag)}neg(){return N.fromComponents_noNormalize(-this.sign,this.layer,this.mag)}negate(){return this.neg()}negated(){return this.neg()}sgn(){return this.sign}round(){return this.mag<0?N.dZero:this.layer===0?N.fromComponents(this.sign,0,Math.round(this.mag)):this}floor(){return this.mag<0?N.dZero:this.layer===0?N.fromComponents(this.sign,0,Math.floor(this.mag)):this}ceil(){return this.mag<0?N.dZero:this.layer===0?N.fromComponents(this.sign,0,Math.ceil(this.mag)):this}trunc(){return this.mag<0?N.dZero:this.layer===0?N.fromComponents(this.sign,0,Math.trunc(this.mag)):this}add(x){const w=N.fromValue_noAlloc(x);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(w.layer)||this.sign===0)return w;if(w.sign===0)return this;if(this.sign===-w.sign&&this.layer===w.layer&&this.mag===w.mag)return N.fromComponents_noNormalize(0,0,0);let O,H;if(this.layer>=2||w.layer>=2)return this.maxabs(w);if(N.cmpabs(this,w)>0?(O=this,H=w):(O=w,H=this),O.layer===0&&H.layer===0)return N.fromNumber(O.sign*O.mag+H.sign*H.mag);const V=O.layer*Math.sign(O.mag),Q=H.layer*Math.sign(H.mag);if(V-Q>=2)return O;if(V===0&&Q===-1){if(Math.abs(H.mag-Math.log10(O.mag))>at)return O;{const Gt=Math.pow(10,Math.log10(O.mag)-H.mag),$t=H.sign+O.sign*Gt;return N.fromComponents(Math.sign($t),1,H.mag+Math.log10(Math.abs($t)))}}if(V===1&&Q===0){if(Math.abs(O.mag-Math.log10(H.mag))>at)return O;{const Gt=Math.pow(10,O.mag-Math.log10(H.mag)),$t=H.sign+O.sign*Gt;return N.fromComponents(Math.sign($t),1,Math.log10(H.mag)+Math.log10(Math.abs($t)))}}if(Math.abs(O.mag-H.mag)>at)return O;{const Gt=Math.pow(10,O.mag-H.mag),$t=H.sign+O.sign*Gt;return N.fromComponents(Math.sign($t),1,H.mag+Math.log10(Math.abs($t)))}throw Error("Bad arguments to add: "+this+", "+x)}plus(x){return this.add(x)}sub(x){return this.add(N.fromValue_noAlloc(x).neg())}subtract(x){return this.sub(x)}minus(x){return this.sub(x)}mul(x){const w=N.fromValue_noAlloc(x);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(w.layer))return w;if(this.sign===0||w.sign===0)return N.fromComponents_noNormalize(0,0,0);if(this.layer===w.layer&&this.mag===-w.mag)return N.fromComponents_noNormalize(this.sign*w.sign,0,1);let O,H;if(this.layer>w.layer||this.layer==w.layer&&Math.abs(this.mag)>Math.abs(w.mag)?(O=this,H=w):(O=w,H=this),O.layer===0&&H.layer===0)return N.fromNumber(O.sign*H.sign*O.mag*H.mag);if(O.layer>=3||O.layer-H.layer>=2)return N.fromComponents(O.sign*H.sign,O.layer,O.mag);if(O.layer===1&&H.layer===0)return N.fromComponents(O.sign*H.sign,1,O.mag+Math.log10(H.mag));if(O.layer===1&&H.layer===1)return N.fromComponents(O.sign*H.sign,1,O.mag+H.mag);if(O.layer===2&&H.layer===1){const V=N.fromComponents(Math.sign(O.mag),O.layer-1,Math.abs(O.mag)).add(N.fromComponents(Math.sign(H.mag),H.layer-1,Math.abs(H.mag)));return N.fromComponents(O.sign*H.sign,V.layer+1,V.sign*V.mag)}if(O.layer===2&&H.layer===2){const V=N.fromComponents(Math.sign(O.mag),O.layer-1,Math.abs(O.mag)).add(N.fromComponents(Math.sign(H.mag),H.layer-1,Math.abs(H.mag)));return N.fromComponents(O.sign*H.sign,V.layer+1,V.sign*V.mag)}throw Error("Bad arguments to mul: "+this+", "+x)}multiply(x){return this.mul(x)}times(x){return this.mul(x)}div(x){const w=N.fromValue_noAlloc(x);return this.mul(w.recip())}divide(x){return this.div(x)}divideBy(x){return this.div(x)}dividedBy(x){return this.div(x)}recip(){return this.mag===0?N.dNaN:this.layer===0?N.fromComponents(this.sign,0,1/this.mag):N.fromComponents(this.sign,this.layer,-this.mag)}reciprocal(){return this.recip()}reciprocate(){return this.recip()}cmp(x){const w=N.fromValue_noAlloc(x);return this.sign>w.sign?1:this.sign<w.sign?-1:this.sign*this.cmpabs(x)}cmpabs(x){const w=N.fromValue_noAlloc(x),O=this.mag>0?this.layer:-this.layer,H=w.mag>0?w.layer:-w.layer;return O>H?1:O<H?-1:this.mag>w.mag?1:this.mag<w.mag?-1:0}compare(x){return this.cmp(x)}isNan(){return isNaN(this.sign)||isNaN(this.layer)||isNaN(this.mag)}isFinite(){return isFinite(this.sign)&&isFinite(this.layer)&&isFinite(this.mag)}eq(x){const w=N.fromValue_noAlloc(x);return this.sign===w.sign&&this.layer===w.layer&&this.mag===w.mag}equals(x){return this.eq(x)}neq(x){return!this.eq(x)}notEquals(x){return this.neq(x)}lt(x){return this.cmp(x)===-1}lte(x){return!this.gt(x)}gt(x){return this.cmp(x)===1}gte(x){return!this.lt(x)}max(x){const w=N.fromValue_noAlloc(x);return this.lt(w)?w:this}min(x){const w=N.fromValue_noAlloc(x);return this.gt(w)?w:this}maxabs(x){const w=N.fromValue_noAlloc(x);return this.cmpabs(w)<0?w:this}minabs(x){const w=N.fromValue_noAlloc(x);return this.cmpabs(w)>0?w:this}clamp(x,w){return this.max(x).min(w)}clampMin(x){return this.max(x)}clampMax(x){return this.min(x)}cmp_tolerance(x,w){const O=N.fromValue_noAlloc(x);return this.eq_tolerance(O,w)?0:this.cmp(O)}compare_tolerance(x,w){return this.cmp_tolerance(x,w)}eq_tolerance(x,w){const O=N.fromValue_noAlloc(x);if(w==null&&(w=1e-7),this.sign!==O.sign||Math.abs(this.layer-O.layer)>1)return!1;let H=this.mag,V=O.mag;return this.layer>O.layer&&(V=At(V)),this.layer<O.layer&&(H=At(H)),Math.abs(H-V)<=w*Math.max(Math.abs(H),Math.abs(V))}equals_tolerance(x,w){return this.eq_tolerance(x,w)}neq_tolerance(x,w){return!this.eq_tolerance(x,w)}notEquals_tolerance(x,w){return this.neq_tolerance(x,w)}lt_tolerance(x,w){const O=N.fromValue_noAlloc(x);return!this.eq_tolerance(O,w)&&this.lt(O)}lte_tolerance(x,w){const O=N.fromValue_noAlloc(x);return this.eq_tolerance(O,w)||this.lt(O)}gt_tolerance(x,w){const O=N.fromValue_noAlloc(x);return!this.eq_tolerance(O,w)&&this.gt(O)}gte_tolerance(x,w){const O=N.fromValue_noAlloc(x);return this.eq_tolerance(O,w)||this.gt(O)}pLog10(){return this.lt(N.dZero)?N.dZero:this.log10()}absLog10(){return this.sign===0?N.dNaN:this.layer>0?N.fromComponents(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):N.fromComponents(1,0,Math.log10(this.mag))}log10(){return this.sign<=0?N.dNaN:this.layer>0?N.fromComponents(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):N.fromComponents(this.sign,0,Math.log10(this.mag))}log(x){return x=N.fromValue_noAlloc(x),this.sign<=0||x.sign<=0||x.sign===1&&x.layer===0&&x.mag===1?N.dNaN:this.layer===0&&x.layer===0?N.fromComponents(this.sign,0,Math.log(this.mag)/Math.log(x.mag)):N.div(this.log10(),x.log10())}log2(){return this.sign<=0?N.dNaN:this.layer===0?N.fromComponents(this.sign,0,Math.log2(this.mag)):this.layer===1?N.fromComponents(Math.sign(this.mag),0,Math.abs(this.mag)*3.321928094887362):this.layer===2?N.fromComponents(Math.sign(this.mag),1,Math.abs(this.mag)+.5213902276543247):N.fromComponents(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}ln(){return this.sign<=0?N.dNaN:this.layer===0?N.fromComponents(this.sign,0,Math.log(this.mag)):this.layer===1?N.fromComponents(Math.sign(this.mag),0,Math.abs(this.mag)*2.302585092994046):this.layer===2?N.fromComponents(Math.sign(this.mag),1,Math.abs(this.mag)+.36221568869946325):N.fromComponents(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}logarithm(x){return this.log(x)}pow(x){const w=N.fromValue_noAlloc(x),O=this,H=w;if(O.sign===0)return H.eq(0)?N.fromComponents_noNormalize(1,0,1):O;if(O.sign===1&&O.layer===0&&O.mag===1)return O;if(H.sign===0)return N.fromComponents_noNormalize(1,0,1);if(H.sign===1&&H.layer===0&&H.mag===1)return O;const V=O.absLog10().mul(H).pow10();return this.sign===-1?Math.abs(H.toNumber()%2)%2===1?V.neg():Math.abs(H.toNumber()%2)%2===0?V:N.dNaN:V}pow10(){if(!Number.isFinite(this.layer)||!Number.isFinite(this.mag))return N.dNaN;let x=this;if(x.layer===0){const w=Math.pow(10,x.sign*x.mag);if(Number.isFinite(w)&&Math.abs(w)>=.1)return N.fromComponents(1,0,w);if(x.sign===0)return N.dOne;x=N.fromComponents_noNormalize(x.sign,x.layer+1,Math.log10(x.mag))}return x.sign>0&&x.mag>=0?N.fromComponents(x.sign,x.layer+1,x.mag):x.sign<0&&x.mag>=0?N.fromComponents(-x.sign,x.layer+1,-x.mag):N.dOne}pow_base(x){return N.fromValue_noAlloc(x).pow(this)}root(x){const w=N.fromValue_noAlloc(x);return this.pow(w.recip())}factorial(){return this.mag<0?this.add(1).gamma():this.layer===0?this.add(1).gamma():this.layer===1?N.exp(N.mul(this,N.ln(this).sub(1))):N.exp(this)}gamma(){if(this.mag<0)return this.recip();if(this.layer===0){if(this.lt(N.fromComponents_noNormalize(1,0,24)))return N.fromNumber(ot(this.sign*this.mag));const x=this.mag-1;let w=.9189385332046727;w=w+(x+.5)*Math.log(x),w=w-x;const O=x*x;let H=x,V=12*H,Q=1/V,Gt=w+Q;if(Gt===w||(w=Gt,H=H*O,V=360*H,Q=1/V,Gt=w-Q,Gt===w))return N.exp(w);w=Gt,H=H*O,V=1260*H;let $t=1/V;return w=w+$t,H=H*O,V=1680*H,$t=1/V,w=w-$t,N.exp(w)}else return this.layer===1?N.exp(N.mul(this,N.ln(this).sub(1))):N.exp(this)}lngamma(){return this.gamma().ln()}exp(){return this.mag<0?N.dOne:this.layer===0&&this.mag<=709.7?N.fromNumber(Math.exp(this.sign*this.mag)):this.layer===0?N.fromComponents(1,1,this.sign*Math.log10(Math.E)*this.mag):this.layer===1?N.fromComponents(1,2,this.sign*(Math.log10(.4342944819032518)+this.mag)):N.fromComponents(1,this.layer+1,this.sign*this.mag)}sqr(){return this.pow(2)}sqrt(){if(this.layer===0)return N.fromNumber(Math.sqrt(this.sign*this.mag));if(this.layer===1)return N.fromComponents(1,2,Math.log10(this.mag)-.3010299956639812);{const x=N.div(N.fromComponents_noNormalize(this.sign,this.layer-1,this.mag),N.fromComponents_noNormalize(1,0,2));return x.layer+=1,x.normalize(),x}}cube(){return this.pow(3)}cbrt(){return this.pow(1/3)}tetrate(x=2,w=N.fromComponents_noNormalize(1,0,1)){if(x===1)return N.pow(this,w);if(x===0)return new N(w);if(this.eq(N.dOne))return N.dOne;if(this.eq(-1))return N.pow(this,w);if(x===Number.POSITIVE_INFINITY){const V=this.toNumber();if(V<=1.444667861009766&&V>=.06598803584531254){if(V>1.444667861009099)return N.fromNumber(Math.E);const Q=N.ln(this).neg();return Q.lambertw().div(Q)}else return V>1.444667861009766?N.fromNumber(Number.POSITIVE_INFINITY):N.dNaN}if(this.eq(N.dZero)){let V=Math.abs((x+1)%2);return V>1&&(V=2-V),N.fromNumber(V)}if(x<0)return N.iteratedlog(w,this,-x);w=N.fromValue_noAlloc(w);const O=x;x=Math.trunc(x);const H=O-x;if(this.gt(N.dZero)&&this.lte(1.444667861009766)){x=Math.min(1e4,x);for(let V=0;V<x;++V){const Q=w;if(w=this.pow(w),Q.eq(w))return w}if(H!=0){const V=this.pow(w);return w.mul(1-H).add(V.mul(H))}return w}H!==0&&(w.eq(N.dOne)?this.gt(10)?w=this.pow(H):(w=N.fromNumber(N.tetrate_critical(this.toNumber(),H)),this.lt(2)&&(w=w.sub(1).mul(this.minus(1)).plus(1))):this.eq(10)?w=w.layeradd10(H):w=w.layeradd(H,this));for(let V=0;V<x;++V){if(w=this.pow(w),!isFinite(w.layer)||!isFinite(w.mag))return w.normalize();if(w.layer-this.layer>3)return N.fromComponents_noNormalize(w.sign,w.layer+(x-V-1),w.mag);if(V>1e4)return w}return w}iteratedexp(x=2,w=N.fromComponents_noNormalize(1,0,1)){return this.tetrate(x,w)}iteratedlog(x=10,w=1){if(w<0)return N.tetrate(x,-w,this);x=N.fromValue_noAlloc(x);let O=N.fromDecimal(this);const H=w;w=Math.trunc(w);const V=H-w;if(O.layer-x.layer>3){const Q=Math.min(w,O.layer-x.layer-3);w-=Q,O.layer-=Q}for(let Q=0;Q<w;++Q){if(O=O.log(x),!isFinite(O.layer)||!isFinite(O.mag))return O.normalize();if(Q>1e4)return O}return V>0&&V<1&&(x.eq(10)?O=O.layeradd10(-V):O=O.layeradd(-V,x)),O}slog(x=10,w=100){let O=.001,H=!1,V=!1,Q=this.slog_internal(x).toNumber();for(let Gt=1;Gt<w;++Gt){const Zt=new N(x).tetrate(Q).gt(this);if(Gt>1&&V!=Zt&&(H=!0),V=Zt,H?O/=2:O*=2,O=Math.abs(O)*(Zt?-1:1),Q+=O,O===0)break}return N.fromNumber(Q)}slog_internal(x=10){if(x=N.fromValue_noAlloc(x),x.lte(N.dZero)||x.eq(N.dOne))return N.dNaN;if(x.lt(N.dOne))return this.eq(N.dOne)?N.dZero:this.eq(N.dZero)?N.dNegOne:N.dNaN;if(this.mag<0||this.eq(N.dZero))return N.dNegOne;let w=0,O=N.fromDecimal(this);if(O.layer-x.layer>3){const H=O.layer-x.layer-3;w+=H,O.layer-=H}for(let H=0;H<100;++H)if(O.lt(N.dZero))O=N.pow(x,O),w-=1;else{if(O.lte(N.dOne))return N.fromNumber(w+N.slog_critical(x.toNumber(),O.toNumber()));w+=1,O=N.log(O,x)}return N.fromNumber(w)}static slog_critical(x,w){return x>10?w-1:N.critical_section(x,w,Dt)}static tetrate_critical(x,w){return N.critical_section(x,w,Et)}static critical_section(x,w,O){w*=10,w<0&&(w=0),w>10&&(w=10),x<2&&(x=2),x>10&&(x=10);let H=0,V=0;for(let Gt=0;Gt<It.length;++Gt)if(It[Gt]==x){H=O[Gt][Math.floor(w)],V=O[Gt][Math.ceil(w)];break}else if(It[Gt]<x&&It[Gt+1]>x){const $t=(x-It[Gt])/(It[Gt+1]-It[Gt]);H=O[Gt][Math.floor(w)]*(1-$t)+O[Gt+1][Math.floor(w)]*$t,V=O[Gt][Math.ceil(w)]*(1-$t)+O[Gt+1][Math.ceil(w)]*$t;break}const Q=w-Math.floor(w);return H<=0||V<=0?H*(1-Q)+V*Q:Math.pow(x,Math.log(H)/Math.log(x)*(1-Q)+Math.log(V)/Math.log(x)*Q)}layeradd10(x){x=N.fromValue_noAlloc(x).toNumber();const w=N.fromDecimal(this);if(x>=1){w.mag<0&&w.layer>0?(w.sign=0,w.mag=0,w.layer=0):w.sign===-1&&w.layer==0&&(w.sign=1,w.mag=-w.mag);const O=Math.trunc(x);x-=O,w.layer+=O}if(x<=-1){const O=Math.trunc(x);if(x-=O,w.layer+=O,w.layer<0)for(let H=0;H<100;++H){if(w.layer++,w.mag=Math.log10(w.mag),!isFinite(w.mag))return w.sign===0&&(w.sign=1),w.layer<0&&(w.layer=0),w.normalize();if(w.layer>=0)break}}for(;w.layer<0;)w.layer++,w.mag=Math.log10(w.mag);return w.sign===0&&(w.sign=1,w.mag===0&&w.layer>=1&&(w.layer-=1,w.mag=1)),w.normalize(),x!==0?w.layeradd(x,10):w}layeradd(x,w){const H=this.slog(w).toNumber()+x;return H>=0?N.tetrate(w,H):Number.isFinite(H)?H>=-1?N.log(N.tetrate(w,H+1),w):N.log(N.log(N.tetrate(w,H+2),w),w):N.dNaN}lambertw(){if(this.lt(-.3678794411710499))throw Error("lambertw is unimplemented for results less than -1, sorry!");if(this.mag<0)return N.fromNumber(ye(this.toNumber()));if(this.layer===0)return N.fromNumber(ye(this.sign*this.mag));if(this.layer===1)return zt(this);if(this.layer===2)return zt(this);if(this.layer>=3)return N.fromComponents_noNormalize(this.sign,this.layer-1,this.mag);throw"Unhandled behavior in lambertw()"}ssqrt(){if(this.sign==1&&this.layer>=3)return N.fromComponents_noNormalize(this.sign,this.layer-1,this.mag);const x=this.ln();return x.div(x.lambertw())}pentate(x=2,w=N.fromComponents_noNormalize(1,0,1)){w=N.fromValue_noAlloc(w);const O=x;x=Math.trunc(x);const H=O-x;H!==0&&(w.eq(N.dOne)?(++x,w=N.fromNumber(H)):this.eq(10)?w=w.layeradd10(H):w=w.layeradd(H,this));for(let V=0;V<x;++V){if(w=this.tetrate(w.toNumber()),!isFinite(w.layer)||!isFinite(w.mag))return w.normalize();if(V>10)return w}return w}sin(){return this.mag<0?this:this.layer===0?N.fromNumber(Math.sin(this.sign*this.mag)):N.fromComponents_noNormalize(0,0,0)}cos(){return this.mag<0?N.dOne:this.layer===0?N.fromNumber(Math.cos(this.sign*this.mag)):N.fromComponents_noNormalize(0,0,0)}tan(){return this.mag<0?this:this.layer===0?N.fromNumber(Math.tan(this.sign*this.mag)):N.fromComponents_noNormalize(0,0,0)}asin(){return this.mag<0?this:this.layer===0?N.fromNumber(Math.asin(this.sign*this.mag)):N.fromComponents_noNormalize(Number.NaN,Number.NaN,Number.NaN)}acos(){return this.mag<0?N.fromNumber(Math.acos(this.toNumber())):this.layer===0?N.fromNumber(Math.acos(this.sign*this.mag)):N.fromComponents_noNormalize(Number.NaN,Number.NaN,Number.NaN)}atan(){return this.mag<0?this:this.layer===0?N.fromNumber(Math.atan(this.sign*this.mag)):N.fromNumber(Math.atan(this.sign*(1/0)))}sinh(){return this.exp().sub(this.negate().exp()).div(2)}cosh(){return this.exp().add(this.negate().exp()).div(2)}tanh(){return this.sinh().div(this.cosh())}asinh(){return N.ln(this.add(this.sqr().add(1).sqrt()))}acosh(){return N.ln(this.add(this.sqr().sub(1).sqrt()))}atanh(){return this.abs().gte(1)?N.fromComponents_noNormalize(Number.NaN,Number.NaN,Number.NaN):N.ln(this.add(1).div(N.fromNumber(1).sub(this))).div(2)}ascensionPenalty(x){return x===0?this:this.root(N.pow(10,x))}egg(){return this.add(9)}lessThanOrEqualTo(x){return this.cmp(x)<1}lessThan(x){return this.cmp(x)<0}greaterThanOrEqualTo(x){return this.cmp(x)>-1}greaterThan(x){return this.cmp(x)>0}static smoothDamp(x,w,O,H){return new N(x).add(new N(w).minus(new N(x)).times(new N(O)).times(new N(H)))}static format(x,w=2,O=9){return Bt(new N(x),w,O)}clone(){return this}mod(x){const w=new N(x);return w.eq(0)?new N(0):this.sign*w.sign==-1?this.abs().mod(w.abs()).neg():this.sign==-1?this.abs().mod(w.abs()):this.sub(this.div(w).floor().mul(w))}softcap(x,w,O){let H=this.clone();return H.gte(x)&&([0,"pow"].includes(O)&&(H=H.div(x).pow(w).mul(x)),[1,"mul"].includes(O)&&(H=H.sub(x).div(w).add(x))),H}scale(x,w,O,H=!1){x=new N(x),w=new N(w);let V=this.clone();return V.gte(x)&&([0,"pow"].includes(O)&&(V=H?V.mul(x.pow(w.sub(1))).root(w):V.pow(w).div(x.pow(w.sub(1)))),[1,"exp"].includes(O)&&(V=H?V.div(x).max(1).log(w).add(x):N.pow(w,V.sub(x)).mul(x))),V}format(x=2,w=9){return Bt(this.clone(),x,w)}formatST(x=2,w=9,O="st"){return Bt(this.clone(),x,w,O)}formatGain(x){return Ht(this.clone(),x)}toRoman(x){x=x?new N(x):5e3;const w=this.clone();if(w.gte(x))return w;const O=w.toNumber(),H=String(+O).split(""),V=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let Q="",Gt=3;if(typeof H.pop()!="undefined"){for(;Gt--;)Q=(V[+H.pop()+Gt*10]||"")+Q;return Array(+H.join("")+1).join("M")+Q}else return""}},N.dZero=N.fromComponents_noNormalize(0,0,0),N.dOne=N.fromComponents_noNormalize(1,0,1),N.dNegOne=N.fromComponents_noNormalize(-1,0,1),N.dTwo=N.fromComponents_noNormalize(1,0,2),N.dTen=N.fromComponents_noNormalize(1,0,10),N.dNaN=N.fromComponents_noNormalize(Number.NaN,Number.NaN,Number.NaN),N.dInf=N.fromComponents_noNormalize(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),N.dNegInf=N.fromComponents_noNormalize(-1,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),N.dNumberMax=N.fromComponents(1,0,Number.MAX_VALUE),N.dNumberMin=N.fromComponents(1,0,Number.MIN_VALUE),N.fromStringCache=new nt(yt),N),st=[[["","U","D","T","Qa","Qt","Sx","Sp","Oc","No"],["","Dc","Vg","Tg","Qag","Qtg","Sxg","Spg","Ocg","Nog"],["","Ce","De","Te","Qae","Qte","Sxe","Spe","Oce","Noe"]],[["","Mi","Mc","Na","Pc","Fm","At","Zp","Yc","Xn"],["","Me","Du","Tr","Te","Pe","He","Hp","Ot","En"],["","c","Ic","TCn","TeC","PCn","HCn","HpC","OCn","ECn"],["","Hc","DHe","THt","TeH","PHc","HHe","HpH","OHt","EHc"]]],rt={omega:{config:{greek:"\u03B2\u03B6\u03BB\u03C8\u03A3\u0398\u03A8\u03C9",infinity:"\u03A9"},format(k){const x=z.floor(k.div(1e3)),w=z.floor(x.div(this.config.greek.length));let O=this.config.greek[x.toNumber()%this.config.greek.length]+bt(k.toNumber()%1e3);(this.config.greek[x.toNumber()%this.config.greek.length]===void 0||x.toNumber()>Number.MAX_SAFE_INTEGER)&&(O="\u03C9");const V=z.log(k,8e3).toNumber();if(w.equals(0))return O;if(w.gt(0)&&w.lte(3)){const $t=[];for(let Zt=0;Zt<w.toNumber();Zt++)$t.push("\u03C9");return`${$t.join("^")}^${O}`}else{if(w.gt(3)&&w.lt(10))return`\u03C9(${w.toFixed(0)})^${O}`;if(V<3)return`\u03C9(${this.format(w)})^${O}`;if(V<6)return`\u03C9(${this.format(w)})`}const Q=z.pow(8e3,V%1);return`\u03C9[${V<100?Math.floor(V).toFixed(0):this.format(z.floor(V))}](${this.format(Q)})`}},omega_short:{config:{greek:"\u03B2\u03B6\u03BB\u03C8\u03A3\u0398\u03A8\u03C9",infinity:"\u03A9"},format(k){const x=z.floor(k.div(1e3)),w=z.floor(x.div(this.config.greek.length));let O=this.config.greek[x.toNumber()%this.config.greek.length]+bt(k.toNumber()%1e3);(this.config.greek[x.toNumber()%this.config.greek.length]===void 0||x.toNumber()>Number.MAX_SAFE_INTEGER)&&(O="\u03C9");const V=z.log(k,8e3).toNumber();if(w.equals(0))return O;if(w.gt(0)&&w.lte(2)){const $t=[];for(let Zt=0;Zt<w.toNumber();Zt++)$t.push("\u03C9");return`${$t.join("^")}^${O}`}else if(w.gt(2)&&w.lt(10))return`\u03C9(${w.toFixed(0)})^${O}`;const Q=z.pow(8e3,V%1);return`\u03C9[${V<100?Math.floor(V).toFixed(0):this.format(z.floor(V))}](${this.format(Q)})`}},elemental:{config:{element_lists:[["H"],["He","Li","Be","B","C","N","O","F"],["Ne","Na","Mg","Al","Si","P","S","Cl"],["Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br"],["Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I"],["Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At"],["Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Nh","Fl","Mc","Lv","Ts"],["Og"]]},getOffset(k){if(k==1)return 1;const x=Math.floor(k/2);let w=2*x*(x+1)*(2*x+1)/3-2;return k%2==1&&(w+=2*Math.pow(x+1,2)),w},getAbbreviation(k,x){const w=this.abbreviationLength(k),O=Math.floor(w*x),H=O+this.getOffset(k);return H>118?this.beyondOg(H):this.config.element_lists[k-1][O]},beyondOg(k){const x=Math.floor(Math.log10(k)),w=["n","u","b","t","q","p","h","s","o","e"];let O="";for(let H=x;H>=0;H--){const V=Math.floor(k/Math.pow(10,H))%10;O==""?O=w[V].toUpperCase():O+=w[V]}return O},abbreviationLength(k){return k==1?1:Math.pow(Math.floor(k/2)+1,2)*2},getAbbreviationAndValue(k){const x=k.log(118).toNumber(),w=Math.floor(x)+1,O=this.abbreviationLength(w),H=x-w+1,V=Math.floor(H*O),Q=this.getAbbreviation(w,H),Gt=new z(118).pow(w+V/O-1);return[Q,Gt]},formatElementalPart(k,x){return x.eq(1)?k:`${x} ${k}`},format(k,x){if(k.gt(new z(118).pow(new z(118).pow(new z(118).pow(4)))))return"e"+this.format(k.log10(),x);let w=k.log(118);const H=w.log(118).log(118).toNumber(),V=Math.max(4-H*2,1),Q=[];for(;w.gte(1)&&Q.length<V;){const[$t,Zt]=this.getAbbreviationAndValue(w),se=w.div(Zt).floor();w=w.sub(se.mul(Zt)),Q.unshift([$t,se])}if(Q.length>=V)return Q.map($t=>this.formatElementalPart($t[0],$t[1])).join(" + ");const Gt=new z(118).pow(w).toFixed(Q.length===1?3:x);return Q.length===0?Gt:Q.length===1?`${Gt} \xD7 ${this.formatElementalPart(Q[0][0],Q[0][1])}`:`${Gt} \xD7 (${Q.map($t=>this.formatElementalPart($t[0],$t[1])).join(" + ")})`}},old_sc:{format(k,x){k=new z(k);const w=k.log10().floor();if(w.lt(9))return w.lt(3)?k.toFixed(x):k.floor().toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");{if(k.gte("eeee10")){const H=k.slog();return(H.gte(1e9)?"":new z(10).pow(H.sub(H.floor())).toFixed(4))+"F"+this.format(H.floor(),0)}const O=k.div(new z(10).pow(w));return(w.log10().gte(9)?"":O.toFixed(4))+"e"+this.format(w,0)}}},eng:{format(k,x){k=new z(k);const w=k.log10().floor();if(w.lt(9))return w.lt(3)?k.toFixed(x):k.floor().toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");{if(k.gte("eeee10")){const H=k.slog();return(H.gte(1e9)?"":new z(10).pow(H.sub(H.floor())).toFixed(4))+"F"+this.format(H.floor(),0)}const O=k.div(new z(1e3).pow(w.div(3).floor()));return(w.log10().gte(9)?"":O.toFixed(new z(4).sub(w.sub(w.div(3).floor().mul(3)))))+"e"+this.format(w.div(3).floor().mul(3),0)}}},mixed_sc:{format(k,x,w){k=new z(k);const O=k.log10().floor();return O.lt(303)&&O.gte(w)?Bt(k,x,w,"st"):Bt(k,x,w,"sc")}},layer:{layers:["infinity","eternity","reality","equality","affinity","celerity","identity","vitality","immunity","atrocity"],format(k,x,w){k=new z(k);const O=k.max(1).log10().max(1).log(Pt.log10()).floor();if(O.lte(0))return Bt(k,x,w,"sc");k=new z(10).pow(k.max(1).log10().div(Pt.log10().pow(O)).sub(O.gte(1)?1:0));const H=O.div(10).floor(),V=O.toNumber()%10-1;return Bt(k,Math.max(4,x),w,"sc")+" "+(H.gte(1)?"meta"+(H.gte(2)?"^"+Bt(H,0,w,"sc"):"")+"-":"")+(isNaN(V)?"nanity":this.layers[V])}},standard:{tier1(k){return st[0][0][k%10]+st[0][1][Math.floor(k/10)%10]+st[0][2][Math.floor(k/100)]},tier2(k){const x=k%10,w=Math.floor(k/10)%10,O=Math.floor(k/100)%10;let H="";return k<10?st[1][0][k]:(w==1&&x==0?H+="Vec":H+=st[1][1][x]+st[1][2][w],H+=st[1][3][O],H)}},inf:{format(k,x,w){k=new z(k);let O=0;const H=new z(Number.MAX_VALUE),V=["","\u221E","\u03A9","\u03A8","\u028A"],Q=["","","m","mm","mmm"];for(;k.gte(H);)k=k.log(H),O++;return O==0?Bt(k,x,w,"sc"):k.gte(3)?Q[O]+V[O]+"\u03C9^"+Bt(k.sub(1),x,w,"sc"):k.gte(2)?Q[O]+"\u03C9"+V[O]+"-"+Bt(H.pow(k.sub(2)),x,w,"sc"):Q[O]+V[O]+"-"+Bt(H.pow(k.sub(1)),x,w,"sc")}}},Pt=new z(2).pow(1024),St="\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089",ut="\u2070\xB9\xB2\xB3\u2074\u2075\u2076\u2077\u2078\u2079";function bt(k){return k.toFixed(0).split("").map(x=>x==="-"?"\u208B":St[parseInt(x,10)]).join("")}function Nt(k){return k.toFixed(0).split("").map(x=>x==="-"?"\u208B":ut[parseInt(x,10)]).join("")}function Vt(k,x=2,w=9,O="st"){return Bt(k,x,w,O)}function Bt(k,x=2,w=9,O="mixed_sc"){k=new z(k);const H=k.lt(0)?"-":"";if(k.mag==1/0)return H+"Infinity";if(Number.isNaN(k.mag))return H+"NaN";if(k.lt(0)&&(k=k.mul(-1)),k.eq(0))return k.toFixed(x);const V=k.log10().floor();switch(O){case"sc":if(k.log10().lt(Math.min(-x,0))&&x>1){const Q=k.log10().ceil(),Gt=k.div(Q.eq(-1)?new z(.1):new z(10).pow(Q)),$t=Q.mul(-1).max(1).log10().gte(9);return H+($t?"":Gt.toFixed(2))+"e"+Bt(Q,0,w,"mixed_sc")}else if(V.lt(w)){const Q=Math.max(Math.min(x-V.toNumber(),x),0);return H+(Q>0?k.toFixed(Q):k.toFixed(Q).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"))}else{if(k.gte("eeee10")){const $t=k.slog();return($t.gte(1e9)?"":new z(10).pow($t.sub($t.floor())).toFixed(2))+"F"+Bt($t.floor(),0)}const Q=k.div(new z(10).pow(V)),Gt=V.log10().gte(9);return H+(Gt?"":Q.toFixed(2))+"e"+Bt(V,0,w,"mixed_sc")}case"st":{let Q=k.log(1e3).floor();if(Q.lt(1))return H+k.toFixed(Math.max(Math.min(x-V.toNumber(),x),0));{const Gt=Q.mul(3),$t=Q.log10().floor();if($t.gte(3e3))return"e"+Bt(V,x,w,"st");let Zt="";if(Q.lt(4))Zt=["","K","M","B"][Math.round(Q.toNumber())];else{let Ae=Math.floor(Q.log(1e3).toNumber());for(Ae<100&&(Ae=Math.max(Ae-1,0)),Q=Q.sub(1).div(new z(10).pow(Ae*3));Q.gt(0);){const Be=Q.div(1e3).floor(),Ue=Q.sub(Be.mul(1e3)).floor().toNumber();Ue>0&&(Ue==1&&!Ae&&(Zt="U"),Ae&&(Zt=rt.standard.tier2(Ae)+(Zt?"-"+Zt:"")),Ue>1&&(Zt=rt.standard.tier1(Ue)+Zt)),Q=Be,Ae++}}const se=k.div(new z(10).pow(Gt));return H+($t.gte(10)?"":se.toFixed(new z(2).sub(V.sub(Gt)).add(1).toNumber())+" ")+Zt}}default:return H+rt[O].format(k,x,w)}}function Ht(k,x){k=new z(k),x=new z(x);const w=k.add(x);let O,H=w.div(k);return H.gte(10)&&k.gte(1e100)?(H=H.log10().mul(20),O="(+"+Bt(H)+" OoMs/sec)"):O="(+"+Bt(x)+"/sec)",O}function Qt(k,x=2,w="s"){return k=new z(k),k.gte(86400)?Bt(k.div(86400).floor(),0,12,"sc")+":"+Qt(k.mod(86400),x,"d"):k.gte(3600)||w=="d"?(k.div(3600).gte(10)||w!="d"?"":"0")+Bt(k.div(3600).floor(),0,12,"sc")+":"+Qt(k.mod(3600),x,"h"):k.gte(60)||w=="h"?(k.div(60).gte(10)||w!="h"?"":"0")+Bt(k.div(60).floor(),0,12,"sc")+":"+Qt(k.mod(60),x,"m"):(k.gte(10)||w!="m"?"":"0")+Bt(k,x,12,"sc")}function ee(k){return k=new z(k),Bt(new z(1).sub(k).mul(100))+"%"}function le(k){return k=new z(k),Bt(k.mul(100))+"%"}function he(k,x=2){return k=new z(k),k.gte(1)?"\xD7"+k.format(x):"/"+k.pow(-1).format(x)}function Xe(k,x,w=10){return z.gte(k,10)?z.pow(w,z.log(k,w).pow(x)):new z(k)}function Ee(k,x){k=new z(k);const w=[{name:"K",altName:"Kilo",value:new z("1000")},{name:"M",altName:"Mega",value:new z("1e6")},{name:"G",altName:"Giga",value:new z("1e9")},{name:"T",altName:"Tera",value:new z("1e12")},{name:"P",altName:"Peta",value:new z("1e15")},{name:"E",altName:"Exa",value:new z("1e18")},{name:"Z",altName:"Zetta",value:new z("1e21")},{name:"Y",altName:"Yotta",value:new z("1e24")},{name:"R",altName:"Ronna",value:new z("1e27")},{name:"Q",altName:"Quetta",value:new z("1e30")}];let O;for(let H=0;H<w.length;H++)if(k.greaterThanOrEqualTo(w[H].value)){if(H==w.length-1)switch(x){case 1:O=w[H].name;break;case 2:O=`${k.divide(w[H].value).format()}`;break;case 3:O=w[H].altName;break;case 0:default:O=`${k.divide(w[H].value).format()} ${w[H].name}`;break}continue}else if(H==0)switch(x){case 1:O="";break;case 2:case 0:default:O=k.format();break}else switch(x){case 1:O=w[H-1].name;break;case 2:O=`${k.divide(w[H-1].value).format()}`;break;case 3:O=w[H-1].altName;break;case 0:default:O=`${k.divide(w[H-1].value).format()} ${w[H-1].name}`;break}return O}function te(k,x=!1){return`${Ee(k,2)} ${Ee(k,1)}eV${x?"/c^2":""}`}var We=Ni(Qe({},rt),{toSubscript:bt,toSuperscript:Nt,formatST:Vt,format:Bt,formatGain:Ht,formatTime:Qt,formatReduction:ee,formatPercent:le,formatMult:he,expMult:Xe,metric:Ee,ev:te});z.formats=We;var ue=z,fe=class extends String{constructor(k){super(k),this.forEach=function(x){for(let w=0;w<this.length;w++)x(this[w])},this.forEachAdvanced=function(x,w,O){for(let H=w<0?0:w;H<(O>this.length?this.length:O<w?this.length:O);H++)x({value:this[H],index:H})},this.toNumber=function(){let x="";for(let w=0;w<this.length;w++)x+=this.charCodeAt(w).toString();return parseInt(x)},this.toArray=function(){const x=[];for(let w=0;w<this.length;w++)x.push(this[w]);return x},this.before=function(x){let w="";return this.forEachAdvanced(function(O){w+=O.value},0,x),w},this.after=function(x){let w="";return this.forEachAdvanced(function(O){w+=O.value},x,-1),w},this.customSplit=function(x){const w=[];return w.push(this.before(x)),w.push(this.after(x)),w},this.random=function(x){const w=(H,V,Q)=>Q!=null&&!Q?Math.random()*(V>H?V-H:H-V)+(V>H?H:V):Math.round(Math.random()*(V>H?V-H:H-V)+(V>H?H:V));let O="";if(x>0)for(let H=0;H<x;H++)O+=this.charAt(w(0,this.length));else O=this.charAt(w(0,this.length));return O}}},Se=k=>new ue(k);Object.getOwnPropertyNames(ue).filter(k=>!Object.getOwnPropertyNames(class{}).includes(k)).forEach(k=>{Se[k]=ue[k]});var Er={getFast:function(k,x){k=JSON.stringify(k);const w=x.toString().replace(/\\/g,"").length,O=k.search(x);let H="",V=w+2,Q=0,Gt=0,$t=0,Zt=0,se=0;function Ae(){const Be=k[O+V];if(k[O+V-1]!="\\")switch(Be){case'"':Q==0?Q=1:Q=0;break;case"'":Gt==0?Gt=1:Gt=0;break;case"`":$t==0?$t=1:$t=0;break;case"[":Zt++;break;case"]":Zt--;break;case"{":se++;break;case"}":se--;break}H+=Be,V++}for(Ae();Q+Gt+$t+Zt+se!=0;)Ae();return JSON.parse(H)},get:function(k,x){try{for(let w=0;w<Object.keys(k).length&&Object.keys(k)[w]!="sign";w++){if(Object.keys(k)[w]==x)return k[Object.keys(k)[w]];if(typeof k[Object.keys(k)[w]]=="object"){const O=this.get(k[Object.keys(k)[w]],x);if(O!=null)return O}else continue}return null}catch(w){return null}},randomNumber:(k,x,w)=>w!=null&&!w?Math.random()*(x>k?x-k:k-x)+(x>k?k:x):Math.round(Math.random()*(x>k?x-k:k-x)+(x>k?k:x)),randomString64:(k,x)=>{let w=(Math.random()*1232311).toString();for(let O=0;O<k;O++)w=btoa(w)+btoa(btoa(Math.random().toString()));return x?w.length:w},randomString:k=>new fe("!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~").random(k).toString()},vr=class $s{static normalizeBoost(x,w){return x.order||(x.order=99),x.index||(x.index=w||0),x}static normalizeBoostArray(x){const w=[];return x.forEach((O,H)=>{w.push(this.normalizeBoost(O,H))}),w}constructor(x,w){x=x?Se(x):1,this.baseEffect=Se(x),w?this.boostArray=$s.normalizeBoostArray(w):this.boostArray=[]}bGet(x){let w=null;for(let O=0;O<this.boostArray.length&&O!==this.boostArray.length;O++)x===this.boostArray[O].id&&(w=this.boostArray[O],w.index=O);return w}bRemove(x){const w=this.bGet(x);w&&delete this.boostArray[w.index]}bSet(x,w,O,H,V){const Q=this.bGet(x);Q?this.boostArray[Q.index]=$s.normalizeBoost({id:x,name:w,desc:O,value:H,order:V,index:this.boostArray.length}):this.boostArray.push($s.normalizeBoost({id:x,name:w,desc:O,value:H,order:V,index:this.boostArray.length}))}bSetAdvanced(...x){for(let w=0;w<x.length;w++){const O=this.bGet(x[w].id);O?(console.log(w),this.boostArray[O.index]=$s.normalizeBoost(x[w])):this.boostArray=this.boostArray.concat($s.normalizeBoost(x[w]))}}calculate(x=this.baseEffect){let w=Se(x);const O=this.boostArray;O.sort((H,V)=>H.order-V.order);for(let H=0;H<O.length;H++)w=O[H].value(w);return w}},Tr=class{constructor(){this.value=Se(0),this.upgrades=[]}},wr=class{constructor(k){this.upgrades=[],this.pointer=k,this.boost=new vr(1)}gain(k=1e3){return this.pointer().value=this.pointer().value.add(this.boost.calculate().mul(Se(k).div(1e3))),this.pointer().value}addUpgrade(k,x=!0){const w=H=>{const V=H.level?{level:H.level}:{level:Se(1)};return this.pointer().upgrades.push(V),H},O=[];for(let H=0;H<k.length;H++){const V=w(k[H]);V.getLevel=()=>{var Q;return(Q=this.pointer().upgrades[H].level)!=null?Q:Se(0)},V.setLevel=Q=>{var Gt,$t;return this.pointer().upgrades[H].level=($t=(Gt=this.pointer().upgrades[H].level)==null?void 0:Gt.add(Q))!=null?$t:Q},x&&V.effect(V.level),O.push(V)}this.upgrades=this.upgrades.concat(O)}calculateUpgrade(k,x,w=!1){x=Se(x);function O(Q,Gt){let $t=Se();for(let Zt=Se(0);Zt.lte(Gt);Zt=Zt.add(1))$t=$t.add(Q(Zt));return $t}function H(Q,Gt,$t=w){if($t){let Zt=Se(0),se=x,Ae=Se(-1);for(;Zt.lessThanOrEqualTo(se);){const Be=Zt.plus(se).dividedBy(2).floor();Q(Be).lte(Gt)?(Ae=Be,Zt=Be.plus(1)):se=Be.minus(1)}return Ae}else{let Zt=Se(0),se=Se(1),Ae=Se(0);for(;O(Q,se).lt(Gt);)Ae=se,se=se.mul(2);for(;Zt.lt(se);){const Be=Se.floor(Zt.add(se).div(2));O(Q,Be).lt(Gt)?Zt=Be.add(1):se=Be}return[Zt,O(Q,Zt.sub(1))]}}let V;if(typeof k=="number")V=this.upgrades[k];else if(typeof k=="string")for(let Q=0;Q<this.upgrades.length;Q++)if(this.upgrades[Q].id==k){V=this.upgrades[Q];break}else continue;else return!1;return H(Q=>V.costScaling(V.getLevel().add(Q)),this.pointer().value)}buyUpgrade(k,x){const w=(()=>{let H;if(typeof k=="number")H=this.upgrades[k];else if(typeof k=="string"){for(let V=0;V<this.upgrades.length;V++)if(this.upgrades[V].id===k){H=this.upgrades[V];break}}else H=!1;return H})();if(typeof w=="boolean")return!1;const O=this.calculateUpgrade(k,x);if(!Array.isArray(O)||O.length!==2||O[0].lte(0))return!1;{x=w.getLevel().add(x).lte(w.maxLevel)?x:w.maxLevel.sub(w.getLevel());const H=O[0].lte(x);return this.pointer().value=this.pointer().value.sub(O[1]),w.setLevel(w.getLevel().add(O[0])),typeof w.effect=="function"&&w.effect(w.getLevel(),w),!0}}},jr=class{constructor(k){this.initial=Se(k),this.value=Se(k),this.boost=new vr(1)}update(k){return k&&k(),this.value=this.boost.calculate(this.initial),this.value}},Lr=class{constructor(k,x,w){this.x=k,this.y=x,this.properties=w||{}}setValue(k,x){return this.properties[k]=x,x}getValue(k){return this.properties[k]}},Ar=class{constructor(k,x,w){this.x_size=k,this.y_size=x,this.cells=[];for(let O=0;O<x;O++){this.cells[O]=[];for(let H=0;H<k;H++)this.cells[O][H]=new Lr(H,O,w)}}getAll(){const k=[];for(let x=0;x<this.y_size;x++)for(let w=0;w<this.x_size;w++)k.push(this.cells[x][w]);return k}all(){return this.getAll()}static getAll(k){return k.getAll()}getAllX(k){const x=[];for(let w=0;w<this.y_size;w++)x.push(this.cells[w][k]);return x}allX(k){return this.getAllX(k)}static getAllX(k,x){return k.getAllX(x)}getAllY(k){const x=[];for(let w=0;this.x_size;w++)x.push(this.cells[k][w]);return x}allY(k){return this.getAllY(k)}static getAllY(k,x){return k.getAllY(x)}getCell(k,x){return this.cells[x][k]}static getCell(k,x,w){return k.getCell(x,w)}setCell(k,x,w){this.cells[x][k]=w}static setCell(k,x,w,O){return k.setCell(x,w,O)}getAdjacent(k,x){const w=[];return w[0]=this.getCell(k,x+1),w[1]=this.getCell(k+1,x),w[2]=this.getCell(k,x-1),w[3]=this.getCell(k-1,x+1),w}static getAdjacent(k,x,w){return k.getAdjacent(x,w)}getDiagonal(k,x){const w=[];return w[0]=this.getCell(k-1,x+1),w[1]=this.getCell(k+1,x+1),w[2]=this.getCell(k+1,x-1),w[3]=this.getCell(k-1,x-1),w}static getDiagonal(k,x,w){return k.getDiagonal(x,w)}getEncircling(k,x){return this.getAdjacent(k,x).concat(this.getDiagonal(k,x))}static getEncircling(k,x,w){return k.getEncircling(x,w)}static getDistance(k,x,w,O){return Math.abs(Math.sqrt(Math.pow(w-k,2)+Math.pow(O-x,2)))}},sr=class{constructor(k,x){for(const w of k){if(!w.name||!w.value)break;if(this[w.name]=w.value,x!=null)for(const O of x){if(!O.name||!O.value)break;this[w.name][O.name]||(this[w.name][O.name]=O.value)}delete this[w.name].name,delete this[w.name].value}}},Wr=class extends Array{constructor(k){super(k)}random(k){let x="";if(k>0)for(let w=0;w<k;w++)x+=this[Er.randomNumber(0,this.length)];else x=this[Er.randomNumber(0,this.length)];return x}},xr=class ho extends Object{constructor(x){super(x)}static getFast(x,w){x=JSON.stringify(x);const O=w.toString().replace(/\\/g,"").length,H=x.search(w);let V="",Q=O+2,Gt=0,$t=0,Zt=0,se=0,Ae=0;function Be(){const Ue=x[H+Q];if(x[H+Q-1]!="\\")switch(Ue){case'"':Gt==0?Gt=1:Gt=0;break;case"'":$t==0?$t=1:$t=0;break;case"`":Zt==0?Zt=1:Zt=0;break;case"[":se++;break;case"]":se--;break;case"{":Ae++;break;case"}":Ae--;break}V+=Ue,Q++}for(Be();Gt+$t+Zt+se+Ae!=0;)Be();return JSON.parse(V)}getFast(x){return ho.getFast(this,x)}static get(x,w){try{for(let O=0;O<Object.keys(x).length&&Object.keys(x)[O]!="sign";O++){if(Object.keys(x)[O]==w)return x[Object.keys(x)[O]];if(typeof x[Object.keys(x)[O]]=="object"){const H=ho.get(x[Object.keys(x)[O]],w);if(H!=null)return H}else continue}return null}catch(O){return null}}get(x){return ho.get(this,x)}},Je=Ni(Qe({},Er),{E:Se,classes:{boost:vr,currency:Tr,currencyStatic:wr,attribute:jr,grid:Ar,gridCell:Lr,EString:fe,EArray:Wr,EObject:xr,obb:sr}});typeof process!="object"&&typeof window!="undefined"&&(window.eMath=Je)},774:function(Wt,Kt,dt){"use strict";var xi;dt.d(Kt,{iw:function(){return Z},T$:function(){return vt},VL:function(){return Ve},a$:function(){return Ms},JZ:function(){return ni},Ie:function(){return kn},lW:function(){return fr},qm:function(){return os},yl:function(){return ft},Cd:function(){return us},Il:function(){return gr},ZX:function(){return Rs},lg:function(){return Ft},Pj:function(){return Sr},nw:function(){return Fe},I2:function(){return nt},wn:function(){return hi},wG:function(){return si},A7:function(){return lt},KI:function(){return it},y3:function(){return M},bO:function(){return Yi},AB:function(){return ar},_b:function(){return ls},E9:function(){return Ye},mg:function(){return Nr},$r:function(){return Oe},ud:function(){return Hn},jl:function(){return hs},Ae:function(){return Jt},TI:function(){return Pi},c9:function(){return I},aH:function(){return $},HS:function(){return zr},pX:function(){return In},ex:function(){return li},ZM:function(){return ri},vK:function(){return at},xE:function(){return qe},UX:function(){return wn},vB:function(){return ne},wx:function(){return Br},uF:function(){return jt},oo:function(){return pr},eH:function(){return xs},Rv:function(){return Ss},Nt:function(){return tt},e6:function(){return oe},Y9:function(){return pe},kP:function(){return Ke},Rw:function(){return ze},Xd:function(){return q},P6:function(){return S}});var S={};dt.r(S),dt.d(S,{BaseTextureCache:function(){return br},BoundingBox:function(){return fi},CanvasRenderTarget:function(){return ei},DATA_URI:function(){return Gi},EventEmitter:function(){return le},ProgramCache:function(){return Fr},TextureCache:function(){return or},clearTextureCache:function(){return On},correctBlendMode:function(){return Ur},createIndicesForQuads:function(){return Js},decomposeDataUri:function(){return nn},deprecation:function(){return te},destroyTextureCache:function(){return sn},detectVideoAlphaMode:function(){return jr},determineCrossOrigin:function(){return Yr},earcut:function(){return he},getBufferType:function(){return zi},getCanvasBoundingBox:function(){return As},getResolutionOfUrl:function(){return Hi},hex2rgb:function(){return Li},hex2string:function(){return Ji},interleaveTypedArrays:function(){return ws},isMobile:function(){return ee},isPow2:function(){return Ai},isWebGLSupported:function(){return Wr},log2:function(){return ts},nextPow2:function(){return wi},path:function(){return Tr},premultiplyBlendMode:function(){return ti},premultiplyRgba:function(){return Qs},premultiplyTint:function(){return Ui},premultiplyTintToRgba:function(){return bs},removeItems:function(){return tn},rgb2hex:function(){return $r},sayHello:function(){return Ar},sign:function(){return en},skipHello:function(){return Lr},string2hex:function(){return ki},trimCanvas:function(){return Es},uid:function(){return Gr},url:function(){return We}});var ct=(p=>(p[p.WEBGL_LEGACY=0]="WEBGL_LEGACY",p[p.WEBGL=1]="WEBGL",p[p.WEBGL2=2]="WEBGL2",p))(ct||{}),xt=(p=>(p[p.UNKNOWN=0]="UNKNOWN",p[p.WEBGL=1]="WEBGL",p[p.CANVAS=2]="CANVAS",p))(xt||{}),Lt=(p=>(p[p.COLOR=16384]="COLOR",p[p.DEPTH=256]="DEPTH",p[p.STENCIL=1024]="STENCIL",p))(Lt||{}),vt=(p=>(p[p.NORMAL=0]="NORMAL",p[p.ADD=1]="ADD",p[p.MULTIPLY=2]="MULTIPLY",p[p.SCREEN=3]="SCREEN",p[p.OVERLAY=4]="OVERLAY",p[p.DARKEN=5]="DARKEN",p[p.LIGHTEN=6]="LIGHTEN",p[p.COLOR_DODGE=7]="COLOR_DODGE",p[p.COLOR_BURN=8]="COLOR_BURN",p[p.HARD_LIGHT=9]="HARD_LIGHT",p[p.SOFT_LIGHT=10]="SOFT_LIGHT",p[p.DIFFERENCE=11]="DIFFERENCE",p[p.EXCLUSION=12]="EXCLUSION",p[p.HUE=13]="HUE",p[p.SATURATION=14]="SATURATION",p[p.COLOR=15]="COLOR",p[p.LUMINOSITY=16]="LUMINOSITY",p[p.NORMAL_NPM=17]="NORMAL_NPM",p[p.ADD_NPM=18]="ADD_NPM",p[p.SCREEN_NPM=19]="SCREEN_NPM",p[p.NONE=20]="NONE",p[p.SRC_OVER=0]="SRC_OVER",p[p.SRC_IN=21]="SRC_IN",p[p.SRC_OUT=22]="SRC_OUT",p[p.SRC_ATOP=23]="SRC_ATOP",p[p.DST_OVER=24]="DST_OVER",p[p.DST_IN=25]="DST_IN",p[p.DST_OUT=26]="DST_OUT",p[p.DST_ATOP=27]="DST_ATOP",p[p.ERASE=26]="ERASE",p[p.SUBTRACT=28]="SUBTRACT",p[p.XOR=29]="XOR",p))(vt||{}),Ft=(p=>(p[p.POINTS=0]="POINTS",p[p.LINES=1]="LINES",p[p.LINE_LOOP=2]="LINE_LOOP",p[p.LINE_STRIP=3]="LINE_STRIP",p[p.TRIANGLES=4]="TRIANGLES",p[p.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",p[p.TRIANGLE_FAN=6]="TRIANGLE_FAN",p))(Ft||{}),nt=(p=>(p[p.RGBA=6408]="RGBA",p[p.RGB=6407]="RGB",p[p.RG=33319]="RG",p[p.RED=6403]="RED",p[p.RGBA_INTEGER=36249]="RGBA_INTEGER",p[p.RGB_INTEGER=36248]="RGB_INTEGER",p[p.RG_INTEGER=33320]="RG_INTEGER",p[p.RED_INTEGER=36244]="RED_INTEGER",p[p.ALPHA=6406]="ALPHA",p[p.LUMINANCE=6409]="LUMINANCE",p[p.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",p[p.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",p[p.DEPTH_STENCIL=34041]="DEPTH_STENCIL",p))(nt||{}),mt=(p=>(p[p.TEXTURE_2D=3553]="TEXTURE_2D",p[p.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",p[p.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",p[p.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",p[p.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",p[p.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",p[p.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",p[p.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",p[p.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",p))(mt||{}),at=(p=>(p[p.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",p[p.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",p[p.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",p[p.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",p[p.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",p[p.UNSIGNED_INT=5125]="UNSIGNED_INT",p[p.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",p[p.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",p[p.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",p[p.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",p[p.BYTE=5120]="BYTE",p[p.SHORT=5122]="SHORT",p[p.INT=5124]="INT",p[p.FLOAT=5126]="FLOAT",p[p.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",p[p.HALF_FLOAT=36193]="HALF_FLOAT",p))(at||{}),L=(p=>(p[p.FLOAT=0]="FLOAT",p[p.INT=1]="INT",p[p.UINT=2]="UINT",p))(L||{}),$=(p=>(p[p.NEAREST=0]="NEAREST",p[p.LINEAR=1]="LINEAR",p))($||{}),tt=(p=>(p[p.CLAMP=33071]="CLAMP",p[p.REPEAT=10497]="REPEAT",p[p.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",p))(tt||{}),it=(p=>(p[p.OFF=0]="OFF",p[p.POW2=1]="POW2",p[p.ON=2]="ON",p[p.ON_MANUAL=3]="ON_MANUAL",p))(it||{}),Z=(p=>(p[p.NPM=0]="NPM",p[p.UNPACK=1]="UNPACK",p[p.PMA=2]="PMA",p[p.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",p[p.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",p[p.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",p))(Z||{}),ft=(p=>(p[p.NO=0]="NO",p[p.YES=1]="YES",p[p.AUTO=2]="AUTO",p[p.BLEND=0]="BLEND",p[p.CLEAR=1]="CLEAR",p[p.BLIT=2]="BLIT",p))(ft||{}),yt=(p=>(p[p.AUTO=0]="AUTO",p[p.MANUAL=1]="MANUAL",p))(yt||{}),K=(p=>(p.LOW="lowp",p.MEDIUM="mediump",p.HIGH="highp",p))(K||{}),lt=(p=>(p[p.NONE=0]="NONE",p[p.SCISSOR=1]="SCISSOR",p[p.STENCIL=2]="STENCIL",p[p.SPRITE=3]="SPRITE",p[p.COLOR=4]="COLOR",p))(lt||{}),_t=(p=>(p[p.RED=1]="RED",p[p.GREEN=2]="GREEN",p[p.BLUE=4]="BLUE",p[p.ALPHA=8]="ALPHA",p))(_t||{}),It=(p=>(p[p.NONE=0]="NONE",p[p.LOW=2]="LOW",p[p.MEDIUM=4]="MEDIUM",p[p.HIGH=8]="HIGH",p))(It||{}),Et=(p=>(p[p.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",p[p.ARRAY_BUFFER=34962]="ARRAY_BUFFER",p[p.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",p))(Et||{});const q={ADAPTER:{createCanvas:(p,c)=>{const f=document.createElement("canvas");return f.width=p,f.height=c,f},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>{var p;return(p=document.baseURI)!=null?p:window.location.href},getFontFaceSet:()=>document.fonts,fetch:(p,c)=>fetch(p,c),parseXML:p=>new DOMParser().parseFromString(p,"text/xml")},RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var At=/iPhone/i,ot=/iPod/i,qt=/iPad/i,ve=/\biOS-universal(?:.+)Mac\b/i,_e=/\bAndroid(?:.+)Mobile\b/i,ye=/Android/i,zt=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,z=/Silk/i,st=/Windows Phone/i,rt=/\bWindows(?:.+)ARM\b/i,Pt=/BlackBerry/i,St=/BB10/i,ut=/Opera Mini/i,bt=/\b(CriOS|Chrome)(?:.+)Mobile/i,Nt=/Mobile(?:.+)Firefox\b/i,Vt=function(p){return typeof p!="undefined"&&p.platform==="MacIntel"&&typeof p.maxTouchPoints=="number"&&p.maxTouchPoints>1&&typeof MSStream=="undefined"};function Bt(p){return function(c){return c.test(p)}}function Ht(p){var c={userAgent:"",platform:"",maxTouchPoints:0};!p&&typeof navigator!="undefined"?c={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof p=="string"?c.userAgent=p:p&&p.userAgent&&(c={userAgent:p.userAgent,platform:p.platform,maxTouchPoints:p.maxTouchPoints||0});var f=c.userAgent,v=f.split("[FBAN");typeof v[1]!="undefined"&&(f=v[0]),v=f.split("Twitter"),typeof v[1]!="undefined"&&(f=v[0]);var _=Bt(f),A={apple:{phone:_(At)&&!_(st),ipod:_(ot),tablet:!_(At)&&(_(qt)||Vt(c))&&!_(st),universal:_(ve),device:(_(At)||_(ot)||_(qt)||_(ve)||Vt(c))&&!_(st)},amazon:{phone:_(zt),tablet:!_(zt)&&_(z),device:_(zt)||_(z)},android:{phone:!_(st)&&_(zt)||!_(st)&&_(_e),tablet:!_(st)&&!_(zt)&&!_(_e)&&(_(z)||_(ye)),device:!_(st)&&(_(zt)||_(z)||_(_e)||_(ye))||_(/\bokhttp\b/i)},windows:{phone:_(st),tablet:_(rt),device:_(st)||_(rt)},other:{blackberry:_(Pt),blackberry10:_(St),opera:_(ut),firefox:_(Nt),chrome:_(bt),device:_(Pt)||_(St)||_(ut)||_(Nt)||_(bt)},any:!1,phone:!1,tablet:!1};return A.any=A.apple.device||A.android.device||A.windows.device||A.other.device,A.phone=A.apple.phone||A.android.phone||A.windows.phone,A.tablet=A.apple.tablet||A.android.tablet||A.windows.tablet,A}const Qt=(xi=Ht.default)!=null?xi:Ht,ee=Qt(globalThis.navigator);q.RETINA_PREFIX=/@([0-9\.]+)x/,q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var le=dt(729),he=dt(187),Xe=dt(575);const Ee={};function te(p,c,f=3){if(Ee[c])return;let v=new Error().stack;typeof v>"u"?console.warn("PixiJS Deprecation Warning: ",`${c}
Deprecated since v${p}`):(v=v.split(`
`).splice(f).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${c}
Deprecated since v${p}`),console.warn(v),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${c}
Deprecated since v${p}`),console.warn(v))),Ee[c]=!0}const We={get parse(){return te("7.3.0","utils.url.parse is deprecated, use native URL API instead."),Xe.Qc},get format(){return te("7.3.0","utils.url.format is deprecated, use native URL API instead."),Xe.WU},get resolve(){return te("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),Xe.DB}};function ue(p){if(typeof p!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(p)}`)}function fe(p){return p.split("?")[0].split("#")[0]}function Se(p){return p.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Er(p,c,f){return p.replace(new RegExp(Se(c),"g"),f)}function vr(p,c){let f="",v=0,_=-1,A=0,R=-1;for(let U=0;U<=p.length;++U){if(U<p.length)R=p.charCodeAt(U);else{if(R===47)break;R=47}if(R===47){if(!(_===U-1||A===1))if(_!==U-1&&A===2){if(f.length<2||v!==2||f.charCodeAt(f.length-1)!==46||f.charCodeAt(f.length-2)!==46){if(f.length>2){const J=f.lastIndexOf("/");if(J!==f.length-1){J===-1?(f="",v=0):(f=f.slice(0,J),v=f.length-1-f.lastIndexOf("/")),_=U,A=0;continue}}else if(f.length===2||f.length===1){f="",v=0,_=U,A=0;continue}}c&&(f.length>0?f+="/..":f="..",v=2)}else f.length>0?f+=`/${p.slice(_+1,U)}`:f=p.slice(_+1,U),v=U-_-1;_=U,A=0}else R===46&&A!==-1?++A:A=-1}return f}const Tr={toPosix(p){return Er(p,"\\","/")},isUrl(p){return/^https?:/.test(this.toPosix(p))},isDataUrl(p){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(p)},isBlobUrl(p){return p.startsWith("blob:")},hasProtocol(p){return/^[^/:]+:/.test(this.toPosix(p))},getProtocol(p){ue(p),p=this.toPosix(p);const c=/^file:\/\/\//.exec(p);if(c)return c[0];const f=/^[^/:]+:\/{0,2}/.exec(p);return f?f[0]:""},toAbsolute(p,c,f){if(ue(p),this.isDataUrl(p)||this.isBlobUrl(p))return p;const v=fe(this.toPosix(c!=null?c:q.ADAPTER.getBaseUrl())),_=fe(this.toPosix(f!=null?f:this.rootname(v)));return p=this.toPosix(p),p.startsWith("/")?Tr.join(_,p.slice(1)):this.isAbsolute(p)?p:this.join(v,p)},normalize(p){if(ue(p),p.length===0)return".";if(this.isDataUrl(p)||this.isBlobUrl(p))return p;p=this.toPosix(p);let c="";const f=p.startsWith("/");this.hasProtocol(p)&&(c=this.rootname(p),p=p.slice(c.length));const v=p.endsWith("/");return p=vr(p,!1),p.length>0&&v&&(p+="/"),f?`/${p}`:c+p},isAbsolute(p){return ue(p),p=this.toPosix(p),this.hasProtocol(p)?!0:p.startsWith("/")},join(...p){var f;if(p.length===0)return".";let c;for(let v=0;v<p.length;++v){const _=p[v];if(ue(_),_.length>0)if(c===void 0)c=_;else{const A=(f=p[v-1])!=null?f:"";this.extname(A)?c+=`/../${_}`:c+=`/${_}`}}return c===void 0?".":this.normalize(c)},dirname(p){if(ue(p),p.length===0)return".";p=this.toPosix(p);let c=p.charCodeAt(0);const f=c===47;let v=-1,_=!0;const A=this.getProtocol(p),R=p;p=p.slice(A.length);for(let U=p.length-1;U>=1;--U)if(c=p.charCodeAt(U),c===47){if(!_){v=U;break}}else _=!1;return v===-1?f?"/":this.isUrl(R)?A+p:A:f&&v===1?"//":A+p.slice(0,v)},rootname(p){ue(p),p=this.toPosix(p);let c="";if(p.startsWith("/")?c="/":c=this.getProtocol(p),this.isUrl(p)){const f=p.indexOf("/",c.length);f!==-1?c=p.slice(0,f):c=p,c.endsWith("/")||(c+="/")}return c},basename(p,c){ue(p),c&&ue(c),p=fe(this.toPosix(p));let f=0,v=-1,_=!0,A;if(c!==void 0&&c.length>0&&c.length<=p.length){if(c.length===p.length&&c===p)return"";let R=c.length-1,U=-1;for(A=p.length-1;A>=0;--A){const J=p.charCodeAt(A);if(J===47){if(!_){f=A+1;break}}else U===-1&&(_=!1,U=A+1),R>=0&&(J===c.charCodeAt(R)?--R===-1&&(v=A):(R=-1,v=U))}return f===v?v=U:v===-1&&(v=p.length),p.slice(f,v)}for(A=p.length-1;A>=0;--A)if(p.charCodeAt(A)===47){if(!_){f=A+1;break}}else v===-1&&(_=!1,v=A+1);return v===-1?"":p.slice(f,v)},extname(p){ue(p),p=fe(this.toPosix(p));let c=-1,f=0,v=-1,_=!0,A=0;for(let R=p.length-1;R>=0;--R){const U=p.charCodeAt(R);if(U===47){if(!_){f=R+1;break}continue}v===-1&&(_=!1,v=R+1),U===46?c===-1?c=R:A!==1&&(A=1):c!==-1&&(A=-1)}return c===-1||v===-1||A===0||A===1&&c===v-1&&c===f+1?"":p.slice(c,v)},parse(p){ue(p);const c={root:"",dir:"",base:"",ext:"",name:""};if(p.length===0)return c;p=fe(this.toPosix(p));let f=p.charCodeAt(0);const v=this.isAbsolute(p);let _;const A="";c.root=this.rootname(p),v||this.hasProtocol(p)?_=1:_=0;let R=-1,U=0,J=-1,gt=!0,Ot=p.length-1,Xt=0;for(;Ot>=_;--Ot){if(f=p.charCodeAt(Ot),f===47){if(!gt){U=Ot+1;break}continue}J===-1&&(gt=!1,J=Ot+1),f===46?R===-1?R=Ot:Xt!==1&&(Xt=1):R!==-1&&(Xt=-1)}return R===-1||J===-1||Xt===0||Xt===1&&R===J-1&&R===U+1?J!==-1&&(U===0&&v?c.base=c.name=p.slice(1,J):c.base=c.name=p.slice(U,J)):(U===0&&v?(c.name=p.slice(1,R),c.base=p.slice(1,J)):(c.name=p.slice(U,R),c.base=p.slice(U,J)),c.ext=p.slice(R,J)),c.dir=this.dirname(p),A&&(c.dir=A+c.dir),c},sep:"/",delimiter:":"};let wr;function jr(){return ce(this,null,function*(){return wr!=null||(wr=(()=>ce(this,null,function*(){var A;const p=document.createElement("canvas").getContext("webgl");if(!p)return Z.UNPACK;const c=yield new Promise(R=>{const U=document.createElement("video");U.onloadeddata=()=>R(U),U.onerror=()=>R(null),U.autoplay=!1,U.crossOrigin="anonymous",U.preload="auto",U.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",U.load()});if(!c)return Z.UNPACK;const f=p.createTexture();p.bindTexture(p.TEXTURE_2D,f);const v=p.createFramebuffer();p.bindFramebuffer(p.FRAMEBUFFER,v),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,f,0),p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),p.pixelStorei(p.UNPACK_COLORSPACE_CONVERSION_WEBGL,p.NONE),p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,c);const _=new Uint8Array(4);return p.readPixels(0,0,1,1,p.RGBA,p.UNSIGNED_BYTE,_),p.deleteFramebuffer(v),p.deleteTexture(f),(A=p.getExtension("WEBGL_lose_context"))==null||A.loseContext(),_[0]<=_[3]?Z.PMA:Z.UNPACK}))()),wr})}function Lr(){te("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function Ar(){te("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}let sr;function Wr(){return typeof sr>"u"&&(sr=function(){var c;const p={stencil:!0,failIfMajorPerformanceCaveat:q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!q.ADAPTER.getWebGLRenderingContext())return!1;const f=q.ADAPTER.createCanvas();let v=f.getContext("webgl",p)||f.getContext("experimental-webgl",p);const _=!!((c=v==null?void 0:v.getContextAttributes())!=null&&c.stencil);if(v){const A=v.getExtension("WEBGL_lose_context");A&&A.loseContext()}return v=null,_}catch(f){return!1}}()),sr}var xr={grad:.9,turn:360,rad:360/(2*Math.PI)},Je=function(p){return typeof p=="string"?p.length>0:typeof p=="number"},N=function(p,c,f){return c===void 0&&(c=0),f===void 0&&(f=Math.pow(10,c)),Math.round(f*p)/f+0},k=function(p,c,f){return c===void 0&&(c=0),f===void 0&&(f=1),p>f?f:p>c?p:c},x=function(p){return(p=isFinite(p)?p%360:0)>0?p:p+360},w=function(p){return{r:k(p.r,0,255),g:k(p.g,0,255),b:k(p.b,0,255),a:k(p.a)}},O=function(p){return{r:N(p.r),g:N(p.g),b:N(p.b),a:N(p.a,3)}},H=/^#([0-9a-f]{3,8})$/i,V=function(p){var c=p.toString(16);return c.length<2?"0"+c:c},Q=function(p){var c=p.r,f=p.g,v=p.b,_=p.a,A=Math.max(c,f,v),R=A-Math.min(c,f,v),U=R?A===c?(f-v)/R:A===f?2+(v-c)/R:4+(c-f)/R:0;return{h:60*(U<0?U+6:U),s:A?R/A*100:0,v:A/255*100,a:_}},Gt=function(p){var c=p.h,f=p.s,v=p.v,_=p.a;c=c/360*6,f/=100,v/=100;var A=Math.floor(c),R=v*(1-f),U=v*(1-(c-A)*f),J=v*(1-(1-c+A)*f),gt=A%6;return{r:255*[v,U,R,R,J,v][gt],g:255*[J,v,v,U,R,R][gt],b:255*[R,R,J,v,v,U][gt],a:_}},$t=function(p){return{h:x(p.h),s:k(p.s,0,100),l:k(p.l,0,100),a:k(p.a)}},Zt=function(p){return{h:N(p.h),s:N(p.s),l:N(p.l),a:N(p.a,3)}},se=function(p){return Gt((f=(c=p).s,{h:c.h,s:(f*=((v=c.l)<50?v:100-v)/100)>0?2*f/(v+f)*100:0,v:v+f,a:c.a}));var c,f,v},Ae=function(p){return{h:(c=Q(p)).h,s:(_=(200-(f=c.s))*(v=c.v)/100)>0&&_<200?f*v/100/(_<=100?_:200-_)*100:0,l:_/2,a:c.a};var c,f,v,_},Be=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ue=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,dr=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ie=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ne={string:[[function(p){var c=H.exec(p);return c?(p=c[1]).length<=4?{r:parseInt(p[0]+p[0],16),g:parseInt(p[1]+p[1],16),b:parseInt(p[2]+p[2],16),a:p.length===4?N(parseInt(p[3]+p[3],16)/255,2):1}:p.length===6||p.length===8?{r:parseInt(p.substr(0,2),16),g:parseInt(p.substr(2,2),16),b:parseInt(p.substr(4,2),16),a:p.length===8?N(parseInt(p.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(p){var c=dr.exec(p)||Ie.exec(p);return c?c[2]!==c[4]||c[4]!==c[6]?null:w({r:Number(c[1])/(c[2]?100/255:1),g:Number(c[3])/(c[4]?100/255:1),b:Number(c[5])/(c[6]?100/255:1),a:c[7]===void 0?1:Number(c[7])/(c[8]?100:1)}):null},"rgb"],[function(p){var c=Be.exec(p)||Ue.exec(p);if(!c)return null;var f,v,_=$t({h:(f=c[1],v=c[2],v===void 0&&(v="deg"),Number(f)*(xr[v]||1)),s:Number(c[3]),l:Number(c[4]),a:c[5]===void 0?1:Number(c[5])/(c[6]?100:1)});return se(_)},"hsl"]],object:[[function(p){var c=p.r,f=p.g,v=p.b,_=p.a,A=_===void 0?1:_;return Je(c)&&Je(f)&&Je(v)?w({r:Number(c),g:Number(f),b:Number(v),a:Number(A)}):null},"rgb"],[function(p){var c=p.h,f=p.s,v=p.l,_=p.a,A=_===void 0?1:_;if(!Je(c)||!Je(f)||!Je(v))return null;var R=$t({h:Number(c),s:Number(f),l:Number(v),a:Number(A)});return se(R)},"hsl"],[function(p){var c=p.h,f=p.s,v=p.v,_=p.a,A=_===void 0?1:_;if(!Je(c)||!Je(f)||!Je(v))return null;var R=function(U){return{h:x(U.h),s:k(U.s,0,100),v:k(U.v,0,100),a:k(U.a)}}({h:Number(c),s:Number(f),v:Number(v),a:Number(A)});return Gt(R)},"hsv"]]},Ge=function(p,c){for(var f=0;f<c.length;f++){var v=c[f][0](p);if(v)return[v,c[f][1]]}return[null,void 0]},yr=function(p){return typeof p=="string"?Ge(p.trim(),Ne.string):typeof p=="object"&&p!==null?Ge(p,Ne.object):[null,void 0]},Mr=function(p){return yr(p)[1]},Ti=function(p,c){var f=Ae(p);return{h:f.h,s:k(f.s+100*c,0,100),l:f.l,a:f.a}},Ir=function(p){return(299*p.r+587*p.g+114*p.b)/1e3/255},ci=function(p,c){var f=Ae(p);return{h:f.h,s:f.s,l:k(f.l+100*c,0,100),a:f.a}},Dr=function(){function p(c){this.parsed=yr(c)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return p.prototype.isValid=function(){return this.parsed!==null},p.prototype.brightness=function(){return N(Ir(this.rgba),2)},p.prototype.isDark=function(){return Ir(this.rgba)<.5},p.prototype.isLight=function(){return Ir(this.rgba)>=.5},p.prototype.toHex=function(){return c=O(this.rgba),f=c.r,v=c.g,_=c.b,R=(A=c.a)<1?V(N(255*A)):"","#"+V(f)+V(v)+V(_)+R;var c,f,v,_,A,R},p.prototype.toRgb=function(){return O(this.rgba)},p.prototype.toRgbString=function(){return c=O(this.rgba),f=c.r,v=c.g,_=c.b,(A=c.a)<1?"rgba("+f+", "+v+", "+_+", "+A+")":"rgb("+f+", "+v+", "+_+")";var c,f,v,_,A},p.prototype.toHsl=function(){return Zt(Ae(this.rgba))},p.prototype.toHslString=function(){return c=Zt(Ae(this.rgba)),f=c.h,v=c.s,_=c.l,(A=c.a)<1?"hsla("+f+", "+v+"%, "+_+"%, "+A+")":"hsl("+f+", "+v+"%, "+_+"%)";var c,f,v,_,A},p.prototype.toHsv=function(){return c=Q(this.rgba),{h:N(c.h),s:N(c.s),v:N(c.v),a:N(c.a,3)};var c},p.prototype.invert=function(){return nr({r:255-(c=this.rgba).r,g:255-c.g,b:255-c.b,a:c.a});var c},p.prototype.saturate=function(c){return c===void 0&&(c=.1),nr(Ti(this.rgba,c))},p.prototype.desaturate=function(c){return c===void 0&&(c=.1),nr(Ti(this.rgba,-c))},p.prototype.grayscale=function(){return nr(Ti(this.rgba,-1))},p.prototype.lighten=function(c){return c===void 0&&(c=.1),nr(ci(this.rgba,c))},p.prototype.darken=function(c){return c===void 0&&(c=.1),nr(ci(this.rgba,-c))},p.prototype.rotate=function(c){return c===void 0&&(c=15),this.hue(this.hue()+c)},p.prototype.alpha=function(c){return typeof c=="number"?nr({r:(f=this.rgba).r,g:f.g,b:f.b,a:c}):N(this.rgba.a,3);var f},p.prototype.hue=function(c){var f=Ae(this.rgba);return typeof c=="number"?nr({h:c,s:f.s,l:f.l,a:f.a}):N(f.h)},p.prototype.isEqual=function(c){return this.toHex()===nr(c).toHex()},p}(),nr=function(p){return p instanceof Dr?p:new Dr(p)},di=[],Bi=function(p){p.forEach(function(c){di.indexOf(c)<0&&(c(Dr,Ne),di.push(c))})},Oi=function(){return new Dr({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})};function kr(p,c){var f={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},v={};for(var _ in f)v[f[_]]=_;var A={};p.prototype.toName=function(R){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var U,J,gt=v[this.toHex()];if(gt)return gt;if(R!=null&&R.closest){var Ot=this.toRgb(),Xt=1/0,re="black";if(!A.length)for(var Re in f)A[Re]=new p(f[Re]).toRgb();for(var Ze in f){var De=(U=Ot,J=A[Ze],Math.pow(U.r-J.r,2)+Math.pow(U.g-J.g,2)+Math.pow(U.b-J.b,2));De<Xt&&(Xt=De,re=Ze)}return re}},c.string.push([function(R){var U=R.toLowerCase(),J=U==="transparent"?"#0000":f[U];return J?new p(J).toRgb():null},"name"])}Bi([kr]);const Rr=class uo{constructor(c=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=c}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(c){return this.value=c,this}set value(c){if(c instanceof uo)this._value=this.cloneSource(c._value),this._int=c._int,this._components.set(c._components);else{if(c===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,c))&&(this.normalize(c),this._value=this.cloneSource(c))}}get value(){return this._value}cloneSource(c){return typeof c=="string"||typeof c=="number"||c instanceof Number||c===null?c:Array.isArray(c)||ArrayBuffer.isView(c)?c.slice(0):typeof c=="object"&&c!==null?Qe({},c):c}isSourceEqual(c,f){const v=typeof c;if(v!==typeof f)return!1;if(v==="number"||v==="string"||c instanceof Number)return c===f;if(Array.isArray(c)&&Array.isArray(f)||ArrayBuffer.isView(c)&&ArrayBuffer.isView(f))return c.length!==f.length?!1:c.every((_,A)=>_===f[A]);if(c!==null&&f!==null){const _=Object.keys(c),A=Object.keys(f);return _.length!==A.length?!1:_.every(R=>c[R]===f[R])}return c===f}toRgba(){const[c,f,v,_]=this._components;return{r:c,g:f,b:v,a:_}}toRgb(){const[c,f,v]=this._components;return{r:c,g:f,b:v}}toRgbaString(){const[c,f,v]=this.toUint8RgbArray();return`rgba(${c},${f},${v},${this.alpha})`}toUint8RgbArray(c){const[f,v,_]=this._components;return c=c!=null?c:[],c[0]=Math.round(f*255),c[1]=Math.round(v*255),c[2]=Math.round(_*255),c}toRgbArray(c){c=c!=null?c:[];const[f,v,_]=this._components;return c[0]=f,c[1]=v,c[2]=_,c}toNumber(){return this._int}toLittleEndianNumber(){const c=this._int;return(c>>16)+(c&65280)+((c&255)<<16)}multiply(c){const[f,v,_,A]=uo.temp.setValue(c)._components;return this._components[0]*=f,this._components[1]*=v,this._components[2]*=_,this._components[3]*=A,this.refreshInt(),this._value=null,this}premultiply(c,f=!0){return f&&(this._components[0]*=c,this._components[1]*=c,this._components[2]*=c),this._components[3]=c,this.refreshInt(),this._value=null,this}toPremultiplied(c,f=!0){if(c===1)return(255<<24)+this._int;if(c===0)return f?0:this._int;let v=this._int>>16&255,_=this._int>>8&255,A=this._int&255;return f&&(v=v*c+.5|0,_=_*c+.5|0,A=A*c+.5|0),(c*255<<24)+(v<<16)+(_<<8)+A}toHex(){const c=this._int.toString(16);return`#${"000000".substring(0,6-c.length)+c}`}toHexa(){const c=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-c.length)+c}setAlpha(c){return this._components[3]=this._clamp(c),this}round(c){const[f,v,_]=this._components;return this._components[0]=Math.round(f*c)/c,this._components[1]=Math.round(v*c)/c,this._components[2]=Math.round(_*c)/c,this.refreshInt(),this._value=null,this}toArray(c){c=c!=null?c:[];const[f,v,_,A]=this._components;return c[0]=f,c[1]=v,c[2]=_,c[3]=A,c}normalize(c){let f,v,_,A;if((typeof c=="number"||c instanceof Number)&&c>=0&&c<=16777215){const R=c;f=(R>>16&255)/255,v=(R>>8&255)/255,_=(R&255)/255,A=1}else if((Array.isArray(c)||c instanceof Float32Array)&&c.length>=3&&c.length<=4)c=this._clamp(c),[f,v,_,A=1]=c;else if((c instanceof Uint8Array||c instanceof Uint8ClampedArray)&&c.length>=3&&c.length<=4)c=this._clamp(c,0,255),[f,v,_,A=255]=c,f/=255,v/=255,_/=255,A/=255;else if(typeof c=="string"||typeof c=="object"){if(typeof c=="string"){const U=uo.HEX_PATTERN.exec(c);U&&(c=`#${U[2]}`)}const R=nr(c);R.isValid()&&({r:f,g:v,b:_,a:A}=R.rgba,f/=255,v/=255,_/=255)}if(f!==void 0)this._components[0]=f,this._components[1]=v,this._components[2]=_,this._components[3]=A,this.refreshInt();else throw new Error(`Unable to convert color ${c}`)}refreshInt(){this._clamp(this._components);const[c,f,v]=this._components;this._int=(c*255<<16)+(f*255<<8)+(v*255|0)}_clamp(c,f=0,v=1){return typeof c=="number"?Math.min(Math.max(c,f),v):(c.forEach((_,A)=>{c[A]=Math.min(Math.max(_,f),v)}),c)}};Rr.shared=new Rr,Rr.temp=new Rr,Rr.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let gr=Rr;function Li(p,c=[]){return te("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),gr.shared.setValue(p).toRgbArray(c)}function Ji(p){return te("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),gr.shared.setValue(p).toHex()}function ki(p){return te("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),gr.shared.setValue(p).toNumber()}function $r(p){return te("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),gr.shared.setValue(p).toNumber()}function Jr(){const p=[],c=[];for(let v=0;v<32;v++)p[v]=v,c[v]=v;p[vt.NORMAL_NPM]=vt.NORMAL,p[vt.ADD_NPM]=vt.ADD,p[vt.SCREEN_NPM]=vt.SCREEN,c[vt.NORMAL]=vt.NORMAL_NPM,c[vt.ADD]=vt.ADD_NPM,c[vt.SCREEN]=vt.SCREEN_NPM;const f=[];return f.push(c),f.push(p),f}const ti=Jr();function Ur(p,c){return ti[c?1:0][p]}function Qs(p,c,f,v=!0){return te("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),gr.shared.setValue(p).premultiply(c,v).toArray(f!=null?f:new Float32Array(4))}function Ui(p,c){return te("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),gr.shared.setValue(p).toPremultiplied(c)}function bs(p,c,f,v=!0){return te("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),gr.shared.setValue(p).premultiply(c,v).toArray(f!=null?f:new Float32Array(4))}const Gi=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Js(p,c=null){const f=p*6;if(c=c||new Uint16Array(f),c.length!==f)throw new Error(`Out buffer length is incorrect, got ${c.length} and expected ${f}`);for(let v=0,_=0;v<f;v+=6,_+=4)c[v+0]=_+0,c[v+1]=_+1,c[v+2]=_+2,c[v+3]=_+0,c[v+4]=_+2,c[v+5]=_+3;return c}function zi(p){if(p.BYTES_PER_ELEMENT===4)return p instanceof Float32Array?"Float32Array":p instanceof Uint32Array?"Uint32Array":"Int32Array";if(p.BYTES_PER_ELEMENT===2){if(p instanceof Uint16Array)return"Uint16Array"}else if(p.BYTES_PER_ELEMENT===1&&p instanceof Uint8Array)return"Uint8Array";return null}const Ts={Float32Array,Uint32Array,Int32Array,Uint8Array};function ws(p,c){let f=0,v=0;const _={};for(let J=0;J<p.length;J++)v+=c[J],f+=p[J].length;const A=new ArrayBuffer(f*4);let R=null,U=0;for(let J=0;J<p.length;J++){const gt=c[J],Ot=p[J],Xt=zi(Ot);_[Xt]||(_[Xt]=new Ts[Xt](A)),R=_[Xt];for(let re=0;re<Ot.length;re++){const Re=(re/gt|0)*v+U,Ze=re%gt;R[Re+Ze]=Ot[re]}U+=gt}return new Float32Array(A)}function wi(p){return p+=p===0?1:0,--p,p|=p>>>1,p|=p>>>2,p|=p>>>4,p|=p>>>8,p|=p>>>16,p+1}function Ai(p){return!(p&p-1)&&!!p}function ts(p){let c=(p>65535?1:0)<<4;p>>>=c;let f=(p>255?1:0)<<3;return p>>>=f,c|=f,f=(p>15?1:0)<<2,p>>>=f,c|=f,f=(p>3?1:0)<<1,p>>>=f,c|=f,c|p>>1}function tn(p,c,f){const v=p.length;let _;if(c>=v||f===0)return;f=c+f>v?v-c:f;const A=v-f;for(_=c;_<A;++_)p[_]=p[_+f];p.length=A}function en(p){return p===0?0:p<0?-1:1}let rn=0;function Gr(){return++rn}const _r=class{constructor(p,c,f,v){this.left=p,this.top=c,this.right=f,this.bottom=v}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};_r.EMPTY=new _r(0,0,0,0);let fi=_r;const Fr={},or=Object.create(null),br=Object.create(null);function sn(){let p;for(p in or)or[p].destroy();for(p in br)br[p].destroy()}function On(){let p;for(p in or)delete or[p];for(p in br)delete br[p]}class ei{constructor(c,f,v){this._canvas=q.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=v||q.RESOLUTION,this.resize(c,f)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(c,f){this._checkDestroyed(),this._canvas.width=Math.round(c*this.resolution),this._canvas.height=Math.round(f*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(c){this._checkDestroyed(),this._canvas.width=Math.round(c)}get height(){return this._checkDestroyed(),this._canvas.height}set height(c){this._checkDestroyed(),this._canvas.height=Math.round(c)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Vi(p,c,f){for(let v=0,_=4*f*c;v<c;++v,_+=4)if(p[_+3]!==0)return!1;return!0}function pi(p,c,f,v,_){const A=4*c;for(let R=v,U=v*A+4*f;R<=_;++R,U+=A)if(p[U+3]!==0)return!1;return!0}function As(p){const{width:c,height:f}=p,v=p.getContext("2d",{willReadFrequently:!0});if(v===null)throw new TypeError("Failed to get canvas 2D context");const _=v.getImageData(0,0,c,f).data;let A=0,R=0,U=c-1,J=f-1;for(;R<f&&Vi(_,c,R);)++R;if(R===f)return fi.EMPTY;for(;Vi(_,c,J);)--J;for(;pi(_,c,A,R,J);)++A;for(;pi(_,c,U,R,J);)--U;return++U,++J,new fi(A,R,U,J)}function Es(p){const c=As(p),{width:f,height:v}=c;let _=null;if(!c.isEmpty()){const A=p.getContext("2d");if(A===null)throw new TypeError("Failed to get canvas 2D context");_=A.getImageData(c.left,c.top,f,v)}return{width:f,height:v,data:_}}function nn(p){const c=Gi.exec(p);if(c)return{mediaType:c[1]?c[1].toLowerCase():void 0,subType:c[2]?c[2].toLowerCase():void 0,charset:c[3]?c[3].toLowerCase():void 0,encoding:c[4]?c[4].toLowerCase():void 0,data:c[5]}}function Yr(p,c=globalThis.location){if(p.startsWith("data:"))return"";c=c||globalThis.location;const f=new URL(p,document.baseURI);return f.hostname!==c.hostname||f.port!==c.port||f.protocol!==c.protocol?"anonymous":""}function Hi(p,c=1){var v;const f=(v=q.RETINA_PREFIX)==null?void 0:v.exec(p);return f?parseFloat(f[1]):c}var Fe=(p=>(p.Renderer="renderer",p.Application="application",p.RendererSystem="renderer-webgl-system",p.RendererPlugin="renderer-webgl-plugin",p.CanvasRendererSystem="renderer-canvas-system",p.CanvasRendererPlugin="renderer-canvas-plugin",p.Asset="asset",p.LoadParser="load-parser",p.ResolveParser="resolve-parser",p.CacheParser="cache-parser",p.DetectionParser="detection-parser",p))(Fe||{});const es=p=>{if(typeof p=="function"||typeof p=="object"&&p.extension){if(!p.extension)throw new Error("Extension class must have an extension object");p=Ni(Qe({},typeof p.extension!="object"?{type:p.extension}:p.extension),{ref:p})}if(typeof p=="object")p=Qe({},p);else throw new Error("Invalid extension type");return typeof p.type=="string"&&(p.type=[p.type]),p},on=(p,c)=>{var f;return(f=es(p).priority)!=null?f:c},ze={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...p){return p.map(es).forEach(c=>{c.type.forEach(f=>{var v,_;return(_=(v=this._removeHandlers)[f])==null?void 0:_.call(v,c)})}),this},add(...p){return p.map(es).forEach(c=>{c.type.forEach(f=>{const v=this._addHandlers,_=this._queue;v[f]?v[f](c):(_[f]=_[f]||[],_[f].push(c))})}),this},handle(p,c,f){const v=this._addHandlers,_=this._removeHandlers;if(v[p]||_[p])throw new Error(`Extension type ${p} already has a handler`);v[p]=c,_[p]=f;const A=this._queue;return A[p]&&(A[p].forEach(R=>c(R)),delete A[p]),this},handleByMap(p,c){return this.handle(p,f=>{c[f.name]=f.ref},f=>{delete c[f.name]})},handleByList(p,c,f=-1){return this.handle(p,v=>{c.includes(v.ref)||(c.push(v.ref),c.sort((_,A)=>on(A,f)-on(_,f)))},v=>{const _=c.indexOf(v.ref);_!==-1&&c.splice(_,1)})}};class Ss{constructor(c){typeof c=="number"?this.rawBinaryData=new ArrayBuffer(c):c instanceof Uint8Array?this.rawBinaryData=c.buffer:this.rawBinaryData=c,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(c){return this[`${c}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(c){switch(c){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${c} isn't a valid view type`)}}}const Ln=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function an(p){let c="";for(let f=0;f<p;++f)f>0&&(c+=`
else `),f<p-1&&(c+=`if(test == ${f}.0){}`);return c}function ln(p,c){if(p===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const f=c.createShader(c.FRAGMENT_SHADER);for(;;){const v=Ln.replace(/%forloop%/gi,an(p));if(c.shaderSource(f,v),c.compileShader(f),!c.getShaderParameter(f,c.COMPILE_STATUS))p=p/2|0;else break}return p}const Xi=0,rs=1,is=2,ss=3,Cs=4,ns=5;class ri{constructor(){this.data=0,this.blendMode=vt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Xi)}set blend(c){!!(this.data&1<<Xi)!==c&&(this.data^=1<<Xi)}get offsets(){return!!(this.data&1<<rs)}set offsets(c){!!(this.data&1<<rs)!==c&&(this.data^=1<<rs)}get culling(){return!!(this.data&1<<is)}set culling(c){!!(this.data&1<<is)!==c&&(this.data^=1<<is)}get depthTest(){return!!(this.data&1<<ss)}set depthTest(c){!!(this.data&1<<ss)!==c&&(this.data^=1<<ss)}get depthMask(){return!!(this.data&1<<ns)}set depthMask(c){!!(this.data&1<<ns)!==c&&(this.data^=1<<ns)}get clockwiseFrontFace(){return!!(this.data&1<<Cs)}set clockwiseFrontFace(c){!!(this.data&1<<Cs)!==c&&(this.data^=1<<Cs)}get blendMode(){return this._blendMode}set blendMode(c){this.blend=c!==vt.NONE,this._blendMode=c}get polygonOffset(){return this._polygonOffset}set polygonOffset(c){this.offsets=!!c,this._polygonOffset=c}static for2d(){const c=new ri;return c.depthTest=!1,c.blend=!0,c}}ri.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Ei=[];function Ps(p,c){if(!p)return null;let f="";if(typeof p=="string"){const v=/\.(\w{3,4})(?:$|\?|#)/i.exec(p);v&&(f=v[1].toLowerCase())}for(let v=Ei.length-1;v>=0;--v){const _=Ei[v];if(_.test&&_.test(p,f))return new _(p,c)}throw new Error("Unrecognized source type to auto-detect Resource")}class er{constructor(c){this.items=[],this._name=c,this._aliasCount=0}emit(c,f,v,_,A,R,U,J){if(arguments.length>8)throw new Error("max arguments reached");const{name:gt,items:Ot}=this;this._aliasCount++;for(let Xt=0,re=Ot.length;Xt<re;Xt++)Ot[Xt][gt](c,f,v,_,A,R,U,J);return Ot===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(c){return c[this._name]&&(this.ensureNonAliasedItems(),this.remove(c),this.items.push(c)),this}remove(c){const f=this.items.indexOf(c);return f!==-1&&(this.ensureNonAliasedItems(),this.items.splice(f,1)),this}contains(c){return this.items.includes(c)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(er.prototype,{dispatch:{value:er.prototype.emit},run:{value:er.prototype.emit}});class ii{constructor(c=0,f=0){this._width=c,this._height=f,this.destroyed=!1,this.internal=!1,this.onResize=new er("setRealSize"),this.onUpdate=new er("update"),this.onError=new er("onError")}bind(c){this.onResize.add(c),this.onUpdate.add(c),this.onError.add(c),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(c){this.onResize.remove(c),this.onUpdate.remove(c),this.onError.remove(c)}resize(c,f){(c!==this._width||f!==this._height)&&(this._width=c,this._height=f,this.onResize.emit(c,f))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(c,f,v){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(c,f){return!1}}class os extends ii{constructor(c,f){var A;const{width:v,height:_}=f||{};if(!v||!_)throw new Error("BufferResource width or height invalid");super(v,_),this.data=c,this.unpackAlignment=(A=f.unpackAlignment)!=null?A:4}upload(c,f,v){const _=c.gl;_.pixelStorei(_.UNPACK_ALIGNMENT,this.unpackAlignment),_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.alphaMode===Z.UNPACK);const A=f.realWidth,R=f.realHeight;return v.width===A&&v.height===R?_.texSubImage2D(f.target,0,0,0,A,R,f.format,v.type,this.data):(v.width=A,v.height=R,_.texImage2D(f.target,0,v.internalFormat,A,R,0,f.format,v.type,this.data)),!0}dispose(){this.data=null}static test(c){return c===null||c instanceof Int8Array||c instanceof Uint8Array||c instanceof Uint8ClampedArray||c instanceof Int16Array||c instanceof Uint16Array||c instanceof Int32Array||c instanceof Uint32Array||c instanceof Float32Array}}const hn={scaleMode:$.NEAREST,alphaMode:Z.NPM},as=class Ys extends le{constructor(c=null,f=null){super(),f=Object.assign({},Ys.defaultOptions,f);const{alphaMode:v,mipmap:_,anisotropicLevel:A,scaleMode:R,width:U,height:J,wrapMode:gt,format:Ot,type:Xt,target:re,resolution:Re,resourceOptions:Ze}=f;c&&!(c instanceof ii)&&(c=Ps(c,Ze),c.internal=!0),this.resolution=Re||q.RESOLUTION,this.width=Math.round((U||0)*this.resolution)/this.resolution,this.height=Math.round((J||0)*this.resolution)/this.resolution,this._mipmap=_,this.anisotropicLevel=A,this._wrapMode=gt,this._scaleMode=R,this.format=Ot,this.type=Xt,this.target=re,this.alphaMode=v,this.uid=Gr(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=U>0&&J>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(c)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(c){this._mipmap!==c&&(this._mipmap=c,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(c){this._scaleMode!==c&&(this._scaleMode=c,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(c){this._wrapMode!==c&&(this._wrapMode=c,this.dirtyStyleId++)}setStyle(c,f){let v;return c!==void 0&&c!==this.scaleMode&&(this.scaleMode=c,v=!0),f!==void 0&&f!==this.mipmap&&(this.mipmap=f,v=!0),v&&this.dirtyStyleId++,this}setSize(c,f,v){return v=v||this.resolution,this.setRealSize(c*v,f*v,v)}setRealSize(c,f,v){return this.resolution=v||this.resolution,this.width=Math.round(c)/this.resolution,this.height=Math.round(f)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Ai(this.realWidth)&&Ai(this.realHeight)}setResolution(c){const f=this.resolution;return f===c?this:(this.resolution=c,this.valid&&(this.width=Math.round(this.width*f)/c,this.height=Math.round(this.height*f)/c,this.emit("update",this)),this._refreshPOT(),this)}setResource(c){if(this.resource===c)return this;if(this.resource)throw new Error("Resource can be set only once");return c.bind(this),this.resource=c,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(c){this.emit("error",this,c)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete br[this.cacheId],delete or[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Ys.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(c,f,v=q.STRICT_TEXTURE_CACHE){const _=typeof c=="string";let A=null;if(_)A=c;else{if(!c._pixiId){const U=(f==null?void 0:f.pixiIdPrefix)||"pixiid";c._pixiId=`${U}_${Gr()}`}A=c._pixiId}let R=br[A];if(_&&v&&!R)throw new Error(`The cacheId "${A}" does not exist in BaseTextureCache.`);return R||(R=new Ys(c,f),R.cacheId=A,Ys.addToCache(R,A)),R}static fromBuffer(c,f,v,_){c=c||new Float32Array(f*v*4);const A=new os(c,Qe({width:f,height:v},_==null?void 0:_.resourceOptions));let R,U;return c instanceof Float32Array?(R=nt.RGBA,U=at.FLOAT):c instanceof Int32Array?(R=nt.RGBA_INTEGER,U=at.INT):c instanceof Uint32Array?(R=nt.RGBA_INTEGER,U=at.UNSIGNED_INT):c instanceof Int16Array?(R=nt.RGBA_INTEGER,U=at.SHORT):c instanceof Uint16Array?(R=nt.RGBA_INTEGER,U=at.UNSIGNED_SHORT):c instanceof Int8Array?(R=nt.RGBA,U=at.BYTE):(R=nt.RGBA,U=at.UNSIGNED_BYTE),A.internal=!0,new Ys(A,Object.assign({},hn,{type:U,format:R},_))}static addToCache(c,f){f&&(c.textureCacheIds.includes(f)||c.textureCacheIds.push(f),br[f]&&br[f]!==c&&console.warn(`BaseTexture added to the cache with an id [${f}] that already had an entry`),br[f]=c)}static removeFromCache(c){if(typeof c=="string"){const f=br[c];if(f){const v=f.textureCacheIds.indexOf(c);return v>-1&&f.textureCacheIds.splice(v,1),delete br[c],f}}else if(c!=null&&c.textureCacheIds){for(let f=0;f<c.textureCacheIds.length;++f)delete br[c.textureCacheIds[f]];return c.textureCacheIds.length=0,c}return null}};as.defaultOptions={mipmap:it.POW2,anisotropicLevel:0,scaleMode:$.LINEAR,wrapMode:tt.CLAMP,alphaMode:Z.UNPACK,target:mt.TEXTURE_2D,format:nt.RGBA,type:at.UNSIGNED_BYTE},as._globalBatch=0;let Ve=as;class Ms{constructor(){this.texArray=null,this.blend=0,this.type=Ft.TRIANGLES,this.start=0,this.size=0,this.data=null}}let un=0;class fr{constructor(c,f=!0,v=!1){this.data=c||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=v,this.static=f,this.id=un++,this.disposeRunner=new er("disposeBuffer")}update(c){c instanceof Array&&(c=new Float32Array(c)),this.data=c||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(c){this.type=c?Et.ELEMENT_ARRAY_BUFFER:Et.ARRAY_BUFFER}get index(){return this.type===Et.ELEMENT_ARRAY_BUFFER}static from(c){return c instanceof Array&&(c=new Float32Array(c)),new fr(c)}}class ji{constructor(c,f=0,v=!1,_=at.FLOAT,A,R,U,J=1){this.buffer=c,this.size=f,this.normalized=v,this.type=_,this.stride=A,this.start=R,this.instance=U,this.divisor=J}destroy(){this.buffer=null}static from(c,f,v,_,A){return new ji(c,f,v,_,A)}}const cn={Float32Array,Uint32Array,Int32Array,Uint8Array};function dn(p,c){let f=0,v=0;const _={};for(let J=0;J<p.length;J++)v+=c[J],f+=p[J].length;const A=new ArrayBuffer(f*4);let R=null,U=0;for(let J=0;J<p.length;J++){const gt=c[J],Ot=p[J],Xt=zi(Ot);_[Xt]||(_[Xt]=new cn[Xt](A)),R=_[Xt];for(let re=0;re<Ot.length;re++){const Re=(re/gt|0)*v+U,Ze=re%gt;R[Re+Ze]=Ot[re]}U+=gt}return new Float32Array(A)}const mi={5126:4,5123:2,5121:1};let fn=0;const Is={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class si{constructor(c=[],f={}){this.buffers=c,this.indexBuffer=null,this.attributes=f,this.glVertexArrayObjects={},this.id=fn++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new er("disposeGeometry"),this.refCount=0}addAttribute(c,f,v=0,_=!1,A,R,U,J=!1){if(!f)throw new Error("You must pass a buffer when creating an attribute");f instanceof fr||(f instanceof Array&&(f=new Float32Array(f)),f=new fr(f));const gt=c.split("|");if(gt.length>1){for(let Xt=0;Xt<gt.length;Xt++)this.addAttribute(gt[Xt],f,v,_,A);return this}let Ot=this.buffers.indexOf(f);return Ot===-1&&(this.buffers.push(f),Ot=this.buffers.length-1),this.attributes[c]=new ji(Ot,v,_,A,R,U,J),this.instanced=this.instanced||J,this}getAttribute(c){return this.attributes[c]}getBuffer(c){return this.buffers[this.getAttribute(c).buffer]}addIndex(c){return c instanceof fr||(c instanceof Array&&(c=new Uint16Array(c)),c=new fr(c)),c.type=Et.ELEMENT_ARRAY_BUFFER,this.indexBuffer=c,this.buffers.includes(c)||this.buffers.push(c),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const c=[],f=[],v=new fr;let _;for(_ in this.attributes){const A=this.attributes[_],R=this.buffers[A.buffer];c.push(R.data),f.push(A.size*mi[A.type]/4),A.buffer=0}for(v.data=dn(c,f),_=0;_<this.buffers.length;_++)this.buffers[_]!==this.indexBuffer&&this.buffers[_].destroy();return this.buffers=[v],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const c in this.attributes){const f=this.attributes[c];return this.buffers[f.buffer].data.length/(f.stride/4||f.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const c=new si;for(let f=0;f<this.buffers.length;f++)c.buffers[f]=new fr(this.buffers[f].data.slice(0));for(const f in this.attributes){const v=this.attributes[f];c.attributes[f]=new ji(v.buffer,v.size,v.normalized,v.type,v.stride,v.start,v.instance)}return this.indexBuffer&&(c.indexBuffer=c.buffers[this.buffers.indexOf(this.indexBuffer)],c.indexBuffer.type=Et.ELEMENT_ARRAY_BUFFER),c}static merge(c){const f=new si,v=[],_=[],A=[];let R;for(let U=0;U<c.length;U++){R=c[U];for(let J=0;J<R.buffers.length;J++)_[J]=_[J]||0,_[J]+=R.buffers[J].data.length,A[J]=0}for(let U=0;U<R.buffers.length;U++)v[U]=new Is[zi(R.buffers[U].data)](_[U]),f.buffers[U]=new fr(v[U]);for(let U=0;U<c.length;U++){R=c[U];for(let J=0;J<R.buffers.length;J++)v[J].set(R.buffers[J].data,A[J]),A[J]+=R.buffers[J].data.length}if(f.attributes=R.attributes,R.indexBuffer){f.indexBuffer=f.buffers[R.buffers.indexOf(R.indexBuffer)],f.indexBuffer.type=Et.ELEMENT_ARRAY_BUFFER;let U=0,J=0,gt=0,Ot=0;for(let Xt=0;Xt<R.buffers.length;Xt++)if(R.buffers[Xt]!==R.indexBuffer){Ot=Xt;break}for(const Xt in R.attributes){const re=R.attributes[Xt];(re.buffer|0)===Ot&&(J+=re.size*mi[re.type]/4)}for(let Xt=0;Xt<c.length;Xt++){const re=c[Xt].indexBuffer.data;for(let Re=0;Re<re.length;Re++)f.indexBuffer.data[Re+gt]+=U;U+=c[Xt].buffers[Ot].data.length/J,gt+=re.length}}return f}}class ni extends si{constructor(c=!1){super(),this._buffer=new fr(null,c,!1),this._indexBuffer=new fr(null,c,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,at.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,at.FLOAT).addAttribute("aColor",this._buffer,4,!0,at.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,at.FLOAT).addIndex(this._indexBuffer)}}const ls=Math.PI*2,hs=180/Math.PI,Rs=Math.PI/180;var zr=(p=>(p[p.POLY=0]="POLY",p[p.RECT=1]="RECT",p[p.CIRC=2]="CIRC",p[p.ELIP=3]="ELIP",p[p.RREC=4]="RREC",p))(zr||{});class Ye{constructor(c=0,f=0){this.x=0,this.y=0,this.x=c,this.y=f}clone(){return new Ye(this.x,this.y)}copyFrom(c){return this.set(c.x,c.y),this}copyTo(c){return c.set(this.x,this.y),c}equals(c){return c.x===this.x&&c.y===this.y}set(c=0,f=c){return this.x=c,this.y=f,this}}Ye.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const He=[new Ye,new Ye,new Ye,new Ye];class Jt{constructor(c=0,f=0,v=0,_=0){this.x=Number(c),this.y=Number(f),this.width=Number(v),this.height=Number(_),this.type=zr.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Jt(0,0,0,0)}clone(){return new Jt(this.x,this.y,this.width,this.height)}copyFrom(c){return this.x=c.x,this.y=c.y,this.width=c.width,this.height=c.height,this}copyTo(c){return c.x=this.x,c.y=this.y,c.width=this.width,c.height=this.height,c}contains(c,f){return this.width<=0||this.height<=0?!1:c>=this.x&&c<this.x+this.width&&f>=this.y&&f<this.y+this.height}intersects(c,f){if(!f){const Ko=this.x<c.x?c.x:this.x;if((this.right>c.right?c.right:this.right)<=Ko)return!1;const Zo=this.y<c.y?c.y:this.y;return(this.bottom>c.bottom?c.bottom:this.bottom)>Zo}const v=this.left,_=this.right,A=this.top,R=this.bottom;if(_<=v||R<=A)return!1;const U=He[0].set(c.left,c.top),J=He[1].set(c.left,c.bottom),gt=He[2].set(c.right,c.top),Ot=He[3].set(c.right,c.bottom);if(gt.x<=U.x||J.y<=U.y)return!1;const Xt=Math.sign(f.a*f.d-f.b*f.c);if(Xt===0||(f.apply(U,U),f.apply(J,J),f.apply(gt,gt),f.apply(Ot,Ot),Math.max(U.x,J.x,gt.x,Ot.x)<=v||Math.min(U.x,J.x,gt.x,Ot.x)>=_||Math.max(U.y,J.y,gt.y,Ot.y)<=A||Math.min(U.y,J.y,gt.y,Ot.y)>=R))return!1;const re=Xt*(J.y-U.y),Re=Xt*(U.x-J.x),Ze=re*v+Re*A,De=re*_+Re*A,ir=re*v+Re*R,Qi=re*_+Re*R;if(Math.max(Ze,De,ir,Qi)<=re*U.x+Re*U.y||Math.min(Ze,De,ir,Qi)>=re*Ot.x+Re*Ot.y)return!1;const Ii=Xt*(U.y-gt.y),Ri=Xt*(gt.x-U.x),Fi=Ii*v+Ri*A,Di=Ii*_+Ri*A,Oo=Ii*v+Ri*R,Lo=Ii*_+Ri*R;return!(Math.max(Fi,Di,Oo,Lo)<=Ii*U.x+Ri*U.y||Math.min(Fi,Di,Oo,Lo)>=Ii*Ot.x+Ri*Ot.y)}pad(c=0,f=c){return this.x-=c,this.y-=f,this.width+=c*2,this.height+=f*2,this}fit(c){const f=Math.max(this.x,c.x),v=Math.min(this.x+this.width,c.x+c.width),_=Math.max(this.y,c.y),A=Math.min(this.y+this.height,c.y+c.height);return this.x=f,this.width=Math.max(v-f,0),this.y=_,this.height=Math.max(A-_,0),this}ceil(c=1,f=.001){const v=Math.ceil((this.x+this.width-f)*c)/c,_=Math.ceil((this.y+this.height-f)*c)/c;return this.x=Math.floor((this.x+f)*c)/c,this.y=Math.floor((this.y+f)*c)/c,this.width=v-this.x,this.height=_-this.y,this}enlarge(c){const f=Math.min(this.x,c.x),v=Math.max(this.x+this.width,c.x+c.width),_=Math.min(this.y,c.y),A=Math.max(this.y+this.height,c.y+c.height);return this.x=f,this.width=v-f,this.y=_,this.height=A-_,this}}Jt.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class us{constructor(c=0,f=0,v=0){this.x=c,this.y=f,this.radius=v,this.type=zr.CIRC}clone(){return new us(this.x,this.y,this.radius)}contains(c,f){if(this.radius<=0)return!1;const v=this.radius*this.radius;let _=this.x-c,A=this.y-f;return _*=_,A*=A,_+A<=v}getBounds(){return new Jt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}us.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Sr{constructor(c=0,f=0,v=0,_=0){this.x=c,this.y=f,this.width=v,this.height=_,this.type=zr.ELIP}clone(){return new Sr(this.x,this.y,this.width,this.height)}contains(c,f){if(this.width<=0||this.height<=0)return!1;let v=(c-this.x)/this.width,_=(f-this.y)/this.height;return v*=v,_*=_,v+_<=1}getBounds(){return new Jt(this.x-this.width,this.y-this.height,this.width,this.height)}}Sr.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Nr{constructor(...c){let f=Array.isArray(c[0])?c[0]:c;if(typeof f[0]!="number"){const v=[];for(let _=0,A=f.length;_<A;_++)v.push(f[_].x,f[_].y);f=v}this.points=f,this.type=zr.POLY,this.closeStroke=!0}clone(){const c=this.points.slice(),f=new Nr(c);return f.closeStroke=this.closeStroke,f}contains(c,f){let v=!1;const _=this.points.length/2;for(let A=0,R=_-1;A<_;R=A++){const U=this.points[A*2],J=this.points[A*2+1],gt=this.points[R*2],Ot=this.points[R*2+1];J>f!=Ot>f&&c<(gt-U)*((f-J)/(Ot-J))+U&&(v=!v)}return v}}Nr.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((p,c)=>`${p}, ${c}`,"")}]`};class I{constructor(c=0,f=0,v=0,_=0,A=20){this.x=c,this.y=f,this.width=v,this.height=_,this.radius=A,this.type=zr.RREC}clone(){return new I(this.x,this.y,this.width,this.height,this.radius)}contains(c,f){if(this.width<=0||this.height<=0)return!1;if(c>=this.x&&c<=this.x+this.width&&f>=this.y&&f<=this.y+this.height){const v=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(f>=this.y+v&&f<=this.y+this.height-v||c>=this.x+v&&c<=this.x+this.width-v)return!0;let _=c-(this.x+v),A=f-(this.y+v);const R=v*v;if(_*_+A*A<=R||(_=c-(this.x+this.width-v),_*_+A*A<=R)||(A=f-(this.y+this.height-v),_*_+A*A<=R)||(_=c-(this.x+v),_*_+A*A<=R))return!0}return!1}}I.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class M{constructor(c=1,f=0,v=0,_=1,A=0,R=0){this.array=null,this.a=c,this.b=f,this.c=v,this.d=_,this.tx=A,this.ty=R}fromArray(c){this.a=c[0],this.b=c[1],this.c=c[3],this.d=c[4],this.tx=c[2],this.ty=c[5]}set(c,f,v,_,A,R){return this.a=c,this.b=f,this.c=v,this.d=_,this.tx=A,this.ty=R,this}toArray(c,f){this.array||(this.array=new Float32Array(9));const v=f||this.array;return c?(v[0]=this.a,v[1]=this.b,v[2]=0,v[3]=this.c,v[4]=this.d,v[5]=0,v[6]=this.tx,v[7]=this.ty,v[8]=1):(v[0]=this.a,v[1]=this.c,v[2]=this.tx,v[3]=this.b,v[4]=this.d,v[5]=this.ty,v[6]=0,v[7]=0,v[8]=1),v}apply(c,f){f=f||new Ye;const v=c.x,_=c.y;return f.x=this.a*v+this.c*_+this.tx,f.y=this.b*v+this.d*_+this.ty,f}applyInverse(c,f){f=f||new Ye;const v=1/(this.a*this.d+this.c*-this.b),_=c.x,A=c.y;return f.x=this.d*v*_+-this.c*v*A+(this.ty*this.c-this.tx*this.d)*v,f.y=this.a*v*A+-this.b*v*_+(-this.ty*this.a+this.tx*this.b)*v,f}translate(c,f){return this.tx+=c,this.ty+=f,this}scale(c,f){return this.a*=c,this.d*=f,this.c*=c,this.b*=f,this.tx*=c,this.ty*=f,this}rotate(c){const f=Math.cos(c),v=Math.sin(c),_=this.a,A=this.c,R=this.tx;return this.a=_*f-this.b*v,this.b=_*v+this.b*f,this.c=A*f-this.d*v,this.d=A*v+this.d*f,this.tx=R*f-this.ty*v,this.ty=R*v+this.ty*f,this}append(c){const f=this.a,v=this.b,_=this.c,A=this.d;return this.a=c.a*f+c.b*_,this.b=c.a*v+c.b*A,this.c=c.c*f+c.d*_,this.d=c.c*v+c.d*A,this.tx=c.tx*f+c.ty*_+this.tx,this.ty=c.tx*v+c.ty*A+this.ty,this}setTransform(c,f,v,_,A,R,U,J,gt){return this.a=Math.cos(U+gt)*A,this.b=Math.sin(U+gt)*A,this.c=-Math.sin(U-J)*R,this.d=Math.cos(U-J)*R,this.tx=c-(v*this.a+_*this.c),this.ty=f-(v*this.b+_*this.d),this}prepend(c){const f=this.tx;if(c.a!==1||c.b!==0||c.c!==0||c.d!==1){const v=this.a,_=this.c;this.a=v*c.a+this.b*c.c,this.b=v*c.b+this.b*c.d,this.c=_*c.a+this.d*c.c,this.d=_*c.b+this.d*c.d}return this.tx=f*c.a+this.ty*c.c+c.tx,this.ty=f*c.b+this.ty*c.d+c.ty,this}decompose(c){const f=this.a,v=this.b,_=this.c,A=this.d,R=c.pivot,U=-Math.atan2(-_,A),J=Math.atan2(v,f),gt=Math.abs(U+J);return gt<1e-5||Math.abs(ls-gt)<1e-5?(c.rotation=J,c.skew.x=c.skew.y=0):(c.rotation=0,c.skew.x=U,c.skew.y=J),c.scale.x=Math.sqrt(f*f+v*v),c.scale.y=Math.sqrt(_*_+A*A),c.position.x=this.tx+(R.x*f+R.y*_),c.position.y=this.ty+(R.x*v+R.y*A),c}invert(){const c=this.a,f=this.b,v=this.c,_=this.d,A=this.tx,R=c*_-f*v;return this.a=_/R,this.b=-f/R,this.c=-v/R,this.d=c/R,this.tx=(v*this.ty-_*A)/R,this.ty=-(c*this.ty-f*A)/R,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const c=new M;return c.a=this.a,c.b=this.b,c.c=this.c,c.d=this.d,c.tx=this.tx,c.ty=this.ty,c}copyTo(c){return c.a=this.a,c.b=this.b,c.c=this.c,c.d=this.d,c.tx=this.tx,c.ty=this.ty,c}copyFrom(c){return this.a=c.a,this.b=c.b,this.c=c.c,this.d=c.d,this.tx=c.tx,this.ty=c.ty,this}static get IDENTITY(){return new M}static get TEMP_MATRIX(){return new M}}M.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const Y=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],pt=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ct=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Mt=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Yt=[],me=[],de=Math.sign;function tr(){for(let p=0;p<16;p++){const c=[];Yt.push(c);for(let f=0;f<16;f++){const v=de(Y[p]*Y[f]+Ct[p]*pt[f]),_=de(pt[p]*Y[f]+Mt[p]*pt[f]),A=de(Y[p]*Ct[f]+Ct[p]*Mt[f]),R=de(pt[p]*Ct[f]+Mt[p]*Mt[f]);for(let U=0;U<16;U++)if(Y[U]===v&&pt[U]===_&&Ct[U]===A&&Mt[U]===R){c.push(U);break}}}for(let p=0;p<16;p++){const c=new M;c.set(Y[p],pt[p],Ct[p],Mt[p],0,0),me.push(c)}}tr();const Le={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:p=>Y[p],uY:p=>pt[p],vX:p=>Ct[p],vY:p=>Mt[p],inv:p=>p&8?p&15:-p&7,add:(p,c)=>Yt[p][c],sub:(p,c)=>Yt[p][Le.inv(c)],rotate180:p=>p^4,isVertical:p=>(p&3)===2,byDirection:(p,c)=>Math.abs(p)*2<=Math.abs(c)?c>=0?Le.S:Le.N:Math.abs(c)*2<=Math.abs(p)?p>0?Le.E:Le.W:c>0?p>0?Le.SE:Le.SW:p>0?Le.NE:Le.NW,matrixAppendRotationInv:(p,c,f=0,v=0)=>{const _=me[Le.inv(c)];_.tx=f,_.ty=v,p.append(_)}};class ar{constructor(c,f,v=0,_=0){this._x=v,this._y=_,this.cb=c,this.scope=f}clone(c=this.cb,f=this.scope){return new ar(c,f,this._x,this._y)}set(c=0,f=c){return(this._x!==c||this._y!==f)&&(this._x=c,this._y=f,this.cb.call(this.scope)),this}copyFrom(c){return(this._x!==c.x||this._y!==c.y)&&(this._x=c.x,this._y=c.y,this.cb.call(this.scope)),this}copyTo(c){return c.set(this._x,this._y),c}equals(c){return c.x===this._x&&c.y===this._y}get x(){return this._x}set x(c){this._x!==c&&(this._x=c,this.cb.call(this.scope))}get y(){return this._y}set y(c){this._y!==c&&(this._y=c,this.cb.call(this.scope))}}ar.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const rr=class{constructor(){this.worldTransform=new M,this.localTransform=new M,this.position=new ar(this.onChange,this,0,0),this.scale=new ar(this.onChange,this,1,1),this.pivot=new ar(this.onChange,this,0,0),this.skew=new ar(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const p=this.localTransform;this._localID!==this._currentLocalID&&(p.a=this._cx*this.scale.x,p.b=this._sx*this.scale.x,p.c=this._cy*this.scale.y,p.d=this._sy*this.scale.y,p.tx=this.position.x-(this.pivot.x*p.a+this.pivot.y*p.c),p.ty=this.position.y-(this.pivot.x*p.b+this.pivot.y*p.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(p){const c=this.localTransform;if(this._localID!==this._currentLocalID&&(c.a=this._cx*this.scale.x,c.b=this._sx*this.scale.x,c.c=this._cy*this.scale.y,c.d=this._sy*this.scale.y,c.tx=this.position.x-(this.pivot.x*c.a+this.pivot.y*c.c),c.ty=this.position.y-(this.pivot.x*c.b+this.pivot.y*c.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==p._worldID){const f=p.worldTransform,v=this.worldTransform;v.a=c.a*f.a+c.b*f.c,v.b=c.a*f.b+c.b*f.d,v.c=c.c*f.a+c.d*f.c,v.d=c.c*f.b+c.d*f.d,v.tx=c.tx*f.a+c.ty*f.c+f.tx,v.ty=c.tx*f.b+c.ty*f.d+f.ty,this._parentID=p._worldID,this._worldID++}}setFromMatrix(p){p.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(p){this._rotation!==p&&(this._rotation=p,this.updateSkew())}};rr.IDENTITY=new rr;let Br=rr;Br.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var Wi=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,Si=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;const Vr=[{test:p=>p.type==="float"&&p.size===1&&!p.isArray,code:p=>`
            if(uv["${p}"] !== ud["${p}"].value)
            {
                ud["${p}"].value = uv["${p}"]
                gl.uniform1f(ud["${p}"].location, uv["${p}"])
            }
            `},{test:(p,c)=>(p.type==="sampler2D"||p.type==="samplerCube"||p.type==="sampler2DArray")&&p.size===1&&!p.isArray&&(c==null||c.castToBaseTexture!==void 0),code:p=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${p}"], t);

            if(ud["${p}"].value !== t)
            {
                ud["${p}"].value = t;
                gl.uniform1i(ud["${p}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(p,c)=>p.type==="mat3"&&p.size===1&&!p.isArray&&c.a!==void 0,code:p=>`
            gl.uniformMatrix3fv(ud["${p}"].location, false, uv["${p}"].toArray(true));
            `,codeUbo:p=>`
                var ${p}_matrix = uv.${p}.toArray(true);

                data[offset] = ${p}_matrix[0];
                data[offset+1] = ${p}_matrix[1];
                data[offset+2] = ${p}_matrix[2];
        
                data[offset + 4] = ${p}_matrix[3];
                data[offset + 5] = ${p}_matrix[4];
                data[offset + 6] = ${p}_matrix[5];
        
                data[offset + 8] = ${p}_matrix[6];
                data[offset + 9] = ${p}_matrix[7];
                data[offset + 10] = ${p}_matrix[8];
            `},{test:(p,c)=>p.type==="vec2"&&p.size===1&&!p.isArray&&c.x!==void 0,code:p=>`
                cv = ud["${p}"].value;
                v = uv["${p}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${p}"].location, v.x, v.y);
                }`,codeUbo:p=>`
                v = uv.${p};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:p=>p.type==="vec2"&&p.size===1&&!p.isArray,code:p=>`
                cv = ud["${p}"].value;
                v = uv["${p}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${p}"].location, v[0], v[1]);
                }
            `},{test:(p,c)=>p.type==="vec4"&&p.size===1&&!p.isArray&&c.width!==void 0,code:p=>`
                cv = ud["${p}"].value;
                v = uv["${p}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${p}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:p=>`
                    v = uv.${p};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(p,c)=>p.type==="vec4"&&p.size===1&&!p.isArray&&c.red!==void 0,code:p=>`
                cv = ud["${p}"].value;
                v = uv["${p}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${p}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:p=>`
                    v = uv.${p};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(p,c)=>p.type==="vec3"&&p.size===1&&!p.isArray&&c.red!==void 0,code:p=>`
                cv = ud["${p}"].value;
                v = uv["${p}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${p}"].location, v.red, v.green, v.blue)
                }`,codeUbo:p=>`
                    v = uv.${p};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:p=>p.type==="vec4"&&p.size===1&&!p.isArray,code:p=>`
                cv = ud["${p}"].value;
                v = uv["${p}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${p}"].location, v[0], v[1], v[2], v[3])
                }`}],$i={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},cs={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function ds(p,c){var v;const f=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const _ in p.uniforms){const A=c[_];if(!A){((v=p.uniforms[_])==null?void 0:v.group)===!0&&(p.uniforms[_].ubo?f.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${_}, '${_}');
                    `):f.push(`
                        renderer.shader.syncUniformGroup(uv.${_}, syncData);
                    `));continue}const R=p.uniforms[_];let U=!1;for(let J=0;J<Vr.length;J++)if(Vr[J].test(A,R)){f.push(Vr[J].code(_,R)),U=!0;break}if(!U){const J=(A.size===1&&!A.isArray?$i:cs)[A.type].replace("location",`ud["${_}"].location`);f.push(`
            cu = ud["${_}"];
            cv = cu.value;
            v = uv["${_}"];
            ${J};`)}}return new Function("ud","uv","renderer","syncData",f.join(`
`))}const Fs={};let qr=Fs;function Ds(){if(qr===Fs||qr!=null&&qr.isContextLost()){const p=q.ADAPTER.createCanvas();let c;q.PREFER_ENV>=ct.WEBGL2&&(c=p.getContext("webgl2",{})),c||(c=p.getContext("webgl",{})||p.getContext("experimental-webgl",{}),c?c.getExtension("WEBGL_draw_buffers"):c=null),qr=c}return qr}let Ci;function Ns(){if(!Ci){Ci=K.MEDIUM;const p=Ds();if(p&&p.getShaderPrecisionFormat){const c=p.getShaderPrecisionFormat(p.FRAGMENT_SHADER,p.HIGH_FLOAT);c&&(Ci=c.precision?K.HIGH:K.MEDIUM)}}return Ci}const pn={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function fs(p){return pn[p]}let oi=null;const ps={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Bs(p,c){if(!oi){const f=Object.keys(ps);oi={};for(let v=0;v<f.length;++v){const _=f[v];oi[p[_]]=ps[_]}}return oi[c]}function Cr(p,c,f){if(p.substring(0,9)!=="precision"){let v=c;return c===K.HIGH&&f!==K.HIGH&&(v=K.MEDIUM),`precision ${v} float;
${p}`}else if(f!==K.HIGH&&p.substring(0,15)==="precision highp")return p.replace("precision highp","precision mediump");return p}let ai=0;const Kr={},xe=class qs{constructor(c,f,v="pixi-shader",_={}){this.extra={},this.id=ai++,this.vertexSrc=c||qs.defaultVertexSrc,this.fragmentSrc=f||qs.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=_,this.vertexSrc.substring(0,8)!=="#version"&&(v=v.replace(/\s+/g,"-"),Kr[v]?(Kr[v]++,v+=`-${Kr[v]}`):Kr[v]=1,this.vertexSrc=`#define SHADER_NAME ${v}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${v}
${this.fragmentSrc}`,this.vertexSrc=Cr(this.vertexSrc,qs.defaultVertexPrecision,K.HIGH),this.fragmentSrc=Cr(this.fragmentSrc,qs.defaultFragmentPrecision,Ns())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return Si}static get defaultFragmentSrc(){return Wi}static from(c,f,v){const _=c+f;let A=Fr[_];return A||(Fr[_]=A=new qs(c,f,v)),A}};xe.defaultVertexPrecision=K.HIGH,xe.defaultFragmentPrecision=ee.apple.device?K.HIGH:K.MEDIUM;let Oe=xe,lr=0;class pr{constructor(c,f,v){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=lr++,this.static=!!f,this.ubo=!!v,c instanceof fr?(this.buffer=c,this.buffer.type=Et.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=c,this.ubo&&(this.buffer=new fr(new Float32Array(1)),this.buffer.type=Et.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(c,f,v){if(!this.ubo)this.uniforms[c]=new pr(f,v);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(c,f,v){return new pr(c,f,v)}static uboFrom(c,f){return new pr(c,f!=null?f:!0,!0)}}class li{constructor(c,f){this.uniformBindCount=0,this.program=c,f?f instanceof pr?this.uniformGroup=f:this.uniformGroup=new pr(f):this.uniformGroup=new pr({}),this.disposeRunner=new er("disposeShader")}checkUniformExists(c,f){if(f.uniforms[c])return!0;for(const v in f.uniforms){const _=f.uniforms[v];if(_.group===!0&&this.checkUniformExists(c,_))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(c,f,v){const _=Oe.from(c,f);return new li(_,v)}}class go{constructor(c,f){if(this.vertexSrc=c,this.fragTemplate=f,this.programCache={},this.defaultGroupCache={},!f.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!f.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(c){if(!this.programCache[c]){const v=new Int32Array(c);for(let A=0;A<c;A++)v[A]=A;this.defaultGroupCache[c]=pr.from({uSamplers:v},!0);let _=this.fragTemplate;_=_.replace(/%count%/gi,`${c}`),_=_.replace(/%forloop%/gi,this.generateSampleSrc(c)),this.programCache[c]=new Oe(this.vertexSrc,_)}const f={tint:new Float32Array([1,1,1,1]),translationMatrix:new M,default:this.defaultGroupCache[c]};return new li(this.programCache[c],f)}generateSampleSrc(c){let f="";f+=`
`,f+=`
`;for(let v=0;v<c;v++)v>0&&(f+=`
else `),v<c-1&&(f+=`if(vTextureId < ${v}.5)`),f+=`
{`,f+=`
	color = texture2D(uSamplers[${v}], vTextureCoord);`,f+=`
}`;return f+=`
`,f+=`
`,f}}class kn{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let c=0;c<this.count;c++)this.elements[c]=null;this.count=0}}function Un(){return!ee.apple.device}function Os(p){let c=!0;const f=q.ADAPTER.getNavigator();if(ee.tablet||ee.phone){if(ee.apple.device){const v=f.userAgent.match(/OS (\d+)_(\d+)?/);v&&parseInt(v[1],10)<11&&(c=!1)}if(ee.android.device){const v=f.userAgent.match(/Android\s([0-9.]*)/);v&&parseInt(v[1],10)<7&&(c=!1)}}return c?p:4}class Yi{constructor(c){this.renderer=c}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(c){}}var Zr=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,gi=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const ms=class ui extends Yi{constructor(c){super(c),this.setShaderGenerator(),this.geometryClass=ni,this.vertexSize=6,this.state=ri.for2d(),this.size=ui.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),c.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){var c;return this._defaultMaxTextures=(c=this._defaultMaxTextures)!=null?c:Os(32),this._defaultMaxTextures}static set defaultMaxTextures(c){this._defaultMaxTextures=c}static get canUploadSameBuffer(){var c;return this._canUploadSameBuffer=(c=this._canUploadSameBuffer)!=null?c:Un(),this._canUploadSameBuffer}static set canUploadSameBuffer(c){this._canUploadSameBuffer=c}get MAX_TEXTURES(){return te("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return gi}static get defaultFragmentTemplate(){return Zr}setShaderGenerator({vertex:c=ui.defaultVertexSrc,fragment:f=ui.defaultFragmentTemplate}={}){this.shaderGenerator=new go(c,f)}contextChange(){const c=this.renderer.gl;q.PREFER_ENV===ct.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),ui.defaultMaxTextures),this.maxTextures=ln(this.maxTextures,c)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let f=0;f<this._packedGeometryPoolSize;f++)this._packedGeometries[f]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:c,_textureArrayPool:f}=ui,v=this.size/4,_=Math.floor(v/this.maxTextures)+1;for(;c.length<v;)c.push(new Ms);for(;f.length<_;)f.push(new kn);for(let A=0;A<this.maxTextures;A++)this._tempBoundTextures[A]=null}onPrerender(){this._flushId=0}render(c){c._texture.valid&&(this._vertexCount+c.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=c.vertexData.length/2,this._indexCount+=c.indices.length,this._bufferedTextures[this._bufferSize]=c._texture.baseTexture,this._bufferedElements[this._bufferSize++]=c)}buildTexturesAndDrawCalls(){const{_bufferedTextures:c,maxTextures:f}=this,v=ui._textureArrayPool,_=this.renderer.batch,A=this._tempBoundTextures,R=this.renderer.textureGC.count;let U=++Ve._globalBatch,J=0,gt=v[0],Ot=0;_.copyBoundTextures(A,f);for(let Xt=0;Xt<this._bufferSize;++Xt){const re=c[Xt];c[Xt]=null,re._batchEnabled!==U&&(gt.count>=f&&(_.boundArray(gt,A,U,f),this.buildDrawCalls(gt,Ot,Xt),Ot=Xt,gt=v[++J],++U),re._batchEnabled=U,re.touched=R,gt.elements[gt.count++]=re)}gt.count>0&&(_.boundArray(gt,A,U,f),this.buildDrawCalls(gt,Ot,this._bufferSize),++J,++U);for(let Xt=0;Xt<A.length;Xt++)A[Xt]=null;Ve._globalBatch=U}buildDrawCalls(c,f,v){const{_bufferedElements:_,_attributeBuffer:A,_indexBuffer:R,vertexSize:U}=this,J=ui._drawCallPool;let gt=this._dcIndex,Ot=this._aIndex,Xt=this._iIndex,re=J[gt];re.start=this._iIndex,re.texArray=c;for(let Re=f;Re<v;++Re){const Ze=_[Re],De=Ze._texture.baseTexture,ir=ti[De.alphaMode?1:0][Ze.blendMode];_[Re]=null,f<Re&&re.blend!==ir&&(re.size=Xt-re.start,f=Re,re=J[++gt],re.texArray=c,re.start=Xt),this.packInterleavedGeometry(Ze,A,R,Ot,Xt),Ot+=Ze.vertexData.length/2*U,Xt+=Ze.indices.length,re.blend=ir}f<v&&(re.size=Xt-re.start,++gt),this._dcIndex=gt,this._aIndex=Ot,this._iIndex=Xt}bindAndClearTexArray(c){const f=this.renderer.texture;for(let v=0;v<c.count;v++)f.bind(c.elements[v],c.ids[v]),c.elements[v]=null;c.count=0}updateGeometry(){const{_packedGeometries:c,_attributeBuffer:f,_indexBuffer:v}=this;ui.canUploadSameBuffer?(c[this._flushId]._buffer.update(f.rawBinaryData),c[this._flushId]._indexBuffer.update(v),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,c[this._flushId]=new this.geometryClass),c[this._flushId]._buffer.update(f.rawBinaryData),c[this._flushId]._indexBuffer.update(v),this.renderer.geometry.bind(c[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const c=this._dcIndex,{gl:f,state:v}=this.renderer,_=ui._drawCallPool;let A=null;for(let R=0;R<c;R++){const{texArray:U,type:J,size:gt,start:Ot,blend:Xt}=_[R];A!==U&&(A=U,this.bindAndClearTexArray(U)),this.state.blendMode=Xt,v.set(this.state),f.drawElements(J,gt,f.UNSIGNED_SHORT,Ot*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),ui.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let c=0;c<this._packedGeometryPoolSize;c++)this._packedGeometries[c]&&this._packedGeometries[c].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(c){const f=wi(Math.ceil(c/8)),v=ts(f),_=f*8;this._aBuffers.length<=v&&(this._iBuffers.length=v+1);let A=this._aBuffers[_];return A||(this._aBuffers[_]=A=new Ss(_*this.vertexSize*4)),A}getIndexBuffer(c){const f=wi(Math.ceil(c/12)),v=ts(f),_=f*12;this._iBuffers.length<=v&&(this._iBuffers.length=v+1);let A=this._iBuffers[v];return A||(this._iBuffers[v]=A=new Uint16Array(_)),A}packInterleavedGeometry(c,f,v,_,A){const{uint32View:R,float32View:U}=f,J=_/this.vertexSize,gt=c.uvs,Ot=c.indices,Xt=c.vertexData,re=c._texture.baseTexture._batchLocation,Re=Math.min(c.worldAlpha,1),Ze=gr.shared.setValue(c._tintRGB).toPremultiplied(Re,c._texture.baseTexture.alphaMode>0);for(let De=0;De<Xt.length;De+=2)U[_++]=Xt[De],U[_++]=Xt[De+1],U[_++]=gt[De],U[_++]=gt[De+1],R[_++]=Ze,U[_++]=re;for(let De=0;De<Ot.length;De++)v[A++]=J+Ot[De]}};ms.defaultBatchSize=4096,ms.extension={name:"batch",type:Fe.RendererPlugin},ms._drawCallPool=[],ms._textureArrayPool=[];let vi=ms;ze.add(vi);var yi=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,mn=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const gn=class Rn extends li{constructor(c,f,v){const _=Oe.from(c||Rn.defaultVertexSrc,f||Rn.defaultFragmentSrc);super(_,v),this.padding=0,this.resolution=Rn.defaultResolution,this.multisample=Rn.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new ri}apply(c,f,v,_,A){c.applyFilter(this,f,v,_)}get blendMode(){return this.state.blendMode}set blendMode(c){this.state.blendMode=c}get resolution(){return this._resolution}set resolution(c){this._resolution=c}static get defaultVertexSrc(){return mn}static get defaultFragmentSrc(){return yi}};gn.defaultResolution=1,gn.defaultMultisample=It.NONE;let hi=gn;class Ls{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new gr(0),this.alpha=1}init(c){this.clearBeforeRender=c.clearBeforeRender;const{backgroundColor:f,background:v,backgroundAlpha:_}=c,A=v!=null?v:f;A!==void 0&&(this.color=A),this.alpha=_}get color(){return this._backgroundColor.value}set color(c){this._backgroundColor.setValue(c)}get alpha(){return this._backgroundColor.alpha}set alpha(c){this._backgroundColor.setAlpha(c)}get backgroundColor(){return this._backgroundColor}destroy(){}}Ls.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Ls.extension={type:[Fe.RendererSystem,Fe.CanvasRendererSystem],name:"background"},ze.add(Ls);class vn{constructor(c){this.renderer=c,this.emptyRenderer=new Yi(c),this.currentRenderer=this.emptyRenderer}setObjectRenderer(c){this.currentRenderer!==c&&(this.currentRenderer.stop(),this.currentRenderer=c,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(c,f){const{boundTextures:v}=this.renderer.texture;for(let _=f-1;_>=0;--_)c[_]=v[_]||null,c[_]&&(c[_]._batchLocation=_)}boundArray(c,f,v,_){const{elements:A,ids:R,count:U}=c;let J=0;for(let gt=0;gt<U;gt++){const Ot=A[gt],Xt=Ot._batchLocation;if(Xt>=0&&Xt<_&&f[Xt]===Ot){R[gt]=Xt;continue}for(;J<_;){const re=f[J];if(re&&re._batchEnabled===v&&re._batchLocation===J){J++;continue}R[gt]=J,Ot._batchLocation=J,f[J]=Ot;break}}}destroy(){this.renderer=null}}vn.extension={type:Fe.RendererSystem,name:"batch"},ze.add(vn);let yn=0;class ks{constructor(c){this.renderer=c,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(c){this.gl=c,this.renderer.gl=c,this.renderer.CONTEXT_UID=yn++}init(c){if(c.context)this.initFromContext(c.context);else{const f=this.renderer.background.alpha<1,v=c.premultipliedAlpha;this.preserveDrawingBuffer=c.preserveDrawingBuffer,this.useContextAlpha=c.useContextAlpha,this.powerPreference=c.powerPreference,this.initFromOptions({alpha:f,premultipliedAlpha:v,antialias:c.antialias,stencil:!0,preserveDrawingBuffer:c.preserveDrawingBuffer,powerPreference:c.powerPreference})}}initFromContext(c){this.gl=c,this.validateContext(c),this.renderer.gl=c,this.renderer.CONTEXT_UID=yn++,this.renderer.runners.contextChange.emit(c);const f=this.renderer.view;f.addEventListener!==void 0&&(f.addEventListener("webglcontextlost",this.handleContextLost,!1),f.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(c){const f=this.createContext(this.renderer.view,c);this.initFromContext(f)}createContext(c,f){let v;if(q.PREFER_ENV>=ct.WEBGL2&&(v=c.getContext("webgl2",f)),v)this.webGLVersion=2;else if(this.webGLVersion=1,v=c.getContext("webgl",f)||c.getContext("experimental-webgl",f),!v)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=v,this.getExtensions(),this.gl}getExtensions(){const{gl:c}=this,f={loseContext:c.getExtension("WEBGL_lose_context"),anisotropicFiltering:c.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:c.getExtension("OES_texture_float_linear"),s3tc:c.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:c.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:c.getExtension("WEBGL_compressed_texture_etc"),etc1:c.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:c.getExtension("WEBGL_compressed_texture_pvrtc")||c.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:c.getExtension("WEBGL_compressed_texture_atc"),astc:c.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,f,{drawBuffers:c.getExtension("WEBGL_draw_buffers"),depthTexture:c.getExtension("WEBGL_depth_texture"),vertexArrayObject:c.getExtension("OES_vertex_array_object")||c.getExtension("MOZ_OES_vertex_array_object")||c.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:c.getExtension("OES_element_index_uint"),floatTexture:c.getExtension("OES_texture_float"),floatTextureLinear:c.getExtension("OES_texture_float_linear"),textureHalfFloat:c.getExtension("OES_texture_half_float"),textureHalfFloatLinear:c.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,f,{colorBufferFloat:c.getExtension("EXT_color_buffer_float")})}handleContextLost(c){c.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const c=this.renderer.view;this.renderer=null,c.removeEventListener!==void 0&&(c.removeEventListener("webglcontextlost",this.handleContextLost),c.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(c){const f=c.getContextAttributes(),v="WebGL2RenderingContext"in globalThis&&c instanceof globalThis.WebGL2RenderingContext;v&&(this.webGLVersion=2),f&&!f.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const _=v||!!c.getExtension("OES_element_index_uint");this.supports.uint32Indices=_,_||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}ks.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},ks.extension={type:Fe.RendererSystem,name:"context"},ze.add(ks);class _n{constructor(c,f){if(this.width=Math.round(c),this.height=Math.round(f),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new er("disposeFramebuffer"),this.multisample=It.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(c=0,f){return this.colorTextures[c]=f||new Ve(null,{scaleMode:$.NEAREST,resolution:1,mipmap:it.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(c){return this.depthTexture=c||new Ve(null,{scaleMode:$.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:it.OFF,format:nt.DEPTH_COMPONENT,type:at.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(c,f){if(c=Math.round(c),f=Math.round(f),!c||!f)throw new Error("Framebuffer width and height must not be zero");if(!(c===this.width&&f===this.height)){this.width=c,this.height=f,this.dirtyId++,this.dirtySize++;for(let v=0;v<this.colorTextures.length;v++){const _=this.colorTextures[v],A=_.resolution;_.setSize(c/A,f/A)}if(this.depthTexture){const v=this.depthTexture.resolution;this.depthTexture.setSize(c/v,f/v)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Gn extends Ve{constructor(c={}){var f,v,_;if(typeof c=="number"){const A=arguments[0],R=arguments[1],U=arguments[2],J=arguments[3];c={width:A,height:R,scaleMode:U,resolution:J}}c.width=(f=c.width)!=null?f:100,c.height=(v=c.height)!=null?v:100,(_=c.multisample)!=null||(c.multisample=It.NONE),super(null,c),this.mipmap=it.OFF,this.valid=!0,this._clear=new gr([0,0,0,0]),this.framebuffer=new _n(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=c.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(c){this._clear.setValue(c)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(c){this.framebuffer.multisample=c}resize(c,f){this.framebuffer.resize(c*this.resolution,f*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class _i extends ii{constructor(c){const f=c,v=f.naturalWidth||f.videoWidth||f.width,_=f.naturalHeight||f.videoHeight||f.height;super(v,_),this.source=c,this.noSubImage=!1}static crossOrigin(c,f,v){v===void 0&&!f.startsWith("data:")?c.crossOrigin=Yr(f):v!==!1&&(c.crossOrigin=typeof v=="string"?v:"anonymous")}upload(c,f,v,_){const A=c.gl,R=f.realWidth,U=f.realHeight;if(_=_||this.source,typeof HTMLImageElement<"u"&&_ instanceof HTMLImageElement){if(!_.complete||_.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&_ instanceof HTMLVideoElement&&_.readyState<=1)return!1;return A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.alphaMode===Z.UNPACK),!this.noSubImage&&f.target===A.TEXTURE_2D&&v.width===R&&v.height===U?A.texSubImage2D(A.TEXTURE_2D,0,0,0,f.format,v.type,_):(v.width=R,v.height=U,A.texImage2D(f.target,0,v.internalFormat,f.format,v.type,_)),!0}update(){if(this.destroyed)return;const c=this.source,f=c.naturalWidth||c.videoWidth||c.width,v=c.naturalHeight||c.videoHeight||c.height;this.resize(f,v),super.update()}dispose(){this.source=null}}class zn extends _i{constructor(c,f){var v;if(f=f||{},typeof c=="string"){const _=new Image;_i.crossOrigin(_,c,f.crossorigin),_.src=c,c=_}super(c),!c.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=c.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=((v=f.createBitmap)!=null?v:q.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof f.alphaMode=="number"?f.alphaMode:null,this.bitmap=null,this._load=null,f.autoLoad!==!1&&this.load()}load(c){return this._load?this._load:(c!==void 0&&(this.createBitmap=c),this._load=new Promise((f,v)=>{const _=this.source;this.url=_.src;const A=()=>{this.destroyed||(_.onload=null,_.onerror=null,this.update(),this._load=null,this.createBitmap?f(this.process()):f(this))};_.complete&&_.src?A():(_.onload=A,_.onerror=R=>{v(R),this.onError.emit(R)})}),this._load)}process(){const c=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const f=globalThis.createImageBitmap,v=!c.crossOrigin||c.crossOrigin==="anonymous";return this._process=fetch(c.src,{mode:v?"cors":"no-cors"}).then(_=>_.blob()).then(_=>f(_,0,0,c.width,c.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Z.UNPACK?"premultiply":"none"})).then(_=>this.destroyed?Promise.reject():(this.bitmap=_,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(c,f,v){if(typeof this.alphaMode=="number"&&(f.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(c,f,v);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(c,f,v,this.bitmap),!this.preserveBitmap){let _=!0;const A=f._glTextures;for(const R in A){const U=A[R];if(U!==v&&U.dirtyId!==f.dirtyId){_=!1;break}}_&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(c){return typeof HTMLImageElement<"u"&&(typeof c=="string"||c instanceof HTMLImageElement)}}class xn{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(c,f,v){const _=f.width,A=f.height;if(v){const R=c.width/2/_,U=c.height/2/A,J=c.x/_+R,gt=c.y/A+U;v=Le.add(v,Le.NW),this.x0=J+R*Le.uX(v),this.y0=gt+U*Le.uY(v),v=Le.add(v,2),this.x1=J+R*Le.uX(v),this.y1=gt+U*Le.uY(v),v=Le.add(v,2),this.x2=J+R*Le.uX(v),this.y2=gt+U*Le.uY(v),v=Le.add(v,2),this.x3=J+R*Le.uX(v),this.y3=gt+U*Le.uY(v)}else this.x0=c.x/_,this.y0=c.y/A,this.x1=(c.x+c.width)/_,this.y1=c.y/A,this.x2=(c.x+c.width)/_,this.y2=(c.y+c.height)/A,this.x3=c.x/_,this.y3=(c.y+c.height)/A;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}xn.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Vn=new xn;function Us(p){p.destroy=function(){},p.on=function(){},p.once=function(){},p.emit=function(){}}class qe extends le{constructor(c,f,v,_,A,R,U){if(super(),this.noFrame=!1,f||(this.noFrame=!0,f=new Jt(0,0,1,1)),c instanceof qe&&(c=c.baseTexture),this.baseTexture=c,this._frame=f,this.trim=_,this.valid=!1,this.destroyed=!1,this._uvs=Vn,this.uvMatrix=null,this.orig=v||f,this._rotate=Number(A||0),A===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=R?new Ye(R.x,R.y):new Ye(0,0),this.defaultBorders=U,this._updateID=0,this.textureCacheIds=[],c.valid?this.noFrame?c.valid&&this.onBaseTextureUpdated(c):this.frame=f:c.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&c.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(c){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=c.width,this._frame.height=c.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(c){if(this.baseTexture){if(c){const{resource:f}=this.baseTexture;f!=null&&f.url&&or[f.url]&&qe.removeFromCache(f.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,qe.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var _;const c=this._frame.clone(),f=this._frame===this.orig?c:this.orig.clone(),v=new qe(this.baseTexture,!this.noFrame&&c,f,(_=this.trim)==null?void 0:_.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(v._frame=c),v}updateUvs(){this._uvs===Vn&&(this._uvs=new xn),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(c,f={},v=q.STRICT_TEXTURE_CACHE){const _=typeof c=="string";let A=null;if(_)A=c;else if(c instanceof Ve){if(!c.cacheId){const U=(f==null?void 0:f.pixiIdPrefix)||"pixiid";c.cacheId=`${U}-${Gr()}`,Ve.addToCache(c,c.cacheId)}A=c.cacheId}else{if(!c._pixiId){const U=(f==null?void 0:f.pixiIdPrefix)||"pixiid";c._pixiId=`${U}_${Gr()}`}A=c._pixiId}let R=or[A];if(_&&v&&!R)throw new Error(`The cacheId "${A}" does not exist in TextureCache.`);return!R&&!(c instanceof Ve)?(f.resolution||(f.resolution=Hi(c)),R=new qe(new Ve(c,f)),R.baseTexture.cacheId=A,Ve.addToCache(R.baseTexture,A),qe.addToCache(R,A)):!R&&c instanceof Ve&&(R=new qe(c),qe.addToCache(R,A)),R}static fromURL(c,f){const v=Object.assign({autoLoad:!1},f==null?void 0:f.resourceOptions),_=qe.from(c,Object.assign({resourceOptions:v},f),!1),A=_.baseTexture.resource;return _.baseTexture.valid?Promise.resolve(_):A.load().then(()=>Promise.resolve(_))}static fromBuffer(c,f,v,_){return new qe(Ve.fromBuffer(c,f,v,_))}static fromLoader(c,f,v,_){const A=new Ve(c,Object.assign({scaleMode:Ve.defaultOptions.scaleMode,resolution:Hi(f)},_)),{resource:R}=A;R instanceof zn&&(R.url=f);const U=new qe(A);return v||(v=f),Ve.addToCache(U.baseTexture,v),qe.addToCache(U,v),v!==f&&(Ve.addToCache(U.baseTexture,f),qe.addToCache(U,f)),U.baseTexture.valid?Promise.resolve(U):new Promise(J=>{U.baseTexture.once("loaded",()=>J(U))})}static addToCache(c,f){f&&(c.textureCacheIds.includes(f)||c.textureCacheIds.push(f),or[f]&&or[f]!==c&&console.warn(`Texture added to the cache with an id [${f}] that already had an entry`),or[f]=c)}static removeFromCache(c){if(typeof c=="string"){const f=or[c];if(f){const v=f.textureCacheIds.indexOf(c);return v>-1&&f.textureCacheIds.splice(v,1),delete or[c],f}}else if(c!=null&&c.textureCacheIds){for(let f=0;f<c.textureCacheIds.length;++f)or[c.textureCacheIds[f]]===c&&delete or[c.textureCacheIds[f]];return c.textureCacheIds.length=0,c}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(c){this._frame=c,this.noFrame=!1;const{x:f,y:v,width:_,height:A}=c,R=f+_>this.baseTexture.width,U=v+A>this.baseTexture.height;if(R||U){const J=R&&U?"and":"or",gt=`X: ${f} + ${_} = ${f+_} > ${this.baseTexture.width}`,Ot=`Y: ${v} + ${A} = ${v+A} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${gt} ${J} ${Ot}`)}this.valid=_&&A&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=c),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(c){this._rotate=c,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return qe._EMPTY||(qe._EMPTY=new qe(new Ve),Us(qe._EMPTY),Us(qe._EMPTY.baseTexture)),qe._EMPTY}static get WHITE(){if(!qe._WHITE){const c=q.ADAPTER.createCanvas(16,16),f=c.getContext("2d");c.width=16,c.height=16,f.fillStyle="white",f.fillRect(0,0,16,16),qe._WHITE=new qe(Ve.from(c)),Us(qe._WHITE),Us(qe._WHITE.baseTexture)}return qe._WHITE}}class Pi extends qe{constructor(c,f){super(c,f),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(c){this.framebuffer.multisample=c}resize(c,f,v=!0){const _=this.baseTexture.resolution,A=Math.round(c*_)/_,R=Math.round(f*_)/_;this.valid=A>0&&R>0,this._frame.width=this.orig.width=A,this._frame.height=this.orig.height=R,v&&this.baseTexture.resize(A,R),this.updateUvs()}setResolution(c){const{baseTexture:f}=this;f.resolution!==c&&(f.setResolution(c),this.resize(f.width,f.height,!1))}static create(c){return new Pi(new Gn(c))}}class bn{constructor(c){this.texturePool={},this.textureOptions=c||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(c,f,v=It.NONE){const _=new Gn(Object.assign({width:c,height:f,resolution:1,multisample:v},this.textureOptions));return new Pi(_)}getOptimalTexture(c,f,v=1,_=It.NONE){let A;c=Math.max(Math.ceil(c*v-1e-6),1),f=Math.max(Math.ceil(f*v-1e-6),1),!this.enableFullScreen||c!==this._pixelsWidth||f!==this._pixelsHeight?(c=wi(c),f=wi(f),A=((c&65535)<<16|f&65535)>>>0,_>1&&(A+=_*4294967296)):A=_>1?-_:-1,this.texturePool[A]||(this.texturePool[A]=[]);let R=this.texturePool[A].pop();return R||(R=this.createTexture(c,f,_)),R.filterPoolKey=A,R.setResolution(v),R}getFilterTexture(c,f,v){const _=this.getOptimalTexture(c.width,c.height,f||c.resolution,v||It.NONE);return _.filterFrame=c.filterFrame,_}returnTexture(c){const f=c.filterPoolKey;c.filterFrame=null,this.texturePool[f].push(c)}returnFilterTexture(c){this.returnTexture(c)}clear(c){if(c=c!==!1,c)for(const f in this.texturePool){const v=this.texturePool[f];if(v)for(let _=0;_<v.length;_++)v[_].destroy(!0)}this.texturePool={}}setScreenSize(c){if(!(c.width===this._pixelsWidth&&c.height===this._pixelsHeight)){this.enableFullScreen=c.width>0&&c.height>0;for(const f in this.texturePool){if(!(Number(f)<0))continue;const v=this.texturePool[f];if(v)for(let _=0;_<v.length;_++)v[_].destroy(!0);this.texturePool[f]=[]}this._pixelsWidth=c.width,this._pixelsHeight=c.height}}}bn.SCREEN_KEY=-1;class vo extends si{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Hn extends si{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new fr(this.vertices),this.uvBuffer=new fr(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(c,f){let v=0,_=0;return this.uvs[0]=v,this.uvs[1]=_,this.uvs[2]=v+f.width/c.width,this.uvs[3]=_,this.uvs[4]=v+f.width/c.width,this.uvs[5]=_+f.height/c.height,this.uvs[6]=v,this.uvs[7]=_+f.height/c.height,v=f.x,_=f.y,this.vertices[0]=v,this.vertices[1]=_,this.vertices[2]=v+f.width,this.vertices[3]=_,this.vertices[4]=v+f.width,this.vertices[5]=_+f.height,this.vertices[6]=v,this.vertices[7]=_+f.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Xn{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=It.NONE,this.sourceFrame=new Jt,this.destinationFrame=new Jt,this.bindingSourceFrame=new Jt,this.bindingDestinationFrame=new Jt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const qi=[new Ye,new Ye,new Ye,new Ye],Mi=new M;class Tn{constructor(c){this.renderer=c,this.defaultFilterStack=[{}],this.texturePool=new bn,this.statePool=[],this.quad=new vo,this.quadUv=new Hn,this.tempRect=new Jt,this.activeState={},this.globalUniforms=new pr({outputFrame:new Jt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(c,f){var ir,Qi,Ii,Ri;const v=this.renderer,_=this.defaultFilterStack,A=this.statePool.pop()||new Xn,R=v.renderTexture;let U,J;if(R.current){const Fi=R.current;U=Fi.resolution,J=Fi.multisample}else U=v.resolution,J=v.multisample;let gt=f[0].resolution||U,Ot=(ir=f[0].multisample)!=null?ir:J,Xt=f[0].padding,re=f[0].autoFit,Re=(Qi=f[0].legacy)!=null?Qi:!0;for(let Fi=1;Fi<f.length;Fi++){const Di=f[Fi];gt=Math.min(gt,Di.resolution||U),Ot=Math.min(Ot,(Ii=Di.multisample)!=null?Ii:J),Xt=this.useMaxPadding?Math.max(Xt,Di.padding):Xt+Di.padding,re=re&&Di.autoFit,Re=Re||((Ri=Di.legacy)!=null?Ri:!0)}_.length===1&&(this.defaultFilterStack[0].renderTexture=R.current),_.push(A),A.resolution=gt,A.multisample=Ot,A.legacy=Re,A.target=c,A.sourceFrame.copyFrom(c.filterArea||c.getBounds(!0)),A.sourceFrame.pad(Xt);const Ze=this.tempRect.copyFrom(R.sourceFrame);v.projection.transform&&this.transformAABB(Mi.copyFrom(v.projection.transform).invert(),Ze),re?(A.sourceFrame.fit(Ze),(A.sourceFrame.width<=0||A.sourceFrame.height<=0)&&(A.sourceFrame.width=0,A.sourceFrame.height=0)):A.sourceFrame.intersects(Ze)||(A.sourceFrame.width=0,A.sourceFrame.height=0),this.roundFrame(A.sourceFrame,R.current?R.current.resolution:v.resolution,R.sourceFrame,R.destinationFrame,v.projection.transform),A.renderTexture=this.getOptimalFilterTexture(A.sourceFrame.width,A.sourceFrame.height,gt,Ot),A.filters=f,A.destinationFrame.width=A.renderTexture.width,A.destinationFrame.height=A.renderTexture.height;const De=this.tempRect;De.x=0,De.y=0,De.width=A.sourceFrame.width,De.height=A.sourceFrame.height,A.renderTexture.filterFrame=A.sourceFrame,A.bindingSourceFrame.copyFrom(R.sourceFrame),A.bindingDestinationFrame.copyFrom(R.destinationFrame),A.transform=v.projection.transform,v.projection.transform=null,R.bind(A.renderTexture,A.sourceFrame,De),v.framebuffer.clear(0,0,0,0)}pop(){const c=this.defaultFilterStack,f=c.pop(),v=f.filters;this.activeState=f;const _=this.globalUniforms.uniforms;_.outputFrame=f.sourceFrame,_.resolution=f.resolution;const A=_.inputSize,R=_.inputPixel,U=_.inputClamp;if(A[0]=f.destinationFrame.width,A[1]=f.destinationFrame.height,A[2]=1/A[0],A[3]=1/A[1],R[0]=Math.round(A[0]*f.resolution),R[1]=Math.round(A[1]*f.resolution),R[2]=1/R[0],R[3]=1/R[1],U[0]=.5*R[2],U[1]=.5*R[3],U[2]=f.sourceFrame.width*A[2]-.5*R[2],U[3]=f.sourceFrame.height*A[3]-.5*R[3],f.legacy){const gt=_.filterArea;gt[0]=f.destinationFrame.width,gt[1]=f.destinationFrame.height,gt[2]=f.sourceFrame.x,gt[3]=f.sourceFrame.y,_.filterClamp=_.inputClamp}this.globalUniforms.update();const J=c[c.length-1];if(this.renderer.framebuffer.blit(),v.length===1)v[0].apply(this,f.renderTexture,J.renderTexture,ft.BLEND,f),this.returnFilterTexture(f.renderTexture);else{let gt=f.renderTexture,Ot=this.getOptimalFilterTexture(gt.width,gt.height,f.resolution);Ot.filterFrame=gt.filterFrame;let Xt=0;for(Xt=0;Xt<v.length-1;++Xt){Xt===1&&f.multisample>1&&(Ot=this.getOptimalFilterTexture(gt.width,gt.height,f.resolution),Ot.filterFrame=gt.filterFrame),v[Xt].apply(this,gt,Ot,ft.CLEAR,f);const re=gt;gt=Ot,Ot=re}v[Xt].apply(this,gt,J.renderTexture,ft.BLEND,f),Xt>1&&f.multisample>1&&this.returnFilterTexture(f.renderTexture),this.returnFilterTexture(gt),this.returnFilterTexture(Ot)}f.clear(),this.statePool.push(f)}bindAndClear(c,f=ft.CLEAR){const{renderTexture:v,state:_}=this.renderer;if(c===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,c==null?void 0:c.filterFrame){const R=this.tempRect;R.x=0,R.y=0,R.width=c.filterFrame.width,R.height=c.filterFrame.height,v.bind(c,c.filterFrame,R)}else c!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?v.bind(c):this.renderer.renderTexture.bind(c,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const A=_.stateId&1||this.forceClear;(f===ft.CLEAR||f===ft.BLIT&&A)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(c,f,v,_){const A=this.renderer;A.state.set(c.state),this.bindAndClear(v,_),c.uniforms.uSampler=f,c.uniforms.filterGlobals=this.globalUniforms,A.shader.bind(c),c.legacy=!!c.program.attributeData.aTextureCoord,c.legacy?(this.quadUv.map(f._frame,f.filterFrame),A.geometry.bind(this.quadUv),A.geometry.draw(Ft.TRIANGLES)):(A.geometry.bind(this.quad),A.geometry.draw(Ft.TRIANGLE_STRIP))}calculateSpriteMatrix(c,f){const{sourceFrame:v,destinationFrame:_}=this.activeState,{orig:A}=f._texture,R=c.set(_.width,0,0,_.height,v.x,v.y),U=f.worldTransform.copyTo(M.TEMP_MATRIX);return U.invert(),R.prepend(U),R.scale(1/A.width,1/A.height),R.translate(f.anchor.x,f.anchor.y),R}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(c,f,v=1,_=It.NONE){return this.texturePool.getOptimalTexture(c,f,v,_)}getFilterTexture(c,f,v){if(typeof c=="number"){const A=c;c=f,f=A}c=c||this.activeState.renderTexture;const _=this.texturePool.getOptimalTexture(c.width,c.height,f||c.resolution,v||It.NONE);return _.filterFrame=c.filterFrame,_}returnFilterTexture(c){this.texturePool.returnTexture(c)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(c,f){const v=qi[0],_=qi[1],A=qi[2],R=qi[3];v.set(f.left,f.top),_.set(f.left,f.bottom),A.set(f.right,f.top),R.set(f.right,f.bottom),c.apply(v,v),c.apply(_,_),c.apply(A,A),c.apply(R,R);const U=Math.min(v.x,_.x,A.x,R.x),J=Math.min(v.y,_.y,A.y,R.y),gt=Math.max(v.x,_.x,A.x,R.x),Ot=Math.max(v.y,_.y,A.y,R.y);f.x=U,f.y=J,f.width=gt-U,f.height=Ot-J}roundFrame(c,f,v,_,A){if(!(c.width<=0||c.height<=0||v.width<=0||v.height<=0)){if(A){const{a:R,b:U,c:J,d:gt}=A;if((Math.abs(U)>1e-4||Math.abs(J)>1e-4)&&(Math.abs(R)>1e-4||Math.abs(gt)>1e-4))return}A=A?Mi.copyFrom(A):Mi.identity(),A.translate(-v.x,-v.y).scale(_.width/v.width,_.height/v.height).translate(_.x,_.y),this.transformAABB(A,c),c.ceil(f),this.transformAABB(A.invert(),c)}}}Tn.extension={type:Fe.RendererSystem,name:"filter"},ze.add(Tn);class yo{constructor(c){this.framebuffer=c,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=It.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const _o=new Jt;class jn{constructor(c){this.renderer=c,this.managedFramebuffers=[],this.unknownFramebuffer=new _n(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const c=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Jt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let f=this.renderer.context.extensions.drawBuffers,v=this.renderer.context.extensions.depthTexture;q.PREFER_ENV===ct.WEBGL_LEGACY&&(f=null,v=null),f?c.drawBuffers=_=>f.drawBuffersWEBGL(_):(this.hasMRT=!1,c.drawBuffers=()=>{}),v||(this.writeDepthTexture=!1)}else this.msaaSamples=c.getInternalformatParameter(c.RENDERBUFFER,c.RGBA8,c.SAMPLES)}bind(c,f,v=0){const{gl:_}=this;if(c){const A=c.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(c);this.current!==c&&(this.current=c,_.bindFramebuffer(_.FRAMEBUFFER,A.framebuffer)),A.mipLevel!==v&&(c.dirtyId++,c.dirtyFormat++,A.mipLevel=v),A.dirtyId!==c.dirtyId&&(A.dirtyId=c.dirtyId,A.dirtyFormat!==c.dirtyFormat?(A.dirtyFormat=c.dirtyFormat,A.dirtySize=c.dirtySize,this.updateFramebuffer(c,v)):A.dirtySize!==c.dirtySize&&(A.dirtySize=c.dirtySize,this.resizeFramebuffer(c)));for(let R=0;R<c.colorTextures.length;R++){const U=c.colorTextures[R];this.renderer.texture.unbind(U.parentTextureArray||U)}if(c.depthTexture&&this.renderer.texture.unbind(c.depthTexture),f){const R=f.width>>v,U=f.height>>v,J=R/f.width;this.setViewport(f.x*J,f.y*J,R,U)}else{const R=c.width>>v,U=c.height>>v;this.setViewport(0,0,R,U)}}else this.current&&(this.current=null,_.bindFramebuffer(_.FRAMEBUFFER,null)),f?this.setViewport(f.x,f.y,f.width,f.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(c,f,v,_){const A=this.viewport;c=Math.round(c),f=Math.round(f),v=Math.round(v),_=Math.round(_),(A.width!==v||A.height!==_||A.x!==c||A.y!==f)&&(A.x=c,A.y=f,A.width=v,A.height=_,this.gl.viewport(c,f,v,_))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(c,f,v,_,A=Lt.COLOR|Lt.DEPTH){const{gl:R}=this;R.clearColor(c,f,v,_),R.clear(A)}initFramebuffer(c){const{gl:f}=this,v=new yo(f.createFramebuffer());return v.multisample=this.detectSamples(c.multisample),c.glFramebuffers[this.CONTEXT_UID]=v,this.managedFramebuffers.push(c),c.disposeRunner.add(this),v}resizeFramebuffer(c){const{gl:f}=this,v=c.glFramebuffers[this.CONTEXT_UID];if(v.stencil){f.bindRenderbuffer(f.RENDERBUFFER,v.stencil);let R;this.renderer.context.webGLVersion===1?R=f.DEPTH_STENCIL:c.depth&&c.stencil?R=f.DEPTH24_STENCIL8:c.depth?R=f.DEPTH_COMPONENT24:R=f.STENCIL_INDEX8,v.msaaBuffer?f.renderbufferStorageMultisample(f.RENDERBUFFER,v.multisample,R,c.width,c.height):f.renderbufferStorage(f.RENDERBUFFER,R,c.width,c.height)}const _=c.colorTextures;let A=_.length;f.drawBuffers||(A=Math.min(A,1));for(let R=0;R<A;R++){const U=_[R],J=U.parentTextureArray||U;this.renderer.texture.bind(J,0),R===0&&v.msaaBuffer&&(f.bindRenderbuffer(f.RENDERBUFFER,v.msaaBuffer),f.renderbufferStorageMultisample(f.RENDERBUFFER,v.multisample,J._glTextures[this.CONTEXT_UID].internalFormat,c.width,c.height))}c.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(c.depthTexture,0)}updateFramebuffer(c,f){const{gl:v}=this,_=c.glFramebuffers[this.CONTEXT_UID],A=c.colorTextures;let R=A.length;v.drawBuffers||(R=Math.min(R,1)),_.multisample>1&&this.canMultisampleFramebuffer(c)?_.msaaBuffer=_.msaaBuffer||v.createRenderbuffer():_.msaaBuffer&&(v.deleteRenderbuffer(_.msaaBuffer),_.msaaBuffer=null,_.blitFramebuffer&&(_.blitFramebuffer.dispose(),_.blitFramebuffer=null));const U=[];for(let J=0;J<R;J++){const gt=A[J],Ot=gt.parentTextureArray||gt;this.renderer.texture.bind(Ot,0),J===0&&_.msaaBuffer?(v.bindRenderbuffer(v.RENDERBUFFER,_.msaaBuffer),v.renderbufferStorageMultisample(v.RENDERBUFFER,_.multisample,Ot._glTextures[this.CONTEXT_UID].internalFormat,c.width,c.height),v.framebufferRenderbuffer(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.RENDERBUFFER,_.msaaBuffer)):(v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0+J,gt.target,Ot._glTextures[this.CONTEXT_UID].texture,f),U.push(v.COLOR_ATTACHMENT0+J))}if(U.length>1&&v.drawBuffers(U),c.depthTexture&&this.writeDepthTexture){const J=c.depthTexture;this.renderer.texture.bind(J,0),v.framebufferTexture2D(v.FRAMEBUFFER,v.DEPTH_ATTACHMENT,v.TEXTURE_2D,J._glTextures[this.CONTEXT_UID].texture,f)}if((c.stencil||c.depth)&&!(c.depthTexture&&this.writeDepthTexture)){_.stencil=_.stencil||v.createRenderbuffer();let J,gt;this.renderer.context.webGLVersion===1?(J=v.DEPTH_STENCIL_ATTACHMENT,gt=v.DEPTH_STENCIL):c.depth&&c.stencil?(J=v.DEPTH_STENCIL_ATTACHMENT,gt=v.DEPTH24_STENCIL8):c.depth?(J=v.DEPTH_ATTACHMENT,gt=v.DEPTH_COMPONENT24):(J=v.STENCIL_ATTACHMENT,gt=v.STENCIL_INDEX8),v.bindRenderbuffer(v.RENDERBUFFER,_.stencil),_.msaaBuffer?v.renderbufferStorageMultisample(v.RENDERBUFFER,_.multisample,gt,c.width,c.height):v.renderbufferStorage(v.RENDERBUFFER,gt,c.width,c.height),v.framebufferRenderbuffer(v.FRAMEBUFFER,J,v.RENDERBUFFER,_.stencil)}else _.stencil&&(v.deleteRenderbuffer(_.stencil),_.stencil=null)}canMultisampleFramebuffer(c){return this.renderer.context.webGLVersion!==1&&c.colorTextures.length<=1&&!c.depthTexture}detectSamples(c){const{msaaSamples:f}=this;let v=It.NONE;if(c<=1||f===null)return v;for(let _=0;_<f.length;_++)if(f[_]<=c){v=f[_];break}return v===1&&(v=It.NONE),v}blit(c,f,v){const{current:_,renderer:A,gl:R,CONTEXT_UID:U}=this;if(A.context.webGLVersion!==2||!_)return;const J=_.glFramebuffers[U];if(!J)return;if(!c){if(!J.msaaBuffer)return;const Ot=_.colorTextures[0];if(!Ot)return;J.blitFramebuffer||(J.blitFramebuffer=new _n(_.width,_.height),J.blitFramebuffer.addColorTexture(0,Ot)),c=J.blitFramebuffer,c.colorTextures[0]!==Ot&&(c.colorTextures[0]=Ot,c.dirtyId++,c.dirtyFormat++),(c.width!==_.width||c.height!==_.height)&&(c.width=_.width,c.height=_.height,c.dirtyId++,c.dirtySize++)}f||(f=_o,f.width=_.width,f.height=_.height),v||(v=f);const gt=f.width===v.width&&f.height===v.height;this.bind(c),R.bindFramebuffer(R.READ_FRAMEBUFFER,J.framebuffer),R.blitFramebuffer(f.left,f.top,f.right,f.bottom,v.left,v.top,v.right,v.bottom,R.COLOR_BUFFER_BIT,gt?R.NEAREST:R.LINEAR),R.bindFramebuffer(R.READ_FRAMEBUFFER,c.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(c,f){const v=c.glFramebuffers[this.CONTEXT_UID],_=this.gl;if(!v)return;delete c.glFramebuffers[this.CONTEXT_UID];const A=this.managedFramebuffers.indexOf(c);A>=0&&this.managedFramebuffers.splice(A,1),c.disposeRunner.remove(this),f||(_.deleteFramebuffer(v.framebuffer),v.msaaBuffer&&_.deleteRenderbuffer(v.msaaBuffer),v.stencil&&_.deleteRenderbuffer(v.stencil)),v.blitFramebuffer&&this.disposeFramebuffer(v.blitFramebuffer,f)}disposeAll(c){const f=this.managedFramebuffers;this.managedFramebuffers=[];for(let v=0;v<f.length;v++)this.disposeFramebuffer(f[v],c)}forceStencil(){const c=this.current;if(!c)return;const f=c.glFramebuffers[this.CONTEXT_UID];if(!f||f.stencil&&c.stencil)return;c.stencil=!0;const v=c.width,_=c.height,A=this.gl,R=f.stencil=A.createRenderbuffer();A.bindRenderbuffer(A.RENDERBUFFER,R);let U,J;this.renderer.context.webGLVersion===1?(U=A.DEPTH_STENCIL_ATTACHMENT,J=A.DEPTH_STENCIL):c.depth?(U=A.DEPTH_STENCIL_ATTACHMENT,J=A.DEPTH24_STENCIL8):(U=A.STENCIL_ATTACHMENT,J=A.STENCIL_INDEX8),f.msaaBuffer?A.renderbufferStorageMultisample(A.RENDERBUFFER,f.multisample,J,v,_):A.renderbufferStorage(A.RENDERBUFFER,J,v,_),A.framebufferRenderbuffer(A.FRAMEBUFFER,U,A.RENDERBUFFER,R)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Jt}destroy(){this.renderer=null}}jn.extension={type:Fe.RendererSystem,name:"framebuffer"},ze.add(jn);const Gs={5126:4,5123:2,5121:1};class Wn{constructor(c){this.renderer=c,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const c=this.gl=this.renderer.gl,f=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,f.webGLVersion!==2){let v=this.renderer.context.extensions.vertexArrayObject;q.PREFER_ENV===ct.WEBGL_LEGACY&&(v=null),v?(c.createVertexArray=()=>v.createVertexArrayOES(),c.bindVertexArray=_=>v.bindVertexArrayOES(_),c.deleteVertexArray=_=>v.deleteVertexArrayOES(_)):(this.hasVao=!1,c.createVertexArray=()=>null,c.bindVertexArray=()=>null,c.deleteVertexArray=()=>null)}if(f.webGLVersion!==2){const v=c.getExtension("ANGLE_instanced_arrays");v?(c.vertexAttribDivisor=(_,A)=>v.vertexAttribDivisorANGLE(_,A),c.drawElementsInstanced=(_,A,R,U,J)=>v.drawElementsInstancedANGLE(_,A,R,U,J),c.drawArraysInstanced=(_,A,R,U)=>v.drawArraysInstancedANGLE(_,A,R,U)):this.hasInstance=!1}this.canUseUInt32ElementIndex=f.webGLVersion===2||!!f.extensions.uint32ElementIndex}bind(c,f){f=f||this.renderer.shader.shader;const{gl:v}=this;let _=c.glVertexArrayObjects[this.CONTEXT_UID],A=!1;_||(this.managedGeometries[c.id]=c,c.disposeRunner.add(this),c.glVertexArrayObjects[this.CONTEXT_UID]=_={},A=!0);const R=_[f.program.id]||this.initGeometryVao(c,f,A);this._activeGeometry=c,this._activeVao!==R&&(this._activeVao=R,this.hasVao?v.bindVertexArray(R):this.activateVao(c,f.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const c=this._activeGeometry,f=this.renderer.buffer;for(let v=0;v<c.buffers.length;v++){const _=c.buffers[v];f.update(_)}}checkCompatibility(c,f){const v=c.attributes,_=f.attributeData;for(const A in _)if(!v[A])throw new Error(`shader and geometry incompatible, geometry missing the "${A}" attribute`)}getSignature(c,f){const v=c.attributes,_=f.attributeData,A=["g",c.id];for(const R in v)_[R]&&A.push(R,_[R].location);return A.join("-")}initGeometryVao(c,f,v=!0){const _=this.gl,A=this.CONTEXT_UID,R=this.renderer.buffer,U=f.program;U.glPrograms[A]||this.renderer.shader.generateProgram(f),this.checkCompatibility(c,U);const J=this.getSignature(c,U),gt=c.glVertexArrayObjects[this.CONTEXT_UID];let Ot=gt[J];if(Ot)return gt[U.id]=Ot,Ot;const Xt=c.buffers,re=c.attributes,Re={},Ze={};for(const De in Xt)Re[De]=0,Ze[De]=0;for(const De in re)!re[De].size&&U.attributeData[De]?re[De].size=U.attributeData[De].size:re[De].size||console.warn(`PIXI Geometry attribute '${De}' size cannot be determined (likely the bound shader does not have the attribute)`),Re[re[De].buffer]+=re[De].size*Gs[re[De].type];for(const De in re){const ir=re[De],Qi=ir.size;ir.stride===void 0&&(Re[ir.buffer]===Qi*Gs[ir.type]?ir.stride=0:ir.stride=Re[ir.buffer]),ir.start===void 0&&(ir.start=Ze[ir.buffer],Ze[ir.buffer]+=Qi*Gs[ir.type])}Ot=_.createVertexArray(),_.bindVertexArray(Ot);for(let De=0;De<Xt.length;De++){const ir=Xt[De];R.bind(ir),v&&ir._glBuffers[A].refCount++}return this.activateVao(c,U),gt[U.id]=Ot,gt[J]=Ot,_.bindVertexArray(null),R.unbind(Et.ARRAY_BUFFER),Ot}disposeGeometry(c,f){var U;if(!this.managedGeometries[c.id])return;delete this.managedGeometries[c.id];const v=c.glVertexArrayObjects[this.CONTEXT_UID],_=this.gl,A=c.buffers,R=(U=this.renderer)==null?void 0:U.buffer;if(c.disposeRunner.remove(this),!!v){if(R)for(let J=0;J<A.length;J++){const gt=A[J]._glBuffers[this.CONTEXT_UID];gt&&(gt.refCount--,gt.refCount===0&&!f&&R.dispose(A[J],f))}if(!f){for(const J in v)if(J[0]==="g"){const gt=v[J];this._activeVao===gt&&this.unbind(),_.deleteVertexArray(gt)}}delete c.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(c){const f=Object.keys(this.managedGeometries);for(let v=0;v<f.length;v++)this.disposeGeometry(this.managedGeometries[f[v]],c)}activateVao(c,f){const v=this.gl,_=this.CONTEXT_UID,A=this.renderer.buffer,R=c.buffers,U=c.attributes;c.indexBuffer&&A.bind(c.indexBuffer);let J=null;for(const gt in U){const Ot=U[gt],Xt=R[Ot.buffer],re=Xt._glBuffers[_];if(f.attributeData[gt]){J!==re&&(A.bind(Xt),J=re);const Re=f.attributeData[gt].location;if(v.enableVertexAttribArray(Re),v.vertexAttribPointer(Re,Ot.size,Ot.type||v.FLOAT,Ot.normalized,Ot.stride,Ot.start),Ot.instance)if(this.hasInstance)v.vertexAttribDivisor(Re,Ot.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(c,f,v,_){const{gl:A}=this,R=this._activeGeometry;if(R.indexBuffer){const U=R.indexBuffer.data.BYTES_PER_ELEMENT,J=U===2?A.UNSIGNED_SHORT:A.UNSIGNED_INT;U===2||U===4&&this.canUseUInt32ElementIndex?R.instanced?A.drawElementsInstanced(c,f||R.indexBuffer.data.length,J,(v||0)*U,_||1):A.drawElements(c,f||R.indexBuffer.data.length,J,(v||0)*U):console.warn("unsupported index buffer type: uint32")}else R.instanced?A.drawArraysInstanced(c,v,f||R.getSize(),_||1):A.drawArrays(c,v,f||R.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Wn.extension={type:Fe.RendererSystem,name:"geometry"},ze.add(Wn);const gs=new M;class wn{constructor(c,f){this._texture=c,this.mapCoord=new M,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof f>"u"?.5:f,this.isSimple=!1}get texture(){return this._texture}set texture(c){this._texture=c,this._textureID=-1}multiplyUvs(c,f){f===void 0&&(f=c);const v=this.mapCoord;for(let _=0;_<c.length;_+=2){const A=c[_],R=c[_+1];f[_]=A*v.a+R*v.c+v.tx,f[_+1]=A*v.b+R*v.d+v.ty}return f}update(c){const f=this._texture;if(!f||!f.valid||!c&&this._textureID===f._updateID)return!1;this._textureID=f._updateID,this._updateID++;const v=f._uvs;this.mapCoord.set(v.x1-v.x0,v.y1-v.y0,v.x3-v.x0,v.y3-v.y0,v.x0,v.y0);const _=f.orig,A=f.trim;A&&(gs.set(_.width/A.width,0,0,_.height/A.height,-A.x/A.width,-A.y/A.height),this.mapCoord.append(gs));const R=f.baseTexture,U=this.uClampFrame,J=this.clampMargin/R.resolution,gt=this.clampOffset;return U[0]=(f._frame.x+J+gt)/R.width,U[1]=(f._frame.y+J+gt)/R.height,U[2]=(f._frame.x+f._frame.width-J+gt)/R.width,U[3]=(f._frame.y+f._frame.height-J+gt)/R.height,this.uClampOffset[0]=gt/R.realWidth,this.uClampOffset[1]=gt/R.realHeight,this.isSimple=f._frame.width===R.width&&f._frame.height===R.height&&f.rotate===0,!0}}var $n=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Yn=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class xo extends hi{constructor(c,f,v){let _=null;typeof c!="string"&&f===void 0&&v===void 0&&(_=c,c=void 0,f=void 0,v=void 0),super(c||Yn,f||$n,v),this.maskSprite=_,this.maskMatrix=new M}get maskSprite(){return this._maskSprite}set maskSprite(c){this._maskSprite=c,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(c,f,v,_){const A=this._maskSprite,R=A._texture;R.valid&&(R.uvMatrix||(R.uvMatrix=new wn(R,0)),R.uvMatrix.update(),this.uniforms.npmAlpha=R.baseTexture.alphaMode?0:1,this.uniforms.mask=R,this.uniforms.otherMatrix=c.calculateSpriteMatrix(this.maskMatrix,A).prepend(R.uvMatrix.mapCoord),this.uniforms.alpha=A.worldAlpha,this.uniforms.maskClamp=R.uvMatrix.uClampFrame,c.applyFilter(this,f,v,_))}}class qn{constructor(c=null){this.type=lt.NONE,this.autoDetect=!0,this.maskObject=c||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=hi.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(c){c?this._filters?this._filters[0]=c:this._filters=[c]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=lt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(c){c?(this._stencilCounter=c._stencilCounter,this._scissorCounter=c._scissorCounter,this._scissorRect=c._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Kn{constructor(c){this.renderer=c,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(c){this.maskStack=c,this.renderer.scissor.setMaskStack(c),this.renderer.stencil.setMaskStack(c)}push(c,f){let v=f;if(!v.isMaskData){const A=this.maskDataPool.pop()||new qn;A.pooled=!0,A.maskObject=f,v=A}const _=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(v.copyCountersOrReset(_),v._colorMask=_?_._colorMask:15,v.autoDetect&&this.detect(v),v._target=c,v.type!==lt.SPRITE&&this.maskStack.push(v),v.enabled)switch(v.type){case lt.SCISSOR:this.renderer.scissor.push(v);break;case lt.STENCIL:this.renderer.stencil.push(v);break;case lt.SPRITE:v.copyCountersOrReset(null),this.pushSpriteMask(v);break;case lt.COLOR:this.pushColorMask(v);break;default:break}v.type===lt.SPRITE&&this.maskStack.push(v)}pop(c){const f=this.maskStack.pop();if(!(!f||f._target!==c)){if(f.enabled)switch(f.type){case lt.SCISSOR:this.renderer.scissor.pop(f);break;case lt.STENCIL:this.renderer.stencil.pop(f.maskObject);break;case lt.SPRITE:this.popSpriteMask(f);break;case lt.COLOR:this.popColorMask(f);break;default:break}if(f.reset(),f.pooled&&this.maskDataPool.push(f),this.maskStack.length!==0){const v=this.maskStack[this.maskStack.length-1];v.type===lt.SPRITE&&v._filters&&(v._filters[0].maskSprite=v.maskObject)}}}detect(c){const f=c.maskObject;f?f.isSprite?c.type=lt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(c)?c.type=lt.SCISSOR:c.type=lt.STENCIL:c.type=lt.COLOR}pushSpriteMask(c){const{maskObject:f}=c,v=c._target;let _=c._filters;_||(_=this.alphaMaskPool[this.alphaMaskIndex],_||(_=this.alphaMaskPool[this.alphaMaskIndex]=[new xo])),_[0].resolution=c.resolution,_[0].multisample=c.multisample,_[0].maskSprite=f;const A=v.filterArea;v.filterArea=f.getBounds(!0),this.renderer.filter.push(v,_),v.filterArea=A,c._filters||this.alphaMaskIndex++}popSpriteMask(c){this.renderer.filter.pop(),c._filters?c._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(c){const f=c._colorMask,v=c._colorMask=f&c.colorMask;v!==f&&this.renderer.gl.colorMask((v&1)!==0,(v&2)!==0,(v&4)!==0,(v&8)!==0)}popColorMask(c){const f=c._colorMask,v=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;v!==f&&this.renderer.gl.colorMask((v&1)!==0,(v&2)!==0,(v&4)!==0,(v&8)!==0)}destroy(){this.renderer=null}}Kn.extension={type:Fe.RendererSystem,name:"mask"},ze.add(Kn);class vs{constructor(c){this.renderer=c,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(c){const{gl:f}=this.renderer,v=this.getStackLength();this.maskStack=c;const _=this.getStackLength();_!==v&&(_===0?f.disable(this.glConst):(f.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const ys=new M,zs=[],Vs=class co extends vs{constructor(c){super(c),this.glConst=q.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const c=this.maskStack[this.maskStack.length-1];return c?c._scissorCounter:0}calcScissorRect(c){var U;if(c._scissorRectLocal)return;const f=c._scissorRect,{maskObject:v}=c,{renderer:_}=this,A=_.renderTexture,R=v.getBounds(!0,(U=zs.pop())!=null?U:new Jt);this.roundFrameToPixels(R,A.current?A.current.resolution:_.resolution,A.sourceFrame,A.destinationFrame,_.projection.transform),f&&R.fit(f),c._scissorRectLocal=R}static isMatrixRotated(c){if(!c)return!1;const{a:f,b:v,c:_,d:A}=c;return(Math.abs(v)>1e-4||Math.abs(_)>1e-4)&&(Math.abs(f)>1e-4||Math.abs(A)>1e-4)}testScissor(c){const{maskObject:f}=c;if(!f.isFastRect||!f.isFastRect()||co.isMatrixRotated(f.worldTransform)||co.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(c);const v=c._scissorRectLocal;return v.width>0&&v.height>0}roundFrameToPixels(c,f,v,_,A){co.isMatrixRotated(A)||(A=A?ys.copyFrom(A):ys.identity(),A.translate(-v.x,-v.y).scale(_.width/v.width,_.height/v.height).translate(_.x,_.y),this.renderer.filter.transformAABB(A,c),c.fit(_),c.x=Math.round(c.x*f),c.y=Math.round(c.y*f),c.width=Math.round(c.width*f),c.height=Math.round(c.height*f))}push(c){c._scissorRectLocal||this.calcScissorRect(c);const{gl:f}=this.renderer;c._scissorRect||f.enable(f.SCISSOR_TEST),c._scissorCounter++,c._scissorRect=c._scissorRectLocal,this._useCurrent()}pop(c){const{gl:f}=this.renderer;c&&zs.push(c._scissorRectLocal),this.getStackLength()>0?this._useCurrent():f.disable(f.SCISSOR_TEST)}_useCurrent(){const c=this.maskStack[this.maskStack.length-1]._scissorRect;let f;this.renderer.renderTexture.current?f=c.y:f=this.renderer.height-c.height-c.y,this.renderer.gl.scissor(c.x,f,c.width,c.height)}};Vs.extension={type:Fe.RendererSystem,name:"scissor"};let An=Vs;ze.add(An);class Zn extends vs{constructor(c){super(c),this.glConst=q.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const c=this.maskStack[this.maskStack.length-1];return c?c._stencilCounter:0}push(c){const f=c.maskObject,{gl:v}=this.renderer,_=c._stencilCounter;_===0&&(this.renderer.framebuffer.forceStencil(),v.clearStencil(0),v.clear(v.STENCIL_BUFFER_BIT),v.enable(v.STENCIL_TEST)),c._stencilCounter++;const A=c._colorMask;A!==0&&(c._colorMask=0,v.colorMask(!1,!1,!1,!1)),v.stencilFunc(v.EQUAL,_,4294967295),v.stencilOp(v.KEEP,v.KEEP,v.INCR),f.renderable=!0,f.render(this.renderer),this.renderer.batch.flush(),f.renderable=!1,A!==0&&(c._colorMask=A,v.colorMask((A&1)!==0,(A&2)!==0,(A&4)!==0,(A&8)!==0)),this._useCurrent()}pop(c){const f=this.renderer.gl;if(this.getStackLength()===0)f.disable(f.STENCIL_TEST);else{const v=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,_=v?v._colorMask:15;_!==0&&(v._colorMask=0,f.colorMask(!1,!1,!1,!1)),f.stencilOp(f.KEEP,f.KEEP,f.DECR),c.renderable=!0,c.render(this.renderer),this.renderer.batch.flush(),c.renderable=!1,_!==0&&(v._colorMask=_,f.colorMask((_&1)!==0,(_&2)!==0,(_&4)!==0,(_&8)!==0)),this._useCurrent()}}_useCurrent(){const c=this.renderer.gl;c.stencilFunc(c.EQUAL,this.getStackLength(),4294967295),c.stencilOp(c.KEEP,c.KEEP,c.KEEP)}}Zn.extension={type:Fe.RendererSystem,name:"stencil"},ze.add(Zn);class Qn{constructor(c){this.renderer=c,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return te("7.0.0","renderer.plugins.extract has moved to renderer.extract"),c.extract}},prepare:{enumerable:!1,get(){return te("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),c.prepare}},interaction:{enumerable:!1,get(){return te("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),c.events}}})}init(){const c=this.rendererPlugins;for(const f in c)this.plugins[f]=new c[f](this.renderer)}destroy(){for(const c in this.plugins)this.plugins[c].destroy(),this.plugins[c]=null}}Qn.extension={type:[Fe.RendererSystem,Fe.CanvasRendererSystem],name:"_plugin"},ze.add(Qn);class Jn{constructor(c){this.renderer=c,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new M,this.transform=null}update(c,f,v,_){this.destinationFrame=c||this.destinationFrame||this.defaultFrame,this.sourceFrame=f||this.sourceFrame||c,this.calculateProjection(this.destinationFrame,this.sourceFrame,v,_),this.transform&&this.projectionMatrix.append(this.transform);const A=this.renderer;A.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,A.globalUniforms.update(),A.shader.shader&&A.shader.syncUniformGroup(A.shader.shader.uniforms.globals)}calculateProjection(c,f,v,_){const A=this.projectionMatrix,R=_?-1:1;A.identity(),A.a=1/f.width*2,A.d=R*(1/f.height*2),A.tx=-1-f.x*A.a,A.ty=-R-f.y*A.d}setTransform(c){}destroy(){this.renderer=null}}Jn.extension={type:Fe.RendererSystem,name:"projection"},ze.add(Jn);const to=new Br,eo=new Jt;class _s{constructor(c){this.renderer=c,this._tempMatrix=new M}generateTexture(c,f){var Ot;const gt=f||{},{region:v}=gt,_=wo(gt,["region"]),A=(v==null?void 0:v.copyTo(eo))||c.getLocalBounds(eo,!0),R=_.resolution||this.renderer.resolution;A.width=Math.max(A.width,1/R),A.height=Math.max(A.height,1/R),_.width=A.width,_.height=A.height,_.resolution=R,(Ot=_.multisample)!=null||(_.multisample=this.renderer.multisample);const U=Pi.create(_);this._tempMatrix.tx=-A.x,this._tempMatrix.ty=-A.y;const J=c.transform;return c.transform=to,this.renderer.render(c,{renderTexture:U,transform:this._tempMatrix,skipUpdateTransform:!!c.parent,blit:!0}),c.transform=J,U}destroy(){}}_s.extension={type:[Fe.RendererSystem,Fe.CanvasRendererSystem],name:"textureGenerator"},ze.add(_s);const Pr=new Jt,Or=new Jt;class ro{constructor(c){this.renderer=c,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Jt,this.destinationFrame=new Jt,this.viewportFrame=new Jt}contextChange(){var f;const c=(f=this.renderer)==null?void 0:f.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(c&&c.alpha&&c.premultipliedAlpha)}bind(c=null,f,v){const _=this.renderer;this.current=c;let A,R,U;c?(A=c.baseTexture,U=A.resolution,f||(Pr.width=c.frame.width,Pr.height=c.frame.height,f=Pr),v||(Or.x=c.frame.x,Or.y=c.frame.y,Or.width=f.width,Or.height=f.height,v=Or),R=A.framebuffer):(U=_.resolution,f||(Pr.width=_._view.screen.width,Pr.height=_._view.screen.height,f=Pr),v||(v=Pr,v.width=f.width,v.height=f.height));const J=this.viewportFrame;J.x=v.x*U,J.y=v.y*U,J.width=v.width*U,J.height=v.height*U,c||(J.y=_.view.height-(J.y+J.height)),J.ceil(),this.renderer.framebuffer.bind(R,J),this.renderer.projection.update(v,f,U,!R),c?this.renderer.mask.setMaskStack(A.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(f),this.destinationFrame.copyFrom(v)}clear(c,f){const v=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,_=gr.shared.setValue(c||v);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&_.premultiply(_.alpha);const A=this.destinationFrame,R=this.current?this.current.baseTexture:this.renderer._view.screen,U=A.width!==R.width||A.height!==R.height;if(U){let{x:J,y:gt,width:Ot,height:Xt}=this.viewportFrame;J=Math.round(J),gt=Math.round(gt),Ot=Math.round(Ot),Xt=Math.round(Xt),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(J,gt,Ot,Xt)}this.renderer.framebuffer.clear(_.red,_.green,_.blue,_.alpha,f),U&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}ro.extension={type:Fe.RendererSystem,name:"renderTexture"},ze.add(ro);class Ro{}class io{constructor(c,f){this.program=c,this.uniformData=f,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function En(p,c,f){const v=p.createShader(c);return p.shaderSource(v,f),p.compileShader(v),v}function Hs(p){const c=new Array(p);for(let f=0;f<c.length;f++)c[f]=!1;return c}function so(p,c){switch(p){case"float":return 0;case"vec2":return new Float32Array(2*c);case"vec3":return new Float32Array(3*c);case"vec4":return new Float32Array(4*c);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*c);case"ivec3":return new Int32Array(3*c);case"ivec4":return new Int32Array(4*c);case"uvec2":return new Uint32Array(2*c);case"uvec3":return new Uint32Array(3*c);case"uvec4":return new Uint32Array(4*c);case"bool":return!1;case"bvec2":return Hs(2*c);case"bvec3":return Hs(3*c);case"bvec4":return Hs(4*c);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function Fo(p,c){const f={},v=c.getProgramParameter(p,c.ACTIVE_ATTRIBUTES);for(let _=0;_<v;_++){const A=c.getActiveAttrib(p,_);if(A.name.startsWith("gl_"))continue;const R=Bs(c,A.type),U={type:R,name:A.name,size:fs(R),location:c.getAttribLocation(p,A.name)};f[A.name]=U}return f}function bo(p,c){const f={},v=c.getProgramParameter(p,c.ACTIVE_UNIFORMS);for(let _=0;_<v;_++){const A=c.getActiveUniform(p,_),R=A.name.replace(/\[.*?\]$/,""),U=!!A.name.match(/\[.*?\]$/),J=Bs(c,A.type);f[R]={name:R,index:_,type:J,size:A.size,isArray:U,value:so(J,A.size)}}return f}function no(p,c){const f=p.getShaderSource(c).split(`
`).map((gt,Ot)=>`${Ot}: ${gt}`),v=p.getShaderInfoLog(c),_=v.split(`
`),A={},R=_.map(gt=>parseFloat(gt.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(gt=>gt&&!A[gt]?(A[gt]=!0,!0):!1),U=[""];R.forEach(gt=>{f[gt-1]=`%c${f[gt-1]}%c`,U.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const J=f.join(`
`);U[0]=J,console.error(v),console.groupCollapsed("click to view full shader code"),console.warn(...U),console.groupEnd()}function Sn(p,c,f,v){p.getProgramParameter(c,p.LINK_STATUS)||(p.getShaderParameter(f,p.COMPILE_STATUS)||no(p,f),p.getShaderParameter(v,p.COMPILE_STATUS)||no(p,v),console.error("PixiJS Error: Could not initialize shader."),p.getProgramInfoLog(c)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",p.getProgramInfoLog(c)))}function Cn(p,c){var U;const f=En(p,p.VERTEX_SHADER,c.vertexSrc),v=En(p,p.FRAGMENT_SHADER,c.fragmentSrc),_=p.createProgram();p.attachShader(_,f),p.attachShader(_,v);const A=(U=c.extra)==null?void 0:U.transformFeedbackVaryings;if(A&&(typeof p.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):p.transformFeedbackVaryings(_,A.names,A.bufferMode==="separate"?p.SEPARATE_ATTRIBS:p.INTERLEAVED_ATTRIBS)),p.linkProgram(_),p.getProgramParameter(_,p.LINK_STATUS)||Sn(p,_,f,v),c.attributeData=Fo(_,p),c.uniformData=bo(_,p),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(c.vertexSrc)){const J=Object.keys(c.attributeData);J.sort((gt,Ot)=>gt>Ot?1:-1);for(let gt=0;gt<J.length;gt++)c.attributeData[J[gt]].location=gt,p.bindAttribLocation(_,gt,J[gt]);p.linkProgram(_)}p.deleteShader(f),p.deleteShader(v);const R={};for(const J in c.uniformData){const gt=c.uniformData[J];R[J]={location:p.getUniformLocation(_,J),value:so(gt.type,gt.size)}}return new io(_,R)}function Xs(p,c,f,v,_){f.buffer.update(_)}const Do={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},No={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function jo(p){const c=p.map(A=>({data:A,offset:0,dataLen:0,dirty:0}));let f=0,v=0,_=0;for(let A=0;A<c.length;A++){const R=c[A];if(f=No[R.data.type],R.data.size>1&&(f=Math.max(f,16)*R.data.size),R.dataLen=f,v%f!==0&&v<16){const U=v%f%16;v+=U,_+=U}v+f>16?(_=Math.ceil(_/16)*16,R.offset=_,_+=f,v=f):(R.offset=_,v+=f,_+=f)}return _=Math.ceil(_/16)*16,{uboElements:c,size:_}}function Wo(p,c){const f=[];for(const v in p)c[v]&&f.push(c[v]);return f.sort((v,_)=>v.index-_.index),f}function $o(p,c){if(!p.autoManage)return{size:0,syncFunc:Xs};const f=Wo(p.uniforms,c),{uboElements:v,size:_}=jo(f),A=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let R=0;R<v.length;R++){const U=v[R],J=p.uniforms[U.data.name],gt=U.data.name;let Ot=!1;for(let Xt=0;Xt<Vr.length;Xt++){const re=Vr[Xt];if(re.codeUbo&&re.test(U.data,J)){A.push(`offset = ${U.offset/4};`,Vr[Xt].codeUbo(U.data.name,J)),Ot=!0;break}}if(!Ot)if(U.data.size>1){const Xt=fs(U.data.type),re=Math.max(No[U.data.type]/16,1),Re=Xt/re,Ze=(4-Re%4)%4;A.push(`
                cv = ud.${gt}.value;
                v = uv.${gt};
                offset = ${U.offset/4};

                t = 0;

                for(var i=0; i < ${U.data.size*re}; i++)
                {
                    for(var j = 0; j < ${Re}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${Ze};
                }

                `)}else{const Xt=Do[U.data.type];A.push(`
                cv = ud.${gt}.value;
                v = uv.${gt};
                offset = ${U.offset/4};
                ${Xt};
                `)}}return A.push(`
       renderer.buffer.update(buffer);
    `),{size:_,syncFunc:new Function("ud","uv","renderer","syncData","buffer",A.join(`
`))}}let Pn;function Yo(){if(typeof Pn=="boolean")return Pn;try{Pn=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch(p){Pn=!1}return Pn}let qo=0;const oo={textureCount:0,uboCount:0};class Bo{constructor(c){this.destroyed=!1,this.renderer=c,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=qo++}systemCheck(){if(!Yo())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(c){this.gl=c,this.reset()}bind(c,f){c.disposeRunner.add(this),c.uniforms.globals=this.renderer.globalUniforms;const v=c.program,_=v.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(c);return this.shader=c,this.program!==v&&(this.program=v,this.gl.useProgram(_.program)),f||(oo.textureCount=0,oo.uboCount=0,this.syncUniformGroup(c.uniformGroup,oo)),_}setUniforms(c){const f=this.shader.program,v=f.glPrograms[this.renderer.CONTEXT_UID];f.syncUniforms(v.uniformData,c,this.renderer)}syncUniformGroup(c,f){const v=this.getGlProgram();(!c.static||c.dirtyId!==v.uniformDirtyGroups[c.id])&&(v.uniformDirtyGroups[c.id]=c.dirtyId,this.syncUniforms(c,v,f))}syncUniforms(c,f,v){(c.syncUniforms[this.shader.program.id]||this.createSyncGroups(c))(f.uniformData,c.uniforms,this.renderer,v)}createSyncGroups(c){const f=this.getSignature(c,this.shader.program.uniformData,"u");return this.cache[f]||(this.cache[f]=ds(c,this.shader.program.uniformData)),c.syncUniforms[this.shader.program.id]=this.cache[f],c.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(c,f){const v=this.getGlProgram();if(!c.static||c.dirtyId!==0||!v.uniformGroups[c.id]){c.dirtyId=0;const _=v.uniformGroups[c.id]||this.createSyncBufferGroup(c,v,f);c.buffer.update(),_(v.uniformData,c.uniforms,this.renderer,oo,c.buffer)}this.renderer.buffer.bindBufferBase(c.buffer,v.uniformBufferBindings[f])}createSyncBufferGroup(c,f,v){const{gl:_}=this.renderer;this.renderer.buffer.bind(c.buffer);const A=this.gl.getUniformBlockIndex(f.program,v);f.uniformBufferBindings[v]=this.shader.uniformBindCount,_.uniformBlockBinding(f.program,A,this.shader.uniformBindCount),this.shader.uniformBindCount++;const R=this.getSignature(c,this.shader.program.uniformData,"ubo");let U=this._uboCache[R];if(U||(U=this._uboCache[R]=$o(c,this.shader.program.uniformData)),c.autoManage){const J=new Float32Array(U.size/4);c.buffer.update(J)}return f.uniformGroups[c.id]=U.syncFunc,f.uniformGroups[c.id]}getSignature(c,f,v){const _=c.uniforms,A=[`${v}-`];for(const R in _)A.push(R),f[R]&&A.push(f[R].type);return A.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(c){const f=this.gl,v=c.program,_=Cn(f,v);return v.glPrograms[this.renderer.CONTEXT_UID]=_,_}reset(){this.program=null,this.shader=null}disposeShader(c){this.shader===c&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Bo.extension={type:Fe.RendererSystem,name:"shader"},ze.add(Bo);class ao{constructor(c){this.renderer=c}run(c){const{renderer:f}=this;f.runners.init.emit(f.options),c.hello&&console.log(`PixiJS 7.3.2 - ${f.rendererLogId} - https://pixijs.com`),f.resize(f.screen.width,f.screen.height)}destroy(){}}ao.defaultOptions={hello:!1},ao.extension={type:[Fe.RendererSystem,Fe.CanvasRendererSystem],name:"startup"},ze.add(ao);function C(p,c=[]){return c[vt.NORMAL]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.ADD]=[p.ONE,p.ONE],c[vt.MULTIPLY]=[p.DST_COLOR,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.SCREEN]=[p.ONE,p.ONE_MINUS_SRC_COLOR,p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.OVERLAY]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.DARKEN]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.LIGHTEN]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.COLOR_DODGE]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.COLOR_BURN]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.HARD_LIGHT]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.SOFT_LIGHT]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.DIFFERENCE]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.EXCLUSION]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.HUE]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.SATURATION]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.COLOR]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.LUMINOSITY]=[p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.NONE]=[0,0],c[vt.NORMAL_NPM]=[p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.ADD_NPM]=[p.SRC_ALPHA,p.ONE,p.ONE,p.ONE],c[vt.SCREEN_NPM]=[p.SRC_ALPHA,p.ONE_MINUS_SRC_COLOR,p.ONE,p.ONE_MINUS_SRC_ALPHA],c[vt.SRC_IN]=[p.DST_ALPHA,p.ZERO],c[vt.SRC_OUT]=[p.ONE_MINUS_DST_ALPHA,p.ZERO],c[vt.SRC_ATOP]=[p.DST_ALPHA,p.ONE_MINUS_SRC_ALPHA],c[vt.DST_OVER]=[p.ONE_MINUS_DST_ALPHA,p.ONE],c[vt.DST_IN]=[p.ZERO,p.SRC_ALPHA],c[vt.DST_OUT]=[p.ZERO,p.ONE_MINUS_SRC_ALPHA],c[vt.DST_ATOP]=[p.ONE_MINUS_DST_ALPHA,p.SRC_ALPHA],c[vt.XOR]=[p.ONE_MINUS_DST_ALPHA,p.ONE_MINUS_SRC_ALPHA],c[vt.SUBTRACT]=[p.ONE,p.ONE,p.ONE,p.ONE,p.FUNC_REVERSE_SUBTRACT,p.FUNC_ADD],c}const u=0,d=1,g=2,y=3,T=4,E=5,P=class Ao{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=vt.NONE,this._blendEq=!1,this.map=[],this.map[u]=this.setBlend,this.map[d]=this.setOffset,this.map[g]=this.setCullFace,this.map[y]=this.setDepthTest,this.map[T]=this.setFrontFace,this.map[E]=this.setDepthMask,this.checks=[],this.defaultState=new ri,this.defaultState.blend=!0}contextChange(c){this.gl=c,this.blendModes=C(c),this.set(this.defaultState),this.reset()}set(c){if(c=c||this.defaultState,this.stateId!==c.data){let f=this.stateId^c.data,v=0;for(;f;)f&1&&this.map[v].call(this,!!(c.data&1<<v)),f=f>>1,v++;this.stateId=c.data}for(let f=0;f<this.checks.length;f++)this.checks[f](this,c)}forceState(c){c=c||this.defaultState;for(let f=0;f<this.map.length;f++)this.map[f].call(this,!!(c.data&1<<f));for(let f=0;f<this.checks.length;f++)this.checks[f](this,c);this.stateId=c.data}setBlend(c){this.updateCheck(Ao.checkBlendMode,c),this.gl[c?"enable":"disable"](this.gl.BLEND)}setOffset(c){this.updateCheck(Ao.checkPolygonOffset,c),this.gl[c?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(c){this.gl[c?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(c){this.gl.depthMask(c)}setCullFace(c){this.gl[c?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(c){this.gl.frontFace(this.gl[c?"CW":"CCW"])}setBlendMode(c){if(c===this.blendMode)return;this.blendMode=c;const f=this.blendModes[c],v=this.gl;f.length===2?v.blendFunc(f[0],f[1]):v.blendFuncSeparate(f[0],f[1],f[2],f[3]),f.length===6?(this._blendEq=!0,v.blendEquationSeparate(f[4],f[5])):this._blendEq&&(this._blendEq=!1,v.blendEquationSeparate(v.FUNC_ADD,v.FUNC_ADD))}setPolygonOffset(c,f){this.gl.polygonOffset(c,f)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(c,f){const v=this.checks.indexOf(c);f&&v===-1?this.checks.push(c):!f&&v!==-1&&this.checks.splice(v,1)}static checkBlendMode(c,f){c.setBlendMode(f.blendMode)}static checkPolygonOffset(c,f){c.setPolygonOffset(1,f.polygonOffset)}destroy(){this.gl=null}};P.extension={type:Fe.RendererSystem,name:"state"};let D=P;ze.add(D);class B extends le{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(c){var _;this.addRunners(...c.runners);const f=((_=c.priority)!=null?_:[]).filter(A=>c.systems[A]),v=[...f,...Object.keys(c.systems).filter(A=>!f.includes(A))];for(const A of v)this.addSystem(c.systems[A],A)}addRunners(...c){c.forEach(f=>{this.runners[f]=new er(f)})}addSystem(c,f){const v=new c(this);if(this[f])throw new Error(`Whoops! The name "${f}" is already in use`);this[f]=v,this._systemsHash[f]=v;for(const _ in this.runners)this.runners[_].add(v);return this}emitWithCustomOptions(c,f){const v=Object.keys(this._systemsHash);c.items.forEach(_=>{const A=v.find(R=>this._systemsHash[R]===_);_[c.name](f[A])})}destroy(){Object.values(this.runners).forEach(c=>{c.destroy()}),this._systemsHash={}}}const G=class fo{constructor(c){this.renderer=c,this.count=0,this.checkCount=0,this.maxIdle=fo.defaultMaxIdle,this.checkCountMax=fo.defaultCheckCountMax,this.mode=fo.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==yt.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const c=this.renderer.texture,f=c.managedTextures;let v=!1;for(let _=0;_<f.length;_++){const A=f[_];A.resource&&this.count-A.touched>this.maxIdle&&(c.destroyTexture(A,!0),f[_]=null,v=!0)}if(v){let _=0;for(let A=0;A<f.length;A++)f[A]!==null&&(f[_++]=f[A]);f.length=_}}unload(c){const f=this.renderer.texture,v=c._texture;v&&!v.framebuffer&&f.destroyTexture(v);for(let _=c.children.length-1;_>=0;_--)this.unload(c.children[_])}destroy(){this.renderer=null}};G.defaultMode=yt.AUTO,G.defaultMaxIdle=3600,G.defaultCheckCountMax=600,G.extension={type:Fe.RendererSystem,name:"textureGC"};let X=G;ze.add(X);class W{constructor(c){this.texture=c,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=at.UNSIGNED_BYTE,this.internalFormat=nt.RGBA,this.samplerType=0}}function j(p){let c;return"WebGL2RenderingContext"in globalThis&&p instanceof globalThis.WebGL2RenderingContext?c={[p.RGB]:L.FLOAT,[p.RGBA]:L.FLOAT,[p.ALPHA]:L.FLOAT,[p.LUMINANCE]:L.FLOAT,[p.LUMINANCE_ALPHA]:L.FLOAT,[p.R8]:L.FLOAT,[p.R8_SNORM]:L.FLOAT,[p.RG8]:L.FLOAT,[p.RG8_SNORM]:L.FLOAT,[p.RGB8]:L.FLOAT,[p.RGB8_SNORM]:L.FLOAT,[p.RGB565]:L.FLOAT,[p.RGBA4]:L.FLOAT,[p.RGB5_A1]:L.FLOAT,[p.RGBA8]:L.FLOAT,[p.RGBA8_SNORM]:L.FLOAT,[p.RGB10_A2]:L.FLOAT,[p.RGB10_A2UI]:L.FLOAT,[p.SRGB8]:L.FLOAT,[p.SRGB8_ALPHA8]:L.FLOAT,[p.R16F]:L.FLOAT,[p.RG16F]:L.FLOAT,[p.RGB16F]:L.FLOAT,[p.RGBA16F]:L.FLOAT,[p.R32F]:L.FLOAT,[p.RG32F]:L.FLOAT,[p.RGB32F]:L.FLOAT,[p.RGBA32F]:L.FLOAT,[p.R11F_G11F_B10F]:L.FLOAT,[p.RGB9_E5]:L.FLOAT,[p.R8I]:L.INT,[p.R8UI]:L.UINT,[p.R16I]:L.INT,[p.R16UI]:L.UINT,[p.R32I]:L.INT,[p.R32UI]:L.UINT,[p.RG8I]:L.INT,[p.RG8UI]:L.UINT,[p.RG16I]:L.INT,[p.RG16UI]:L.UINT,[p.RG32I]:L.INT,[p.RG32UI]:L.UINT,[p.RGB8I]:L.INT,[p.RGB8UI]:L.UINT,[p.RGB16I]:L.INT,[p.RGB16UI]:L.UINT,[p.RGB32I]:L.INT,[p.RGB32UI]:L.UINT,[p.RGBA8I]:L.INT,[p.RGBA8UI]:L.UINT,[p.RGBA16I]:L.INT,[p.RGBA16UI]:L.UINT,[p.RGBA32I]:L.INT,[p.RGBA32UI]:L.UINT,[p.DEPTH_COMPONENT16]:L.FLOAT,[p.DEPTH_COMPONENT24]:L.FLOAT,[p.DEPTH_COMPONENT32F]:L.FLOAT,[p.DEPTH_STENCIL]:L.FLOAT,[p.DEPTH24_STENCIL8]:L.FLOAT,[p.DEPTH32F_STENCIL8]:L.FLOAT}:c={[p.RGB]:L.FLOAT,[p.RGBA]:L.FLOAT,[p.ALPHA]:L.FLOAT,[p.LUMINANCE]:L.FLOAT,[p.LUMINANCE_ALPHA]:L.FLOAT,[p.DEPTH_STENCIL]:L.FLOAT},c}function et(p){let c;return"WebGL2RenderingContext"in globalThis&&p instanceof globalThis.WebGL2RenderingContext?c={[at.UNSIGNED_BYTE]:{[nt.RGBA]:p.RGBA8,[nt.RGB]:p.RGB8,[nt.RG]:p.RG8,[nt.RED]:p.R8,[nt.RGBA_INTEGER]:p.RGBA8UI,[nt.RGB_INTEGER]:p.RGB8UI,[nt.RG_INTEGER]:p.RG8UI,[nt.RED_INTEGER]:p.R8UI,[nt.ALPHA]:p.ALPHA,[nt.LUMINANCE]:p.LUMINANCE,[nt.LUMINANCE_ALPHA]:p.LUMINANCE_ALPHA},[at.BYTE]:{[nt.RGBA]:p.RGBA8_SNORM,[nt.RGB]:p.RGB8_SNORM,[nt.RG]:p.RG8_SNORM,[nt.RED]:p.R8_SNORM,[nt.RGBA_INTEGER]:p.RGBA8I,[nt.RGB_INTEGER]:p.RGB8I,[nt.RG_INTEGER]:p.RG8I,[nt.RED_INTEGER]:p.R8I},[at.UNSIGNED_SHORT]:{[nt.RGBA_INTEGER]:p.RGBA16UI,[nt.RGB_INTEGER]:p.RGB16UI,[nt.RG_INTEGER]:p.RG16UI,[nt.RED_INTEGER]:p.R16UI,[nt.DEPTH_COMPONENT]:p.DEPTH_COMPONENT16},[at.SHORT]:{[nt.RGBA_INTEGER]:p.RGBA16I,[nt.RGB_INTEGER]:p.RGB16I,[nt.RG_INTEGER]:p.RG16I,[nt.RED_INTEGER]:p.R16I},[at.UNSIGNED_INT]:{[nt.RGBA_INTEGER]:p.RGBA32UI,[nt.RGB_INTEGER]:p.RGB32UI,[nt.RG_INTEGER]:p.RG32UI,[nt.RED_INTEGER]:p.R32UI,[nt.DEPTH_COMPONENT]:p.DEPTH_COMPONENT24},[at.INT]:{[nt.RGBA_INTEGER]:p.RGBA32I,[nt.RGB_INTEGER]:p.RGB32I,[nt.RG_INTEGER]:p.RG32I,[nt.RED_INTEGER]:p.R32I},[at.FLOAT]:{[nt.RGBA]:p.RGBA32F,[nt.RGB]:p.RGB32F,[nt.RG]:p.RG32F,[nt.RED]:p.R32F,[nt.DEPTH_COMPONENT]:p.DEPTH_COMPONENT32F},[at.HALF_FLOAT]:{[nt.RGBA]:p.RGBA16F,[nt.RGB]:p.RGB16F,[nt.RG]:p.RG16F,[nt.RED]:p.R16F},[at.UNSIGNED_SHORT_5_6_5]:{[nt.RGB]:p.RGB565},[at.UNSIGNED_SHORT_4_4_4_4]:{[nt.RGBA]:p.RGBA4},[at.UNSIGNED_SHORT_5_5_5_1]:{[nt.RGBA]:p.RGB5_A1},[at.UNSIGNED_INT_2_10_10_10_REV]:{[nt.RGBA]:p.RGB10_A2,[nt.RGBA_INTEGER]:p.RGB10_A2UI},[at.UNSIGNED_INT_10F_11F_11F_REV]:{[nt.RGB]:p.R11F_G11F_B10F},[at.UNSIGNED_INT_5_9_9_9_REV]:{[nt.RGB]:p.RGB9_E5},[at.UNSIGNED_INT_24_8]:{[nt.DEPTH_STENCIL]:p.DEPTH24_STENCIL8},[at.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[nt.DEPTH_STENCIL]:p.DEPTH32F_STENCIL8}}:c={[at.UNSIGNED_BYTE]:{[nt.RGBA]:p.RGBA,[nt.RGB]:p.RGB,[nt.ALPHA]:p.ALPHA,[nt.LUMINANCE]:p.LUMINANCE,[nt.LUMINANCE_ALPHA]:p.LUMINANCE_ALPHA},[at.UNSIGNED_SHORT_5_6_5]:{[nt.RGB]:p.RGB},[at.UNSIGNED_SHORT_4_4_4_4]:{[nt.RGBA]:p.RGBA},[at.UNSIGNED_SHORT_5_5_5_1]:{[nt.RGBA]:p.RGBA}},c}class ht{constructor(c){this.renderer=c,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Ve,this.hasIntegerTextures=!1}contextChange(){const c=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=et(c),this.samplerTypes=j(c);const f=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=f;for(let _=0;_<f;_++)this.boundTextures[_]=null;this.emptyTextures={};const v=new W(c.createTexture());c.bindTexture(c.TEXTURE_2D,v.texture),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[c.TEXTURE_2D]=v,this.emptyTextures[c.TEXTURE_CUBE_MAP]=new W(c.createTexture()),c.bindTexture(c.TEXTURE_CUBE_MAP,this.emptyTextures[c.TEXTURE_CUBE_MAP].texture);for(let _=0;_<6;_++)c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+_,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,null);c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_MIN_FILTER,c.LINEAR);for(let _=0;_<this.boundTextures.length;_++)this.bind(null,_)}bind(c,f=0){const{gl:v}=this;if(c=c==null?void 0:c.castToBaseTexture(),(c==null?void 0:c.valid)&&!c.parentTextureArray){c.touched=this.renderer.textureGC.count;const _=c._glTextures[this.CONTEXT_UID]||this.initTexture(c);this.boundTextures[f]!==c&&(this.currentLocation!==f&&(this.currentLocation=f,v.activeTexture(v.TEXTURE0+f)),v.bindTexture(c.target,_.texture)),_.dirtyId!==c.dirtyId?(this.currentLocation!==f&&(this.currentLocation=f,v.activeTexture(v.TEXTURE0+f)),this.updateTexture(c)):_.dirtyStyleId!==c.dirtyStyleId&&this.updateTextureStyle(c),this.boundTextures[f]=c}else this.currentLocation!==f&&(this.currentLocation=f,v.activeTexture(v.TEXTURE0+f)),v.bindTexture(v.TEXTURE_2D,this.emptyTextures[v.TEXTURE_2D].texture),this.boundTextures[f]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let c=0;c<this.boundTextures.length;c++)this.boundTextures[c]=this.unknownTexture}unbind(c){const{gl:f,boundTextures:v}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let _=0;_<v.length;_++)v[_]===this.unknownTexture&&this.bind(null,_)}for(let _=0;_<v.length;_++)v[_]===c&&(this.currentLocation!==_&&(f.activeTexture(f.TEXTURE0+_),this.currentLocation=_),f.bindTexture(c.target,this.emptyTextures[c.target].texture),v[_]=null)}ensureSamplerType(c){const{boundTextures:f,hasIntegerTextures:v,CONTEXT_UID:_}=this;if(v)for(let A=c-1;A>=0;--A){const R=f[A];R&&R._glTextures[_].samplerType!==L.FLOAT&&this.renderer.texture.unbind(R)}}initTexture(c){const f=new W(this.gl.createTexture());return f.dirtyId=-1,c._glTextures[this.CONTEXT_UID]=f,this.managedTextures.push(c),c.on("dispose",this.destroyTexture,this),f}initTextureType(c,f){var v,_,A;f.internalFormat=(_=(v=this.internalFormats[c.type])==null?void 0:v[c.format])!=null?_:c.format,f.samplerType=(A=this.samplerTypes[f.internalFormat])!=null?A:L.FLOAT,this.webGLVersion===2&&c.type===at.HALF_FLOAT?f.type=this.gl.HALF_FLOAT:f.type=c.type}updateTexture(c){var _;const f=c._glTextures[this.CONTEXT_UID];if(!f)return;const v=this.renderer;if(this.initTextureType(c,f),(_=c.resource)==null?void 0:_.upload(v,c,f))f.samplerType!==L.FLOAT&&(this.hasIntegerTextures=!0);else{const A=c.realWidth,R=c.realHeight,U=v.gl;(f.width!==A||f.height!==R||f.dirtyId<0)&&(f.width=A,f.height=R,U.texImage2D(c.target,0,f.internalFormat,A,R,0,c.format,f.type,null))}c.dirtyStyleId!==f.dirtyStyleId&&this.updateTextureStyle(c),f.dirtyId=c.dirtyId}destroyTexture(c,f){const{gl:v}=this;if(c=c.castToBaseTexture(),c._glTextures[this.CONTEXT_UID]&&(this.unbind(c),v.deleteTexture(c._glTextures[this.CONTEXT_UID].texture),c.off("dispose",this.destroyTexture,this),delete c._glTextures[this.CONTEXT_UID],!f)){const _=this.managedTextures.indexOf(c);_!==-1&&tn(this.managedTextures,_,1)}}updateTextureStyle(c){var v;const f=c._glTextures[this.CONTEXT_UID];f&&((c.mipmap===it.POW2||this.webGLVersion!==2)&&!c.isPowerOfTwo?f.mipmap=!1:f.mipmap=c.mipmap>=1,this.webGLVersion!==2&&!c.isPowerOfTwo?f.wrapMode=tt.CLAMP:f.wrapMode=c.wrapMode,(v=c.resource)!=null&&v.style(this.renderer,c,f)||this.setStyle(c,f),f.dirtyStyleId=c.dirtyStyleId)}setStyle(c,f){const v=this.gl;if(f.mipmap&&c.mipmap!==it.ON_MANUAL&&v.generateMipmap(c.target),v.texParameteri(c.target,v.TEXTURE_WRAP_S,f.wrapMode),v.texParameteri(c.target,v.TEXTURE_WRAP_T,f.wrapMode),f.mipmap){v.texParameteri(c.target,v.TEXTURE_MIN_FILTER,c.scaleMode===$.LINEAR?v.LINEAR_MIPMAP_LINEAR:v.NEAREST_MIPMAP_NEAREST);const _=this.renderer.context.extensions.anisotropicFiltering;if(_&&c.anisotropicLevel>0&&c.scaleMode===$.LINEAR){const A=Math.min(c.anisotropicLevel,v.getParameter(_.MAX_TEXTURE_MAX_ANISOTROPY_EXT));v.texParameterf(c.target,_.TEXTURE_MAX_ANISOTROPY_EXT,A)}}else v.texParameteri(c.target,v.TEXTURE_MIN_FILTER,c.scaleMode===$.LINEAR?v.LINEAR:v.NEAREST);v.texParameteri(c.target,v.TEXTURE_MAG_FILTER,c.scaleMode===$.LINEAR?v.LINEAR:v.NEAREST)}destroy(){this.renderer=null}}ht.extension={type:Fe.RendererSystem,name:"texture"},ze.add(ht);class wt{constructor(c){this.renderer=c}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(c){const{gl:f,CONTEXT_UID:v}=this,_=c._glTransformFeedbacks[v]||this.createGLTransformFeedback(c);f.bindTransformFeedback(f.TRANSFORM_FEEDBACK,_)}unbind(){const{gl:c}=this;c.bindTransformFeedback(c.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(c,f){const{gl:v,renderer:_}=this;f&&_.shader.bind(f),v.beginTransformFeedback(c)}endTransformFeedback(){const{gl:c}=this;c.endTransformFeedback()}createGLTransformFeedback(c){const{gl:f,renderer:v,CONTEXT_UID:_}=this,A=f.createTransformFeedback();c._glTransformFeedbacks[_]=A,f.bindTransformFeedback(f.TRANSFORM_FEEDBACK,A);for(let R=0;R<c.buffers.length;R++){const U=c.buffers[R];U&&(v.buffer.update(U),U._glBuffers[_].refCount++,f.bindBufferBase(f.TRANSFORM_FEEDBACK_BUFFER,R,U._glBuffers[_].buffer||null))}return f.bindTransformFeedback(f.TRANSFORM_FEEDBACK,null),c.disposeRunner.add(this),A}disposeTransformFeedback(c,f){const v=c._glTransformFeedbacks[this.CONTEXT_UID],_=this.gl;c.disposeRunner.remove(this);const A=this.renderer.buffer;if(A)for(let R=0;R<c.buffers.length;R++){const U=c.buffers[R];if(!U)continue;const J=U._glBuffers[this.CONTEXT_UID];J&&(J.refCount--,J.refCount===0&&!f&&A.dispose(U,f))}v&&(f||_.deleteTransformFeedback(v),delete c._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}wt.extension={type:Fe.RendererSystem,name:"transformFeedback"},ze.add(wt);class Tt{constructor(c){this.renderer=c}init(c){this.screen=new Jt(0,0,c.width,c.height),this.element=c.view||q.ADAPTER.createCanvas(),this.resolution=c.resolution||q.RESOLUTION,this.autoDensity=!!c.autoDensity}resizeView(c,f){this.element.width=Math.round(c*this.resolution),this.element.height=Math.round(f*this.resolution);const v=this.element.width/this.resolution,_=this.element.height/this.resolution;this.screen.width=v,this.screen.height=_,this.autoDensity&&(this.element.style.width=`${v}px`,this.element.style.height=`${_}px`),this.renderer.emit("resize",v,_),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(c){var f;c&&((f=this.element.parentNode)==null||f.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Tt.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},Tt.extension={type:[Fe.RendererSystem,Fe.CanvasRendererSystem],name:"_view"},ze.add(Tt),q.PREFER_ENV=ct.WEBGL2,q.STRICT_TEXTURE_CACHE=!1,q.RENDER_OPTIONS=Qe(Qe(Qe(Qe({},ks.defaultOptions),Ls.defaultOptions),Tt.defaultOptions),ao.defaultOptions),Object.defineProperties(q,{WRAP_MODE:{get(){return Ve.defaultOptions.wrapMode},set(p){te("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Ve.defaultOptions.wrapMode=p}},SCALE_MODE:{get(){return Ve.defaultOptions.scaleMode},set(p){te("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Ve.defaultOptions.scaleMode=p}},MIPMAP_TEXTURES:{get(){return Ve.defaultOptions.mipmap},set(p){te("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Ve.defaultOptions.mipmap=p}},ANISOTROPIC_LEVEL:{get(){return Ve.defaultOptions.anisotropicLevel},set(p){te("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Ve.defaultOptions.anisotropicLevel=p}},FILTER_RESOLUTION:{get(){return te("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),hi.defaultResolution},set(p){hi.defaultResolution=p}},FILTER_MULTISAMPLE:{get(){return te("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),hi.defaultMultisample},set(p){hi.defaultMultisample=p}},SPRITE_MAX_TEXTURES:{get(){return vi.defaultMaxTextures},set(p){te("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),vi.defaultMaxTextures=p}},SPRITE_BATCH_SIZE:{get(){return vi.defaultBatchSize},set(p){te("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),vi.defaultBatchSize=p}},CAN_UPLOAD_SAME_BUFFER:{get(){return vi.canUploadSameBuffer},set(p){te("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),vi.canUploadSameBuffer=p}},GC_MODE:{get(){return X.defaultMode},set(p){te("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),X.defaultMode=p}},GC_MAX_IDLE:{get(){return X.defaultMaxIdle},set(p){te("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),X.defaultMaxIdle=p}},GC_MAX_CHECK_COUNT:{get(){return X.defaultCheckCountMax},set(p){te("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),X.defaultCheckCountMax=p}},PRECISION_VERTEX:{get(){return Oe.defaultVertexPrecision},set(p){te("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Oe.defaultVertexPrecision=p}},PRECISION_FRAGMENT:{get(){return Oe.defaultFragmentPrecision},set(p){te("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Oe.defaultFragmentPrecision=p}}});var jt=(p=>(p[p.INTERACTION=50]="INTERACTION",p[p.HIGH=25]="HIGH",p[p.NORMAL=0]="NORMAL",p[p.LOW=-25]="LOW",p[p.UTILITY=-50]="UTILITY",p))(jt||{});class Rt{constructor(c,f=null,v=0,_=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=c,this.context=f,this.priority=v,this.once=_}match(c,f=null){return this.fn===c&&this.context===f}emit(c){this.fn&&(this.context?this.fn.call(this.context,c):this.fn(c));const f=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),f}connect(c){this.previous=c,c.next&&(c.next.previous=this),this.next=c.next,c.next=this}destroy(c=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const f=this.next;return this.next=c?null:f,this.previous=null,f}}const kt=class Hr{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Rt(null,null,1/0),this.deltaMS=1/Hr.targetFPMS,this.elapsedMS=1/Hr.targetFPMS,this._tick=c=>{this._requestId=null,this.started&&(this.update(c),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(c,f,v=jt.NORMAL){return this._addListener(new Rt(c,f,v))}addOnce(c,f,v=jt.NORMAL){return this._addListener(new Rt(c,f,v,!0))}_addListener(c){let f=this._head.next,v=this._head;if(!f)c.connect(v);else{for(;f;){if(c.priority>f.priority){c.connect(v);break}v=f,f=f.next}c.previous||c.connect(v)}return this._startIfPossible(),this}remove(c,f){let v=this._head.next;for(;v;)v.match(c,f)?v=v.destroy():v=v.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let c=0,f=this._head;for(;f=f.next;)c++;return c}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let c=this._head.next;for(;c;)c=c.destroy(!0);this._head.destroy(),this._head=null}}update(c=performance.now()){let f;if(c>this.lastTime){if(f=this.elapsedMS=c-this.lastTime,f>this._maxElapsedMS&&(f=this._maxElapsedMS),f*=this.speed,this._minElapsedMS){const A=c-this._lastFrame|0;if(A<this._minElapsedMS)return;this._lastFrame=c-A%this._minElapsedMS}this.deltaMS=f,this.deltaTime=this.deltaMS*Hr.targetFPMS;const v=this._head;let _=v.next;for(;_;)_=_.emit(this.deltaTime);v.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=c}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(c){const f=Math.min(this.maxFPS,c),v=Math.min(Math.max(0,f)/1e3,Hr.targetFPMS);this._maxElapsedMS=1/v}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(c){if(c===0)this._minElapsedMS=0;else{const f=Math.max(this.minFPS,c);this._minElapsedMS=1/(f/1e3)}}static get shared(){if(!Hr._shared){const c=Hr._shared=new Hr;c.autoStart=!0,c._protected=!0}return Hr._shared}static get system(){if(!Hr._system){const c=Hr._system=new Hr;c.autoStart=!0,c._protected=!0}return Hr._system}};kt.targetFPMS=.06;let ne=kt;Object.defineProperties(q,{TARGET_FPMS:{get(){return ne.targetFPMS},set(p){te("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ne.targetFPMS=p}}});class Ce{static init(c){c=Object.assign({autoStart:!0,sharedTicker:!1},c),Object.defineProperty(this,"ticker",{set(f){this._ticker&&this._ticker.remove(this.render,this),this._ticker=f,f&&f.add(this.render,this,jt.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=c.sharedTicker?ne.shared:new ne,c.autoStart&&this.start()}static destroy(){if(this._ticker){const c=this._ticker;this.ticker=null,c.destroy()}}}Ce.extension=Fe.Application,ze.add(Ce);const ae=[];ze.handleByList(Fe.Renderer,ae);function oe(p){for(const c of ae)if(c.test(p))return new c(p);throw new Error("Unable to auto-detect a suitable renderer.")}var Te=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Pe=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Ke=Te,pe=Pe;class Ut{constructor(c){this.renderer=c}contextChange(c){let f;if(this.renderer.context.webGLVersion===1){const v=c.getParameter(c.FRAMEBUFFER_BINDING);c.bindFramebuffer(c.FRAMEBUFFER,null),f=c.getParameter(c.SAMPLES),c.bindFramebuffer(c.FRAMEBUFFER,v)}else{const v=c.getParameter(c.DRAW_FRAMEBUFFER_BINDING);c.bindFramebuffer(c.DRAW_FRAMEBUFFER,null),f=c.getParameter(c.SAMPLES),c.bindFramebuffer(c.DRAW_FRAMEBUFFER,v)}f>=It.HIGH?this.multisample=It.HIGH:f>=It.MEDIUM?this.multisample=It.MEDIUM:f>=It.LOW?this.multisample=It.LOW:this.multisample=It.NONE}destroy(){}}Ut.extension={type:Fe.RendererSystem,name:"_multisample"},ze.add(Ut);class ie{constructor(c){this.buffer=c||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class we{constructor(c){this.renderer=c,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(c){const{gl:f,CONTEXT_UID:v}=this,_=c._glBuffers[v]||this.createGLBuffer(c);f.bindBuffer(c.type,_.buffer)}unbind(c){const{gl:f}=this;f.bindBuffer(c,null)}bindBufferBase(c,f){const{gl:v,CONTEXT_UID:_}=this;if(this.boundBufferBases[f]!==c){const A=c._glBuffers[_]||this.createGLBuffer(c);this.boundBufferBases[f]=c,v.bindBufferBase(v.UNIFORM_BUFFER,f,A.buffer)}}bindBufferRange(c,f,v){const{gl:_,CONTEXT_UID:A}=this;v=v||0;const R=c._glBuffers[A]||this.createGLBuffer(c);_.bindBufferRange(_.UNIFORM_BUFFER,f||0,R.buffer,v*256,256)}update(c){const{gl:f,CONTEXT_UID:v}=this,_=c._glBuffers[v]||this.createGLBuffer(c);if(c._updateID!==_.updateID)if(_.updateID=c._updateID,f.bindBuffer(c.type,_.buffer),_.byteLength>=c.data.byteLength)f.bufferSubData(c.type,0,c.data);else{const A=c.static?f.STATIC_DRAW:f.DYNAMIC_DRAW;_.byteLength=c.data.byteLength,f.bufferData(c.type,c.data,A)}}dispose(c,f){if(!this.managedBuffers[c.id])return;delete this.managedBuffers[c.id];const v=c._glBuffers[this.CONTEXT_UID],_=this.gl;c.disposeRunner.remove(this),v&&(f||_.deleteBuffer(v.buffer),delete c._glBuffers[this.CONTEXT_UID])}disposeAll(c){const f=Object.keys(this.managedBuffers);for(let v=0;v<f.length;v++)this.dispose(this.managedBuffers[f[v]],c)}createGLBuffer(c){const{CONTEXT_UID:f,gl:v}=this;return c._glBuffers[f]=new ie(v.createBuffer()),this.managedBuffers[c.id]=c,c.disposeRunner.add(this),c._glBuffers[f]}}we.extension={type:Fe.RendererSystem,name:"buffer"},ze.add(we);class je{constructor(c){this.renderer=c}render(c,f){const v=this.renderer;let _,A,R,U;if(f&&(_=f.renderTexture,A=f.clear,R=f.transform,U=f.skipUpdateTransform),this.renderingToScreen=!_,v.runners.prerender.emit(),v.emit("prerender"),v.projection.transform=R,!v.context.isLost){if(_||(this.lastObjectRendered=c),!U){const J=c.enableTempParent();c.updateTransform(),c.disableTempParent(J)}v.renderTexture.bind(_),v.batch.currentRenderer.start(),(A!=null?A:v.background.clearBeforeRender)&&v.renderTexture.clear(),c.render(v),v.batch.currentRenderer.flush(),_&&(f.blit&&v.framebuffer.blit(),_.baseTexture.update()),v.runners.postrender.emit(),v.projection.transform=null,v.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}je.extension={type:Fe.RendererSystem,name:"objectRenderer"},ze.add(je);const be=class Eo extends B{constructor(c){super(),this.type=xt.WEBGL,c=Object.assign({},q.RENDER_OPTIONS,c),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new pr({projectionMatrix:new M},!0);const f={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Eo.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(f),"useContextAlpha"in c&&(te("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),c.premultipliedAlpha=c.useContextAlpha&&c.useContextAlpha!=="notMultiplied",c.backgroundAlpha=c.useContextAlpha===!1?1:c.backgroundAlpha),this._plugin.rendererPlugins=Eo.__plugins,this.options=c,this.startup.run(this.options)}static test(c){return c!=null&&c.forceCanvas?!1:Wr()}render(c,f){this.objectRenderer.render(c,f)}resize(c,f){this._view.resizeView(c,f)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(c=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:c}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(c){this._view.resolution=c,this.runners.resolutionChange.emit(c)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return te("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return te("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return te("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return te("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(c){te("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=c}get backgroundAlpha(){return te("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(c){te("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=c}get powerPreference(){return te("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(c,f){return this.textureGenerator.generateTexture(c,f)}};be.extension={type:Fe.Renderer,priority:1},be.__plugins={},be.__systems={};let Me=be;ze.handleByMap(Fe.RendererPlugin,Me.__plugins),ze.handleByMap(Fe.RendererSystem,Me.__systems),ze.add(Me);class hr extends ii{constructor(c,f){const{width:v,height:_}=f||{};super(v,_),this.items=[],this.itemDirtyIds=[];for(let A=0;A<c;A++){const R=new Ve;this.items.push(R),this.itemDirtyIds.push(-2)}this.length=c,this._load=null,this.baseTexture=null}initFromArray(c,f){for(let v=0;v<this.length;v++)c[v]&&(c[v].castToBaseTexture?this.addBaseTextureAt(c[v].castToBaseTexture(),v):c[v]instanceof ii?this.addResourceAt(c[v],v):this.addResourceAt(Ps(c[v],f),v))}dispose(){for(let c=0,f=this.length;c<f;c++)this.items[c].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(c,f){if(!this.items[f])throw new Error(`Index ${f} is out of bounds`);return c.valid&&!this.valid&&this.resize(c.width,c.height),this.items[f].setResource(c),this}bind(c){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(c);for(let f=0;f<this.length;f++)this.items[f].parentTextureArray=c,this.items[f].on("update",c.update,c)}unbind(c){super.unbind(c);for(let f=0;f<this.length;f++)this.items[f].parentTextureArray=null,this.items[f].off("update",c.update,c)}load(){if(this._load)return this._load;const c=this.items.map(f=>f.resource).filter(f=>f).map(f=>f.load());return this._load=Promise.all(c).then(()=>{const{realWidth:f,realHeight:v}=this.items[0];return this.resize(f,v),this.update(),Promise.resolve(this)}),this._load}}class ur extends hr{constructor(c,f){const{width:v,height:_}=f||{};let A,R;Array.isArray(c)?(A=c,R=c.length):R=c,super(R,{width:v,height:_}),A&&this.initFromArray(A,f)}addBaseTextureAt(c,f){if(c.resource)this.addResourceAt(c.resource,f);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(c){super.bind(c),c.target=mt.TEXTURE_2D_ARRAY}upload(c,f,v){const{length:_,itemDirtyIds:A,items:R}=this,{gl:U}=c;v.dirtyId<0&&U.texImage3D(U.TEXTURE_2D_ARRAY,0,v.internalFormat,this._width,this._height,_,0,f.format,v.type,null);for(let J=0;J<_;J++){const gt=R[J];A[J]<gt.dirtyId&&(A[J]=gt.dirtyId,gt.valid&&U.texSubImage3D(U.TEXTURE_2D_ARRAY,0,0,0,J,gt.resource.width,gt.resource.height,1,f.format,v.type,gt.resource.source))}return!0}}class ke extends _i{constructor(c){super(c)}static test(c){const{OffscreenCanvas:f}=globalThis;return f&&c instanceof f?!0:globalThis.HTMLCanvasElement&&c instanceof HTMLCanvasElement}}const Mn=class Fn extends hr{constructor(c,f){const{width:v,height:_,autoLoad:A,linkBaseTexture:R}=f||{};if(c&&c.length!==Fn.SIDES)throw new Error(`Invalid length. Got ${c.length}, expected 6`);super(6,{width:v,height:_});for(let U=0;U<Fn.SIDES;U++)this.items[U].target=mt.TEXTURE_CUBE_MAP_POSITIVE_X+U;this.linkBaseTexture=R!==!1,c&&this.initFromArray(c,f),A!==!1&&this.load()}bind(c){super.bind(c),c.target=mt.TEXTURE_CUBE_MAP}addBaseTextureAt(c,f,v){if(v===void 0&&(v=this.linkBaseTexture),!this.items[f])throw new Error(`Index ${f} is out of bounds`);if(!this.linkBaseTexture||c.parentTextureArray||Object.keys(c._glTextures).length>0)if(c.resource)this.addResourceAt(c.resource,f);else throw new Error("CubeResource does not support copying of renderTexture.");else c.target=mt.TEXTURE_CUBE_MAP_POSITIVE_X+f,c.parentTextureArray=this.baseTexture,this.items[f]=c;return c.valid&&!this.valid&&this.resize(c.realWidth,c.realHeight),this.items[f]=c,this}upload(c,f,v){const _=this.itemDirtyIds;for(let A=0;A<Fn.SIDES;A++){const R=this.items[A];(_[A]<R.dirtyId||v.dirtyId<f.dirtyId)&&(R.valid&&R.resource?(R.resource.upload(c,R,v),_[A]=R.dirtyId):_[A]<-1&&(c.gl.texImage2D(R.target,0,v.internalFormat,f.realWidth,f.realHeight,0,f.format,v.type,null),_[A]=-1))}return!0}static test(c){return Array.isArray(c)&&c.length===Fn.SIDES}};Mn.SIDES=6;let js=Mn;class Qr extends _i{constructor(c,f){var R,U;f=f||{};let v,_,A;typeof c=="string"?(v=Qr.EMPTY,_=c,A=!0):(v=c,_=null,A=!1),super(v),this.url=_,this.crossOrigin=(R=f.crossOrigin)!=null?R:!0,this.alphaMode=typeof f.alphaMode=="number"?f.alphaMode:null,this.ownsImageBitmap=(U=f.ownsImageBitmap)!=null?U:A,this._load=null,f.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise((c,f)=>ce(this,null,function*(){if(this.url===null){c(this);return}try{const v=yield q.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const _=yield v.blob();if(this.destroyed)return;const A=yield createImageBitmap(_,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Z.UNPACK?"premultiply":"none"});if(this.destroyed){A.close();return}this.source=A,this.update(),c(this)}catch(v){if(this.destroyed)return;f(v),this.onError.emit(v)}})),this._load)}upload(c,f,v){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(f.alphaMode=this.alphaMode),super.upload(c,f,v)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(c){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof c=="string"||c instanceof ImageBitmap)}static get EMPTY(){var c;return Qr._EMPTY=(c=Qr._EMPTY)!=null?c:q.ADAPTER.createCanvas(0,0),Qr._EMPTY}}const Ws=class po extends _i{constructor(c,f){f=f||{},super(q.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=c,this.scale=f.scale||1,this._overrideWidth=f.width,this._overrideHeight=f.height,this._resolve=null,this._crossorigin=f.crossorigin,this._load=null,f.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(c=>{if(this._resolve=()=>{this.update(),c(this)},po.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const c=new Image;_i.crossOrigin(c,this.svg,this._crossorigin),c.src=this.svg,c.onerror=f=>{this._resolve&&(c.onerror=null,this.onError.emit(f))},c.onload=()=>{if(!this._resolve)return;const f=c.width,v=c.height;if(!f||!v)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let _=f*this.scale,A=v*this.scale;(this._overrideWidth||this._overrideHeight)&&(_=this._overrideWidth||this._overrideHeight/v*f,A=this._overrideHeight||this._overrideWidth/f*v),_=Math.round(_),A=Math.round(A);const R=this.source;R.width=_,R.height=A,R._pixiId=`canvas_${Gr()}`,R.getContext("2d").drawImage(c,0,0,f,v,0,0,_,A),this._resolve(),this._resolve=null}}static getSize(c){const f=po.SVG_SIZE.exec(c),v={};return f&&(v[f[1]]=Math.round(parseFloat(f[3])),v[f[5]]=Math.round(parseFloat(f[7]))),v}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(c,f){return f==="svg"||typeof c=="string"&&c.startsWith("data:image/svg+xml")||typeof c=="string"&&po.SVG_XML.test(c)}};Ws.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Ws.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let In=Ws;const Ki=class So extends _i{constructor(c,f){if(f=f||{},!(c instanceof HTMLVideoElement)){const v=document.createElement("video");f.autoLoad!==!1&&v.setAttribute("preload","auto"),f.playsinline!==!1&&(v.setAttribute("webkit-playsinline",""),v.setAttribute("playsinline","")),f.muted===!0&&(v.setAttribute("muted",""),v.muted=!0),f.loop===!0&&v.setAttribute("loop",""),f.autoPlay!==!1&&v.setAttribute("autoplay",""),typeof c=="string"&&(c=[c]);const _=c[0].src||c[0];_i.crossOrigin(v,_,f.crossorigin);for(let A=0;A<c.length;++A){const R=document.createElement("source");let{src:U,mime:J}=c[A];if(U=U||c[A],U.startsWith("data:"))J=U.slice(5,U.indexOf(";"));else if(!U.startsWith("blob:")){const gt=U.split("?").shift().toLowerCase(),Ot=gt.slice(gt.lastIndexOf(".")+1);J=J||So.MIME_TYPES[Ot]||`video/${Ot}`}R.src=U,J&&(R.type=J),v.appendChild(R)}c=v}super(c),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=f.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=f.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),f.autoLoad!==!1&&this.load()}update(c=0){if(!this.destroyed){if(this._updateFPS){const f=ne.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-f)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const c=this.source;return(c.readyState===c.HAVE_ENOUGH_DATA||c.readyState===c.HAVE_FUTURE_DATA)&&c.width&&c.height&&(c.complete=!0),c.addEventListener("play",this._onPlayStart),c.addEventListener("pause",this._onPlayStop),c.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(c.addEventListener("canplay",this._onCanPlay),c.addEventListener("canplaythrough",this._onCanPlay),c.addEventListener("error",this._onError,!0)),this._load=new Promise((f,v)=>{this.valid?f(this):(this._resolve=f,this._reject=v,c.load())}),this._load}_onError(c){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(c),this._reject&&(this._reject(c),this._reject=null,this._resolve=null)}_isSourcePlaying(){const c=this.source;return!c.paused&&!c.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const c=this.source;c.removeEventListener("canplay",this._onCanPlay),c.removeEventListener("canplaythrough",this._onCanPlay);const f=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!f&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&c.play()}dispose(){this._configureAutoUpdate();const c=this.source;c&&(c.removeEventListener("play",this._onPlayStart),c.removeEventListener("pause",this._onPlayStop),c.removeEventListener("seeked",this._onSeeked),c.removeEventListener("canplay",this._onCanPlay),c.removeEventListener("canplaythrough",this._onCanPlay),c.removeEventListener("error",this._onError,!0),c.pause(),c.src="",c.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(c){c!==this._autoUpdate&&(this._autoUpdate=c,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(c){c!==this._updateFPS&&(this._updateFPS=c,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ne.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ne.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ne.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(c,f){return globalThis.HTMLVideoElement&&c instanceof HTMLVideoElement||So.TYPES.includes(f)}};Ki.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Ki.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let xs=Ki;Ei.push(Qr,zn,ke,xs,In,os,js,ur);class To{constructor(){this._glTransformFeedbacks={},this.buffers=[],this.disposeRunner=new Runner("disposeTransformFeedback")}bindBuffer(c,f){this.buffers[c]=f}destroy(){this.disposeRunner.emit(this,!1)}}const Zi="7.3.2"},121:function(Wt,Kt,dt){"use strict";dt.d(Kt,{U:function(){return xt}});var S=dt(774),ct=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class xt extends S.wn{constructor(vt=1){super(S.kP,ct,{uAlpha:1}),this.alpha=vt}get alpha(){return this.uniforms.uAlpha}set alpha(vt){this.uniforms.uAlpha=vt}}},844:function(Wt,Kt,dt){"use strict";dt.d(Kt,{T:function(){return mt},Y:function(){return nt}});var S=dt(774);const ct={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},xt=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function Lt(at){const L=ct[at],$=L.length;let tt=xt,it="";const Z="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let ft;for(let yt=0;yt<at;yt++){let K=Z.replace("%index%",yt.toString());ft=yt,yt>=$&&(ft=at-yt-1),K=K.replace("%value%",L[ft].toString()),it+=K,it+=`
`}return tt=tt.replace("%blur%",it),tt=tt.replace("%size%",at.toString()),tt}const vt=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function Ft(at,L){const $=Math.ceil(at/2);let tt=vt,it="",Z;L?Z="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":Z="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let ft=0;ft<at;ft++){let yt=Z.replace("%index%",ft.toString());yt=yt.replace("%sampleIndex%",`${ft-($-1)}.0`),it+=yt,it+=`
`}return tt=tt.replace("%blur%",it),tt=tt.replace("%size%",at.toString()),tt}class nt extends S.wn{constructor(L,$=8,tt=4,it=S.wn.defaultResolution,Z=5){const ft=Ft(Z,L),yt=Lt(Z);super(ft,yt),this.horizontal=L,this.resolution=it,this._quality=0,this.quality=tt,this.blur=$}apply(L,$,tt,it){if(tt?this.horizontal?this.uniforms.strength=1/tt.width*(tt.width/$.width):this.uniforms.strength=1/tt.height*(tt.height/$.height):this.horizontal?this.uniforms.strength=1/L.renderer.width*(L.renderer.width/$.width):this.uniforms.strength=1/L.renderer.height*(L.renderer.height/$.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)L.applyFilter(this,$,tt,it);else{const Z=L.getFilterTexture(),ft=L.renderer;let yt=$,K=Z;this.state.blend=!1,L.applyFilter(this,yt,K,S.yl.CLEAR);for(let lt=1;lt<this.passes-1;lt++){L.bindAndClear(yt,S.yl.BLIT),this.uniforms.uSampler=K;const _t=K;K=yt,yt=_t,ft.shader.bind(this),ft.geometry.draw(5)}this.state.blend=!0,L.applyFilter(this,K,tt,it),L.returnFilterTexture(Z)}}get blur(){return this.strength}set blur(L){this.padding=1+Math.abs(L)*2,this.strength=L}get quality(){return this._quality}set quality(L){this._quality=L,this.passes=L}}class mt extends S.wn{constructor(L=8,$=4,tt=S.wn.defaultResolution,it=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new nt(!0,L,$,tt,it),this.blurYFilter=new nt(!1,L,$,tt,it),this.resolution=tt,this.quality=$,this.blur=L,this.repeatEdgePixels=!1}apply(L,$,tt,it){const Z=Math.abs(this.blurXFilter.strength),ft=Math.abs(this.blurYFilter.strength);if(Z&&ft){const yt=L.getFilterTexture();this.blurXFilter.apply(L,$,yt,S.yl.CLEAR),this.blurYFilter.apply(L,yt,tt,it),L.returnFilterTexture(yt)}else ft?this.blurYFilter.apply(L,$,tt,it):this.blurXFilter.apply(L,$,tt,it)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(L){this.blurXFilter.blur=this.blurYFilter.blur=L,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(L){this.blurXFilter.quality=this.blurYFilter.quality=L}get blurX(){return this.blurXFilter.blur}set blurX(L){this.blurXFilter.blur=L,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(L){this.blurYFilter.blur=L,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(L){this.blurYFilter.blendMode=L}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(L){this._repeatEdgePixels=L,this.updatePadding()}}},465:function(Wt,Kt,dt){"use strict";dt.d(Kt,{MxU:function(){return Tr},Graphics:function(){return cs}});var S=dt(774);class ct{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(u){return this.minX>this.maxX||this.minY>this.maxY?S.Ae.EMPTY:(u=u||new S.Ae(0,0,1,1),u.x=this.minX,u.y=this.minY,u.width=this.maxX-this.minX,u.height=this.maxY-this.minY,u)}addPoint(u){this.minX=Math.min(this.minX,u.x),this.maxX=Math.max(this.maxX,u.x),this.minY=Math.min(this.minY,u.y),this.maxY=Math.max(this.maxY,u.y)}addPointMatrix(u,d){const{a:g,b:y,c:T,d:E,tx:P,ty:D}=u,B=g*d.x+T*d.y+P,G=y*d.x+E*d.y+D;this.minX=Math.min(this.minX,B),this.maxX=Math.max(this.maxX,B),this.minY=Math.min(this.minY,G),this.maxY=Math.max(this.maxY,G)}addQuad(u){let d=this.minX,g=this.minY,y=this.maxX,T=this.maxY,E=u[0],P=u[1];d=E<d?E:d,g=P<g?P:g,y=E>y?E:y,T=P>T?P:T,E=u[2],P=u[3],d=E<d?E:d,g=P<g?P:g,y=E>y?E:y,T=P>T?P:T,E=u[4],P=u[5],d=E<d?E:d,g=P<g?P:g,y=E>y?E:y,T=P>T?P:T,E=u[6],P=u[7],d=E<d?E:d,g=P<g?P:g,y=E>y?E:y,T=P>T?P:T,this.minX=d,this.minY=g,this.maxX=y,this.maxY=T}addFrame(u,d,g,y,T){this.addFrameMatrix(u.worldTransform,d,g,y,T)}addFrameMatrix(u,d,g,y,T){const E=u.a,P=u.b,D=u.c,B=u.d,G=u.tx,X=u.ty;let W=this.minX,j=this.minY,et=this.maxX,ht=this.maxY,wt=E*d+D*g+G,Tt=P*d+B*g+X;W=wt<W?wt:W,j=Tt<j?Tt:j,et=wt>et?wt:et,ht=Tt>ht?Tt:ht,wt=E*y+D*g+G,Tt=P*y+B*g+X,W=wt<W?wt:W,j=Tt<j?Tt:j,et=wt>et?wt:et,ht=Tt>ht?Tt:ht,wt=E*d+D*T+G,Tt=P*d+B*T+X,W=wt<W?wt:W,j=Tt<j?Tt:j,et=wt>et?wt:et,ht=Tt>ht?Tt:ht,wt=E*y+D*T+G,Tt=P*y+B*T+X,W=wt<W?wt:W,j=Tt<j?Tt:j,et=wt>et?wt:et,ht=Tt>ht?Tt:ht,this.minX=W,this.minY=j,this.maxX=et,this.maxY=ht}addVertexData(u,d,g){let y=this.minX,T=this.minY,E=this.maxX,P=this.maxY;for(let D=d;D<g;D+=2){const B=u[D],G=u[D+1];y=B<y?B:y,T=G<T?G:T,E=B>E?B:E,P=G>P?G:P}this.minX=y,this.minY=T,this.maxX=E,this.maxY=P}addVertices(u,d,g,y){this.addVerticesMatrix(u.worldTransform,d,g,y)}addVerticesMatrix(u,d,g,y,T=0,E=T){const P=u.a,D=u.b,B=u.c,G=u.d,X=u.tx,W=u.ty;let j=this.minX,et=this.minY,ht=this.maxX,wt=this.maxY;for(let Tt=g;Tt<y;Tt+=2){const jt=d[Tt],Rt=d[Tt+1],kt=P*jt+B*Rt+X,ne=G*Rt+D*jt+W;j=Math.min(j,kt-T),ht=Math.max(ht,kt+T),et=Math.min(et,ne-E),wt=Math.max(wt,ne+E)}this.minX=j,this.minY=et,this.maxX=ht,this.maxY=wt}addBounds(u){const d=this.minX,g=this.minY,y=this.maxX,T=this.maxY;this.minX=u.minX<d?u.minX:d,this.minY=u.minY<g?u.minY:g,this.maxX=u.maxX>y?u.maxX:y,this.maxY=u.maxY>T?u.maxY:T}addBoundsMask(u,d){const g=u.minX>d.minX?u.minX:d.minX,y=u.minY>d.minY?u.minY:d.minY,T=u.maxX<d.maxX?u.maxX:d.maxX,E=u.maxY<d.maxY?u.maxY:d.maxY;if(g<=T&&y<=E){const P=this.minX,D=this.minY,B=this.maxX,G=this.maxY;this.minX=g<P?g:P,this.minY=y<D?y:D,this.maxX=T>B?T:B,this.maxY=E>G?E:G}}addBoundsMatrix(u,d){this.addFrameMatrix(d,u.minX,u.minY,u.maxX,u.maxY)}addBoundsArea(u,d){const g=u.minX>d.x?u.minX:d.x,y=u.minY>d.y?u.minY:d.y,T=u.maxX<d.x+d.width?u.maxX:d.x+d.width,E=u.maxY<d.y+d.height?u.maxY:d.y+d.height;if(g<=T&&y<=E){const P=this.minX,D=this.minY,B=this.maxX,G=this.maxY;this.minX=g<P?g:P,this.minY=y<D?y:D,this.maxX=T>B?T:B,this.maxY=E>G?E:G}}pad(u=0,d=u){this.isEmpty()||(this.minX-=u,this.maxX+=u,this.minY-=d,this.maxY+=d)}addFramePad(u,d,g,y,T,E){u-=T,d-=E,g+=T,y+=E,this.minX=this.minX<u?this.minX:u,this.maxX=this.maxX>g?this.maxX:g,this.minY=this.minY<d?this.minY:d,this.maxY=this.maxY>y?this.maxY:y}}class xt extends S.P6.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new S.wx,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new ct,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(u){const d=Object.keys(u);for(let g=0;g<d.length;++g){const y=d[g];Object.defineProperty(xt.prototype,y,Object.getOwnPropertyDescriptor(u,y))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(u,d){return u||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),d||(this._boundsRect||(this._boundsRect=new S.Ae),d=this._boundsRect),this._bounds.getRectangle(d)}getLocalBounds(u){var P;u||(this._localBoundsRect||(this._localBoundsRect=new S.Ae),u=this._localBoundsRect),this._localBounds||(this._localBounds=new ct);const d=this.transform,g=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(P=g==null?void 0:g.worldAlpha)!=null?P:1,this.transform=this._tempDisplayObjectParent.transform;const y=this._bounds,T=this._boundsID;this._bounds=this._localBounds;const E=this.getBounds(!1,u);return this.parent=g,this.transform=d,this._bounds=y,this._bounds.updateID+=this._boundsID-T,E}toGlobal(u,d,g=!1){return g||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(u,d)}toLocal(u,d,g,y){return d&&(u=d.toGlobal(u,g,y)),y||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(u,g)}setParent(u){if(!u||!u.addChild)throw new Error("setParent: Argument must be a Container");return u.addChild(this),u}removeFromParent(){var u;(u=this.parent)==null||u.removeChild(this)}setTransform(u=0,d=0,g=1,y=1,T=0,E=0,P=0,D=0,B=0){return this.position.x=u,this.position.y=d,this.scale.x=g||1,this.scale.y=y||1,this.rotation=T,this.skew.x=E,this.skew.y=P,this.pivot.x=D,this.pivot.y=B,this}destroy(u){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Lt),this.tempDisplayObjectParent}enableTempParent(){const u=this.parent;return this.parent=this._tempDisplayObjectParent,u}disableTempParent(u){this.parent=u}get x(){return this.position.x}set x(u){this.transform.position.x=u}get y(){return this.position.y}set y(u){this.transform.position.y=u}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(u){this.transform.position.copyFrom(u)}get scale(){return this.transform.scale}set scale(u){this.transform.scale.copyFrom(u)}get pivot(){return this.transform.pivot}set pivot(u){this.transform.pivot.copyFrom(u)}get skew(){return this.transform.skew}set skew(u){this.transform.skew.copyFrom(u)}get rotation(){return this.transform.rotation}set rotation(u){this.transform.rotation=u}get angle(){return this.transform.rotation*S.jl}set angle(u){this.transform.rotation=u*S.ZX}get zIndex(){return this._zIndex}set zIndex(u){this._zIndex=u,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let u=this;do{if(!u.visible)return!1;u=u.parent}while(u);return!0}get mask(){return this._mask}set mask(u){if(this._mask!==u){if(this._mask){const d=this._mask.isMaskData?this._mask.maskObject:this._mask;d&&(d._maskRefCount--,d._maskRefCount===0&&(d.renderable=!0,d.isMask=!1))}if(this._mask=u,this._mask){const d=this._mask.isMaskData?this._mask.maskObject:this._mask;d&&(d._maskRefCount===0&&(d.renderable=!1,d.isMask=!0),d._maskRefCount++)}}}}class Lt extends xt{constructor(){super(...arguments),this.sortDirty=null}}xt.prototype.displayObjectUpdateTransform=xt.prototype.updateTransform;const vt=new S.y3;function Ft(C,u){return C.zIndex===u.zIndex?C._lastSortedIndex-u._lastSortedIndex:C.zIndex-u.zIndex}const nt=class Co extends xt{constructor(){super(),this.children=[],this.sortableChildren=Co.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(u){}addChild(...u){if(u.length>1)for(let d=0;d<u.length;d++)this.addChild(u[d]);else{const d=u[0];d.parent&&d.parent.removeChild(d),d.parent=this,this.sortDirty=!0,d.transform._parentID=-1,this.children.push(d),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",d,this,this.children.length-1),d.emit("added",this)}return u[0]}addChildAt(u,d){if(d<0||d>this.children.length)throw new Error(`${u}addChildAt: The index ${d} supplied is out of bounds ${this.children.length}`);return u.parent&&u.parent.removeChild(u),u.parent=this,this.sortDirty=!0,u.transform._parentID=-1,this.children.splice(d,0,u),this._boundsID++,this.onChildrenChange(d),u.emit("added",this),this.emit("childAdded",u,this,d),u}swapChildren(u,d){if(u===d)return;const g=this.getChildIndex(u),y=this.getChildIndex(d);this.children[g]=d,this.children[y]=u,this.onChildrenChange(g<y?g:y)}getChildIndex(u){const d=this.children.indexOf(u);if(d===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return d}setChildIndex(u,d){if(d<0||d>=this.children.length)throw new Error(`The index ${d} supplied is out of bounds ${this.children.length}`);const g=this.getChildIndex(u);S.P6.removeItems(this.children,g,1),this.children.splice(d,0,u),this.onChildrenChange(d)}getChildAt(u){if(u<0||u>=this.children.length)throw new Error(`getChildAt: Index (${u}) does not exist.`);return this.children[u]}removeChild(...u){if(u.length>1)for(let d=0;d<u.length;d++)this.removeChild(u[d]);else{const d=u[0],g=this.children.indexOf(d);if(g===-1)return null;d.parent=null,d.transform._parentID=-1,S.P6.removeItems(this.children,g,1),this._boundsID++,this.onChildrenChange(g),d.emit("removed",this),this.emit("childRemoved",d,this,g)}return u[0]}removeChildAt(u){const d=this.getChildAt(u);return d.parent=null,d.transform._parentID=-1,S.P6.removeItems(this.children,u,1),this._boundsID++,this.onChildrenChange(u),d.emit("removed",this),this.emit("childRemoved",d,this,u),d}removeChildren(u=0,d=this.children.length){const g=u,y=d,T=y-g;let E;if(T>0&&T<=y){E=this.children.splice(g,T);for(let P=0;P<E.length;++P)E[P].parent=null,E[P].transform&&(E[P].transform._parentID=-1);this._boundsID++,this.onChildrenChange(u);for(let P=0;P<E.length;++P)E[P].emit("removed",this),this.emit("childRemoved",E[P],this,P);return E}else if(T===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let u=!1;for(let d=0,g=this.children.length;d<g;++d){const y=this.children[d];y._lastSortedIndex=d,!u&&y.zIndex!==0&&(u=!0)}u&&this.children.length>1&&this.children.sort(Ft),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let u=0,d=this.children.length;u<d;++u){const g=this.children[u];g.visible&&g.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let u=0;u<this.children.length;u++){const d=this.children[u];if(!(!d.visible||!d.renderable))if(d.calculateBounds(),d._mask){const g=d._mask.isMaskData?d._mask.maskObject:d._mask;g?(g.calculateBounds(),this._bounds.addBoundsMask(d._bounds,g._bounds)):this._bounds.addBounds(d._bounds)}else d.filterArea?this._bounds.addBoundsArea(d._bounds,d.filterArea):this._bounds.addBounds(d._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(u,d=!1){const g=super.getLocalBounds(u);if(!d)for(let y=0,T=this.children.length;y<T;++y){const E=this.children[y];E.visible&&E.updateTransform()}return g}_calculateBounds(){}_renderWithCulling(u){const d=u.renderTexture.sourceFrame;if(!(d.width>0&&d.height>0))return;let g,y;this.cullArea?(g=this.cullArea,y=this.worldTransform):this._render!==Co.prototype._render&&(g=this.getBounds(!0));const T=u.projection.transform;if(T&&(y?(y=vt.copyFrom(y),y.prepend(T)):y=T),g&&d.intersects(g,y))this._render(u);else if(this.cullArea)return;for(let E=0,P=this.children.length;E<P;++E){const D=this.children[E],B=D.cullable;D.cullable=B||!this.cullArea,D.render(u),D.cullable=B}}render(u){var d;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(d=this.filters)!=null&&d.length)this.renderAdvanced(u);else if(this.cullable)this._renderWithCulling(u);else{this._render(u);for(let g=0,y=this.children.length;g<y;++g)this.children[g].render(u)}}renderAdvanced(u){var T,E,P;const d=this.filters,g=this._mask;if(d){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let D=0;D<d.length;D++)d[D].enabled&&this._enabledFilters.push(d[D])}const y=d&&((T=this._enabledFilters)==null?void 0:T.length)||g&&(!g.isMaskData||g.enabled&&(g.autoDetect||g.type!==S.A7.NONE));if(y&&u.batch.flush(),d&&((E=this._enabledFilters)!=null&&E.length)&&u.filter.push(this,this._enabledFilters),g&&u.mask.push(this,this._mask),this.cullable)this._renderWithCulling(u);else{this._render(u);for(let D=0,B=this.children.length;D<B;++D)this.children[D].render(u)}y&&u.batch.flush(),g&&u.mask.pop(this),d&&((P=this._enabledFilters)!=null&&P.length)&&u.filter.pop()}_render(u){}destroy(u){super.destroy(),this.sortDirty=!1;const d=typeof u=="boolean"?u:u==null?void 0:u.children,g=this.removeChildren(0,this.children.length);if(d)for(let y=0;y<g.length;++y)g[y].destroy(u)}get width(){return this.scale.x*this.getLocalBounds().width}set width(u){const d=this.getLocalBounds().width;d!==0?this.scale.x=u/d:this.scale.x=1,this._width=u}get height(){return this.scale.y*this.getLocalBounds().height}set height(u){const d=this.getLocalBounds().height;d!==0?this.scale.y=u/d:this.scale.y=1,this._height=u}};nt.defaultSortableChildren=!1;let mt=nt;mt.prototype.containerUpdateTransform=mt.prototype.updateTransform,Object.defineProperties(S.Xd,{SORTABLE_CHILDREN:{get(){return mt.defaultSortableChildren},set(C){S.P6.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),mt.defaultSortableChildren=C}}});const at=new S.E9,L=new Uint16Array([0,1,2,0,2,3]);class $ extends mt{constructor(u){super(),this._anchor=new S.AB(this._onAnchorUpdate,this,u?u.defaultAnchor.x:0,u?u.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new S.Il(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=S.T$.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=u||S.xE.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=L,this.pluginName="batch",this.isSprite=!0,this._roundPixels=S.Xd.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=S.P6.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=S.P6.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const u=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===u._updateID)return;this._textureID!==u._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=u._updateID;const d=this.transform.worldTransform,g=d.a,y=d.b,T=d.c,E=d.d,P=d.tx,D=d.ty,B=this.vertexData,G=u.trim,X=u.orig,W=this._anchor;let j=0,et=0,ht=0,wt=0;if(G?(et=G.x-W._x*X.width,j=et+G.width,wt=G.y-W._y*X.height,ht=wt+G.height):(et=-W._x*X.width,j=et+X.width,wt=-W._y*X.height,ht=wt+X.height),B[0]=g*et+T*wt+P,B[1]=E*wt+y*et+D,B[2]=g*j+T*wt+P,B[3]=E*wt+y*j+D,B[4]=g*j+T*ht+P,B[5]=E*ht+y*j+D,B[6]=g*et+T*ht+P,B[7]=E*ht+y*et+D,this._roundPixels){const Tt=S.Xd.RESOLUTION;for(let jt=0;jt<B.length;++jt)B[jt]=Math.round(B[jt]*Tt)/Tt}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const u=this._texture,d=this.vertexTrimmedData,g=u.orig,y=this._anchor,T=this.transform.worldTransform,E=T.a,P=T.b,D=T.c,B=T.d,G=T.tx,X=T.ty,W=-y._x*g.width,j=W+g.width,et=-y._y*g.height,ht=et+g.height;if(d[0]=E*W+D*et+G,d[1]=B*et+P*W+X,d[2]=E*j+D*et+G,d[3]=B*et+P*j+X,d[4]=E*j+D*ht+G,d[5]=B*ht+P*j+X,d[6]=E*W+D*ht+G,d[7]=B*ht+P*W+X,this._roundPixels){const wt=S.Xd.RESOLUTION;for(let Tt=0;Tt<d.length;++Tt)d[Tt]=Math.round(d[Tt]*wt)/wt}}_render(u){this.calculateVertices(),u.batch.setObjectRenderer(u.plugins[this.pluginName]),u.plugins[this.pluginName].render(this)}_calculateBounds(){const u=this._texture.trim,d=this._texture.orig;!u||u.width===d.width&&u.height===d.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(u){return this.children.length===0?(this._localBounds||(this._localBounds=new ct),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),u||(this._localBoundsRect||(this._localBoundsRect=new S.Ae),u=this._localBoundsRect),this._localBounds.getRectangle(u)):super.getLocalBounds.call(this,u)}containsPoint(u){this.worldTransform.applyInverse(u,at);const d=this._texture.orig.width,g=this._texture.orig.height,y=-d*this.anchor.x;let T=0;return at.x>=y&&at.x<y+d&&(T=-g*this.anchor.y,at.y>=T&&at.y<T+g)}destroy(u){if(super.destroy(u),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof u=="boolean"?u:u==null?void 0:u.texture){const d=typeof u=="boolean"?u:u==null?void 0:u.baseTexture;this._texture.destroy(!!d)}this._texture=null}static from(u,d){const g=u instanceof S.xE?u:S.xE.from(u,d);return new $(g)}set roundPixels(u){this._roundPixels!==u&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=u}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(u){const d=S.P6.sign(this.scale.x)||1;this.scale.x=d*u/this._texture.orig.width,this._width=u}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(u){const d=S.P6.sign(this.scale.y)||1;this.scale.y=d*u/this._texture.orig.height,this._height=u}get anchor(){return this._anchor}set anchor(u){this._anchor.copyFrom(u)}get tint(){return this._tintColor.value}set tint(u){this._tintColor.setValue(u),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(u){this._texture!==u&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=u||S.xE.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,u&&(u.baseTexture.valid?this._onTextureUpdate():u.once("update",this._onTextureUpdate,this)))}}const tt=new S.y3;xt.prototype._cacheAsBitmap=!1,xt.prototype._cacheData=null,xt.prototype._cacheAsBitmapResolution=null,xt.prototype._cacheAsBitmapMultisample=null;class it{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(xt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(C){C!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=C,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(C){C!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=C,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(C){if(this._cacheAsBitmap===C)return;this._cacheAsBitmap=C;let u;C?(this._cacheData||(this._cacheData=new it),u=this._cacheData,u.originalRender=this.render,u.originalRenderCanvas=this.renderCanvas,u.originalUpdateTransform=this.updateTransform,u.originalCalculateBounds=this.calculateBounds,u.originalGetLocalBounds=this.getLocalBounds,u.originalDestroy=this.destroy,u.originalContainsPoint=this.containsPoint,u.originalMask=this._mask,u.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(u=this._cacheData,u.sprite&&this._destroyCachedDisplayObject(),this.render=u.originalRender,this.renderCanvas=u.originalRenderCanvas,this.calculateBounds=u.originalCalculateBounds,this.getLocalBounds=u.originalGetLocalBounds,this.destroy=u.originalDestroy,this.updateTransform=u.originalUpdateTransform,this.containsPoint=u.originalContainsPoint,this._mask=u.originalMask,this.filterArea=u.originalFilterArea)}}}),xt.prototype._renderCached=function(C){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(C),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(C))},xt.prototype._initCachedDisplayObject=function(C){var W,j,et;if((W=this._cacheData)!=null&&W.sprite)return;const u=this.alpha;this.alpha=1,C.batch.flush();const d=this.getLocalBounds(new S.Ae,!0);if((j=this.filters)!=null&&j.length){const ht=this.filters[0].padding;d.pad(ht)}const g=this.cacheAsBitmapResolution||C.resolution;d.ceil(g),d.width=Math.max(d.width,1/g),d.height=Math.max(d.height,1/g);const y=C.renderTexture.current,T=C.renderTexture.sourceFrame.clone(),E=C.renderTexture.destinationFrame.clone(),P=C.projection.transform,D=S.TI.create({width:d.width,height:d.height,resolution:g,multisample:(et=this.cacheAsBitmapMultisample)!=null?et:C.multisample}),B=`cacheAsBitmap_${S.P6.uid()}`;this._cacheData.textureCacheId=B,S.VL.addToCache(D.baseTexture,B),S.xE.addToCache(D,B);const G=this.transform.localTransform.copyTo(tt).invert().translate(-d.x,-d.y);this.render=this._cacheData.originalRender,C.render(this,{renderTexture:D,clear:!0,transform:G,skipUpdateTransform:!1}),C.framebuffer.blit(),C.projection.transform=P,C.renderTexture.bind(y,T,E),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=u;const X=new $(D);X.transform.worldTransform=this.transform.worldTransform,X.anchor.x=-(d.x/d.width),X.anchor.y=-(d.y/d.height),X.alpha=u,X._bounds=this._bounds,this._cacheData.sprite=X,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=X.containsPoint.bind(X)},xt.prototype._renderCachedCanvas=function(C){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(C),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(C))},xt.prototype._initCachedDisplayObjectCanvas=function(C){var G;if((G=this._cacheData)!=null&&G.sprite)return;const u=this.getLocalBounds(new S.Ae,!0),d=this.alpha;this.alpha=1;const g=C.canvasContext.activeContext,y=C._projTransform,T=this.cacheAsBitmapResolution||C.resolution;u.ceil(T),u.width=Math.max(u.width,1/T),u.height=Math.max(u.height,1/T);const E=S.TI.create({width:u.width,height:u.height,resolution:T}),P=`cacheAsBitmap_${S.P6.uid()}`;this._cacheData.textureCacheId=P,S.VL.addToCache(E.baseTexture,P),S.xE.addToCache(E,P);const D=tt;this.transform.localTransform.copyTo(D),D.invert(),D.tx-=u.x,D.ty-=u.y,this.renderCanvas=this._cacheData.originalRenderCanvas,C.render(this,{renderTexture:E,clear:!0,transform:D,skipUpdateTransform:!1}),C.canvasContext.activeContext=g,C._projTransform=y,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=d;const B=new $(E);B.transform.worldTransform=this.transform.worldTransform,B.anchor.x=-(u.x/u.width),B.anchor.y=-(u.y/u.height),B.alpha=d,B._bounds=this._bounds,this._cacheData.sprite=B,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=C._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=B.containsPoint.bind(B)},xt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},xt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},xt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,S.VL.removeFromCache(this._cacheData.textureCacheId),S.xE.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},xt.prototype._cacheAsBitmapDestroy=function(C){this.cacheAsBitmap=!1,this.destroy(C)},xt.prototype.name=null,mt.prototype.getChildByName=function(C,u){for(let d=0,g=this.children.length;d<g;d++)if(this.children[d].name===C)return this.children[d];if(u)for(let d=0,g=this.children.length;d<g;d++){const y=this.children[d];if(!y.getChildByName)continue;const T=y.getChildByName(C,!0);if(T)return T}return null},xt.prototype.getGlobalPosition=function(C=new S.E9,u=!1){return this.parent?this.parent.toGlobal(this.position,C,u):(C.x=this.position.x,C.y=this.position.y),C};var Z=dt(121),ft=dt(844),yt=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class K extends S.wn{constructor(){const u={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(S.Y9,yt,u),this.alpha=1}_loadMatrix(u,d=!1){let g=u;d&&(this._multiply(g,this.uniforms.m,u),g=this._colorMatrix(g)),this.uniforms.m=g}_multiply(u,d,g){return u[0]=d[0]*g[0]+d[1]*g[5]+d[2]*g[10]+d[3]*g[15],u[1]=d[0]*g[1]+d[1]*g[6]+d[2]*g[11]+d[3]*g[16],u[2]=d[0]*g[2]+d[1]*g[7]+d[2]*g[12]+d[3]*g[17],u[3]=d[0]*g[3]+d[1]*g[8]+d[2]*g[13]+d[3]*g[18],u[4]=d[0]*g[4]+d[1]*g[9]+d[2]*g[14]+d[3]*g[19]+d[4],u[5]=d[5]*g[0]+d[6]*g[5]+d[7]*g[10]+d[8]*g[15],u[6]=d[5]*g[1]+d[6]*g[6]+d[7]*g[11]+d[8]*g[16],u[7]=d[5]*g[2]+d[6]*g[7]+d[7]*g[12]+d[8]*g[17],u[8]=d[5]*g[3]+d[6]*g[8]+d[7]*g[13]+d[8]*g[18],u[9]=d[5]*g[4]+d[6]*g[9]+d[7]*g[14]+d[8]*g[19]+d[9],u[10]=d[10]*g[0]+d[11]*g[5]+d[12]*g[10]+d[13]*g[15],u[11]=d[10]*g[1]+d[11]*g[6]+d[12]*g[11]+d[13]*g[16],u[12]=d[10]*g[2]+d[11]*g[7]+d[12]*g[12]+d[13]*g[17],u[13]=d[10]*g[3]+d[11]*g[8]+d[12]*g[13]+d[13]*g[18],u[14]=d[10]*g[4]+d[11]*g[9]+d[12]*g[14]+d[13]*g[19]+d[14],u[15]=d[15]*g[0]+d[16]*g[5]+d[17]*g[10]+d[18]*g[15],u[16]=d[15]*g[1]+d[16]*g[6]+d[17]*g[11]+d[18]*g[16],u[17]=d[15]*g[2]+d[16]*g[7]+d[17]*g[12]+d[18]*g[17],u[18]=d[15]*g[3]+d[16]*g[8]+d[17]*g[13]+d[18]*g[18],u[19]=d[15]*g[4]+d[16]*g[9]+d[17]*g[14]+d[18]*g[19]+d[19],u}_colorMatrix(u){const d=new Float32Array(u);return d[4]/=255,d[9]/=255,d[14]/=255,d[19]/=255,d}brightness(u,d){const g=[u,0,0,0,0,0,u,0,0,0,0,0,u,0,0,0,0,0,1,0];this._loadMatrix(g,d)}tint(u,d){const[g,y,T]=S.Il.shared.setValue(u).toArray(),E=[g,0,0,0,0,0,y,0,0,0,0,0,T,0,0,0,0,0,1,0];this._loadMatrix(E,d)}greyscale(u,d){const g=[u,u,u,0,0,u,u,u,0,0,u,u,u,0,0,0,0,0,1,0];this._loadMatrix(g,d)}blackAndWhite(u){const d=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(d,u)}hue(u,d){u=(u||0)/180*Math.PI;const g=Math.cos(u),y=Math.sin(u),T=Math.sqrt,E=1/3,P=T(E),D=g+(1-g)*E,B=E*(1-g)-P*y,G=E*(1-g)+P*y,X=E*(1-g)+P*y,W=g+E*(1-g),j=E*(1-g)-P*y,et=E*(1-g)-P*y,ht=E*(1-g)+P*y,wt=g+E*(1-g),Tt=[D,B,G,0,0,X,W,j,0,0,et,ht,wt,0,0,0,0,0,1,0];this._loadMatrix(Tt,d)}contrast(u,d){const g=(u||0)+1,y=-.5*(g-1),T=[g,0,0,0,y,0,g,0,0,y,0,0,g,0,y,0,0,0,1,0];this._loadMatrix(T,d)}saturate(u=0,d){const g=u*2/3+1,y=(g-1)*-.5,T=[g,y,y,0,0,y,g,y,0,0,y,y,g,0,0,0,0,0,1,0];this._loadMatrix(T,d)}desaturate(){this.saturate(-1)}negative(u){const d=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(d,u)}sepia(u){const d=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(d,u)}technicolor(u){const d=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(d,u)}polaroid(u){const d=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(d,u)}toBGR(u){const d=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(d,u)}kodachrome(u){const d=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(d,u)}browni(u){const d=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(d,u)}vintage(u){const d=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(d,u)}colorTone(u,d,g,y,T){u=u||.2,d=d||.15,g=g||16770432,y=y||3375104;const E=S.Il.shared,[P,D,B]=E.setValue(g).toArray(),[G,X,W]=E.setValue(y).toArray(),j=[.3,.59,.11,0,0,P,D,B,u,0,G,X,W,d,0,P-G,D-X,B-W,0,0];this._loadMatrix(j,T)}night(u,d){u=u||.1;const g=[u*-2,-u,0,0,0,-u,0,u,0,0,0,u,u*2,0,0,0,0,0,1,0];this._loadMatrix(g,d)}predator(u,d){const g=[11.224130630493164*u,-4.794486999511719*u,-2.8746118545532227*u,0*u,.40342438220977783*u,-3.6330697536468506*u,9.193157196044922*u,-2.951810836791992*u,0*u,-1.316135048866272*u,-3.2184197902679443*u,-4.2375030517578125*u,7.476448059082031*u,0*u,.8044459223747253*u,0,0,0,1,0];this._loadMatrix(g,d)}lsd(u){const d=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(d,u)}reset(){const u=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(u,!1)}get matrix(){return this.uniforms.m}set matrix(u){this.uniforms.m=u}get alpha(){return this.uniforms.uAlpha}set alpha(u){this.uniforms.uAlpha=u}}K.prototype.grayscale=K.prototype.greyscale;var lt=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,_t=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class It extends S.wn{constructor(u,d){const g=new S.y3;u.renderable=!1,super(_t,lt,{mapSampler:u._texture,filterMatrix:g,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=u,this.maskMatrix=g,d==null&&(d=20),this.scale=new S.E9(d,d)}apply(u,d,g,y){this.uniforms.filterMatrix=u.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const T=this.maskSprite.worldTransform,E=Math.sqrt(T.a*T.a+T.b*T.b),P=Math.sqrt(T.c*T.c+T.d*T.d);E!==0&&P!==0&&(this.uniforms.rotation[0]=T.a/E,this.uniforms.rotation[1]=T.b/E,this.uniforms.rotation[2]=T.c/P,this.uniforms.rotation[3]=T.d/P),u.applyFilter(this,d,g,y)}get map(){return this.uniforms.mapSampler}set map(u){this.uniforms.mapSampler=u}}var Et=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,Dt=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class q extends S.wn{constructor(){super(Dt,Et)}}var At=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class ot extends S.wn{constructor(u=.5,d=Math.random()){super(S.Y9,At,{uNoise:0,uSeed:0}),this.noise=u,this.seed=d}get noise(){return this.uniforms.uNoise}set noise(u){this.uniforms.uNoise=u}get seed(){return this.uniforms.uSeed}set seed(u){this.uniforms.uSeed=u}}const qt={AlphaFilter:Z.U,BlurFilter:ft.T,BlurFilterPass:ft.Y,ColorMatrixFilter:K,DisplacementFilter:It,FXAAFilter:q,NoiseFilter:ot};Object.entries(qt).forEach(([C,u])=>{Object.defineProperty(qt,C,{get(){return S.P6.deprecation("7.1.0",`filters.${C} has moved to ${C}`),u}})});class ve{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(u){this.removeTickerListener(),this.events=u,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(u){this._pauseUpdate=u}addTickerListener(){this.tickerAdded||!this.domElement||(S.vB.system.add(this.tickerUpdate,this,S.uF.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(S.vB.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const u=this.events.rootPointerEvent;this.events.supportsTouchEvents&&u.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:u.clientX,clientY:u.clientY}))}tickerUpdate(u){this._deltaTime+=u,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const _e=new ve;class ye{constructor(u){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=ye.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new S.E9,this.page=new S.E9,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=u}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(u,d,g){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(u,d,g,y,T){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class zt extends ye{constructor(){super(...arguments),this.client=new S.E9,this.movement=new S.E9,this.offset=new S.E9,this.global=new S.E9,this.screen=new S.E9}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(u,d,g){return u.worldTransform.applyInverse(g||this.global,d)}getModifierState(u){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(u)}initMouseEvent(u,d,g,y,T,E,P,D,B,G,X,W,j,et,ht){throw new Error("Method not implemented.")}}class z extends zt{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class st extends zt{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}st.DOM_DELTA_PIXEL=0,st.DOM_DELTA_LINE=1,st.DOM_DELTA_PAGE=2;const rt=2048,Pt=new S.E9,St=new S.E9;class ut{constructor(u){this.dispatch=new S.P6.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=u,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(u,d){this.mappingTable[u]||(this.mappingTable[u]=[]),this.mappingTable[u].push({fn:d,priority:0}),this.mappingTable[u].sort((g,y)=>g.priority-y.priority)}dispatchEvent(u,d){u.propagationStopped=!1,u.propagationImmediatelyStopped=!1,this.propagate(u,d),this.dispatch.emit(d||u.type,u)}mapEvent(u){if(!this.rootTarget)return;const d=this.mappingTable[u.type];if(d)for(let g=0,y=d.length;g<y;g++)d[g].fn(u);else console.warn(`[EventBoundary]: Event mapping not defined for ${u.type}`)}hitTest(u,d){_e.pauseUpdate=!0;const g=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",y=this[g](this.rootTarget,this.rootTarget.eventMode,Pt.set(u,d),this.hitTestFn,this.hitPruneFn);return y&&y[0]}propagate(u,d){if(!u.target)return;const g=u.composedPath();u.eventPhase=u.CAPTURING_PHASE;for(let y=0,T=g.length-1;y<T;y++)if(u.currentTarget=g[y],this.notifyTarget(u,d),u.propagationStopped||u.propagationImmediatelyStopped)return;if(u.eventPhase=u.AT_TARGET,u.currentTarget=u.target,this.notifyTarget(u,d),!(u.propagationStopped||u.propagationImmediatelyStopped)){u.eventPhase=u.BUBBLING_PHASE;for(let y=g.length-2;y>=0;y--)if(u.currentTarget=g[y],this.notifyTarget(u,d),u.propagationStopped||u.propagationImmediatelyStopped)return}}all(u,d,g=this._allInteractiveElements){if(g.length===0)return;u.eventPhase=u.BUBBLING_PHASE;const y=Array.isArray(d)?d:[d];for(let T=g.length-1;T>=0;T--)y.forEach(E=>{u.currentTarget=g[T],this.notifyTarget(u,E)})}propagationPath(u){const d=[u];for(let g=0;g<rt&&u!==this.rootTarget;g++){if(!u.parent)throw new Error("Cannot find propagation path to disconnected target");d.push(u.parent),u=u.parent}return d.reverse(),d}hitTestMoveRecursive(u,d,g,y,T,E=!1){let P=!1;if(this._interactivePrune(u))return null;if((u.eventMode==="dynamic"||d==="dynamic")&&(_e.pauseUpdate=!1),u.interactiveChildren&&u.children){const G=u.children;for(let X=G.length-1;X>=0;X--){const W=G[X],j=this.hitTestMoveRecursive(W,this._isInteractive(d)?d:W.eventMode,g,y,T,E||T(u,g));if(j){if(j.length>0&&!j[j.length-1].parent)continue;const et=u.isInteractive();(j.length>0||et)&&(et&&this._allInteractiveElements.push(u),j.push(u)),this._hitElements.length===0&&(this._hitElements=j),P=!0}}}const D=this._isInteractive(d),B=u.isInteractive();return D&&B&&this._allInteractiveElements.push(u),E||this._hitElements.length>0?null:P?this._hitElements:D&&!T(u,g)&&y(u,g)?B?[u]:[]:null}hitTestRecursive(u,d,g,y,T){if(this._interactivePrune(u)||T(u,g))return null;if((u.eventMode==="dynamic"||d==="dynamic")&&(_e.pauseUpdate=!1),u.interactiveChildren&&u.children){const D=u.children;for(let B=D.length-1;B>=0;B--){const G=D[B],X=this.hitTestRecursive(G,this._isInteractive(d)?d:G.eventMode,g,y,T);if(X){if(X.length>0&&!X[X.length-1].parent)continue;const W=u.isInteractive();return(X.length>0||W)&&X.push(u),X}}}const E=this._isInteractive(d),P=u.isInteractive();return E&&y(u,g)?P?[u]:[]:null}_isInteractive(u){return u==="static"||u==="dynamic"}_interactivePrune(u){return!!(!u||u.isMask||!u.visible||!u.renderable||u.eventMode==="none"||u.eventMode==="passive"&&!u.interactiveChildren||u.isMask)}hitPruneFn(u,d){var g;if(u.hitArea&&(u.worldTransform.applyInverse(d,St),!u.hitArea.contains(St.x,St.y)))return!0;if(u._mask){const y=u._mask.isMaskData?u._mask.maskObject:u._mask;if(y&&!((g=y.containsPoint)!=null&&g.call(y,d)))return!0}return!1}hitTestFn(u,d){return u.eventMode==="passive"?!1:u.hitArea?!0:u.containsPoint?u.containsPoint(d):!1}notifyTarget(u,d){var T,E;d=d!=null?d:u.type;const g=`on${d}`;(E=(T=u.currentTarget)[g])==null||E.call(T,u);const y=u.eventPhase===u.CAPTURING_PHASE||u.eventPhase===u.AT_TARGET?`${d}capture`:d;this.notifyListeners(u,y),u.eventPhase===u.AT_TARGET&&this.notifyListeners(u,d)}mapPointerDown(u){if(!(u instanceof z)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const d=this.createPointerEvent(u);if(this.dispatchEvent(d,"pointerdown"),d.pointerType==="touch")this.dispatchEvent(d,"touchstart");else if(d.pointerType==="mouse"||d.pointerType==="pen"){const y=d.button===2;this.dispatchEvent(d,y?"rightdown":"mousedown")}const g=this.trackingData(u.pointerId);g.pressTargetsByButton[u.button]=d.composedPath(),this.freeEvent(d)}mapPointerMove(u){var D,B,G;if(!(u instanceof z)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const d=this.createPointerEvent(u);this._isPointerMoveEvent=!1;const g=d.pointerType==="mouse"||d.pointerType==="pen",y=this.trackingData(u.pointerId),T=this.findMountedTarget(y.overTargets);if(((D=y.overTargets)==null?void 0:D.length)>0&&T!==d.target){const X=u.type==="mousemove"?"mouseout":"pointerout",W=this.createPointerEvent(u,X,T);if(this.dispatchEvent(W,"pointerout"),g&&this.dispatchEvent(W,"mouseout"),!d.composedPath().includes(T)){const j=this.createPointerEvent(u,"pointerleave",T);for(j.eventPhase=j.AT_TARGET;j.target&&!d.composedPath().includes(j.target);)j.currentTarget=j.target,this.notifyTarget(j),g&&this.notifyTarget(j,"mouseleave"),j.target=j.target.parent;this.freeEvent(j)}this.freeEvent(W)}if(T!==d.target){const X=u.type==="mousemove"?"mouseover":"pointerover",W=this.clonePointerEvent(d,X);this.dispatchEvent(W,"pointerover"),g&&this.dispatchEvent(W,"mouseover");let j=T==null?void 0:T.parent;for(;j&&j!==this.rootTarget.parent&&j!==d.target;)j=j.parent;if(!j||j===this.rootTarget.parent){const et=this.clonePointerEvent(d,"pointerenter");for(et.eventPhase=et.AT_TARGET;et.target&&et.target!==T&&et.target!==this.rootTarget.parent;)et.currentTarget=et.target,this.notifyTarget(et),g&&this.notifyTarget(et,"mouseenter"),et.target=et.target.parent;this.freeEvent(et)}this.freeEvent(W)}const E=[],P=(B=this.enableGlobalMoveEvents)!=null?B:!0;this.moveOnAll?E.push("pointermove"):this.dispatchEvent(d,"pointermove"),P&&E.push("globalpointermove"),d.pointerType==="touch"&&(this.moveOnAll?E.splice(1,0,"touchmove"):this.dispatchEvent(d,"touchmove"),P&&E.push("globaltouchmove")),g&&(this.moveOnAll?E.splice(1,0,"mousemove"):this.dispatchEvent(d,"mousemove"),P&&E.push("globalmousemove"),this.cursor=(G=d.target)==null?void 0:G.cursor),E.length>0&&this.all(d,E),this._allInteractiveElements.length=0,this._hitElements.length=0,y.overTargets=d.composedPath(),this.freeEvent(d)}mapPointerOver(u){var E;if(!(u instanceof z)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const d=this.trackingData(u.pointerId),g=this.createPointerEvent(u),y=g.pointerType==="mouse"||g.pointerType==="pen";this.dispatchEvent(g,"pointerover"),y&&this.dispatchEvent(g,"mouseover"),g.pointerType==="mouse"&&(this.cursor=(E=g.target)==null?void 0:E.cursor);const T=this.clonePointerEvent(g,"pointerenter");for(T.eventPhase=T.AT_TARGET;T.target&&T.target!==this.rootTarget.parent;)T.currentTarget=T.target,this.notifyTarget(T),y&&this.notifyTarget(T,"mouseenter"),T.target=T.target.parent;d.overTargets=g.composedPath(),this.freeEvent(g),this.freeEvent(T)}mapPointerOut(u){if(!(u instanceof z)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const d=this.trackingData(u.pointerId);if(d.overTargets){const g=u.pointerType==="mouse"||u.pointerType==="pen",y=this.findMountedTarget(d.overTargets),T=this.createPointerEvent(u,"pointerout",y);this.dispatchEvent(T),g&&this.dispatchEvent(T,"mouseout");const E=this.createPointerEvent(u,"pointerleave",y);for(E.eventPhase=E.AT_TARGET;E.target&&E.target!==this.rootTarget.parent;)E.currentTarget=E.target,this.notifyTarget(E),g&&this.notifyTarget(E,"mouseleave"),E.target=E.target.parent;d.overTargets=null,this.freeEvent(T),this.freeEvent(E)}this.cursor=null}mapPointerUp(u){if(!(u instanceof z)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const d=performance.now(),g=this.createPointerEvent(u);if(this.dispatchEvent(g,"pointerup"),g.pointerType==="touch")this.dispatchEvent(g,"touchend");else if(g.pointerType==="mouse"||g.pointerType==="pen"){const P=g.button===2;this.dispatchEvent(g,P?"rightup":"mouseup")}const y=this.trackingData(u.pointerId),T=this.findMountedTarget(y.pressTargetsByButton[u.button]);let E=T;if(T&&!g.composedPath().includes(T)){let P=T;for(;P&&!g.composedPath().includes(P);){if(g.currentTarget=P,this.notifyTarget(g,"pointerupoutside"),g.pointerType==="touch")this.notifyTarget(g,"touchendoutside");else if(g.pointerType==="mouse"||g.pointerType==="pen"){const D=g.button===2;this.notifyTarget(g,D?"rightupoutside":"mouseupoutside")}P=P.parent}delete y.pressTargetsByButton[u.button],E=P}if(E){const P=this.clonePointerEvent(g,"click");P.target=E,P.path=null,y.clicksByButton[u.button]||(y.clicksByButton[u.button]={clickCount:0,target:P.target,timeStamp:d});const D=y.clicksByButton[u.button];if(D.target===P.target&&d-D.timeStamp<200?++D.clickCount:D.clickCount=1,D.target=P.target,D.timeStamp=d,P.detail=D.clickCount,P.pointerType==="mouse"){const B=P.button===2;this.dispatchEvent(P,B?"rightclick":"click")}else P.pointerType==="touch"&&this.dispatchEvent(P,"tap");this.dispatchEvent(P,"pointertap"),this.freeEvent(P)}this.freeEvent(g)}mapPointerUpOutside(u){if(!(u instanceof z)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const d=this.trackingData(u.pointerId),g=this.findMountedTarget(d.pressTargetsByButton[u.button]),y=this.createPointerEvent(u);if(g){let T=g;for(;T;)y.currentTarget=T,this.notifyTarget(y,"pointerupoutside"),y.pointerType==="touch"?this.notifyTarget(y,"touchendoutside"):(y.pointerType==="mouse"||y.pointerType==="pen")&&this.notifyTarget(y,y.button===2?"rightupoutside":"mouseupoutside"),T=T.parent;delete d.pressTargetsByButton[u.button]}this.freeEvent(y)}mapWheel(u){if(!(u instanceof st)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const d=this.createWheelEvent(u);this.dispatchEvent(d),this.freeEvent(d)}findMountedTarget(u){if(!u)return null;let d=u[0];for(let g=1;g<u.length&&u[g].parent===d;g++)d=u[g];return d}createPointerEvent(u,d,g){var T;const y=this.allocateEvent(z);return this.copyPointerData(u,y),this.copyMouseData(u,y),this.copyData(u,y),y.nativeEvent=u.nativeEvent,y.originalEvent=u,y.target=(T=g!=null?g:this.hitTest(y.global.x,y.global.y))!=null?T:this._hitElements[0],typeof d=="string"&&(y.type=d),y}createWheelEvent(u){const d=this.allocateEvent(st);return this.copyWheelData(u,d),this.copyMouseData(u,d),this.copyData(u,d),d.nativeEvent=u.nativeEvent,d.originalEvent=u,d.target=this.hitTest(d.global.x,d.global.y),d}clonePointerEvent(u,d){const g=this.allocateEvent(z);return g.nativeEvent=u.nativeEvent,g.originalEvent=u.originalEvent,this.copyPointerData(u,g),this.copyMouseData(u,g),this.copyData(u,g),g.target=u.target,g.path=u.composedPath().slice(),g.type=d!=null?d:g.type,g}copyWheelData(u,d){d.deltaMode=u.deltaMode,d.deltaX=u.deltaX,d.deltaY=u.deltaY,d.deltaZ=u.deltaZ}copyPointerData(u,d){u instanceof z&&d instanceof z&&(d.pointerId=u.pointerId,d.width=u.width,d.height=u.height,d.isPrimary=u.isPrimary,d.pointerType=u.pointerType,d.pressure=u.pressure,d.tangentialPressure=u.tangentialPressure,d.tiltX=u.tiltX,d.tiltY=u.tiltY,d.twist=u.twist)}copyMouseData(u,d){u instanceof zt&&d instanceof zt&&(d.altKey=u.altKey,d.button=u.button,d.buttons=u.buttons,d.client.copyFrom(u.client),d.ctrlKey=u.ctrlKey,d.metaKey=u.metaKey,d.movement.copyFrom(u.movement),d.screen.copyFrom(u.screen),d.shiftKey=u.shiftKey,d.global.copyFrom(u.global))}copyData(u,d){d.isTrusted=u.isTrusted,d.srcElement=u.srcElement,d.timeStamp=performance.now(),d.type=u.type,d.detail=u.detail,d.view=u.view,d.which=u.which,d.layer.copyFrom(u.layer),d.page.copyFrom(u.page)}trackingData(u){return this.mappingState.trackingData[u]||(this.mappingState.trackingData[u]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[u]}allocateEvent(u){this.eventPool.has(u)||this.eventPool.set(u,[]);const d=this.eventPool.get(u).pop()||new u(this);return d.eventPhase=d.NONE,d.currentTarget=null,d.path=null,d.target=null,d}freeEvent(u){if(u.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const d=u.constructor;this.eventPool.has(d)||this.eventPool.set(d,[]),this.eventPool.get(d).push(u)}notifyListeners(u,d){const g=u.currentTarget._events[d];if(g&&u.currentTarget.isInteractive())if("fn"in g)g.once&&u.currentTarget.removeListener(d,g.fn,void 0,!0),g.fn.call(g.context,u);else for(let y=0,T=g.length;y<T&&!u.propagationImmediatelyStopped;y++)g[y].once&&u.currentTarget.removeListener(d,g[y].fn,void 0,!0),g[y].fn.call(g[y].context,u)}}const bt=1,Nt={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Vt=class Po{constructor(u){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=u,this.rootBoundary=new ut(null),_e.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new z(null),this.rootWheelEvent=new st(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy(Qe({},Po.defaultEventFeatures),{set:(d,g,y)=>(g==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=y),d[g]=y,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(u){var y,T;const{view:d,resolution:g}=this.renderer;this.setTargetElement(d),this.resolution=g,Po._defaultEventMode=(y=u.eventMode)!=null?y:"auto",Object.assign(this.features,(T=u.eventFeatures)!=null?T:{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(u){this.resolution=u}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(u){u=u||"default";let d=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(d=!1),this.currentCursor===u)return;this.currentCursor=u;const g=this.cursorStyles[u];if(g)switch(typeof g){case"string":d&&(this.domElement.style.cursor=g);break;case"function":g(u);break;case"object":d&&Object.assign(this.domElement.style,g);break}else d&&typeof u=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,u)&&(this.domElement.style.cursor=u)}get pointer(){return this.rootPointerEvent}onPointerDown(u){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const d=this.normalizeToPointerData(u);this.autoPreventDefault&&d[0].isNormalized&&(u.cancelable||!("cancelable"in u))&&u.preventDefault();for(let g=0,y=d.length;g<y;g++){const T=d[g],E=this.bootstrapEvent(this.rootPointerEvent,T);this.rootBoundary.mapEvent(E)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(u){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,_e.pointerMoved();const d=this.normalizeToPointerData(u);for(let g=0,y=d.length;g<y;g++){const T=this.bootstrapEvent(this.rootPointerEvent,d[g]);this.rootBoundary.mapEvent(T)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(u){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let d=u.target;u.composedPath&&u.composedPath().length>0&&(d=u.composedPath()[0]);const g=d!==this.domElement?"outside":"",y=this.normalizeToPointerData(u);for(let T=0,E=y.length;T<E;T++){const P=this.bootstrapEvent(this.rootPointerEvent,y[T]);P.type+=g,this.rootBoundary.mapEvent(P)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(u){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const d=this.normalizeToPointerData(u);for(let g=0,y=d.length;g<y;g++){const T=this.bootstrapEvent(this.rootPointerEvent,d[g]);this.rootBoundary.mapEvent(T)}this.setCursor(this.rootBoundary.cursor)}onWheel(u){if(!this.features.wheel)return;const d=this.normalizeWheelEvent(u);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(d)}setTargetElement(u){this.removeEvents(),this.domElement=u,_e.domElement=u,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;_e.addTickerListener();const u=this.domElement.style;u&&(globalThis.navigator.msPointerEnabled?(u.msContentZooming="none",u.msTouchAction="none"):this.supportsPointerEvents&&(u.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;_e.removeTickerListener();const u=this.domElement.style;globalThis.navigator.msPointerEnabled?(u.msContentZooming="",u.msTouchAction=""):this.supportsPointerEvents&&(u.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(u,d,g){const y=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},T=1/this.resolution;u.x=(d-y.left)*(this.domElement.width/y.width)*T,u.y=(g-y.top)*(this.domElement.height/y.height)*T}normalizeToPointerData(u){const d=[];if(this.supportsTouchEvents&&u instanceof TouchEvent)for(let g=0,y=u.changedTouches.length;g<y;g++){const T=u.changedTouches[g];typeof T.button>"u"&&(T.button=0),typeof T.buttons>"u"&&(T.buttons=1),typeof T.isPrimary>"u"&&(T.isPrimary=u.touches.length===1&&u.type==="touchstart"),typeof T.width>"u"&&(T.width=T.radiusX||1),typeof T.height>"u"&&(T.height=T.radiusY||1),typeof T.tiltX>"u"&&(T.tiltX=0),typeof T.tiltY>"u"&&(T.tiltY=0),typeof T.pointerType>"u"&&(T.pointerType="touch"),typeof T.pointerId>"u"&&(T.pointerId=T.identifier||0),typeof T.pressure>"u"&&(T.pressure=T.force||.5),typeof T.twist>"u"&&(T.twist=0),typeof T.tangentialPressure>"u"&&(T.tangentialPressure=0),typeof T.layerX>"u"&&(T.layerX=T.offsetX=T.clientX),typeof T.layerY>"u"&&(T.layerY=T.offsetY=T.clientY),T.isNormalized=!0,T.type=u.type,d.push(T)}else if(!globalThis.MouseEvent||u instanceof MouseEvent&&(!this.supportsPointerEvents||!(u instanceof globalThis.PointerEvent))){const g=u;typeof g.isPrimary>"u"&&(g.isPrimary=!0),typeof g.width>"u"&&(g.width=1),typeof g.height>"u"&&(g.height=1),typeof g.tiltX>"u"&&(g.tiltX=0),typeof g.tiltY>"u"&&(g.tiltY=0),typeof g.pointerType>"u"&&(g.pointerType="mouse"),typeof g.pointerId>"u"&&(g.pointerId=bt),typeof g.pressure>"u"&&(g.pressure=.5),typeof g.twist>"u"&&(g.twist=0),typeof g.tangentialPressure>"u"&&(g.tangentialPressure=0),g.isNormalized=!0,d.push(g)}else d.push(u);return d}normalizeWheelEvent(u){const d=this.rootWheelEvent;return this.transferMouseData(d,u),d.deltaX=u.deltaX,d.deltaY=u.deltaY,d.deltaZ=u.deltaZ,d.deltaMode=u.deltaMode,this.mapPositionToPoint(d.screen,u.clientX,u.clientY),d.global.copyFrom(d.screen),d.offset.copyFrom(d.screen),d.nativeEvent=u,d.type=u.type,d}bootstrapEvent(u,d){return u.originalEvent=null,u.nativeEvent=d,u.pointerId=d.pointerId,u.width=d.width,u.height=d.height,u.isPrimary=d.isPrimary,u.pointerType=d.pointerType,u.pressure=d.pressure,u.tangentialPressure=d.tangentialPressure,u.tiltX=d.tiltX,u.tiltY=d.tiltY,u.twist=d.twist,this.transferMouseData(u,d),this.mapPositionToPoint(u.screen,d.clientX,d.clientY),u.global.copyFrom(u.screen),u.offset.copyFrom(u.screen),u.isTrusted=d.isTrusted,u.type==="pointerleave"&&(u.type="pointerout"),u.type.startsWith("mouse")&&(u.type=u.type.replace("mouse","pointer")),u.type.startsWith("touch")&&(u.type=Nt[u.type]||u.type),u}transferMouseData(u,d){u.isTrusted=d.isTrusted,u.srcElement=d.srcElement,u.timeStamp=performance.now(),u.type=d.type,u.altKey=d.altKey,u.button=d.button,u.buttons=d.buttons,u.client.x=d.clientX,u.client.y=d.clientY,u.ctrlKey=d.ctrlKey,u.metaKey=d.metaKey,u.movement.x=d.movementX,u.movement.y=d.movementY,u.page.x=d.pageX,u.page.y=d.pageY,u.relatedTarget=null,u.shiftKey=d.shiftKey}};Vt.extension={name:"events",type:[S.nw.RendererSystem,S.nw.CanvasRendererSystem]},Vt.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let Bt=Vt;S.Rw.add(Bt);function Ht(C){return C==="dynamic"||C==="static"}const Qt={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){var C;return(C=this._internalInteractive)!=null?C:Ht(Bt.defaultEventMode)},set interactive(C){S.P6.deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=C,this.eventMode=C?"static":"auto"},_internalEventMode:void 0,get eventMode(){var C;return(C=this._internalEventMode)!=null?C:Bt.defaultEventMode},set eventMode(C){this._internalInteractive=Ht(C),this._internalEventMode=C},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(C,u,d){const g=typeof d=="boolean"&&d||typeof d=="object"&&d.capture,y=typeof u=="function"?void 0:u;C=g?`${C}capture`:C,u=typeof u=="function"?u:u.handleEvent,this.on(C,u,y)},removeEventListener(C,u,d){const g=typeof d=="boolean"&&d||typeof d=="object"&&d.capture,y=typeof u=="function"?void 0:u;C=g?`${C}capture`:C,u=typeof u=="function"?u:u.handleEvent,this.off(C,u,y)},dispatchEvent(C){if(!(C instanceof ye))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return C.defaultPrevented=!1,C.path=null,C.target=this,C.manager.dispatchEvent(C),!C.defaultPrevented}};xt.mixin(Qt);const ee={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};xt.mixin(ee);const le=9,he=100,Xe=0,Ee=0,te=2,We=1,ue=-1e3,fe=-1e3,Se=2;class Er{constructor(u){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(S.P6.isMobile.tablet||S.P6.isMobile.phone)&&this.createTouchHook();const d=document.createElement("div");d.style.width=`${he}px`,d.style.height=`${he}px`,d.style.position="absolute",d.style.top=`${Xe}px`,d.style.left=`${Ee}px`,d.style.zIndex=te.toString(),this.div=d,this.renderer=u,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const u=document.createElement("button");u.style.width=`${We}px`,u.style.height=`${We}px`,u.style.position="absolute",u.style.top=`${ue}px`,u.style.left=`${fe}px`,u.style.zIndex=Se.toString(),u.style.backgroundColor="#FF0000",u.title="select to enable accessibility for this content",u.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(u),this._hookDiv=u}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var u;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(u=this.renderer.view.parentNode)==null||u.appendChild(this.div))}deactivate(){var u;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(u=this.div.parentNode)==null||u.removeChild(this.div))}updateAccessibleObjects(u){if(!u.visible||!u.accessibleChildren)return;u.accessible&&u.isInteractive()&&(u._accessibleActive||this.addChild(u),u.renderId=this.renderId);const d=u.children;if(d)for(let g=0;g<d.length;g++)this.updateAccessibleObjects(d[g])}update(){const u=performance.now();if(S.P6.isMobile.android.device&&u<this.androidUpdateCount||(this.androidUpdateCount=u+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:d,y:g,width:y,height:T}=this.renderer.view.getBoundingClientRect(),{width:E,height:P,resolution:D}=this.renderer,B=y/E*D,G=T/P*D;let X=this.div;X.style.left=`${d}px`,X.style.top=`${g}px`,X.style.width=`${E}px`,X.style.height=`${P}px`;for(let W=0;W<this.children.length;W++){const j=this.children[W];if(j.renderId!==this.renderId)j._accessibleActive=!1,S.P6.removeItems(this.children,W,1),this.div.removeChild(j._accessibleDiv),this.pool.push(j._accessibleDiv),j._accessibleDiv=null,W--;else{X=j._accessibleDiv;let et=j.hitArea;const ht=j.worldTransform;j.hitArea?(X.style.left=`${(ht.tx+et.x*ht.a)*B}px`,X.style.top=`${(ht.ty+et.y*ht.d)*G}px`,X.style.width=`${et.width*ht.a*B}px`,X.style.height=`${et.height*ht.d*G}px`):(et=j.getBounds(),this.capHitArea(et),X.style.left=`${et.x*B}px`,X.style.top=`${et.y*G}px`,X.style.width=`${et.width*B}px`,X.style.height=`${et.height*G}px`,X.title!==j.accessibleTitle&&j.accessibleTitle!==null&&(X.title=j.accessibleTitle),X.getAttribute("aria-label")!==j.accessibleHint&&j.accessibleHint!==null&&X.setAttribute("aria-label",j.accessibleHint)),(j.accessibleTitle!==X.title||j.tabIndex!==X.tabIndex)&&(X.title=j.accessibleTitle,X.tabIndex=j.tabIndex,this.debug&&this.updateDebugHTML(X))}}this.renderId++}updateDebugHTML(u){u.innerHTML=`type: ${u.type}</br> title : ${u.title}</br> tabIndex: ${u.tabIndex}`}capHitArea(u){u.x<0&&(u.width+=u.x,u.x=0),u.y<0&&(u.height+=u.y,u.y=0);const{width:d,height:g}=this.renderer;u.x+u.width>d&&(u.width=d-u.x),u.y+u.height>g&&(u.height=g-u.y)}addChild(u){let d=this.pool.pop();d||(d=document.createElement("button"),d.style.width=`${he}px`,d.style.height=`${he}px`,d.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",d.style.position="absolute",d.style.zIndex=te.toString(),d.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?d.setAttribute("aria-live","off"):d.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?d.setAttribute("aria-relevant","additions"):d.setAttribute("aria-relevant","text"),d.addEventListener("click",this._onClick.bind(this)),d.addEventListener("focus",this._onFocus.bind(this)),d.addEventListener("focusout",this._onFocusOut.bind(this))),d.style.pointerEvents=u.accessiblePointerEvents,d.type=u.accessibleType,u.accessibleTitle&&u.accessibleTitle!==null?d.title=u.accessibleTitle:(!u.accessibleHint||u.accessibleHint===null)&&(d.title=`displayObject ${u.tabIndex}`),u.accessibleHint&&u.accessibleHint!==null&&d.setAttribute("aria-label",u.accessibleHint),this.debug&&this.updateDebugHTML(d),u._accessibleActive=!0,u._accessibleDiv=d,d.displayObject=u,this.children.push(u),this.div.appendChild(u._accessibleDiv),u._accessibleDiv.tabIndex=u.tabIndex}_dispatchEvent(u,d){const{displayObject:g}=u.target,y=this.renderer.events.rootBoundary,T=Object.assign(new ye(y),{target:g});y.rootTarget=this.renderer.lastObjectRendered,d.forEach(E=>y.dispatchEvent(T,E))}_onClick(u){this._dispatchEvent(u,["click","pointertap","tap"])}_onFocus(u){u.target.getAttribute("aria-live")||u.target.setAttribute("aria-live","assertive"),this._dispatchEvent(u,["mouseover"])}_onFocusOut(u){u.target.getAttribute("aria-live")||u.target.setAttribute("aria-live","polite"),this._dispatchEvent(u,["mouseout"])}_onKeyDown(u){u.keyCode===le&&this.activate()}_onMouseMove(u){u.movementX===0&&u.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Er.extension={name:"accessibility",type:[S.nw.RendererPlugin,S.nw.CanvasRendererPlugin]},S.Rw.add(Er);const vr=class Mo{constructor(u){this.stage=new mt,u=Object.assign({forceCanvas:!1},u),this.renderer=(0,S.e6)(u),Mo._plugins.forEach(d=>{d.init.call(this,u)})}render(){this.renderer.render(this.stage)}get view(){var u;return(u=this.renderer)==null?void 0:u.view}get screen(){var u;return(u=this.renderer)==null?void 0:u.screen}destroy(u,d){const g=Mo._plugins.slice(0);g.reverse(),g.forEach(y=>{y.destroy.call(this)}),this.stage.destroy(d),this.stage=null,this.renderer.destroy(u),this.renderer=null}};vr._plugins=[];let Tr=vr;S.Rw.handleByList(S.nw.Application,Tr._plugins);class wr{static init(u){Object.defineProperty(this,"resizeTo",{set(d){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=d,d&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let d,g;if(this._resizeTo===globalThis.window)d=globalThis.innerWidth,g=globalThis.innerHeight;else{const{clientWidth:y,clientHeight:T}=this._resizeTo;d=y,g=T}this.renderer.resize(d,g),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=u.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}wr.extension=S.nw.Application,S.Rw.add(wr);const jr={loader:S.nw.LoadParser,resolver:S.nw.ResolveParser,cache:S.nw.CacheParser,detection:S.nw.DetectionParser};S.Rw.handle(S.nw.Asset,C=>{const u=C.ref;Object.entries(jr).filter(([d])=>!!u[d]).forEach(([d,g])=>{var y;return S.Rw.add(Object.assign(u[d],{extension:(y=u[d].extension)!=null?y:g}))})},C=>{const u=C.ref;Object.keys(jr).filter(d=>!!u[d]).forEach(d=>S.Rw.remove(u[d]))});class Lr{constructor(u,d=!1){this._loader=u,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=d}add(u){u.forEach(d=>{this._assetList.push(d)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}_next(){return ce(this,null,function*(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const u=[],d=Math.min(this._assetList.length,this._maxConcurrent);for(let g=0;g<d;g++)u.push(this._assetList.pop());yield this._loader.load(u),this._isLoading=!1,this._next()}})}get active(){return this._isActive}set active(u){this._isActive!==u&&(this._isActive=u,u&&!this._isLoading&&this._next())}}function Ar(C,u){const d=C.split("?")[0],g=S.P6.path.extname(d).toLowerCase();return Array.isArray(u)?u.includes(g):g===u}const sr=(C,u,d=!1)=>(Array.isArray(C)||(C=[C]),u?C.map(g=>typeof g=="string"||d?u(g):g):C);class Wr{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(u){return this._cache.has(u)}get(u){const d=this._cache.get(u);return d||console.warn(`[Assets] Asset id ${u} was not found in the Cache`),d}set(u,d){const g=sr(u);let y;for(let P=0;P<this.parsers.length;P++){const D=this.parsers[P];if(D.test(d)){y=D.getCacheableAssets(g,d);break}}y||(y={},g.forEach(P=>{y[P]=d}));const T=Object.keys(y),E={cacheKeys:T,keys:g};if(g.forEach(P=>{this._cacheMap.set(P,E)}),T.forEach(P=>{this._cache.has(P)&&this._cache.get(P)!==d&&console.warn("[Cache] already has key:",P),this._cache.set(P,y[P])}),d instanceof S.xE){const P=d;g.forEach(D=>{P.baseTexture!==S.xE.EMPTY.baseTexture&&S.VL.addToCache(P.baseTexture,D),S.xE.addToCache(P,D)})}}remove(u){if(!this._cacheMap.has(u)){console.warn(`[Assets] Asset id ${u} was not found in the Cache`);return}const d=this._cacheMap.get(u);d.cacheKeys.forEach(g=>{this._cache.delete(g)}),d.keys.forEach(g=>{this._cacheMap.delete(g)})}get parsers(){return this._parsers}}const xr=new Wr,Je=C=>!Array.isArray(C);class N{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(u,d,g)=>(this._parsersValidated=!1,u[d]=g,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(u,d){const g={promise:null,parser:null};return g.promise=(()=>ce(this,null,function*(){var E,P;let y=null,T=null;if(d.loadParser&&(T=this._parserHash[d.loadParser],T||console.warn(`[Assets] specified load parser "${d.loadParser}" not found while loading ${u}`)),!T){for(let D=0;D<this.parsers.length;D++){const B=this.parsers[D];if(B.load&&((E=B.test)!=null&&E.call(B,u,d,this))){T=B;break}}if(!T)return console.warn(`[Assets] ${u} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}y=yield T.load(u,d,this),g.parser=T;for(let D=0;D<this.parsers.length;D++){const B=this.parsers[D];B.parse&&B.parse&&(yield(P=B.testParse)==null?void 0:P.call(B,y,d,this))&&(y=(yield B.parse(y,d,this))||y,g.parser=B)}return y}))(),g}load(u,d){return ce(this,null,function*(){this._parsersValidated||this._validateParsers();let g=0;const y={},T=Je(u),E=sr(u,B=>({alias:[B],src:B})),P=E.length,D=E.map(B=>ce(this,null,function*(){const G=S.P6.path.toAbsolute(B.src);if(!y[B.src])try{this.promiseCache[G]||(this.promiseCache[G]=this._getLoadPromiseAndParser(G,B)),y[B.src]=yield this.promiseCache[G].promise,d&&d(++g/P)}catch(X){throw delete this.promiseCache[G],delete y[B.src],new Error(`[Loader.load] Failed to load ${G}.
${X}`)}}));return yield Promise.all(D),T?y[E[0].src]:y})}unload(u){return ce(this,null,function*(){const d=sr(u,g=>({alias:[g],src:g})).map(g=>ce(this,null,function*(){var E,P;const y=S.P6.path.toAbsolute(g.src),T=this.promiseCache[y];if(T){const D=yield T.promise;delete this.promiseCache[y],(P=(E=T.parser)==null?void 0:E.unload)==null||P.call(E,D,g,this)}}));yield Promise.all(d)})}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(u=>u.name).reduce((u,d)=>(u[d.name]&&console.warn(`[Assets] loadParser name conflict "${d.name}"`),Ni(Qe({},u),{[d.name]:d})),{})}}var k=(C=>(C[C.Low=0]="Low",C[C.Normal=1]="Normal",C[C.High=2]="High",C))(k||{});function x(C,u){if(Array.isArray(u)){for(const d of u)if(C.startsWith(`data:${d}`))return!0;return!1}return C.startsWith(`data:${u}`)}const w=".json",O="application/json",H={extension:{type:S.nw.LoadParser,priority:k.Low},name:"loadJson",test(C){return x(C,O)||Ar(C,w)},load(C){return ce(this,null,function*(){return yield(yield S.Xd.ADAPTER.fetch(C)).json()})}};S.Rw.add(H);const V=".txt",Q="text/plain",Gt={name:"loadTxt",extension:{type:S.nw.LoadParser,priority:k.Low},test(C){return x(C,Q)||Ar(C,V)},load(C){return ce(this,null,function*(){return yield(yield S.Xd.ADAPTER.fetch(C)).text()})}};S.Rw.add(Gt);const $t=["normal","bold","100","200","300","400","500","600","700","800","900"],Zt=[".ttf",".otf",".woff",".woff2"],se=["font/ttf","font/otf","font/woff","font/woff2"],Ae=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function Be(C){const u=S.P6.path.extname(C),d=S.P6.path.basename(C,u).replace(/(-|_)/g," ").toLowerCase().split(" ").map(T=>T.charAt(0).toUpperCase()+T.slice(1));let g=d.length>0;for(const T of d)if(!T.match(Ae)){g=!1;break}let y=d.join(" ");return g||(y=`"${y.replace(/[\\"]/g,"\\$&")}"`),y}const Ue=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function dr(C){return Ue.test(C)?C:encodeURI(C)}const Ie={extension:{type:S.nw.LoadParser,priority:k.Low},name:"loadWebFont",test(C){return x(C,se)||Ar(C,Zt)},load(C,u){return ce(this,null,function*(){var g,y,T,E,P,D;const d=S.Xd.ADAPTER.getFontFaceSet();if(d){const B=[],G=(y=(g=u.data)==null?void 0:g.family)!=null?y:Be(C),X=(P=(E=(T=u.data)==null?void 0:T.weights)==null?void 0:E.filter(j=>$t.includes(j)))!=null?P:["normal"],W=(D=u.data)!=null?D:{};for(let j=0;j<X.length;j++){const et=X[j],ht=new FontFace(G,`url(${dr(C)})`,Ni(Qe({},W),{weight:et}));yield ht.load(),d.add(ht),B.push(ht)}return B.length===1?B[0]:B}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null})},unload(C){(Array.isArray(C)?C:[C]).forEach(u=>S.Xd.ADAPTER.getFontFaceSet().delete(u))}};S.Rw.add(Ie);let Ne=0,Ge;const yr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",Mr={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${yr}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},Ti={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Ir;class ci{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(u=>{const d=URL.createObjectURL(new Blob([Mr.code],{type:"application/javascript"})),g=new Worker(d);g.addEventListener("message",y=>{g.terminate(),URL.revokeObjectURL(d),u(y.data)})}),this._isImageBitmapSupported)}loadImageBitmap(u){return this._run("loadImageBitmap",[u])}_initWorkers(){return ce(this,null,function*(){this._initialized||(this._initialized=!0)})}getWorker(){Ge===void 0&&(Ge=navigator.hardwareConcurrency||4);let u=this.workerPool.pop();return!u&&this._createdWorkers<Ge&&(Ir||(Ir=URL.createObjectURL(new Blob([Ti.code],{type:"application/javascript"}))),this._createdWorkers++,u=new Worker(Ir),u.addEventListener("message",d=>{this.complete(d.data),this.returnWorker(d.target),this.next()})),u}returnWorker(u){this.workerPool.push(u)}complete(u){u.error!==void 0?this.resolveHash[u.uuid].reject(u.error):this.resolveHash[u.uuid].resolve(u.data),this.resolveHash[u.uuid]=null}_run(u,d){return ce(this,null,function*(){yield this._initWorkers();const g=new Promise((y,T)=>{this.queue.push({id:u,arguments:d,resolve:y,reject:T})});return this.next(),g})}next(){if(!this.queue.length)return;const u=this.getWorker();if(!u)return;const d=this.queue.pop(),g=d.id;this.resolveHash[Ne]={resolve:d.resolve,reject:d.reject},u.postMessage({data:d.arguments,uuid:Ne++,id:g})}}const Dr=new ci;function nr(C,u,d){C.resource.internal=!0;const g=new S.xE(C),y=()=>{delete u.promiseCache[d],xr.has(d)&&xr.remove(d)};return g.baseTexture.once("destroyed",()=>{d in u.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),y())}),g.once("destroyed",()=>{C.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),y())}),g}const di=[".jpeg",".jpg",".png",".webp",".avif"],Bi=["image/jpeg","image/png","image/webp","image/avif"];function Oi(C){return ce(this,null,function*(){const u=yield S.Xd.ADAPTER.fetch(C);if(!u.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${C}: ${u.status} ${u.statusText}`);const d=yield u.blob();return yield createImageBitmap(d)})}const kr={name:"loadTextures",extension:{type:S.nw.LoadParser,priority:k.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(C){return x(C,Bi)||Ar(C,di)},load(C,u,d){return ce(this,null,function*(){var P,D;const g=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let y;g?this.config.preferWorkers&&(yield Dr.isImageBitmapSupported())?y=yield Dr.loadImageBitmap(C):y=yield Oi(C):y=yield new Promise((B,G)=>{const X=new Image;X.crossOrigin=this.config.crossOrigin,X.src=C,X.complete?B(X):(X.onload=()=>B(X),X.onerror=W=>G(W))});const T=Qe({},u.data);(P=T.resolution)!=null||(T.resolution=S.P6.getResolutionOfUrl(C)),g&&((D=T.resourceOptions)==null?void 0:D.ownsImageBitmap)===void 0&&(T.resourceOptions=Qe({},T.resourceOptions),T.resourceOptions.ownsImageBitmap=!0);const E=new S.VL(y,T);return E.resource.src=C,nr(E,d,C)})},unload(C){C.destroy(!0)}};S.Rw.add(kr);const Rr=".svg",gr="image/svg+xml",Li={extension:{type:S.nw.LoadParser,priority:k.High},name:"loadSVG",test(C){return x(C,gr)||Ar(C,Rr)},testParse(C){return ce(this,null,function*(){return S.pX.test(C)})},parse(C,u,d){return ce(this,null,function*(){var T;const g=new S.pX(C,(T=u==null?void 0:u.data)==null?void 0:T.resourceOptions);yield g.load();const y=new S.VL(g,Qe({resolution:S.P6.getResolutionOfUrl(C)},u==null?void 0:u.data));return y.resource.src=u.src,nr(y,d,u.src)})},load(C,u){return ce(this,null,function*(){return(yield S.Xd.ADAPTER.fetch(C)).text()})},unload:kr.unload};S.Rw.add(Li);const Ji=[".mp4",".m4v",".webm",".ogv"],ki=["video/mp4","video/webm","video/ogg"],$r={name:"loadVideo",extension:{type:S.nw.LoadParser,priority:k.High},config:{defaultAutoPlay:!0},test(C){return x(C,ki)||Ar(C,Ji)},load(C,u,d){return ce(this,null,function*(){var E;let g;const y=yield(yield S.Xd.ADAPTER.fetch(C)).blob(),T=URL.createObjectURL(y);try{const P=Qe({autoPlay:this.config.defaultAutoPlay},(E=u==null?void 0:u.data)==null?void 0:E.resourceOptions),D=new S.eH(T,P);yield D.load();const B=new S.VL(D,Qe({alphaMode:yield S.P6.detectVideoAlphaMode(),resolution:S.P6.getResolutionOfUrl(C)},u==null?void 0:u.data));B.resource.src=C,g=nr(B,d,C),g.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(T)})}catch(P){throw URL.revokeObjectURL(T),P}return g})},unload(C){C.destroy(!0)}};S.Rw.add($r);function Jr(C,u,d,g,y){const T=u[d];for(let E=0;E<T.length;E++){const P=T[E];d<u.length-1?Jr(C.replace(g[d],P),u,d+1,g,y):y.push(C.replace(g[d],P))}}function ti(C){const u=/\{(.*?)\}/g,d=C.match(u),g=[];if(d){const y=[];d.forEach(T=>{const E=T.substring(1,T.length-1).split(",");y.push(E)}),Jr(C,y,0,d,g)}else g.push(C);return g}class Ur{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(u,d)=>`${u}${this._bundleIdConnector}${d}`,extractAssetIdFromBundle:(u,d)=>d.replace(`${u}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(u){var d,g,y;if(this._bundleIdConnector=(d=u.connector)!=null?d:this._bundleIdConnector,this._createBundleAssetId=(g=u.createBundleAssetId)!=null?g:this._createBundleAssetId,this._extractAssetIdFromBundle=(y=u.extractAssetIdFromBundle)!=null?y:this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...u){u.forEach(d=>{this._preferredOrder.push(d),d.priority||(d.priority=Object.keys(d.params))}),this._resolverHash={}}set basePath(u){this._basePath=u}get basePath(){return this._basePath}set rootPath(u){this._rootPath=u}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(u){if(typeof u=="string")this._defaultSearchParams=u;else{const d=u;this._defaultSearchParams=Object.keys(d).map(g=>`${encodeURIComponent(g)}=${encodeURIComponent(d[g])}`).join("&")}}getAlias(u){const{alias:d,name:g,src:y,srcs:T}=u;return sr(d||g||y||T,E=>{var P;return typeof E=="string"?E:Array.isArray(E)?E.map(D=>{var B,G;return(G=(B=D==null?void 0:D.src)!=null?B:D==null?void 0:D.srcs)!=null?G:D}):E!=null&&E.src||E!=null&&E.srcs?(P=E.src)!=null?P:E.srcs:E},!0)}addManifest(u){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=u,u.bundles.forEach(d=>{this.addBundle(d.name,d.assets)})}addBundle(u,d){const g=[];Array.isArray(d)?d.forEach(y=>{var D,B;const T=(D=y.src)!=null?D:y.srcs,E=(B=y.alias)!=null?B:y.name;let P;if(typeof E=="string"){const G=this._createBundleAssetId(u,E);g.push(G),P=[E,G]}else{const G=E.map(X=>this._createBundleAssetId(u,X));g.push(...G),P=[...E,...G]}this.add(Ni(Qe({},y),{alias:P,src:T}))}):Object.keys(d).forEach(y=>{var E;const T=[y,this._createBundleAssetId(u,y)];if(typeof d[y]=="string")this.add({alias:T,src:d[y]});else if(Array.isArray(d[y]))this.add({alias:T,src:d[y]});else{const P=d[y],D=(E=P.src)!=null?E:P.srcs;this.add(Ni(Qe({},P),{alias:T,src:Array.isArray(D)?D:[D]}))}g.push(...T)}),this._bundles[u]=g}add(u,d,g,y,T){const E=[];typeof u=="string"||Array.isArray(u)&&typeof u[0]=="string"?(S.P6.deprecation("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),E.push({alias:u,src:d,data:g,format:y,loadParser:T})):Array.isArray(u)?E.push(...u):E.push(u);let P;P=D=>{this.hasKey(D)&&console.warn(`[Resolver] already has key: ${D} overwriting`)},sr(E).forEach(D=>{const{src:B,srcs:G}=D;let{data:X,format:W,loadParser:j}=D;const et=sr(B||G).map(Tt=>typeof Tt=="string"?ti(Tt):Array.isArray(Tt)?Tt:[Tt]),ht=this.getAlias(D);Array.isArray(ht)?ht.forEach(P):P(ht);const wt=[];et.forEach(Tt=>{Tt.forEach(jt=>{var kt,ne,Ce;let Rt={};if(typeof jt!="object"){Rt.src=jt;for(let ae=0;ae<this._parsers.length;ae++){const oe=this._parsers[ae];if(oe.test(jt)){Rt=oe.parse(jt);break}}}else X=(kt=jt.data)!=null?kt:X,W=(ne=jt.format)!=null?ne:W,j=(Ce=jt.loadParser)!=null?Ce:j,Rt=Qe(Qe({},Rt),jt);if(!ht)throw new Error(`[Resolver] alias is undefined for this asset: ${Rt.src}`);Rt=this.buildResolvedAsset(Rt,{aliases:ht,data:X,format:W,loadParser:j}),wt.push(Rt)})}),ht.forEach(Tt=>{this._assetMap[Tt]=wt})})}resolveBundle(u){const d=Je(u);u=sr(u);const g={};return u.forEach(y=>{const T=this._bundles[y];if(T){const E=this.resolve(T),P={};for(const D in E){const B=E[D];P[this._extractAssetIdFromBundle(y,D)]=B}g[y]=P}}),d?g[u[0]]:g}resolveUrl(u){const d=this.resolve(u);if(typeof u!="string"){const g={};for(const y in d)g[y]=d[y].src;return g}return d.src}resolve(u){const d=Je(u);u=sr(u);const g={};return u.forEach(y=>{var T;if(!this._resolverHash[y])if(this._assetMap[y]){let E=this._assetMap[y];const P=E[0],D=this._getPreferredOrder(E);D==null||D.priority.forEach(B=>{D.params[B].forEach(G=>{const X=E.filter(W=>W[B]?W[B]===G:!1);X.length&&(E=X)})}),this._resolverHash[y]=(T=E[0])!=null?T:P}else this._resolverHash[y]=this.buildResolvedAsset({alias:[y],src:y},{});g[y]=this._resolverHash[y]}),d?g[u[0]]:g}hasKey(u){return!!this._assetMap[u]}hasBundle(u){return!!this._bundles[u]}_getPreferredOrder(u){for(let d=0;d<u.length;d++){const g=u[0],y=this._preferredOrder.find(T=>T.params.format.includes(g.format));if(y)return y}return this._preferredOrder[0]}_appendDefaultSearchParams(u){if(!this._defaultSearchParams)return u;const d=/\?/.test(u)?"&":"?";return`${u}${d}${this._defaultSearchParams}`}buildResolvedAsset(u,d){var P;const{aliases:g,data:y,loadParser:T,format:E}=d;return(this._basePath||this._rootPath)&&(u.src=S.P6.path.toAbsolute(u.src,this._basePath,this._rootPath)),u.alias=(P=g!=null?g:u.alias)!=null?P:[u.src],u.src=this._appendDefaultSearchParams(u.src),u.data=Qe(Qe({},y||{}),u.data),u.loadParser=T!=null?T:u.loadParser,u.format=E!=null?E:S.P6.path.extname(u.src).slice(1),u.srcs=u.src,u.name=u.alias,u}}class Qs{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Ur,this.loader=new N,this.cache=xr,this._backgroundLoader=new Lr(this.loader),this._backgroundLoader.active=!0,this.reset()}init(){return ce(this,arguments,function*(u={}){var T,E,P;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,u.defaultSearchParams&&this.resolver.setDefaultSearchParams(u.defaultSearchParams),u.basePath&&(this.resolver.basePath=u.basePath),u.bundleIdentifier&&this.resolver.setBundleIdentifier(u.bundleIdentifier),u.manifest){let D=u.manifest;typeof D=="string"&&(D=yield this.load(D)),this.resolver.addManifest(D)}const d=(E=(T=u.texturePreference)==null?void 0:T.resolution)!=null?E:1,g=typeof d=="number"?[d]:d,y=yield this._detectFormats({preferredFormats:(P=u.texturePreference)==null?void 0:P.format,skipDetections:u.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:y,resolution:g}}),u.preferences&&this.setPreferences(u.preferences)})}add(u,d,g,y,T){this.resolver.add(u,d,g,y,T)}load(u,d){return ce(this,null,function*(){this._initialized||(yield this.init());const g=Je(u),y=sr(u).map(P=>{if(typeof P!="string"){const D=this.resolver.getAlias(P);return D.some(B=>!this.resolver.hasKey(B))&&this.add(P),Array.isArray(D)?D[0]:D}return this.resolver.hasKey(P)||this.add({alias:P,src:P}),P}),T=this.resolver.resolve(y),E=yield this._mapLoadToResolve(T,d);return g?E[y[0]]:E})}addBundle(u,d){this.resolver.addBundle(u,d)}loadBundle(u,d){return ce(this,null,function*(){this._initialized||(yield this.init());let g=!1;typeof u=="string"&&(g=!0,u=[u]);const y=this.resolver.resolveBundle(u),T={},E=Object.keys(y);let P=0,D=0;const B=()=>{d==null||d(++P/D)},G=E.map(X=>{const W=y[X];return D+=Object.keys(W).length,this._mapLoadToResolve(W,B).then(j=>{T[X]=j})});return yield Promise.all(G),g?T[u[0]]:T})}backgroundLoad(u){return ce(this,null,function*(){this._initialized||(yield this.init()),typeof u=="string"&&(u=[u]);const d=this.resolver.resolve(u);this._backgroundLoader.add(Object.values(d))})}backgroundLoadBundle(u){return ce(this,null,function*(){this._initialized||(yield this.init()),typeof u=="string"&&(u=[u]);const d=this.resolver.resolveBundle(u);Object.values(d).forEach(g=>{this._backgroundLoader.add(Object.values(g))})})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(u){if(typeof u=="string")return xr.get(u);const d={};for(let g=0;g<u.length;g++)d[g]=xr.get(u[g]);return d}_mapLoadToResolve(u,d){return ce(this,null,function*(){const g=Object.values(u),y=Object.keys(u);this._backgroundLoader.active=!1;const T=yield this.loader.load(g,d);this._backgroundLoader.active=!0;const E={};return g.forEach((P,D)=>{const B=T[P.src],G=[P.src];P.alias&&G.push(...P.alias),E[y[D]]=B,xr.set(G,B)}),E})}unload(u){return ce(this,null,function*(){this._initialized||(yield this.init());const d=sr(u).map(y=>typeof y!="string"?y.src:y),g=this.resolver.resolve(d);yield this._unloadFromResolved(g)})}unloadBundle(u){return ce(this,null,function*(){this._initialized||(yield this.init()),u=sr(u);const d=this.resolver.resolveBundle(u),g=Object.keys(d).map(y=>this._unloadFromResolved(d[y]));yield Promise.all(g)})}_unloadFromResolved(u){return ce(this,null,function*(){const d=Object.values(u);d.forEach(g=>{xr.remove(g.src)}),yield this.loader.unload(d)})}_detectFormats(u){return ce(this,null,function*(){let d=[];u.preferredFormats&&(d=Array.isArray(u.preferredFormats)?u.preferredFormats:[u.preferredFormats]);for(const g of u.detections)u.skipDetections||(yield g.test())?d=yield g.add(d):u.skipDetections||(d=yield g.remove(d));return d=d.filter((g,y)=>d.indexOf(g)===y),d})}get detections(){return this._detections}get preferWorkers(){return kr.config.preferWorkers}set preferWorkers(u){S.P6.deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:u})}setPreferences(u){this.loader.parsers.forEach(d=>{d.config&&Object.keys(d.config).filter(g=>g in u).forEach(g=>{d.config[g]=u[g]})})}}const Ui=new Qs;S.Rw.handleByList(S.nw.LoadParser,Ui.loader.parsers).handleByList(S.nw.ResolveParser,Ui.resolver.parsers).handleByList(S.nw.CacheParser,Ui.cache.parsers).handleByList(S.nw.DetectionParser,Ui.detections);const bs={extension:S.nw.CacheParser,test:C=>Array.isArray(C)&&C.every(u=>u instanceof S.xE),getCacheableAssets:(C,u)=>{const d={};return C.forEach(g=>{u.forEach((y,T)=>{d[g+(T===0?"":T+1)]=y})}),d}};S.Rw.add(bs);function Gi(C){return ce(this,null,function*(){if("Image"in globalThis)return new Promise(u=>{const d=new Image;d.onload=()=>{u(!0)},d.onerror=()=>{u(!1)},d.src=C});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const u=yield(yield fetch(C)).blob();yield createImageBitmap(u)}catch(u){return!1}return!0}return!1})}const Js={extension:{type:S.nw.DetectionParser,priority:1},test:()=>ce(this,null,function*(){return Gi("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=")}),add:C=>ce(this,null,function*(){return[...C,"avif"]}),remove:C=>ce(this,null,function*(){return C.filter(u=>u!=="avif")})};S.Rw.add(Js);const zi={extension:{type:S.nw.DetectionParser,priority:0},test:()=>ce(this,null,function*(){return Gi("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=")}),add:C=>ce(this,null,function*(){return[...C,"webp"]}),remove:C=>ce(this,null,function*(){return C.filter(u=>u!=="webp")})};S.Rw.add(zi);const Ts=["png","jpg","jpeg"],ws={extension:{type:S.nw.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:C=>ce(this,null,function*(){return[...C,...Ts]}),remove:C=>ce(this,null,function*(){return C.filter(u=>!Ts.includes(u))})};S.Rw.add(ws);const wi="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Ai(C){return wi?!1:document.createElement("video").canPlayType(C)!==""}const ts={extension:{type:S.nw.DetectionParser,priority:0},test:()=>ce(this,null,function*(){return Ai("video/webm")}),add:C=>ce(this,null,function*(){return[...C,"webm"]}),remove:C=>ce(this,null,function*(){return C.filter(u=>u!=="webm")})};S.Rw.add(ts);const tn={extension:{type:S.nw.DetectionParser,priority:0},test:()=>ce(this,null,function*(){return Ai("video/mp4")}),add:C=>ce(this,null,function*(){return[...C,"mp4","m4v"]}),remove:C=>ce(this,null,function*(){return C.filter(u=>u!=="mp4"&&u!=="m4v")})};S.Rw.add(tn);const en={extension:{type:S.nw.DetectionParser,priority:0},test:()=>ce(this,null,function*(){return Ai("video/ogg")}),add:C=>ce(this,null,function*(){return[...C,"ogv"]}),remove:C=>ce(this,null,function*(){return C.filter(u=>u!=="ogv")})};S.Rw.add(en);const rn={extension:S.nw.ResolveParser,test:kr.test,parse:C=>{var u,d;return{resolution:parseFloat((d=(u=S.Xd.RETINA_PREFIX.exec(C))==null?void 0:u[1])!=null?d:"1"),format:S.P6.path.extname(C).slice(1),src:C}}};S.Rw.add(rn);const Gr=(C,u)=>{const d=u.split("?")[1];return d&&(C+=`?${d}`),C};var _r=(C=>(C[C.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",C[C.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",C[C.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",C[C.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",C[C.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",C[C.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",C[C.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",C[C.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",C[C.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",C[C.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",C[C.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",C[C.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",C[C.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",C[C.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",C[C.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",C[C.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",C[C.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",C[C.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",C[C.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",C[C.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",C[C.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",C[C.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",C[C.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",C[C.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",C[C.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",C[C.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",C[C.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",C))(_r||{});const fi={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let Fr,or;function br(){or={s3tc:Fr.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Fr.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Fr.getExtension("WEBGL_compressed_texture_etc"),etc1:Fr.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Fr.getExtension("WEBGL_compressed_texture_pvrtc")||Fr.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Fr.getExtension("WEBGL_compressed_texture_atc"),astc:Fr.getExtension("WEBGL_compressed_texture_astc")}}const sn={extension:{type:S.nw.DetectionParser,priority:2},test:()=>ce(this,null,function*(){const C=S.Xd.ADAPTER.createCanvas().getContext("webgl");return C?(Fr=C,!0):(console.warn("WebGL not available for compressed textures."),!1)}),add:C=>ce(this,null,function*(){or||br();const u=[];for(const d in or)or[d]&&u.push(d);return[...u,...C]}),remove:C=>ce(this,null,function*(){return or||br(),C.filter(u=>!(u in or))})};S.Rw.add(sn);class On extends S.qm{constructor(u,d={width:1,height:1,autoLoad:!0}){let g,y;typeof u=="string"?(g=u,y=new Uint8Array):(g=null,y=u),super(y,d),this.origin=g,this.buffer=y?new S.Rv(y):null,this._load=null,this.loaded=!1,this.origin!==null&&d.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(u){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(u=>u.blob()).then(u=>u.arrayBuffer()).then(u=>(this.data=new Uint32Array(u),this.buffer=new S.Rv(u),this.loaded=!0,this.onBlobLoaded(u),this.update(),this)),this._load)}}class ei extends On{constructor(u,d){super(u,d),this.format=d.format,this.levels=d.levels||1,this._width=d.width,this._height=d.height,this._extension=ei._formatToExtension(this.format),(d.levelBuffers||this.buffer)&&(this._levelBuffers=d.levelBuffers||ei._createLevelBuffers(u instanceof Uint8Array?u:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(u,d,g){const y=u.gl;if(!u.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;y.pixelStorei(y.UNPACK_ALIGNMENT,4);for(let T=0,E=this.levels;T<E;T++){const{levelID:P,levelWidth:D,levelHeight:B,levelBuffer:G}=this._levelBuffers[T];y.compressedTexImage2D(y.TEXTURE_2D,P,this.format,D,B,0,G)}return!0}onBlobLoaded(){this._levelBuffers=ei._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(u){if(u>=33776&&u<=33779)return"s3tc";if(u>=37488&&u<=37497)return"etc";if(u>=35840&&u<=35843)return"pvrtc";if(u>=36196)return"etc1";if(u>=35986&&u<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(u,d,g,y,T,E,P){const D=new Array(g);let B=u.byteOffset,G=E,X=P,W=G+y-1&~(y-1),j=X+T-1&~(T-1),et=W*j*fi[d];for(let ht=0;ht<g;ht++)D[ht]={levelID:ht,levelWidth:g>1?G:W,levelHeight:g>1?X:j,levelBuffer:new Uint8Array(u.buffer,B,et)},B+=et,G=G>>1||1,X=X>>1||1,W=G+y-1&~(y-1),j=X+T-1&~(T-1),et=W*j*fi[d];return D}}const Vi=4,pi=124,As=32,Es=20,nn=542327876,Yr={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},Hi={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Fe={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},es=1,on=2,ze=4,Ss=64,Ln=512,an=131072,ln=827611204,Xi=861165636,rs=894720068,is=808540228,ss=4,Cs={[ln]:_r.COMPRESSED_RGBA_S3TC_DXT1_EXT,[Xi]:_r.COMPRESSED_RGBA_S3TC_DXT3_EXT,[rs]:_r.COMPRESSED_RGBA_S3TC_DXT5_EXT},ns={70:_r.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:_r.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:_r.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:_r.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:_r.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:_r.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:_r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:_r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:_r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function ri(C){const u=new Uint32Array(C);if(u[0]!==nn)throw new Error("Invalid DDS file magic word");const d=new Uint32Array(C,0,pi/Uint32Array.BYTES_PER_ELEMENT),g=d[Yr.HEIGHT],y=d[Yr.WIDTH],T=d[Yr.MIPMAP_COUNT],E=new Uint32Array(C,Yr.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,As/Uint32Array.BYTES_PER_ELEMENT),P=E[es];if(P&ze){const D=E[Hi.FOURCC];if(D!==is){const jt=Cs[D],Rt=Vi+pi,kt=new Uint8Array(C,Rt);return[new ei(kt,{format:jt,width:y,height:g,levels:T})]}const B=Vi+pi,G=new Uint32Array(u.buffer,B,Es/Uint32Array.BYTES_PER_ELEMENT),X=G[Fe.DXGI_FORMAT],W=G[Fe.RESOURCE_DIMENSION],j=G[Fe.MISC_FLAG],et=G[Fe.ARRAY_SIZE],ht=ns[X];if(ht===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${X}`);if(j===ss)throw new Error("DDSParser does not support cubemap textures");if(W===6)throw new Error("DDSParser does not supported 3D texture data");const wt=new Array,Tt=Vi+pi+Es;if(et===1)wt.push(new Uint8Array(C,Tt));else{const jt=fi[ht];let Rt=0,kt=y,ne=g;for(let ae=0;ae<T;ae++){const oe=Math.max(1,kt+3&-4),Te=Math.max(1,ne+3&-4),Pe=oe*Te*jt;Rt+=Pe,kt=kt>>>1,ne=ne>>>1}let Ce=Tt;for(let ae=0;ae<et;ae++)wt.push(new Uint8Array(C,Ce,Rt)),Ce+=Rt}return wt.map(jt=>new ei(jt,{format:ht,width:y,height:g,levels:T}))}throw P&Ss?new Error("DDSParser does not support uncompressed texture data."):P&Ln?new Error("DDSParser does not supported YUV uncompressed texture data."):P&an?new Error("DDSParser does not support single-channel (lumninance) texture data!"):P&on?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Ei=[171,75,84,88,32,49,49,187,13,10,26,10],Ps=67305985,er={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},ii=64,os={[S.vK.UNSIGNED_BYTE]:1,[S.vK.UNSIGNED_SHORT]:2,[S.vK.INT]:4,[S.vK.UNSIGNED_INT]:4,[S.vK.FLOAT]:4,[S.vK.HALF_FLOAT]:8},hn={[S.I2.RGBA]:4,[S.I2.RGB]:3,[S.I2.RG]:2,[S.I2.RED]:1,[S.I2.LUMINANCE]:1,[S.I2.LUMINANCE_ALPHA]:2,[S.I2.ALPHA]:1},as={[S.vK.UNSIGNED_SHORT_4_4_4_4]:2,[S.vK.UNSIGNED_SHORT_5_5_5_1]:2,[S.vK.UNSIGNED_SHORT_5_6_5]:2};function Ve(C,u,d=!1){const g=new DataView(u);if(!Ms(C,g))return null;const y=g.getUint32(er.ENDIANNESS,!0)===Ps,T=g.getUint32(er.GL_TYPE,y),E=g.getUint32(er.GL_FORMAT,y),P=g.getUint32(er.GL_INTERNAL_FORMAT,y),D=g.getUint32(er.PIXEL_WIDTH,y),B=g.getUint32(er.PIXEL_HEIGHT,y)||1,G=g.getUint32(er.PIXEL_DEPTH,y)||1,X=g.getUint32(er.NUMBER_OF_ARRAY_ELEMENTS,y)||1,W=g.getUint32(er.NUMBER_OF_FACES,y),j=g.getUint32(er.NUMBER_OF_MIPMAP_LEVELS,y),et=g.getUint32(er.BYTES_OF_KEY_VALUE_DATA,y);if(B===0||G!==1)throw new Error("Only 2D textures are supported");if(W!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(X!==1)throw new Error("WebGL does not support array textures");const ht=4,wt=4,Tt=D+3&-4,jt=B+3&-4,Rt=new Array(X);let kt=D*B;T===0&&(kt=Tt*jt);let ne;if(T!==0?os[T]?ne=os[T]*hn[E]:ne=as[T]:ne=fi[P],ne===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const Ce=d?fr(g,et,y):null;let ae=kt*ne,oe=D,Te=B,Pe=Tt,Ke=jt,pe=ii+et;for(let Ut=0;Ut<j;Ut++){const ie=g.getUint32(pe,y);let we=pe+4;for(let je=0;je<X;je++){let be=Rt[je];be||(be=Rt[je]=new Array(j)),be[Ut]={levelID:Ut,levelWidth:j>1||T!==0?oe:Pe,levelHeight:j>1||T!==0?Te:Ke,levelBuffer:new Uint8Array(u,we,ae)},we+=ae}pe+=ie+4,pe=pe%4!==0?pe+4-pe%4:pe,oe=oe>>1||1,Te=Te>>1||1,Pe=oe+ht-1&~(ht-1),Ke=Te+wt-1&~(wt-1),ae=Pe*Ke*ne}return T!==0?{uncompressed:Rt.map(Ut=>{let ie=Ut[0].levelBuffer,we=!1;return T===S.vK.FLOAT?ie=new Float32Array(Ut[0].levelBuffer.buffer,Ut[0].levelBuffer.byteOffset,Ut[0].levelBuffer.byteLength/4):T===S.vK.UNSIGNED_INT?(we=!0,ie=new Uint32Array(Ut[0].levelBuffer.buffer,Ut[0].levelBuffer.byteOffset,Ut[0].levelBuffer.byteLength/4)):T===S.vK.INT&&(we=!0,ie=new Int32Array(Ut[0].levelBuffer.buffer,Ut[0].levelBuffer.byteOffset,Ut[0].levelBuffer.byteLength/4)),{resource:new S.qm(ie,{width:Ut[0].levelWidth,height:Ut[0].levelHeight}),type:T,format:we?un(E):E}}),kvData:Ce}:{compressed:Rt.map(Ut=>new ei(null,{format:P,width:D,height:B,levels:j,levelBuffers:Ut})),kvData:Ce}}function Ms(C,u){for(let d=0;d<Ei.length;d++)if(u.getUint8(d)!==Ei[d])return console.error(`${C} is not a valid *.ktx file!`),!1;return!0}function un(C){switch(C){case S.I2.RGBA:return S.I2.RGBA_INTEGER;case S.I2.RGB:return S.I2.RGB_INTEGER;case S.I2.RG:return S.I2.RG_INTEGER;case S.I2.RED:return S.I2.RED_INTEGER;default:return C}}function fr(C,u,d){const g=new Map;let y=0;for(;y<u;){const T=C.getUint32(ii+y,d),E=ii+y+4,P=3-(T+3)%4;if(T===0||T>u-y){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let D=0;for(;D<T&&C.getUint8(E+D)!==0;D++);if(D===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const B=new TextDecoder().decode(new Uint8Array(C.buffer,E,D)),G=new DataView(C.buffer,E+D+1,T-D-1);g.set(B,G),y+=4+T+P}return g}const ji={extension:{type:S.nw.LoadParser,priority:k.High},name:"loadDDS",test(C){return Ar(C,".dds")},load(C,u,d){return ce(this,null,function*(){const g=yield(yield S.Xd.ADAPTER.fetch(C)).arrayBuffer(),y=ri(g).map(T=>{const E=new S.VL(T,Qe({mipmap:S.KI.OFF,alphaMode:S.iw.NO_PREMULTIPLIED_ALPHA,resolution:S.P6.getResolutionOfUrl(C)},u.data));return nr(E,d,C)});return y.length===1?y[0]:y})},unload(C){Array.isArray(C)?C.forEach(u=>u.destroy(!0)):C.destroy(!0)}};S.Rw.add(ji);const cn={extension:{type:S.nw.LoadParser,priority:k.High},name:"loadKTX",test(C){return Ar(C,".ktx")},load(C,u,d){return ce(this,null,function*(){const g=yield(yield S.Xd.ADAPTER.fetch(C)).arrayBuffer(),{compressed:y,uncompressed:T,kvData:E}=Ve(C,g),P=y!=null?y:T,D=Qe({mipmap:S.KI.OFF,alphaMode:S.iw.NO_PREMULTIPLIED_ALPHA,resolution:S.P6.getResolutionOfUrl(C)},u.data),B=P.map(G=>{var j;P===T&&Object.assign(D,{type:G.type,format:G.format});const X=(j=G.resource)!=null?j:G,W=new S.VL(X,D);return W.ktxKeyValueData=E,nr(W,d,C)});return B.length===1?B[0]:B})},unload(C){Array.isArray(C)?C.forEach(u=>u.destroy(!0)):C.destroy(!0)}};S.Rw.add(cn);const dn={extension:S.nw.ResolveParser,test:C=>{const u=S.P6.path.extname(C).slice(1);return["basis","ktx","dds"].includes(u)},parse:C=>{var d,g,y,T;const u=S.P6.path.extname(C).slice(1);if(u==="ktx"){const E=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(E.some(P=>C.endsWith(P)))return{resolution:parseFloat((g=(d=S.Xd.RETINA_PREFIX.exec(C))==null?void 0:d[1])!=null?g:"1"),format:E.find(P=>C.endsWith(P)),src:C}}return{resolution:parseFloat((T=(y=S.Xd.RETINA_PREFIX.exec(C))==null?void 0:y[1])!=null?T:"1"),format:u,src:C}}};S.Rw.add(dn);const mi=new S.Ae,fn=4,Is=class Dn{constructor(u){this.renderer=u,this._rendererPremultipliedAlpha=!1}contextChange(){var d;const u=(d=this.renderer)==null?void 0:d.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(u&&u.alpha&&u.premultipliedAlpha)}image(u,d,g,y){return ce(this,null,function*(){const T=new Image;return T.src=yield this.base64(u,d,g,y),T})}base64(u,d,g,y){return ce(this,null,function*(){const T=this.canvas(u,y);if(T.toBlob!==void 0)return new Promise((E,P)=>{T.toBlob(D=>{if(!D){P(new Error("ICanvas.toBlob failed!"));return}const B=new FileReader;B.onload=()=>E(B.result),B.onerror=P,B.readAsDataURL(D)},d,g)});if(T.toDataURL!==void 0)return T.toDataURL(d,g);if(T.convertToBlob!==void 0){const E=yield T.convertToBlob({type:d,quality:g});return new Promise((P,D)=>{const B=new FileReader;B.onload=()=>P(B.result),B.onerror=D,B.readAsDataURL(E)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")})}canvas(u,d){const{pixels:g,width:y,height:T,flipY:E,premultipliedAlpha:P}=this._rawPixels(u,d);E&&Dn._flipY(g,y,T),P&&Dn._unpremultiplyAlpha(g);const D=new S.P6.CanvasRenderTarget(y,T,1),B=new ImageData(new Uint8ClampedArray(g.buffer),y,T);return D.context.putImageData(B,0,0),D.canvas}pixels(u,d){const{pixels:g,width:y,height:T,flipY:E,premultipliedAlpha:P}=this._rawPixels(u,d);return E&&Dn._flipY(g,y,T),P&&Dn._unpremultiplyAlpha(g),g}_rawPixels(u,d){const g=this.renderer;if(!g)throw new Error("The Extract has already been destroyed");let y,T=!1,E=!1,P,D=!1;u&&(u instanceof S.TI?P=u:(P=g.generateTexture(u,{region:d,resolution:g.resolution,multisample:g.multisample}),D=!0,d&&(mi.width=d.width,mi.height=d.height,d=mi)));const B=g.gl;if(P){if(y=P.baseTexture.resolution,d=d!=null?d:P.frame,T=!1,E=P.baseTexture.alphaMode>0&&P.baseTexture.format===S.I2.RGBA,!D){g.renderTexture.bind(P);const j=P.framebuffer.glFramebuffers[g.CONTEXT_UID];j.blitFramebuffer&&g.framebuffer.bind(j.blitFramebuffer)}}else y=g.resolution,d||(d=mi,d.width=g.width/y,d.height=g.height/y),T=!0,E=this._rendererPremultipliedAlpha,g.renderTexture.bind();const G=Math.max(Math.round(d.width*y),1),X=Math.max(Math.round(d.height*y),1),W=new Uint8Array(fn*G*X);return B.readPixels(Math.round(d.x*y),Math.round(d.y*y),G,X,B.RGBA,B.UNSIGNED_BYTE,W),D&&(P==null||P.destroy(!0)),{pixels:W,width:G,height:X,flipY:T,premultipliedAlpha:E}}destroy(){this.renderer=null}static _flipY(u,d,g){const y=d<<2,T=g>>1,E=new Uint8Array(y);for(let P=0;P<T;P++){const D=P*y,B=(g-P-1)*y;E.set(u.subarray(D,D+y)),u.copyWithin(D,B,B+y),u.set(E,B)}}static _unpremultiplyAlpha(u){u instanceof Uint8ClampedArray&&(u=new Uint8Array(u.buffer));const d=u.length;for(let g=0;g<d;g+=4){const y=u[g+3];if(y!==0){const T=255.001/y;u[g]=u[g]*T+.5,u[g+1]=u[g+1]*T+.5,u[g+2]=u[g+2]*T+.5}}}};Is.extension={name:"extract",type:S.nw.RendererSystem};let si=Is;S.Rw.add(si);const ni={build(C){const u=C.points;let d,g,y,T,E,P;if(C.type===S.HS.CIRC){const et=C.shape;d=et.x,g=et.y,E=P=et.radius,y=T=0}else if(C.type===S.HS.ELIP){const et=C.shape;d=et.x,g=et.y,E=et.width,P=et.height,y=T=0}else{const et=C.shape,ht=et.width/2,wt=et.height/2;d=et.x+ht,g=et.y+wt,E=P=Math.max(0,Math.min(et.radius,Math.min(ht,wt))),y=ht-E,T=wt-P}if(!(E>=0&&P>=0&&y>=0&&T>=0)){u.length=0;return}const D=Math.ceil(2.3*Math.sqrt(E+P)),B=D*8+(y?4:0)+(T?4:0);if(u.length=B,B===0)return;if(D===0){u.length=8,u[0]=u[6]=d+y,u[1]=u[3]=g+T,u[2]=u[4]=d-y,u[5]=u[7]=g-T;return}let G=0,X=D*4+(y?2:0)+2,W=X,j=B;{const et=y+E,ht=T,wt=d+et,Tt=d-et,jt=g+ht;if(u[G++]=wt,u[G++]=jt,u[--X]=jt,u[--X]=Tt,T){const Rt=g-ht;u[W++]=Tt,u[W++]=Rt,u[--j]=Rt,u[--j]=wt}}for(let et=1;et<D;et++){const ht=Math.PI/2*(et/D),wt=y+Math.cos(ht)*E,Tt=T+Math.sin(ht)*P,jt=d+wt,Rt=d-wt,kt=g+Tt,ne=g-Tt;u[G++]=jt,u[G++]=kt,u[--X]=kt,u[--X]=Rt,u[W++]=Rt,u[W++]=ne,u[--j]=ne,u[--j]=jt}{const et=y,ht=T+P,wt=d+et,Tt=d-et,jt=g+ht,Rt=g-ht;u[G++]=wt,u[G++]=jt,u[--j]=Rt,u[--j]=wt,y&&(u[G++]=Tt,u[G++]=jt,u[--j]=Rt,u[--j]=Tt)}},triangulate(C,u){const d=C.points,g=u.points,y=u.indices;if(d.length===0)return;let T=g.length/2;const E=T;let P,D;if(C.type!==S.HS.RREC){const G=C.shape;P=G.x,D=G.y}else{const G=C.shape;P=G.x+G.width/2,D=G.y+G.height/2}const B=C.matrix;g.push(C.matrix?B.a*P+B.c*D+B.tx:P,C.matrix?B.b*P+B.d*D+B.ty:D),T++,g.push(d[0],d[1]);for(let G=2;G<d.length;G+=2)g.push(d[G],d[G+1]),y.push(T++,E,T);y.push(E+1,E,T)}};function ls(C,u=!1){const d=C.length;if(d<6)return;let g=0;for(let y=0,T=C[d-2],E=C[d-1];y<d;y+=2){const P=C[y],D=C[y+1];g+=(P-T)*(D+E),T=P,E=D}if(!u&&g>0||u&&g<=0){const y=d/2;for(let T=y+y%2;T<d;T+=2){const E=d-T-2,P=d-T-1,D=T,B=T+1;[C[E],C[D]]=[C[D],C[E]],[C[P],C[B]]=[C[B],C[P]]}}}const hs={build(C){C.points=C.shape.points.slice()},triangulate(C,u){let d=C.points;const g=C.holes,y=u.points,T=u.indices;if(d.length>=6){ls(d,!1);const E=[];for(let B=0;B<g.length;B++){const G=g[B];ls(G.points,!0),E.push(d.length/2),d=d.concat(G.points)}const P=S.P6.earcut(d,E,2);if(!P)return;const D=y.length/2;for(let B=0;B<P.length;B+=3)T.push(P[B]+D),T.push(P[B+1]+D),T.push(P[B+2]+D);for(let B=0;B<d.length;B++)y.push(d[B])}}},Rs={build(C){const u=C.shape,d=u.x,g=u.y,y=u.width,T=u.height,E=C.points;E.length=0,y>=0&&T>=0&&E.push(d,g,d+y,g,d+y,g+T,d,g+T)},triangulate(C,u){const d=C.points,g=u.points;if(d.length===0)return;const y=g.length/2;g.push(d[0],d[1],d[2],d[3],d[6],d[7],d[4],d[5]),u.indices.push(y,y+1,y+2,y+1,y+2,y+3)}},zr={build(C){ni.build(C)},triangulate(C,u){ni.triangulate(C,u)}};var Ye=(C=>(C.MITER="miter",C.BEVEL="bevel",C.ROUND="round",C))(Ye||{}),He=(C=>(C.BUTT="butt",C.ROUND="round",C.SQUARE="square",C))(He||{});const Jt={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(C,u=20){if(!this.adaptive||!C||isNaN(C))return u;let d=Math.ceil(C/this.maxLength);return d<this.minSegments?d=this.minSegments:d>this.maxSegments&&(d=this.maxSegments),d}},us=null;class Sr{static curveTo(u,d,g,y,T,E){const P=E[E.length-2],D=E[E.length-1]-d,B=P-u,G=y-d,X=g-u,W=Math.abs(D*X-B*G);if(W<1e-8||T===0)return(E[E.length-2]!==u||E[E.length-1]!==d)&&E.push(u,d),null;const j=D*D+B*B,et=G*G+X*X,ht=D*G+B*X,wt=T*Math.sqrt(j)/W,Tt=T*Math.sqrt(et)/W,jt=wt*ht/j,Rt=Tt*ht/et,kt=wt*X+Tt*B,ne=wt*G+Tt*D,Ce=B*(Tt+jt),ae=D*(Tt+jt),oe=X*(wt+Rt),Te=G*(wt+Rt),Pe=Math.atan2(ae-ne,Ce-kt),Ke=Math.atan2(Te-ne,oe-kt);return{cx:kt+u,cy:ne+d,radius:T,startAngle:Pe,endAngle:Ke,anticlockwise:B*G>X*D}}static arc(u,d,g,y,T,E,P,D,B){const G=P-E,X=Jt._segmentsCount(Math.abs(G)*T,Math.ceil(Math.abs(G)/S._b)*40),W=G/(X*2),j=W*2,et=Math.cos(W),ht=Math.sin(W),wt=X-1,Tt=wt%1/wt;for(let jt=0;jt<=wt;++jt){const Rt=jt+Tt*jt,kt=W+E+j*Rt,ne=Math.cos(kt),Ce=-Math.sin(kt);B.push((et*ne+ht*Ce)*T+g,(et*-Ce+ht*ne)*T+y)}}}class Nr{static curveLength(u,d,g,y,T,E,P,D){let B=0,G=0,X=0,W=0,j=0,et=0,ht=0,wt=0,Tt=0,jt=0,Rt=0,kt=u,ne=d;for(let Ce=1;Ce<=10;++Ce)G=Ce/10,X=G*G,W=X*G,j=1-G,et=j*j,ht=et*j,wt=ht*u+3*et*G*g+3*j*X*T+W*P,Tt=ht*d+3*et*G*y+3*j*X*E+W*D,jt=kt-wt,Rt=ne-Tt,kt=wt,ne=Tt,B+=Math.sqrt(jt*jt+Rt*Rt);return B}static curveTo(u,d,g,y,T,E,P){const D=P[P.length-2],B=P[P.length-1];P.length-=2;const G=Jt._segmentsCount(Nr.curveLength(D,B,u,d,g,y,T,E));let X=0,W=0,j=0,et=0,ht=0;P.push(D,B);for(let wt=1,Tt=0;wt<=G;++wt)Tt=wt/G,X=1-Tt,W=X*X,j=W*X,et=Tt*Tt,ht=et*Tt,P.push(j*D+3*W*Tt*u+3*X*et*g+ht*T,j*B+3*W*Tt*d+3*X*et*y+ht*E)}}function I(C,u,d,g,y,T,E,P){const D=C-d*y,B=u-g*y,G=C+d*T,X=u+g*T;let W,j;E?(W=g,j=-d):(W=-g,j=d);const et=D+W,ht=B+j,wt=G+W,Tt=X+j;return P.push(et,ht,wt,Tt),2}function M(C,u,d,g,y,T,E,P){const D=d-C,B=g-u;let G=Math.atan2(D,B),X=Math.atan2(y-C,T-u);P&&G<X?G+=Math.PI*2:!P&&G>X&&(X+=Math.PI*2);let W=G;const j=X-G,et=Math.abs(j),ht=Math.sqrt(D*D+B*B),wt=(15*et*Math.sqrt(ht)/Math.PI>>0)+1,Tt=j/wt;if(W+=Tt,P){E.push(C,u,d,g);for(let jt=1,Rt=W;jt<wt;jt++,Rt+=Tt)E.push(C,u,C+Math.sin(Rt)*ht,u+Math.cos(Rt)*ht);E.push(C,u,y,T)}else{E.push(d,g,C,u);for(let jt=1,Rt=W;jt<wt;jt++,Rt+=Tt)E.push(C+Math.sin(Rt)*ht,u+Math.cos(Rt)*ht,C,u);E.push(y,T,C,u)}return wt*2}function Y(C,u){const d=C.shape;let g=C.points||d.points.slice();const y=u.closePointEps;if(g.length===0)return;const T=C.lineStyle,E=new S.E9(g[0],g[1]),P=new S.E9(g[g.length-2],g[g.length-1]),D=d.type!==S.HS.POLY||d.closeStroke,B=Math.abs(E.x-P.x)<y&&Math.abs(E.y-P.y)<y;if(D){g=g.slice(),B&&(g.pop(),g.pop(),P.set(g[g.length-2],g[g.length-1]));const be=(E.x+P.x)*.5,Me=(P.y+E.y)*.5;g.unshift(be,Me),g.push(be,Me)}const G=u.points,X=g.length/2;let W=g.length;const j=G.length/2,et=T.width/2,ht=et*et,wt=T.miterLimit*T.miterLimit;let Tt=g[0],jt=g[1],Rt=g[2],kt=g[3],ne=0,Ce=0,ae=-(jt-kt),oe=Tt-Rt,Te=0,Pe=0,Ke=Math.sqrt(ae*ae+oe*oe);ae/=Ke,oe/=Ke,ae*=et,oe*=et;const pe=T.alignment,Ut=(1-pe)*2,ie=pe*2;D||(T.cap===He.ROUND?W+=M(Tt-ae*(Ut-ie)*.5,jt-oe*(Ut-ie)*.5,Tt-ae*Ut,jt-oe*Ut,Tt+ae*ie,jt+oe*ie,G,!0)+2:T.cap===He.SQUARE&&(W+=I(Tt,jt,ae,oe,Ut,ie,!0,G))),G.push(Tt-ae*Ut,jt-oe*Ut,Tt+ae*ie,jt+oe*ie);for(let be=1;be<X-1;++be){Tt=g[(be-1)*2],jt=g[(be-1)*2+1],Rt=g[be*2],kt=g[be*2+1],ne=g[(be+1)*2],Ce=g[(be+1)*2+1],ae=-(jt-kt),oe=Tt-Rt,Ke=Math.sqrt(ae*ae+oe*oe),ae/=Ke,oe/=Ke,ae*=et,oe*=et,Te=-(kt-Ce),Pe=Rt-ne,Ke=Math.sqrt(Te*Te+Pe*Pe),Te/=Ke,Pe/=Ke,Te*=et,Pe*=et;const Me=Rt-Tt,hr=jt-kt,ur=Rt-ne,ke=Ce-kt,Mn=Me*ur+hr*ke,js=hr*ur-ke*Me,Qr=js<0;if(Math.abs(js)<.001*Math.abs(Mn)){G.push(Rt-ae*Ut,kt-oe*Ut,Rt+ae*ie,kt+oe*ie),Mn>=0&&(T.join===Ye.ROUND?W+=M(Rt,kt,Rt-ae*Ut,kt-oe*Ut,Rt-Te*Ut,kt-Pe*Ut,G,!1)+4:W+=2,G.push(Rt-Te*ie,kt-Pe*ie,Rt+Te*Ut,kt+Pe*Ut));continue}const Ws=(-ae+Tt)*(-oe+kt)-(-ae+Rt)*(-oe+jt),In=(-Te+ne)*(-Pe+kt)-(-Te+Rt)*(-Pe+Ce),Ki=(Me*In-ur*Ws)/js,xs=(ke*Ws-hr*In)/js,To=(Ki-Rt)*(Ki-Rt)+(xs-kt)*(xs-kt),Zi=Rt+(Ki-Rt)*Ut,xi=kt+(xs-kt)*Ut,p=Rt-(Ki-Rt)*ie,c=kt-(xs-kt)*ie,f=Math.min(Me*Me+hr*hr,ur*ur+ke*ke),v=Qr?Ut:ie,_=f+v*v*ht,A=To<=_;let R=T.join;if(R===Ye.MITER&&To/ht>wt&&(R=Ye.BEVEL),A)switch(R){case Ye.MITER:{G.push(Zi,xi,p,c);break}case Ye.BEVEL:{Qr?G.push(Zi,xi,Rt+ae*ie,kt+oe*ie,Zi,xi,Rt+Te*ie,kt+Pe*ie):G.push(Rt-ae*Ut,kt-oe*Ut,p,c,Rt-Te*Ut,kt-Pe*Ut,p,c),W+=2;break}case Ye.ROUND:{Qr?(G.push(Zi,xi,Rt+ae*ie,kt+oe*ie),W+=M(Rt,kt,Rt+ae*ie,kt+oe*ie,Rt+Te*ie,kt+Pe*ie,G,!0)+4,G.push(Zi,xi,Rt+Te*ie,kt+Pe*ie)):(G.push(Rt-ae*Ut,kt-oe*Ut,p,c),W+=M(Rt,kt,Rt-ae*Ut,kt-oe*Ut,Rt-Te*Ut,kt-Pe*Ut,G,!1)+4,G.push(Rt-Te*Ut,kt-Pe*Ut,p,c));break}}else{switch(G.push(Rt-ae*Ut,kt-oe*Ut,Rt+ae*ie,kt+oe*ie),R){case Ye.MITER:{Qr?G.push(p,c,p,c):G.push(Zi,xi,Zi,xi),W+=2;break}case Ye.ROUND:{Qr?W+=M(Rt,kt,Rt+ae*ie,kt+oe*ie,Rt+Te*ie,kt+Pe*ie,G,!0)+2:W+=M(Rt,kt,Rt-ae*Ut,kt-oe*Ut,Rt-Te*Ut,kt-Pe*Ut,G,!1)+2;break}}G.push(Rt-Te*Ut,kt-Pe*Ut,Rt+Te*ie,kt+Pe*ie),W+=2}}Tt=g[(X-2)*2],jt=g[(X-2)*2+1],Rt=g[(X-1)*2],kt=g[(X-1)*2+1],ae=-(jt-kt),oe=Tt-Rt,Ke=Math.sqrt(ae*ae+oe*oe),ae/=Ke,oe/=Ke,ae*=et,oe*=et,G.push(Rt-ae*Ut,kt-oe*Ut,Rt+ae*ie,kt+oe*ie),D||(T.cap===He.ROUND?W+=M(Rt-ae*(Ut-ie)*.5,kt-oe*(Ut-ie)*.5,Rt-ae*Ut,kt-oe*Ut,Rt+ae*ie,kt+oe*ie,G,!1)+2:T.cap===He.SQUARE&&(W+=I(Rt,kt,ae,oe,Ut,ie,!1,G)));const we=u.indices,je=Jt.epsilon*Jt.epsilon;for(let be=j;be<W+j-2;++be)Tt=G[be*2],jt=G[be*2+1],Rt=G[(be+1)*2],kt=G[(be+1)*2+1],ne=G[(be+2)*2],Ce=G[(be+2)*2+1],!(Math.abs(Tt*(kt-Ce)+Rt*(Ce-jt)+ne*(jt-kt))<je)&&we.push(be,be+1,be+2)}function pt(C,u){let d=0;const g=C.shape,y=C.points||g.points,T=g.type!==S.HS.POLY||g.closeStroke;if(y.length===0)return;const E=u.points,P=u.indices,D=y.length/2,B=E.length/2;let G=B;for(E.push(y[0],y[1]),d=1;d<D;d++)E.push(y[d*2],y[d*2+1]),P.push(G,G+1),G++;T&&P.push(G,B)}function Ct(C,u){C.lineStyle.native?pt(C,u):Y(C,u)}class Mt{static curveLength(u,d,g,y,T,E){const P=u-2*g+T,D=d-2*y+E,B=2*g-2*u,G=2*y-2*d,X=4*(P*P+D*D),W=4*(P*B+D*G),j=B*B+G*G,et=2*Math.sqrt(X+W+j),ht=Math.sqrt(X),wt=2*X*ht,Tt=2*Math.sqrt(j),jt=W/ht;return(wt*et+ht*W*(et-Tt)+(4*j*X-W*W)*Math.log((2*ht+jt+et)/(jt+Tt)))/(4*wt)}static curveTo(u,d,g,y,T){const E=T[T.length-2],P=T[T.length-1],D=Jt._segmentsCount(Mt.curveLength(E,P,u,d,g,y));let B=0,G=0;for(let X=1;X<=D;++X){const W=X/D;B=E+(u-E)*W,G=P+(d-P)*W,T.push(B+(u+(g-u)*W-B)*W,G+(d+(y-d)*W-G)*W)}}}const Yt={[S.HS.POLY]:hs,[S.HS.CIRC]:ni,[S.HS.ELIP]:ni,[S.HS.RECT]:Rs,[S.HS.RREC]:zr},me=[],de=[];class tr{constructor(u,d=null,g=null,y=null){this.points=[],this.holes=[],this.shape=u,this.lineStyle=g,this.fillStyle=d,this.matrix=y,this.type=u.type}clone(){return new tr(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}class Le{constructor(){this.reset()}begin(u,d,g){this.reset(),this.style=u,this.start=d,this.attribStart=g}end(u,d){this.attribSize=d-this.attribStart,this.size=u-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}const ar=new S.E9,rr=class zo extends S.JZ{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new ct,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let u=0;u<this.drawCalls.length;u++)this.drawCalls[u].texArray.clear(),de.push(this.drawCalls[u]);this.drawCalls.length=0;for(let u=0;u<this.batches.length;u++){const d=this.batches[u];d.reset(),me.push(d)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(u,d=null,g=null,y=null){const T=new tr(u,d,g,y);return this.graphicsData.push(T),this.dirty++,this}drawHole(u,d=null){if(!this.graphicsData.length)return null;const g=new tr(u,null,null,d),y=this.graphicsData[this.graphicsData.length-1];return g.lineStyle=y.lineStyle,y.holes.push(g),this.dirty++,this}destroy(){super.destroy();for(let u=0;u<this.graphicsData.length;++u)this.graphicsData[u].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(u){const d=this.graphicsData;for(let g=0;g<d.length;++g){const y=d[g];if(y.fillStyle.visible&&y.shape&&(y.matrix?y.matrix.applyInverse(u,ar):ar.copyFrom(u),y.shape.contains(ar.x,ar.y))){let T=!1;if(y.holes){for(let E=0;E<y.holes.length;E++)if(y.holes[E].shape.contains(ar.x,ar.y)){T=!0;break}}if(!T)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const u=this.uvs,d=this.graphicsData;let g=null,y=null;this.batches.length>0&&(g=this.batches[this.batches.length-1],y=g.style);for(let D=this.shapeIndex;D<d.length;D++){this.shapeIndex++;const B=d[D],G=B.fillStyle,X=B.lineStyle;Yt[B.type].build(B),B.matrix&&this.transformPoints(B.points,B.matrix),(G.visible||X.visible)&&this.processHoles(B.holes);for(let W=0;W<2;W++){const j=W===0?G:X;if(!j.visible)continue;const et=j.texture.baseTexture,ht=this.indices.length,wt=this.points.length/2;et.wrapMode=S.Nt.REPEAT,W===0?this.processFill(B):this.processLine(B);const Tt=this.points.length/2-wt;Tt!==0&&(g&&!this._compareStyles(y,j)&&(g.end(ht,wt),g=null),g||(g=me.pop()||new Le,g.begin(j,ht,wt),this.batches.push(g),y=j),this.addUvs(this.points,u,j.texture,wt,Tt,j.matrix))}}const T=this.indices.length,E=this.points.length/2;if(g&&g.end(T,E),this.batches.length===0){this.batchable=!0;return}const P=E>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&P===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=P?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(u,d){return!(!u||!d||u.texture.baseTexture!==d.texture.baseTexture||u.color+u.alpha!==d.color+d.alpha||!!u.native!=!!d.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let u=0,d=this.graphicsData.length;u<d;u++){const g=this.graphicsData[u],y=g.fillStyle,T=g.lineStyle;if(y&&!y.texture.baseTexture.valid||T&&!T.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const u=this.batches;for(let d=0,g=u.length;d<g;d++){const y=u[d];for(let T=0;T<y.size;T++){const E=y.start+T;this.indicesUint16[E]=this.indicesUint16[E]-y.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const u=this.batches;for(let d=0;d<u.length;d++)if(u[d].style.native)return!1;return this.points.length<zo.BATCHABLE_SIZE*2}buildDrawCalls(){let u=++S.VL._globalBatch;for(let X=0;X<this.drawCalls.length;X++)this.drawCalls[X].texArray.clear(),de.push(this.drawCalls[X]);this.drawCalls.length=0;const d=this.colors,g=this.textureIds;let y=de.pop();y||(y=new S.a$,y.texArray=new S.Ie),y.texArray.count=0,y.start=0,y.size=0,y.type=S.lg.TRIANGLES;let T=0,E=null,P=0,D=!1,B=S.lg.TRIANGLES,G=0;this.drawCalls.push(y);for(let X=0;X<this.batches.length;X++){const W=this.batches[X],j=8,et=W.style,ht=et.texture.baseTexture;D!==!!et.native&&(D=!!et.native,B=D?S.lg.LINES:S.lg.TRIANGLES,E=null,T=j,u++),E!==ht&&(E=ht,ht._batchEnabled!==u&&(T===j&&(u++,T=0,y.size>0&&(y=de.pop(),y||(y=new S.a$,y.texArray=new S.Ie),this.drawCalls.push(y)),y.start=G,y.size=0,y.texArray.count=0,y.type=B),ht.touched=1,ht._batchEnabled=u,ht._batchLocation=T,ht.wrapMode=S.Nt.REPEAT,y.texArray.elements[y.texArray.count++]=ht,T++)),y.size+=W.size,G+=W.size,P=ht._batchLocation,this.addColors(d,et.color,et.alpha,W.attribSize,W.attribStart),this.addTextureIds(g,P,W.attribSize,W.attribStart)}S.VL._globalBatch=u,this.packAttributes()}packAttributes(){const u=this.points,d=this.uvs,g=this.colors,y=this.textureIds,T=new ArrayBuffer(u.length*3*4),E=new Float32Array(T),P=new Uint32Array(T);let D=0;for(let B=0;B<u.length/2;B++)E[D++]=u[B*2],E[D++]=u[B*2+1],E[D++]=d[B*2],E[D++]=d[B*2+1],P[D++]=g[B],E[D++]=y[B];this._buffer.update(T),this._indexBuffer.update(this.indicesUint16)}processFill(u){u.holes.length?hs.triangulate(u,this):Yt[u.type].triangulate(u,this)}processLine(u){Ct(u,this);for(let d=0;d<u.holes.length;d++)Ct(u.holes[d],this)}processHoles(u){for(let d=0;d<u.length;d++){const g=u[d];Yt[g.type].build(g),g.matrix&&this.transformPoints(g.points,g.matrix)}}calculateBounds(){const u=this._bounds;u.clear(),u.addVertexData(this.points,0,this.points.length),u.pad(this.boundsPadding,this.boundsPadding)}transformPoints(u,d){for(let g=0;g<u.length/2;g++){const y=u[g*2],T=u[g*2+1];u[g*2]=d.a*y+d.c*T+d.tx,u[g*2+1]=d.b*y+d.d*T+d.ty}}addColors(u,d,g,y,T=0){const E=S.Il.shared.setValue(d).toLittleEndianNumber(),P=S.Il.shared.setValue(E).toPremultiplied(g);u.length=Math.max(u.length,T+y);for(let D=0;D<y;D++)u[T+D]=P}addTextureIds(u,d,g,y=0){u.length=Math.max(u.length,y+g);for(let T=0;T<g;T++)u[y+T]=d}addUvs(u,d,g,y,T,E=null){let P=0;const D=d.length,B=g.frame;for(;P<T;){let X=u[(y+P)*2],W=u[(y+P)*2+1];if(E){const j=E.a*X+E.c*W+E.tx;W=E.b*X+E.d*W+E.ty,X=j}P++,d.push(X/B.width,W/B.height)}const G=g.baseTexture;(B.width<G.width||B.height<G.height)&&this.adjustUvs(d,g,D,T)}adjustUvs(u,d,g,y){const T=d.baseTexture,E=1e-6,P=g+y*2,D=d.frame,B=D.width/T.width,G=D.height/T.height;let X=D.x/D.width,W=D.y/D.height,j=Math.floor(u[g]+E),et=Math.floor(u[g+1]+E);for(let ht=g+2;ht<P;ht+=2)j=Math.min(j,Math.floor(u[ht]+E)),et=Math.min(et,Math.floor(u[ht+1]+E));X-=j,W-=et;for(let ht=g;ht<P;ht+=2)u[ht]=(u[ht]+X)*B,u[ht+1]=(u[ht+1]+W)*G}};rr.BATCHABLE_SIZE=100;let Br=rr;class Wi{constructor(){this.color=16777215,this.alpha=1,this.texture=S.xE.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const u=new Wi;return u.color=this.color,u.alpha=this.alpha,u.texture=this.texture,u.matrix=this.matrix,u.visible=this.visible,u}reset(){this.color=16777215,this.alpha=1,this.texture=S.xE.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Si extends Wi{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=He.BUTT,this.join=Ye.MITER,this.miterLimit=10}clone(){const u=new Si;return u.color=this.color,u.alpha=this.alpha,u.texture=this.texture,u.matrix=this.matrix,u.visible=this.visible,u.width=this.width,u.alignment=this.alignment,u.native=this.native,u.cap=this.cap,u.join=this.join,u.miterLimit=this.miterLimit,u}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=He.BUTT,this.join=Ye.MITER,this.miterLimit=10}}const Vr={},$i=class mo extends mt{constructor(u=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Wi,this._lineStyle=new Si,this._matrix=null,this._holeMode=!1,this.state=S.ZM.for2d(),this._geometry=u||new Br,this._geometry.refCount++,this._transformID=-1,this._tintColor=new S.Il(16777215),this.blendMode=S.T$.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new mo(this._geometry)}set blendMode(u){this.state.blendMode=u}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(u){this._tintColor.setValue(u)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(u=null,d=0,g,y=.5,T=!1){return typeof u=="number"&&(u={width:u,color:d,alpha:g,alignment:y,native:T}),this.lineTextureStyle(u)}lineTextureStyle(u){const d={width:0,texture:S.xE.WHITE,color:u!=null&&u.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:He.BUTT,join:Ye.MITER,miterLimit:10};u=Object.assign(d,u),this.normalizeColor(u),this.currentPath&&this.startPoly();const g=u.width>0&&u.alpha>0;return g?(u.matrix&&(u.matrix=u.matrix.clone(),u.matrix.invert()),Object.assign(this._lineStyle,{visible:g},u)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const u=this.currentPath.points,d=this.currentPath.points.length;d>2&&(this.drawShape(this.currentPath),this.currentPath=new S.mg,this.currentPath.closeStroke=!1,this.currentPath.points.push(u[d-2],u[d-1]))}else this.currentPath=new S.mg,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(u,d){return this.startPoly(),this.currentPath.points[0]=u,this.currentPath.points[1]=d,this}lineTo(u,d){this.currentPath||this.moveTo(0,0);const g=this.currentPath.points,y=g[g.length-2],T=g[g.length-1];return(y!==u||T!==d)&&g.push(u,d),this}_initCurve(u=0,d=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[u,d]):this.moveTo(u,d)}quadraticCurveTo(u,d,g,y){this._initCurve();const T=this.currentPath.points;return T.length===0&&this.moveTo(0,0),Mt.curveTo(u,d,g,y,T),this}bezierCurveTo(u,d,g,y,T,E){return this._initCurve(),Nr.curveTo(u,d,g,y,T,E,this.currentPath.points),this}arcTo(u,d,g,y,T){this._initCurve(u,d);const E=this.currentPath.points,P=Sr.curveTo(u,d,g,y,T,E);if(P){const{cx:D,cy:B,radius:G,startAngle:X,endAngle:W,anticlockwise:j}=P;this.arc(D,B,G,X,W,j)}return this}arc(u,d,g,y,T,E=!1){if(y===T)return this;if(!E&&T<=y?T+=S._b:E&&y<=T&&(y+=S._b),T-y===0)return this;const P=u+Math.cos(y)*g,D=d+Math.sin(y)*g,B=this._geometry.closePointEps;let G=this.currentPath?this.currentPath.points:null;if(G){const X=Math.abs(G[G.length-2]-P),W=Math.abs(G[G.length-1]-D);X<B&&W<B||G.push(P,D)}else this.moveTo(P,D),G=this.currentPath.points;return Sr.arc(P,D,u,d,g,y,T,E,G),this}beginFill(u=0,d){return this.beginTextureFill({texture:S.xE.WHITE,color:u,alpha:d})}normalizeColor(u){var g,y;const d=S.Il.shared.setValue((g=u.color)!=null?g:0);u.color=d.toNumber(),(y=u.alpha)!=null||(u.alpha=d.alpha)}beginTextureFill(u){const d={texture:S.xE.WHITE,color:16777215,matrix:null};u=Object.assign(d,u),this.normalizeColor(u),this.currentPath&&this.startPoly();const g=u.alpha>0;return g?(u.matrix&&(u.matrix=u.matrix.clone(),u.matrix.invert()),Object.assign(this._fillStyle,{visible:g},u)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(u,d,g,y){return this.drawShape(new S.Ae(u,d,g,y))}drawRoundedRect(u,d,g,y,T){return this.drawShape(new S.c9(u,d,g,y,T))}drawCircle(u,d,g){return this.drawShape(new S.Cd(u,d,g))}drawEllipse(u,d,g,y){return this.drawShape(new S.Pj(u,d,g,y))}drawPolygon(...u){let d,g=!0;const y=u[0];y.points?(g=y.closeStroke,d=y.points):Array.isArray(u[0])?d=u[0]:d=u;const T=new S.mg(d);return T.closeStroke=g,this.drawShape(T),this}drawShape(u){return this._holeMode?this._geometry.drawHole(u,this._matrix):this._geometry.drawShape(u,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const u=this._geometry.graphicsData;return u.length===1&&u[0].shape.type===S.HS.RECT&&!u[0].matrix&&!u[0].holes.length&&!(u[0].lineStyle.visible&&u[0].lineStyle.width)}_render(u){this.finishPoly();const d=this._geometry;d.updateBatches(),d.batchable?(this.batchDirty!==d.batchDirty&&this._populateBatches(),this._renderBatched(u)):(u.batch.flush(),this._renderDirect(u))}_populateBatches(){const u=this._geometry,d=this.blendMode,g=u.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=u.batchDirty,this.batches.length=g,this.vertexData=new Float32Array(u.points);for(let y=0;y<g;y++){const T=u.batches[y],E=T.style.color,P=new Float32Array(this.vertexData.buffer,T.attribStart*4*2,T.attribSize*2),D=new Float32Array(u.uvsFloat32.buffer,T.attribStart*4*2,T.attribSize*2),B=new Uint16Array(u.indicesUint16.buffer,T.start*2,T.size),G={vertexData:P,blendMode:d,indices:B,uvs:D,_batchRGB:S.Il.shared.setValue(E).toRgbArray(),_tintRGB:E,_texture:T.style.texture,alpha:T.style.alpha,worldAlpha:1};this.batches[y]=G}}_renderBatched(u){if(this.batches.length){u.batch.setObjectRenderer(u.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let d=0,g=this.batches.length;d<g;d++){const y=this.batches[d];y.worldAlpha=this.worldAlpha*y.alpha,u.plugins[this.pluginName].render(y)}}}_renderDirect(u){const d=this._resolveDirectShader(u),g=this._geometry,y=this.worldAlpha,T=d.uniforms,E=g.drawCalls;T.translationMatrix=this.transform.worldTransform,S.Il.shared.setValue(this._tintColor).premultiply(y).toArray(T.tint),u.shader.bind(d),u.geometry.bind(g,d),u.state.set(this.state);for(let P=0,D=E.length;P<D;P++)this._renderDrawCallDirect(u,g.drawCalls[P])}_renderDrawCallDirect(u,d){const{texArray:g,type:y,size:T,start:E}=d,P=g.count;for(let D=0;D<P;D++)u.texture.bind(g.elements[D],D);u.geometry.draw(y,T,E)}_resolveDirectShader(u){let d=this.shader;const g=this.pluginName;if(!d){if(!Vr[g]){const{maxTextures:y}=u.plugins[g],T=new Int32Array(y);for(let D=0;D<y;D++)T[D]=D;const E={tint:new Float32Array([1,1,1,1]),translationMatrix:new S.y3,default:S.oo.from({uSamplers:T},!0)},P=u.plugins[g]._shader.program;Vr[g]=new S.ex(P,E)}d=Vr[g]}return d}_calculateBounds(){this.finishPoly();const u=this._geometry;if(!u.graphicsData.length)return;const{minX:d,minY:g,maxX:y,maxY:T}=u.bounds;this._bounds.addFrame(this.transform,d,g,y,T)}containsPoint(u){return this.worldTransform.applyInverse(u,mo._TEMP_POINT),this._geometry.containsPoint(mo._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let u=0;u<this.batches.length;u++){const d=this.batches[u];d._tintRGB=S.Il.shared.setValue(this._tintColor).multiply(d._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const u=this.transform._worldID;if(this._transformID===u)return;this._transformID=u;const d=this.transform.worldTransform,g=d.a,y=d.b,T=d.c,E=d.d,P=d.tx,D=d.ty,B=this._geometry.points,G=this.vertexData;let X=0;for(let W=0;W<B.length;W+=2){const j=B[W],et=B[W+1];G[X++]=g*j+T*et+P,G[X++]=E*et+y*j+D}}closePath(){const u=this.currentPath;return u&&(u.closeStroke=!0,this.finishPoly()),this}setMatrix(u){return this._matrix=u,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(u){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(u)}};$i.curves=Jt,$i._TEMP_POINT=new S.E9;let cs=$i;const ds={buildPoly:hs,buildCircle:ni,buildRectangle:Rs,buildRoundedRectangle:zr,buildLine:Ct,ArcUtils:Sr,BezierUtils:Nr,QuadraticUtils:Mt,BatchPart:Le,FILL_COMMANDS:Yt,BATCH_POOL:me,DRAW_CALL_POOL:de};class Fs{constructor(u,d){this.uvBuffer=u,this.uvMatrix=d,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(u){if(!u&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const d=this.uvBuffer.data;(!this.data||this.data.length!==d.length)&&(this.data=new Float32Array(d.length)),this.uvMatrix.multiplyUvs(d,this.data),this._updateID++}}const qr=new S.E9,Ds=new S.mg,Ci=class Vo extends mt{constructor(u,d,g,y=S.lg.TRIANGLES){super(),this.geometry=u,this.shader=d,this.state=g||S.ZM.for2d(),this.drawMode=y,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=S.Xd.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(u){this._geometry!==u&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=u,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(u){this.shader=u}get material(){return this.shader}set blendMode(u){this.state.blendMode=u}get blendMode(){return this.state.blendMode}set roundPixels(u){this._roundPixels!==u&&(this._transformID=-1),this._roundPixels=u}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(u){this.shader.tint=u}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(u){this.shader.texture=u}_render(u){const d=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===S.lg.TRIANGLES&&d.length<Vo.BATCHABLE_SIZE*2?this._renderToBatch(u):this._renderDefault(u)}_renderDefault(u){const d=this.shader;d.alpha=this.worldAlpha,d.update&&d.update(),u.batch.flush(),d.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),u.shader.bind(d),u.state.set(this.state),u.geometry.bind(this.geometry,d),u.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(u){const d=this.geometry,g=this.shader;g.uvMatrix&&(g.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=d.indexBuffer.data,this._tintRGB=g._tintRGB,this._texture=g.texture;const y=this.material.pluginName;u.batch.setObjectRenderer(u.plugins[y]),u.plugins[y].render(this)}calculateVertices(){const u=this.geometry.buffers[0],d=u.data,g=u._updateID;if(g===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==d.length&&(this.vertexData=new Float32Array(d.length));const y=this.transform.worldTransform,T=y.a,E=y.b,P=y.c,D=y.d,B=y.tx,G=y.ty,X=this.vertexData;for(let W=0;W<X.length/2;W++){const j=d[W*2],et=d[W*2+1];X[W*2]=T*j+P*et+B,X[W*2+1]=E*j+D*et+G}if(this._roundPixels){const W=S.Xd.RESOLUTION;for(let j=0;j<X.length;++j)X[j]=Math.round(X[j]*W)/W}this.vertexDirty=g}calculateUvs(){const u=this.geometry.buffers[1],d=this.shader;d.uvMatrix.isSimple?this.uvs=u.data:(this.batchUvs||(this.batchUvs=new Fs(u,d.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(u){if(!this.getBounds().contains(u.x,u.y))return!1;this.worldTransform.applyInverse(u,qr);const d=this.geometry.getBuffer("aVertexPosition").data,g=Ds.points,y=this.geometry.getIndex().data,T=y.length,E=this.drawMode===4?3:1;for(let P=0;P+2<T;P+=E){const D=y[P]*2,B=y[P+1]*2,G=y[P+2]*2;if(g[0]=d[D],g[1]=d[D+1],g[2]=d[B],g[3]=d[B+1],g[4]=d[G],g[5]=d[G+1],Ds.contains(qr.x,qr.y))return!0}return!1}destroy(u){super.destroy(u),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};Ci.BATCHABLE_SIZE=100;let Ns=Ci;class pn extends S.wG{constructor(u,d,g){super();const y=new S.lW(u),T=new S.lW(d,!0),E=new S.lW(g,!0,!0);this.addAttribute("aVertexPosition",y,2,!1,S.vK.FLOAT).addAttribute("aTextureCoord",T,2,!1,S.vK.FLOAT).addIndex(E),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var fs=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,oi=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class ps extends S.ex{constructor(u,d){const g={uSampler:u,alpha:1,uTextureMatrix:S.y3.IDENTITY,uColor:new Float32Array([1,1,1,1])};d=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},d),d.uniforms&&Object.assign(g,d.uniforms),super(d.program||S.$r.from(oi,fs),g),this._colorDirty=!1,this.uvMatrix=new S.UX(u),this.batchable=d.program===void 0,this.pluginName=d.pluginName,this._tintColor=new S.Il(d.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=d.alpha}get texture(){return this.uniforms.uSampler}set texture(u){this.uniforms.uSampler!==u&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!u.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=u,this.uvMatrix.texture=u)}set alpha(u){u!==this._alpha&&(this._alpha=u,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(u){u!==this.tint&&(this._tintColor.setValue(u),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const u=this.texture.baseTexture.alphaMode;S.Il.shared.setValue(this._tintColor).premultiply(this._alpha,u).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class Bs extends null{constructor(u=100,d=100,g=10,y=10){super(),this.segWidth=g,this.segHeight=y,this.width=u,this.height=d,this.build()}build(){const u=this.segWidth*this.segHeight,d=[],g=[],y=[],T=this.segWidth-1,E=this.segHeight-1,P=this.width/T,D=this.height/E;for(let G=0;G<u;G++){const X=G%this.segWidth,W=G/this.segWidth|0;d.push(X*P,W*D),g.push(X/T,W/E)}const B=T*E;for(let G=0;G<B;G++){const X=G%T,W=G/T|0,j=W*this.segWidth+X,et=W*this.segWidth+X+1,ht=(W+1)*this.segWidth+X,wt=(W+1)*this.segWidth+X+1;y.push(j,et,ht,et,wt,ht)}this.buffers[0].data=new Float32Array(d),this.buffers[1].data=new Float32Array(g),this.indexBuffer.data=new Uint16Array(y),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class Cr extends null{constructor(u=200,d,g=0){super(new Float32Array(d.length*4),new Float32Array(d.length*4),new Uint16Array((d.length-1)*6)),this.points=d,this._width=u,this.textureScale=g,this.build()}get width(){return this._width}build(){const u=this.points;if(!u)return;const d=this.getBuffer("aVertexPosition"),g=this.getBuffer("aTextureCoord"),y=this.getIndex();if(u.length<1)return;d.data.length/4!==u.length&&(d.data=new Float32Array(u.length*4),g.data=new Float32Array(u.length*4),y.data=new Uint16Array((u.length-1)*6));const T=g.data,E=y.data;T[0]=0,T[1]=0,T[2]=0,T[3]=1;let P=0,D=u[0];const B=this._width*this.textureScale,G=u.length;for(let W=0;W<G;W++){const j=W*4;if(this.textureScale>0){const et=D.x-u[W].x,ht=D.y-u[W].y,wt=Math.sqrt(et*et+ht*ht);D=u[W],P+=wt/B}else P=W/(G-1);T[j]=P,T[j+1]=0,T[j+2]=P,T[j+3]=1}let X=0;for(let W=0;W<G-1;W++){const j=W*2;E[X++]=j,E[X++]=j+1,E[X++]=j+2,E[X++]=j+2,E[X++]=j+1,E[X++]=j+3}g.update(),y.update(),this.updateVertices()}updateVertices(){const u=this.points;if(u.length<1)return;let d=u[0],g,y=0,T=0;const E=this.buffers[0].data,P=u.length,D=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let B=0;B<P;B++){const G=u[B],X=B*4;B<u.length-1?g=u[B+1]:g=G,T=-(g.x-d.x),y=g.y-d.y;let W=(1-B/(P-1))*10;W>1&&(W=1);const j=Math.sqrt(y*y+T*T);j<1e-6?(y=0,T=0):(y/=j,T/=j,y*=D,T*=D),E[X]=G.x+y,E[X+1]=G.y+T,E[X+2]=G.x-y,E[X+3]=G.y-T,d=G}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class ai extends null{constructor(u,d,g){const y=new PlaneGeometry(u.width,u.height,d,g),T=new MeshMaterial(Texture.WHITE);super(y,T),this.texture=u,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const u=this.geometry,{width:d,height:g}=this.shader.texture;this.autoResize&&(u.width!==d||u.height!==g)&&(u.width=this.shader.texture.width,u.height=this.shader.texture.height,u.build())}set texture(u){this.shader.texture!==u&&(this.shader.texture=u,this._textureID=-1,u.baseTexture.valid?this.textureUpdated():u.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(u){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(u)}destroy(u){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(u)}}const Kr=10;class xe extends null{constructor(u,d,g,y,T){var E,P,D,B,G,X,W,j;super(Texture.WHITE,4,4),this._origWidth=u.orig.width,this._origHeight=u.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=(P=d!=null?d:(E=u.defaultBorders)==null?void 0:E.left)!=null?P:Kr,this._rightWidth=(B=y!=null?y:(D=u.defaultBorders)==null?void 0:D.right)!=null?B:Kr,this._topHeight=(X=g!=null?g:(G=u.defaultBorders)==null?void 0:G.top)!=null?X:Kr,this._bottomHeight=(j=T!=null?T:(W=u.defaultBorders)==null?void 0:W.bottom)!=null?j:Kr,this.texture=u}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(u){this.geometry.getBuffer("aVertexPosition").data=u}updateHorizontalVertices(){const u=this.vertices,d=this._getMinScale();u[9]=u[11]=u[13]=u[15]=this._topHeight*d,u[17]=u[19]=u[21]=u[23]=this._height-this._bottomHeight*d,u[25]=u[27]=u[29]=u[31]=this._height}updateVerticalVertices(){const u=this.vertices,d=this._getMinScale();u[2]=u[10]=u[18]=u[26]=this._leftWidth*d,u[4]=u[12]=u[20]=u[28]=this._width-this._rightWidth*d,u[6]=u[14]=u[22]=u[30]=this._width}_getMinScale(){const u=this._leftWidth+this._rightWidth,d=this._width>u?1:this._width/u,g=this._topHeight+this._bottomHeight,y=this._height>g?1:this._height/g;return Math.min(d,y)}get width(){return this._width}set width(u){this._width=u,this._refresh()}get height(){return this._height}set height(u){this._height=u,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(u){this._leftWidth=u,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(u){this._rightWidth=u,this._refresh()}get topHeight(){return this._topHeight}set topHeight(u){this._topHeight=u,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(u){this._bottomHeight=u,this._refresh()}_refresh(){const u=this.texture,d=this.geometry.buffers[1].data;this._origWidth=u.orig.width,this._origHeight=u.orig.height;const g=1/this._origWidth,y=1/this._origHeight;d[0]=d[8]=d[16]=d[24]=0,d[1]=d[3]=d[5]=d[7]=0,d[6]=d[14]=d[22]=d[30]=1,d[25]=d[27]=d[29]=d[31]=1,d[2]=d[10]=d[18]=d[26]=g*this._leftWidth,d[4]=d[12]=d[20]=d[28]=1-g*this._rightWidth,d[9]=d[11]=d[13]=d[15]=y*this._topHeight,d[17]=d[19]=d[21]=d[23]=1-y*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class Oe extends null{constructor(u=Texture.EMPTY,d,g,y,T){const E=new MeshGeometry(d,g,y);E.getBuffer("aVertexPosition").static=!1;const P=new MeshMaterial(u);super(E,P,null,T),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(u){this.geometry.getBuffer("aVertexPosition").data=u}_render(u){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(u)}}class lr extends null{constructor(u,d,g=0){const y=new RopeGeometry(u.height,d,g),T=new MeshMaterial(u);g>0&&(u.baseTexture.wrapMode=WRAP_MODES.REPEAT),super(y,T),this.autoUpdate=!0}_render(u){const d=this.geometry;(this.autoUpdate||d._width!==this.shader.texture.height)&&(d._width=this.shader.texture.height,d.update()),super._render(u)}}class pr extends null{constructor(u=1500,d,g=16384,y=!1){super();const T=16384;g>T&&(g=T),this._properties=[!1,!0,!1,!1,!1],this._maxSize=u,this._batchSize=g,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=BLEND_MODES.NORMAL,this.autoResize=y,this.roundPixels=!0,this.baseTexture=null,this.setProperties(d),this._tintColor=new Color(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(u){u&&(this._properties[0]="vertices"in u||"scale"in u?!!u.vertices||!!u.scale:this._properties[0],this._properties[1]="position"in u?!!u.position:this._properties[1],this._properties[2]="rotation"in u?!!u.rotation:this._properties[2],this._properties[3]="uvs"in u?!!u.uvs:this._properties[3],this._properties[4]="tint"in u||"alpha"in u?!!u.tint||!!u.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(u){this._tintColor.setValue(u),this._tintColor.toRgbArray(this.tintRgb)}render(u){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",()=>this.onChildrenChange(0))),u.batch.setObjectRenderer(u.plugins.particle),u.plugins.particle.render(this))}onChildrenChange(u){const d=Math.floor(u/this._batchSize);for(;this._bufferUpdateIDs.length<d;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[d]=++this._updateID}dispose(){if(this._buffers){for(let u=0;u<this._buffers.length;++u)this._buffers[u].destroy();this._buffers=null}}destroy(u){super.destroy(u),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class li{constructor(u,d,g){this.geometry=new S.wG,this.indexBuffer=null,this.size=g,this.dynamicProperties=[],this.staticProperties=[];for(let y=0;y<u.length;++y){let T=u[y];T={attributeName:T.attributeName,size:T.size,uploadFunction:T.uploadFunction,type:T.type||S.vK.FLOAT,offset:T.offset},d[y]?this.dynamicProperties.push(T):this.staticProperties.push(T)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const u=this.geometry;let d=0;this.indexBuffer=new S.lW(S.P6.createIndicesForQuads(this.size),!0,!0),u.addIndex(this.indexBuffer),this.dynamicStride=0;for(let E=0;E<this.dynamicProperties.length;++E){const P=this.dynamicProperties[E];P.offset=d,d+=P.size,this.dynamicStride+=P.size}const g=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(g),this.dynamicDataUint32=new Uint32Array(g),this.dynamicBuffer=new S.lW(this.dynamicData,!1,!1);let y=0;this.staticStride=0;for(let E=0;E<this.staticProperties.length;++E){const P=this.staticProperties[E];P.offset=y,y+=P.size,this.staticStride+=P.size}const T=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(T),this.staticDataUint32=new Uint32Array(T),this.staticBuffer=new S.lW(this.staticData,!0,!1);for(let E=0;E<this.dynamicProperties.length;++E){const P=this.dynamicProperties[E];u.addAttribute(P.attributeName,this.dynamicBuffer,0,P.type===S.vK.UNSIGNED_BYTE,P.type,this.dynamicStride*4,P.offset*4)}for(let E=0;E<this.staticProperties.length;++E){const P=this.staticProperties[E];u.addAttribute(P.attributeName,this.staticBuffer,0,P.type===S.vK.UNSIGNED_BYTE,P.type,this.staticStride*4,P.offset*4)}}uploadDynamic(u,d,g){for(let y=0;y<this.dynamicProperties.length;y++){const T=this.dynamicProperties[y];T.uploadFunction(u,d,g,T.type===S.vK.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,T.offset)}this.dynamicBuffer._updateID++}uploadStatic(u,d,g){for(let y=0;y<this.staticProperties.length;y++){const T=this.staticProperties[y];T.uploadFunction(u,d,g,T.type===S.vK.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,T.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var go=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,kn=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class Un extends S.bO{constructor(u){super(u),this.shader=null,this.properties=null,this.tempMatrix=new S.y3,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:S.vK.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=S.ex.from(kn,go,{}),this.state=S.ZM.for2d()}render(u){const d=u.children,g=u._maxSize,y=u._batchSize,T=this.renderer;let E=d.length;if(E===0)return;E>g&&!u.autoResize&&(E=g);let P=u._buffers;P||(P=u._buffers=this.generateBuffers(u));const D=d[0]._texture.baseTexture,B=D.alphaMode>0;this.state.blendMode=S.P6.correctBlendMode(u.blendMode,B),T.state.set(this.state);const G=T.gl,X=u.worldTransform.copyTo(this.tempMatrix);X.prepend(T.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=X.toArray(!0),this.shader.uniforms.uColor=S.Il.shared.setValue(u.tintRgb).premultiply(u.worldAlpha,B).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=D,this.renderer.shader.bind(this.shader);let W=!1;for(let j=0,et=0;j<E;j+=y,et+=1){let ht=E-j;ht>y&&(ht=y),et>=P.length&&P.push(this._generateOneMoreBuffer(u));const wt=P[et];wt.uploadDynamic(d,j,ht);const Tt=u._bufferUpdateIDs[et]||0;W=W||wt._updateID<Tt,W&&(wt._updateID=u._updateID,wt.uploadStatic(d,j,ht)),T.geometry.bind(wt.geometry),G.drawElements(G.TRIANGLES,ht*6,G.UNSIGNED_SHORT,0)}}generateBuffers(u){const d=[],g=u._maxSize,y=u._batchSize,T=u._properties;for(let E=0;E<g;E+=y)d.push(new li(this.properties,T,y));return d}_generateOneMoreBuffer(u){const d=u._batchSize,g=u._properties;return new li(this.properties,g,d)}uploadVertices(u,d,g,y,T,E){let P=0,D=0,B=0,G=0;for(let X=0;X<g;++X){const W=u[d+X],j=W._texture,et=W.scale.x,ht=W.scale.y,wt=j.trim,Tt=j.orig;wt?(D=wt.x-W.anchor.x*Tt.width,P=D+wt.width,G=wt.y-W.anchor.y*Tt.height,B=G+wt.height):(P=Tt.width*(1-W.anchor.x),D=Tt.width*-W.anchor.x,B=Tt.height*(1-W.anchor.y),G=Tt.height*-W.anchor.y),y[E]=D*et,y[E+1]=G*ht,y[E+T]=P*et,y[E+T+1]=G*ht,y[E+T*2]=P*et,y[E+T*2+1]=B*ht,y[E+T*3]=D*et,y[E+T*3+1]=B*ht,E+=T*4}}uploadPosition(u,d,g,y,T,E){for(let P=0;P<g;P++){const D=u[d+P].position;y[E]=D.x,y[E+1]=D.y,y[E+T]=D.x,y[E+T+1]=D.y,y[E+T*2]=D.x,y[E+T*2+1]=D.y,y[E+T*3]=D.x,y[E+T*3+1]=D.y,E+=T*4}}uploadRotation(u,d,g,y,T,E){for(let P=0;P<g;P++){const D=u[d+P].rotation;y[E]=D,y[E+T]=D,y[E+T*2]=D,y[E+T*3]=D,E+=T*4}}uploadUvs(u,d,g,y,T,E){for(let P=0;P<g;++P){const D=u[d+P]._texture._uvs;D?(y[E]=D.x0,y[E+1]=D.y0,y[E+T]=D.x1,y[E+T+1]=D.y1,y[E+T*2]=D.x2,y[E+T*2+1]=D.y2,y[E+T*3]=D.x3,y[E+T*3+1]=D.y3,E+=T*4):(y[E]=0,y[E+1]=0,y[E+T]=0,y[E+T+1]=0,y[E+T*2]=0,y[E+T*2+1]=0,y[E+T*3]=0,y[E+T*3+1]=0,E+=T*4)}}uploadTint(u,d,g,y,T,E){for(let P=0;P<g;++P){const D=u[d+P],B=S.Il.shared.setValue(D._tintRGB).toPremultiplied(D.alpha,D.texture.baseTexture.alphaMode>0);y[E]=B,y[E+T]=B,y[E+T*2]=B,y[E+T*3]=B,E+=T*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Un.extension={name:"particle",type:S.nw.RendererPlugin},S.Rw.add(Un);var Os=(C=>(C[C.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",C[C.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",C))(Os||{});const Yi={willReadFrequently:!0},Zr=class ge{static get experimentalLetterSpacingSupported(){let u=ge._experimentalLetterSpacingSupported;if(u!==void 0){const d=S.Xd.ADAPTER.getCanvasRenderingContext2D().prototype;u=ge._experimentalLetterSpacingSupported="letterSpacing"in d||"textLetterSpacing"in d}return u}constructor(u,d,g,y,T,E,P,D,B){this.text=u,this.style=d,this.width=g,this.height=y,this.lines=T,this.lineWidths=E,this.lineHeight=P,this.maxLineWidth=D,this.fontProperties=B}static measureText(u,d,g,y=ge._canvas){g=g!=null?g:d.wordWrap;const T=d.toFontString(),E=ge.measureFont(T);E.fontSize===0&&(E.fontSize=d.fontSize,E.ascent=d.fontSize);const P=y.getContext("2d",Yi);P.font=T;const D=(g?ge.wordWrap(u,d,y):u).split(/(?:\r\n|\r|\n)/),B=new Array(D.length);let G=0;for(let et=0;et<D.length;et++){const ht=ge._measureText(D[et],d.letterSpacing,P);B[et]=ht,G=Math.max(G,ht)}let X=G+d.strokeThickness;d.dropShadow&&(X+=d.dropShadowDistance);const W=d.lineHeight||E.fontSize+d.strokeThickness;let j=Math.max(W,E.fontSize+d.strokeThickness*2)+d.leading+(D.length-1)*(W+d.leading);return d.dropShadow&&(j+=d.dropShadowDistance),new ge(u,d,X,j,D,B,W+d.leading,G,E)}static _measureText(u,d,g){let y=!1;ge.experimentalLetterSpacingSupported&&(ge.experimentalLetterSpacing?(g.letterSpacing=`${d}px`,g.textLetterSpacing=`${d}px`,y=!0):(g.letterSpacing="0px",g.textLetterSpacing="0px"));let T=g.measureText(u).width;return T>0&&(y?T-=d:T+=(ge.graphemeSegmenter(u).length-1)*d),T}static wordWrap(u,d,g=ge._canvas){const y=g.getContext("2d",Yi);let T=0,E="",P="";const D=Object.create(null),{letterSpacing:B,whiteSpace:G}=d,X=ge.collapseSpaces(G),W=ge.collapseNewlines(G);let j=!X;const et=d.wordWrapWidth+B,ht=ge.tokenize(u);for(let wt=0;wt<ht.length;wt++){let Tt=ht[wt];if(ge.isNewline(Tt)){if(!W){P+=ge.addLine(E),j=!X,E="",T=0;continue}Tt=" "}if(X){const Rt=ge.isBreakingSpace(Tt),kt=ge.isBreakingSpace(E[E.length-1]);if(Rt&&kt)continue}const jt=ge.getFromCache(Tt,B,D,y);if(jt>et)if(E!==""&&(P+=ge.addLine(E),E="",T=0),ge.canBreakWords(Tt,d.breakWords)){const Rt=ge.wordWrapSplit(Tt);for(let kt=0;kt<Rt.length;kt++){let ne=Rt[kt],Ce=ne,ae=1;for(;Rt[kt+ae];){const Te=Rt[kt+ae];if(!ge.canBreakChars(Ce,Te,Tt,kt,d.breakWords))ne+=Te;else break;Ce=Te,ae++}kt+=ae-1;const oe=ge.getFromCache(ne,B,D,y);oe+T>et&&(P+=ge.addLine(E),j=!1,E="",T=0),E+=ne,T+=oe}}else{E.length>0&&(P+=ge.addLine(E),E="",T=0);const Rt=wt===ht.length-1;P+=ge.addLine(Tt,!Rt),j=!1,E="",T=0}else jt+T>et&&(j=!1,P+=ge.addLine(E),E="",T=0),(E.length>0||!ge.isBreakingSpace(Tt)||j)&&(E+=Tt,T+=jt)}return P+=ge.addLine(E,!1),P}static addLine(u,d=!0){return u=ge.trimRight(u),u=d?`${u}
`:u,u}static getFromCache(u,d,g,y){let T=g[u];return typeof T!="number"&&(T=ge._measureText(u,d,y)+d,g[u]=T),T}static collapseSpaces(u){return u==="normal"||u==="pre-line"}static collapseNewlines(u){return u==="normal"}static trimRight(u){if(typeof u!="string")return"";for(let d=u.length-1;d>=0;d--){const g=u[d];if(!ge.isBreakingSpace(g))break;u=u.slice(0,-1)}return u}static isNewline(u){return typeof u!="string"?!1:ge._newlines.includes(u.charCodeAt(0))}static isBreakingSpace(u,d){return typeof u!="string"?!1:ge._breakingSpaces.includes(u.charCodeAt(0))}static tokenize(u){const d=[];let g="";if(typeof u!="string")return d;for(let y=0;y<u.length;y++){const T=u[y],E=u[y+1];if(ge.isBreakingSpace(T,E)||ge.isNewline(T)){g!==""&&(d.push(g),g=""),d.push(T);continue}g+=T}return g!==""&&d.push(g),d}static canBreakWords(u,d){return d}static canBreakChars(u,d,g,y,T){return!0}static wordWrapSplit(u){return ge.graphemeSegmenter(u)}static measureFont(u){if(ge._fonts[u])return ge._fonts[u];const d={ascent:0,descent:0,fontSize:0},g=ge._canvas,y=ge._context;y.font=u;const T=ge.METRICS_STRING+ge.BASELINE_SYMBOL,E=Math.ceil(y.measureText(T).width);let P=Math.ceil(y.measureText(ge.BASELINE_SYMBOL).width);const D=Math.ceil(ge.HEIGHT_MULTIPLIER*P);if(P=P*ge.BASELINE_MULTIPLIER|0,E===0||D===0)return ge._fonts[u]=d,d;g.width=E,g.height=D,y.fillStyle="#f00",y.fillRect(0,0,E,D),y.font=u,y.textBaseline="alphabetic",y.fillStyle="#000",y.fillText(T,0,P);const B=y.getImageData(0,0,E,D).data,G=B.length,X=E*4;let W=0,j=0,et=!1;for(W=0;W<P;++W){for(let ht=0;ht<X;ht+=4)if(B[j+ht]!==255){et=!0;break}if(!et)j+=X;else break}for(d.ascent=P-W,j=G-X,et=!1,W=D;W>P;--W){for(let ht=0;ht<X;ht+=4)if(B[j+ht]!==255){et=!0;break}if(!et)j-=X;else break}return d.descent=W-P,d.fontSize=d.ascent+d.descent,ge._fonts[u]=d,d}static clearMetrics(u=""){u?delete ge._fonts[u]:ge._fonts={}}static get _canvas(){var u;if(!ge.__canvas){let d;try{const g=new OffscreenCanvas(0,0);if((u=g.getContext("2d",Yi))!=null&&u.measureText)return ge.__canvas=g,g;d=S.Xd.ADAPTER.createCanvas()}catch(g){d=S.Xd.ADAPTER.createCanvas()}d.width=d.height=10,ge.__canvas=d}return ge.__canvas}static get _context(){return ge.__context||(ge.__context=ge._canvas.getContext("2d",Yi)),ge.__context}};Zr.METRICS_STRING="|\xC9q\xC5",Zr.BASELINE_SYMBOL="M",Zr.BASELINE_MULTIPLIER=1.4,Zr.HEIGHT_MULTIPLIER=2,Zr.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const C=new Intl.Segmenter;return u=>[...C.segment(u)].map(d=>d.segment)}return C=>[...C]})(),Zr.experimentalLetterSpacing=!1,Zr._fonts={},Zr._newlines=[10,13],Zr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let gi=Zr;const ms=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],vi=class Nn{constructor(u){this.styleID=0,this.reset(),hi(this,u,u)}clone(){const u={};return hi(u,this,Nn.defaultStyle),new Nn(u)}reset(){hi(this,Nn.defaultStyle,Nn.defaultStyle)}get align(){return this._align}set align(u){this._align!==u&&(this._align=u,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(u){this._breakWords!==u&&(this._breakWords=u,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(u){this._dropShadow!==u&&(this._dropShadow=u,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(u){this._dropShadowAlpha!==u&&(this._dropShadowAlpha=u,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(u){this._dropShadowAngle!==u&&(this._dropShadowAngle=u,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(u){this._dropShadowBlur!==u&&(this._dropShadowBlur=u,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(u){const d=mn(u);this._dropShadowColor!==d&&(this._dropShadowColor=d,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(u){this._dropShadowDistance!==u&&(this._dropShadowDistance=u,this.styleID++)}get fill(){return this._fill}set fill(u){const d=mn(u);this._fill!==d&&(this._fill=d,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(u){this._fillGradientType!==u&&(this._fillGradientType=u,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(u){gn(this._fillGradientStops,u)||(this._fillGradientStops=u,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(u){this.fontFamily!==u&&(this._fontFamily=u,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(u){this._fontSize!==u&&(this._fontSize=u,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(u){this._fontStyle!==u&&(this._fontStyle=u,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(u){this._fontVariant!==u&&(this._fontVariant=u,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(u){this._fontWeight!==u&&(this._fontWeight=u,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(u){this._letterSpacing!==u&&(this._letterSpacing=u,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(u){this._lineHeight!==u&&(this._lineHeight=u,this.styleID++)}get leading(){return this._leading}set leading(u){this._leading!==u&&(this._leading=u,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(u){this._lineJoin!==u&&(this._lineJoin=u,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(u){this._miterLimit!==u&&(this._miterLimit=u,this.styleID++)}get padding(){return this._padding}set padding(u){this._padding!==u&&(this._padding=u,this.styleID++)}get stroke(){return this._stroke}set stroke(u){const d=mn(u);this._stroke!==d&&(this._stroke=d,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(u){this._strokeThickness!==u&&(this._strokeThickness=u,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(u){this._textBaseline!==u&&(this._textBaseline=u,this.styleID++)}get trim(){return this._trim}set trim(u){this._trim!==u&&(this._trim=u,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(u){this._whiteSpace!==u&&(this._whiteSpace=u,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(u){this._wordWrap!==u&&(this._wordWrap=u,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(u){this._wordWrapWidth!==u&&(this._wordWrapWidth=u,this.styleID++)}toFontString(){const u=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let d=this.fontFamily;Array.isArray(this.fontFamily)||(d=this.fontFamily.split(","));for(let g=d.length-1;g>=0;g--){let y=d[g].trim();!/([\"\'])[^\'\"]+\1/.test(y)&&!ms.includes(y)&&(y=`"${y}"`),d[g]=y}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${u} ${d.join(",")}`}};vi.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Os.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let yi=vi;function mn(C){const u=S.Il.shared,d=g=>{const y=u.setValue(g);return y.alpha===1?y.toHex():y.toRgbaString()};return Array.isArray(C)?C.map(d):d(C)}function gn(C,u){if(!Array.isArray(C)||!Array.isArray(u)||C.length!==u.length)return!1;for(let d=0;d<C.length;++d)if(C[d]!==u[d])return!1;return!0}function hi(C,u,d){for(const g in d)Array.isArray(u[g])?C[g]=u[g].slice():C[g]=u[g]}const Ls={texture:!0,children:!1,baseTexture:!0},vn=class Io extends ${constructor(u,d,g){var E;let y=!1;g||(g=S.Xd.ADAPTER.createCanvas(),y=!0),g.width=3,g.height=3;const T=S.xE.from(g);T.orig=new S.Ae,T.trim=new S.Ae,super(T),this._ownCanvas=y,this.canvas=g,this.context=g.getContext("2d",{willReadFrequently:!0}),this._resolution=(E=Io.defaultResolution)!=null?E:S.Xd.RESOLUTION,this._autoResolution=Io.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=u,this.style=d,this.localStyleID=-1}static get experimentalLetterSpacing(){return gi.experimentalLetterSpacing}static set experimentalLetterSpacing(u){S.P6.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),gi.experimentalLetterSpacing=u}updateText(u){const d=this._style;if(this.localStyleID!==d.styleID&&(this.dirty=!0,this.localStyleID=d.styleID),!this.dirty&&u)return;this._font=this._style.toFontString();const g=this.context,y=gi.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),T=y.width,E=y.height,P=y.lines,D=y.lineHeight,B=y.lineWidths,G=y.maxLineWidth,X=y.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,T)+d.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,E)+d.padding*2)*this._resolution),g.scale(this._resolution,this._resolution),g.clearRect(0,0,this.canvas.width,this.canvas.height),g.font=this._font,g.lineWidth=d.strokeThickness,g.textBaseline=d.textBaseline,g.lineJoin=d.lineJoin,g.miterLimit=d.miterLimit;let W,j;const et=d.dropShadow?2:1;for(let ht=0;ht<et;++ht){const wt=d.dropShadow&&ht===0,Tt=wt?Math.ceil(Math.max(1,E)+d.padding*2):0,jt=Tt*this._resolution;if(wt){g.fillStyle="black",g.strokeStyle="black";const kt=d.dropShadowColor,ne=d.dropShadowBlur*this._resolution,Ce=d.dropShadowDistance*this._resolution;g.shadowColor=S.Il.shared.setValue(kt).setAlpha(d.dropShadowAlpha).toRgbaString(),g.shadowBlur=ne,g.shadowOffsetX=Math.cos(d.dropShadowAngle)*Ce,g.shadowOffsetY=Math.sin(d.dropShadowAngle)*Ce+jt}else g.fillStyle=this._generateFillStyle(d,P,y),g.strokeStyle=d.stroke,g.shadowColor="black",g.shadowBlur=0,g.shadowOffsetX=0,g.shadowOffsetY=0;let Rt=(D-X.fontSize)/2;D-X.fontSize<0&&(Rt=0);for(let kt=0;kt<P.length;kt++)W=d.strokeThickness/2,j=d.strokeThickness/2+kt*D+X.ascent+Rt,d.align==="right"?W+=G-B[kt]:d.align==="center"&&(W+=(G-B[kt])/2),d.stroke&&d.strokeThickness&&this.drawLetterSpacing(P[kt],W+d.padding,j+d.padding-Tt,!0),d.fill&&this.drawLetterSpacing(P[kt],W+d.padding,j+d.padding-Tt)}this.updateTexture()}drawLetterSpacing(u,d,g,y=!1){const T=this._style.letterSpacing;let E=!1;if(gi.experimentalLetterSpacingSupported&&(gi.experimentalLetterSpacing?(this.context.letterSpacing=`${T}px`,this.context.textLetterSpacing=`${T}px`,E=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),T===0||E){y?this.context.strokeText(u,d,g):this.context.fillText(u,d,g);return}let P=d;const D=gi.graphemeSegmenter(u);let B=this.context.measureText(u).width,G=0;for(let X=0;X<D.length;++X){const W=D[X];y?this.context.strokeText(W,P,g):this.context.fillText(W,P,g);let j="";for(let et=X+1;et<D.length;++et)j+=D[et];G=this.context.measureText(j).width,P+=B-G+T,B=G}}updateTexture(){const u=this.canvas;if(this._style.trim){const E=S.P6.trimCanvas(u);E.data&&(u.width=E.width,u.height=E.height,this.context.putImageData(E.data,0,0))}const d=this._texture,g=this._style,y=g.trim?0:g.padding,T=d.baseTexture;d.trim.width=d._frame.width=u.width/this._resolution,d.trim.height=d._frame.height=u.height/this._resolution,d.trim.x=-y,d.trim.y=-y,d.orig.width=d._frame.width-y*2,d.orig.height=d._frame.height-y*2,this._onTextureUpdate(),T.setRealSize(u.width,u.height,this._resolution),d.updateUvs(),this.dirty=!1}_render(u){this._autoResolution&&this._resolution!==u.resolution&&(this._resolution=u.resolution,this.dirty=!0),this.updateText(!0),super._render(u)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(u,d){return this.updateText(!0),this._textureID===-1&&(u=!1),super.getBounds(u,d)}getLocalBounds(u){return this.updateText(!0),super.getLocalBounds.call(this,u)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(u,d,g){const y=u.fill;if(Array.isArray(y)){if(y.length===1)return y[0]}else return y;let T;const E=u.dropShadow?u.dropShadowDistance:0,P=u.padding||0,D=this.canvas.width/this._resolution-E-P*2,B=this.canvas.height/this._resolution-E-P*2,G=y.slice(),X=u.fillGradientStops.slice();if(!X.length){const W=G.length+1;for(let j=1;j<W;++j)X.push(j/W)}if(G.unshift(y[0]),X.unshift(0),G.push(y[y.length-1]),X.push(1),u.fillGradientType===Os.LINEAR_VERTICAL){T=this.context.createLinearGradient(D/2,P,D/2,B+P);const W=g.fontProperties.fontSize+u.strokeThickness;for(let j=0;j<d.length;j++){const et=g.lineHeight*(j-1)+W,ht=g.lineHeight*j;let wt=ht;j>0&&et>ht&&(wt=(ht+et)/2);const Tt=ht+W,jt=g.lineHeight*(j+1);let Rt=Tt;j+1<d.length&&jt<Tt&&(Rt=(Tt+jt)/2);const kt=(Rt-wt)/B;for(let ne=0;ne<G.length;ne++){let Ce=0;typeof X[ne]=="number"?Ce=X[ne]:Ce=ne/G.length;let ae=Math.min(1,Math.max(0,wt/B+Ce*kt));ae=Number(ae.toFixed(5)),T.addColorStop(ae,G[ne])}}}else{T=this.context.createLinearGradient(P,B/2,D+P,B/2);const W=G.length+1;let j=1;for(let et=0;et<G.length;et++){let ht;typeof X[et]=="number"?ht=X[et]:ht=j/W,T.addColorStop(ht,G[et]),j++}}return T}destroy(u){typeof u=="boolean"&&(u={children:u}),u=Object.assign({},Ls,u),super.destroy(u),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(u){this.updateText(!0);const d=S.P6.sign(this.scale.x)||1;this.scale.x=d*u/this._texture.orig.width,this._width=u}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(u){this.updateText(!0);const d=S.P6.sign(this.scale.y)||1;this.scale.y=d*u/this._texture.orig.height,this._height=u}get style(){return this._style}set style(u){u=u||{},u instanceof yi?this._style=u:this._style=new yi(u),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(u){u=String(u!=null?u:""),this._text!==u&&(this._text=u,this.dirty=!0)}get resolution(){return this._resolution}set resolution(u){this._autoResolution=!1,this._resolution!==u&&(this._resolution=u,this.dirty=!0)}};vn.defaultAutoResolution=!0;let yn=vn;class ks{constructor(u){this.maxItemsPerFrame=u,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function _n(C,u){var g;let d=!1;if((g=C==null?void 0:C._textures)!=null&&g.length){for(let y=0;y<C._textures.length;y++)if(C._textures[y]instanceof S.xE){const T=C._textures[y].baseTexture;u.includes(T)||(u.push(T),d=!0)}}return d}function Gn(C,u){if(C.baseTexture instanceof S.VL){const d=C.baseTexture;return u.includes(d)||u.push(d),!0}return!1}function _i(C,u){if(C._texture&&C._texture instanceof S.xE){const d=C._texture.baseTexture;return u.includes(d)||u.push(d),!0}return!1}function zn(C,u){return u instanceof yn?(u.updateText(!0),!0):!1}function xn(C,u){if(u instanceof yi){const d=u.toFontString();return gi.measureFont(d),!0}return!1}function Vn(C,u){if(C instanceof yn){u.includes(C.style)||u.push(C.style),u.includes(C)||u.push(C);const d=C._texture.baseTexture;return u.includes(d)||u.push(d),!0}return!1}function Us(C,u){return C instanceof yi?(u.includes(C)||u.push(C),!0):!1}const qe=class Ho{constructor(u){this.limiter=new ks(Ho.uploadsPerFrame),this.renderer=u,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(Vn),this.registerFindHook(Us),this.registerFindHook(_n),this.registerFindHook(Gn),this.registerFindHook(_i),this.registerUploadHook(zn),this.registerUploadHook(xn)}upload(u){return new Promise(d=>{u&&this.add(u),this.queue.length?(this.completes.push(d),this.ticking||(this.ticking=!0,S.vB.system.addOnce(this.tick,this,S.uF.UTILITY))):d()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const u=this.queue[0];let d=!1;if(u&&!u._destroyed){for(let g=0,y=this.uploadHooks.length;g<y;g++)if(this.uploadHooks[g](this.uploadHookHelper,u)){this.queue.shift(),d=!0;break}}d||this.queue.shift()}if(this.queue.length)S.vB.system.addOnce(this.tick,this,S.uF.UTILITY);else{this.ticking=!1;const u=this.completes.slice(0);this.completes.length=0;for(let d=0,g=u.length;d<g;d++)u[d]()}}registerFindHook(u){return u&&this.addHooks.push(u),this}registerUploadHook(u){return u&&this.uploadHooks.push(u),this}add(u){for(let d=0,g=this.addHooks.length;d<g&&!this.addHooks[d](u,this.queue);d++);if(u instanceof mt)for(let d=u.children.length-1;d>=0;d--)this.add(u.children[d]);return this}destroy(){this.ticking&&S.vB.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};qe.uploadsPerFrame=4;let Pi=qe;Object.defineProperties(S.Xd,{UPLOADS_PER_FRAME:{get(){return Pi.uploadsPerFrame},set(C){S.P6.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Pi.uploadsPerFrame=C}}});function bn(C,u){return u instanceof S.VL?(u._glTextures[C.CONTEXT_UID]||C.texture.bind(u),!0):!1}function vo(C,u){if(!(u instanceof cs))return!1;const{geometry:d}=u;u.finishPoly(),d.updateBatches();const{batches:g}=d;for(let y=0;y<g.length;y++){const{texture:T}=g[y].style;T&&bn(C,T.baseTexture)}return d.batchable||C.geometry.bind(d,u._resolveDirectShader(C)),!0}function Hn(C,u){return C instanceof cs?(u.push(C),!0):!1}class Xn extends Pi{constructor(u){super(u),this.uploadHookHelper=this.renderer,this.registerFindHook(Hn),this.registerUploadHook(bn),this.registerUploadHook(vo)}}Xn.extension={name:"prepare",type:S.nw.RendererSystem},S.Rw.add(Xn);class qi extends null{constructor(u,d=!0){super(u[0]instanceof Texture?u[0]:u[0].texture),this._textures=null,this._durations=null,this._autoUpdate=d,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=u}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Ticker.shared.add(this.update,this,UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(u){this.stop(),this.currentFrame=u}gotoAndPlay(u){this.currentFrame=u,this.play()}update(u){if(!this._playing)return;const d=this.animationSpeed*u,g=this.currentFrame;if(this._durations!==null){let y=this._currentTime%1*this._durations[this.currentFrame];for(y+=d/60*1e3;y<0;)this._currentTime--,y+=this._durations[this.currentFrame];const T=Math.sign(this.animationSpeed*u);for(this._currentTime=Math.floor(this._currentTime);y>=this._durations[this.currentFrame];)y-=this._durations[this.currentFrame]*T,this._currentTime+=T;this._currentTime+=y/this._durations[this.currentFrame]}else this._currentTime+=d;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):g!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<g||this.animationSpeed<0&&this.currentFrame>g)&&this.onLoop(),this.updateTexture())}updateTexture(){const u=this.currentFrame;this._previousFrame!==u&&(this._previousFrame=u,this._texture=this._textures[u],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(u){this.stop(),super.destroy(u),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(u){const d=[];for(let g=0;g<u.length;++g)d.push(Texture.from(u[g]));return new qi(d)}static fromImages(u){const d=[];for(let g=0;g<u.length;++g)d.push(Texture.from(u[g]));return new qi(d)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(u){if(u[0]instanceof Texture)this._textures=u,this._durations=null;else{this._textures=[],this._durations=[];for(let d=0;d<u.length;d++)this._textures.push(u[d].texture),this._durations.push(u[d].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let u=Math.floor(this._currentTime)%this._textures.length;return u<0&&(u+=this._textures.length),u}set currentFrame(u){if(u<0||u>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${u}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const d=this.currentFrame;this._currentTime=u,d!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(u){u!==this._autoUpdate&&(this._autoUpdate=u,!this._autoUpdate&&this._isConnectedToTicker?(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const Mi=new S.E9;class Tn extends null{constructor(u,d=100,g=100){super(u),this.tileTransform=new Transform,this._width=d,this._height=g,this.uvMatrix=this.texture.uvMatrix||new TextureMatrix(u),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(u){this.uvMatrix.clampMargin=u,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(u){this.tileTransform.scale.copyFrom(u)}get tilePosition(){return this.tileTransform.position}set tilePosition(u){this.tileTransform.position.copyFrom(u)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(u){const d=this._texture;!d||!d.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),u.batch.setObjectRenderer(u.plugins[this.pluginName]),u.plugins[this.pluginName].render(this))}_calculateBounds(){const u=this._width*-this._anchor._x,d=this._height*-this._anchor._y,g=this._width*(1-this._anchor._x),y=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,u,d,g,y)}getLocalBounds(u){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),u||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),u=this._localBoundsRect),this._bounds.getRectangle(u)):super.getLocalBounds.call(this,u)}containsPoint(u){this.worldTransform.applyInverse(u,Mi);const d=this._width,g=this._height,y=-d*this.anchor._x;if(Mi.x>=y&&Mi.x<y+d){const T=-g*this.anchor._y;if(Mi.y>=T&&Mi.y<T+g)return!0}return!1}destroy(u){super.destroy(u),this.tileTransform=null,this.uvMatrix=null}static from(u,d){const g=u instanceof Texture?u:Texture.from(u,d);return new Tn(g,d.width,d.height)}get width(){return this._width}set width(u){this._width=u}get height(){return this._height}set height(u){this._height=u}}var yo=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,_o=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,jn=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,Gs=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,Wn=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const gs=new S.y3;class wn extends S.bO{constructor(u){super(u),u.runners.contextChange.add(this),this.quad=new S.ud,this.state=S.ZM.for2d()}contextChange(){const u=this.renderer,d={globals:u.globalUniforms};this.simpleShader=S.ex.from(Gs,Wn,d),this.shader=u.context.webGLVersion>1?S.ex.from(_o,yo,d):S.ex.from(Gs,jn,d)}render(u){const d=this.renderer,g=this.quad;let y=g.vertices;y[0]=y[6]=u._width*-u.anchor.x,y[1]=y[3]=u._height*-u.anchor.y,y[2]=y[4]=u._width*(1-u.anchor.x),y[5]=y[7]=u._height*(1-u.anchor.y);const T=u.uvRespectAnchor?u.anchor.x:0,E=u.uvRespectAnchor?u.anchor.y:0;y=g.uvs,y[0]=y[6]=-T,y[1]=y[3]=-E,y[2]=y[4]=1-T,y[5]=y[7]=1-E,g.invalidate();const P=u._texture,D=P.baseTexture,B=D.alphaMode>0,G=u.tileTransform.localTransform,X=u.uvMatrix;let W=D.isPowerOfTwo&&P.frame.width===D.width&&P.frame.height===D.height;W&&(D._glTextures[d.CONTEXT_UID]?W=D.wrapMode!==S.Nt.CLAMP:D.wrapMode===S.Nt.CLAMP&&(D.wrapMode=S.Nt.REPEAT));const j=W?this.simpleShader:this.shader,et=P.width,ht=P.height,wt=u._width,Tt=u._height;gs.set(G.a*et/wt,G.b*et/Tt,G.c*ht/wt,G.d*ht/Tt,G.tx/wt,G.ty/Tt),gs.invert(),W?gs.prepend(X.mapCoord):(j.uniforms.uMapCoord=X.mapCoord.toArray(!0),j.uniforms.uClampFrame=X.uClampFrame,j.uniforms.uClampOffset=X.uClampOffset),j.uniforms.uTransform=gs.toArray(!0),j.uniforms.uColor=S.Il.shared.setValue(u.tint).premultiply(u.worldAlpha,B).toArray(j.uniforms.uColor),j.uniforms.translationMatrix=u.transform.worldTransform.toArray(!0),j.uniforms.uSampler=P,d.shader.bind(j),d.geometry.bind(g),this.state.blendMode=S.P6.correctBlendMode(u.blendMode,B),d.state.set(this.state),d.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}wn.extension={name:"tilingSprite",type:S.nw.RendererPlugin},S.Rw.add(wn);const $n=class Bn{constructor(u,d,g=null){this.linkedSheets=[],this._texture=u instanceof S.xE?u:null,this.baseTexture=u instanceof S.VL?u:this._texture.baseTexture,this.textures={},this.animations={},this.data=d;const y=this.baseTexture.resource;this.resolution=this._updateResolution(g||(y?y.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(u=null){const{scale:d}=this.data.meta;let g=S.P6.getResolutionOfUrl(u,null);return g===null&&(g=parseFloat(d!=null?d:"1")),g!==1&&this.baseTexture.setResolution(g),g}parse(){return new Promise(u=>{this._callback=u,this._batchIndex=0,this._frameKeys.length<=Bn.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(u){let d=u;const g=Bn.BATCH_SIZE;for(;d-u<g&&d<this._frameKeys.length;){const y=this._frameKeys[d],T=this._frames[y],E=T.frame;if(E){let P=null,D=null;const B=T.trimmed!==!1&&T.sourceSize?T.sourceSize:T.frame,G=new S.Ae(0,0,Math.floor(B.w)/this.resolution,Math.floor(B.h)/this.resolution);T.rotated?P=new S.Ae(Math.floor(E.x)/this.resolution,Math.floor(E.y)/this.resolution,Math.floor(E.h)/this.resolution,Math.floor(E.w)/this.resolution):P=new S.Ae(Math.floor(E.x)/this.resolution,Math.floor(E.y)/this.resolution,Math.floor(E.w)/this.resolution,Math.floor(E.h)/this.resolution),T.trimmed!==!1&&T.spriteSourceSize&&(D=new S.Ae(Math.floor(T.spriteSourceSize.x)/this.resolution,Math.floor(T.spriteSourceSize.y)/this.resolution,Math.floor(E.w)/this.resolution,Math.floor(E.h)/this.resolution)),this.textures[y]=new S.xE(this.baseTexture,P,G,D,T.rotated?2:0,T.anchor,T.borders),S.xE.addToCache(this.textures[y],y.toString())}d++}}_processAnimations(){const u=this.data.animations||{};for(const d in u){this.animations[d]=[];for(let g=0;g<u[d].length;g++){const y=u[d][g];this.animations[d].push(this.textures[y])}}}_parseComplete(){const u=this._callback;this._callback=null,this._batchIndex=0,u.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Bn.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Bn.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(u=!1){var d;for(const g in this.textures)this.textures[g].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,u&&((d=this._texture)==null||d.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};$n.BATCH_SIZE=1e3;let Yn=$n;const xo=["jpg","png","jpeg","avif","webp"];function qn(C,u,d){const g={};if(C.forEach(y=>{g[y]=u}),Object.keys(u.textures).forEach(y=>{g[y]=u.textures[y]}),!d){const y=S.P6.path.dirname(C[0]);u.linkedSheets.forEach((T,E)=>{const P=qn([`${y}/${u.data.meta.related_multi_packs[E]}`],T,!0);Object.assign(g,P)})}return g}const Kn={extension:S.nw.Asset,cache:{test:C=>C instanceof Yn,getCacheableAssets:(C,u)=>qn(C,u,!1)},resolver:{test:C=>{const u=C.split("?")[0].split("."),d=u.pop(),g=u.pop();return d==="json"&&xo.includes(g)},parse:C=>{var d,g;const u=C.split(".");return{resolution:parseFloat((g=(d=S.Xd.RETINA_PREFIX.exec(C))==null?void 0:d[1])!=null?g:"1"),format:u[u.length-2],src:C}}},loader:{name:"spritesheetLoader",extension:{type:S.nw.LoadParser,priority:k.Normal},testParse(C,u){return ce(this,null,function*(){return S.P6.path.extname(u.src).toLowerCase()===".json"&&!!C.frames})},parse(C,u,d){return ce(this,null,function*(){var D,B;let g=S.P6.path.dirname(u.src);g&&g.lastIndexOf("/")!==g.length-1&&(g+="/");let y=g+C.meta.image;y=Gr(y,u.src);const T=(yield d.load([y]))[y],E=new Yn(T.baseTexture,C,u.src);yield E.parse();const P=(D=C==null?void 0:C.meta)==null?void 0:D.related_multi_packs;if(Array.isArray(P)){const G=[];for(const W of P){if(typeof W!="string")continue;let j=g+W;(B=u.data)!=null&&B.ignoreMultiPack||(j=Gr(j,u.src),G.push(d.load({src:j,data:{ignoreMultiPack:!0}})))}const X=yield Promise.all(G);E.linkedSheets=X,X.forEach(W=>{W.linkedSheets=[E].concat(E.linkedSheets.filter(j=>j!==W))})}return E})},unload(C){C.destroy(!0)}}};S.Rw.add(Kn);class vs{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class ys{static test(u){return typeof u=="string"&&u.startsWith("info face=")}static parse(u){const d=u.match(/^[a-z]+\s+.+$/gm),g={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const T in d){const E=d[T].match(/^[a-z]+/gm)[0],P=d[T].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),D={};for(const B in P){const G=P[B].split("="),X=G[0],W=G[1].replace(/"/gm,""),j=parseFloat(W),et=isNaN(j)?W:j;D[X]=et}g[E].push(D)}const y=new vs;return g.info.forEach(T=>y.info.push({face:T.face,size:parseInt(T.size,10)})),g.common.forEach(T=>y.common.push({lineHeight:parseInt(T.lineHeight,10)})),g.page.forEach(T=>y.page.push({id:parseInt(T.id,10),file:T.file})),g.char.forEach(T=>y.char.push({id:parseInt(T.id,10),page:parseInt(T.page,10),x:parseInt(T.x,10),y:parseInt(T.y,10),width:parseInt(T.width,10),height:parseInt(T.height,10),xoffset:parseInt(T.xoffset,10),yoffset:parseInt(T.yoffset,10),xadvance:parseInt(T.xadvance,10)})),g.kerning.forEach(T=>y.kerning.push({first:parseInt(T.first,10),second:parseInt(T.second,10),amount:parseInt(T.amount,10)})),g.distanceField.forEach(T=>y.distanceField.push({distanceRange:parseInt(T.distanceRange,10),fieldType:T.fieldType})),y}}class zs{static test(u){const d=u;return typeof u!="string"&&"getElementsByTagName"in u&&d.getElementsByTagName("page").length&&d.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(u){const d=new vs,g=u.getElementsByTagName("info"),y=u.getElementsByTagName("common"),T=u.getElementsByTagName("page"),E=u.getElementsByTagName("char"),P=u.getElementsByTagName("kerning"),D=u.getElementsByTagName("distanceField");for(let B=0;B<g.length;B++)d.info.push({face:g[B].getAttribute("face"),size:parseInt(g[B].getAttribute("size"),10)});for(let B=0;B<y.length;B++)d.common.push({lineHeight:parseInt(y[B].getAttribute("lineHeight"),10)});for(let B=0;B<T.length;B++)d.page.push({id:parseInt(T[B].getAttribute("id"),10)||0,file:T[B].getAttribute("file")});for(let B=0;B<E.length;B++){const G=E[B];d.char.push({id:parseInt(G.getAttribute("id"),10),page:parseInt(G.getAttribute("page"),10)||0,x:parseInt(G.getAttribute("x"),10),y:parseInt(G.getAttribute("y"),10),width:parseInt(G.getAttribute("width"),10),height:parseInt(G.getAttribute("height"),10),xoffset:parseInt(G.getAttribute("xoffset"),10),yoffset:parseInt(G.getAttribute("yoffset"),10),xadvance:parseInt(G.getAttribute("xadvance"),10)})}for(let B=0;B<P.length;B++)d.kerning.push({first:parseInt(P[B].getAttribute("first"),10),second:parseInt(P[B].getAttribute("second"),10),amount:parseInt(P[B].getAttribute("amount"),10)});for(let B=0;B<D.length;B++)d.distanceField.push({fieldType:D[B].getAttribute("fieldType"),distanceRange:parseInt(D[B].getAttribute("distanceRange"),10)});return d}}class Vs{static test(u){return typeof u=="string"&&u.includes("<font>")?zs.test(S.Xd.ADAPTER.parseXML(u)):!1}static parse(u){return zs.parse(S.Xd.ADAPTER.parseXML(u))}}const An=[ys,zs,Vs];function Zn(C){for(let u=0;u<An.length;u++)if(An[u].test(C))return An[u];return null}function Qn(C,u,d,g,y,T){const E=d.fill;if(Array.isArray(E)){if(E.length===1)return E[0]}else return E;let P;const D=d.dropShadow?d.dropShadowDistance:0,B=d.padding||0,G=C.width/g-D-B*2,X=C.height/g-D-B*2,W=E.slice(),j=d.fillGradientStops.slice();if(!j.length){const et=W.length+1;for(let ht=1;ht<et;++ht)j.push(ht/et)}if(W.unshift(E[0]),j.unshift(0),W.push(E[E.length-1]),j.push(1),d.fillGradientType===Os.LINEAR_VERTICAL){P=u.createLinearGradient(G/2,B,G/2,X+B);let et=0;const ht=(T.fontProperties.fontSize+d.strokeThickness)/X;for(let wt=0;wt<y.length;wt++){const Tt=T.lineHeight*wt;for(let jt=0;jt<W.length;jt++){let Rt=0;typeof j[jt]=="number"?Rt=j[jt]:Rt=jt/W.length;const kt=Tt/X+Rt*ht;let ne=Math.max(et,kt);ne=Math.min(ne,1),P.addColorStop(ne,W[jt]),et=ne}}}else{P=u.createLinearGradient(B,X/2,G+B,X/2);const et=W.length+1;let ht=1;for(let wt=0;wt<W.length;wt++){let Tt;typeof j[wt]=="number"?Tt=j[wt]:Tt=ht/et,P.addColorStop(Tt,W[wt]),ht++}}return P}function Jn(C,u,d,g,y,T,E){const P=d.text,D=d.fontProperties;u.translate(g,y),u.scale(T,T);const B=E.strokeThickness/2,G=-(E.strokeThickness/2);if(u.font=E.toFontString(),u.lineWidth=E.strokeThickness,u.textBaseline=E.textBaseline,u.lineJoin=E.lineJoin,u.miterLimit=E.miterLimit,u.fillStyle=Qn(C,u,E,T,[P],d),u.strokeStyle=E.stroke,E.dropShadow){const X=E.dropShadowColor,W=E.dropShadowBlur*T,j=E.dropShadowDistance*T;u.shadowColor=S.Il.shared.setValue(X).setAlpha(E.dropShadowAlpha).toRgbaString(),u.shadowBlur=W,u.shadowOffsetX=Math.cos(E.dropShadowAngle)*j,u.shadowOffsetY=Math.sin(E.dropShadowAngle)*j}else u.shadowColor="black",u.shadowBlur=0,u.shadowOffsetX=0,u.shadowOffsetY=0;E.stroke&&E.strokeThickness&&u.strokeText(P,B,G+d.lineHeight-D.descent),E.fill&&u.fillText(P,B,G+d.lineHeight-D.descent),u.setTransform(1,0,0,1,0,0),u.fillStyle="rgba(0, 0, 0, 0)"}function to(C){return Array.from?Array.from(C):C.split("")}function eo(C){typeof C=="string"&&(C=[C]);const u=[];for(let d=0,g=C.length;d<g;d++){const y=C[d];if(Array.isArray(y)){if(y.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${y.length}.`);const T=y[0].charCodeAt(0),E=y[1].charCodeAt(0);if(E<T)throw new Error("[BitmapFont]: Invalid character range.");for(let P=T,D=E;P<=D;P++)u.push(String.fromCharCode(P))}else u.push(...to(y))}if(u.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return u}function _s(C){return C.codePointAt?C.codePointAt(0):C.charCodeAt(0)}const Pr=class bi{constructor(u,d,g){var G,X;const[y]=u.info,[T]=u.common,[E]=u.page,[P]=u.distanceField,D=S.P6.getResolutionOfUrl(E.file),B={};this._ownsTextures=g,this.font=y.face,this.size=y.size,this.lineHeight=T.lineHeight/D,this.chars={},this.pageTextures=B;for(let W=0;W<u.page.length;W++){const{id:j,file:et}=u.page[W];B[j]=d instanceof Array?d[W]:d[et],P!=null&&P.fieldType&&P.fieldType!=="none"&&(B[j].baseTexture.alphaMode=S.iw.NO_PREMULTIPLIED_ALPHA,B[j].baseTexture.mipmap=S.KI.OFF)}for(let W=0;W<u.char.length;W++){const{id:j,page:et}=u.char[W];let{x:ht,y:wt,width:Tt,height:jt,xoffset:Rt,yoffset:kt,xadvance:ne}=u.char[W];ht/=D,wt/=D,Tt/=D,jt/=D,Rt/=D,kt/=D,ne/=D;const Ce=new S.Ae(ht+B[et].frame.x/D,wt+B[et].frame.y/D,Tt,jt);this.chars[j]={xOffset:Rt,yOffset:kt,xAdvance:ne,kerning:{},texture:new S.xE(B[et].baseTexture,Ce),page:et}}for(let W=0;W<u.kerning.length;W++){let{first:j,second:et,amount:ht}=u.kerning[W];j/=D,et/=D,ht/=D,this.chars[et]&&(this.chars[et].kerning[j]=ht)}this.distanceFieldRange=P==null?void 0:P.distanceRange,this.distanceFieldType=(X=(G=P==null?void 0:P.fieldType)==null?void 0:G.toLowerCase())!=null?X:"none"}destroy(){for(const u in this.chars)this.chars[u].texture.destroy(),this.chars[u].texture=null;for(const u in this.pageTextures)this._ownsTextures&&this.pageTextures[u].destroy(!0),this.pageTextures[u]=null;this.chars=null,this.pageTextures=null}static install(u,d,g){let y;if(u instanceof vs)y=u;else{const E=Zn(u);if(!E)throw new Error("Unrecognized data format for font.");y=E.parse(u)}d instanceof S.xE&&(d=[d]);const T=new bi(y,d,g);return bi.available[T.font]=T,T}static uninstall(u){const d=bi.available[u];if(!d)throw new Error(`No font found named '${u}'`);d.destroy(),delete bi.available[u]}static from(u,d,g){if(!u)throw new Error("[BitmapFont] Property `name` is required.");const ae=Object.assign({},bi.defaultOptions,g),{chars:y,padding:T,resolution:E,textureWidth:P,textureHeight:D}=ae,B=wo(ae,["chars","padding","resolution","textureWidth","textureHeight"]),G=eo(y),X=d instanceof yi?d:new yi(d),W=P,j=new vs;j.info[0]={face:X.fontFamily,size:X.fontSize},j.common[0]={lineHeight:X.fontSize};let et=0,ht=0,wt,Tt,jt,Rt=0;const kt=[],ne=[];for(let oe=0;oe<G.length;oe++){wt||(wt=S.Xd.ADAPTER.createCanvas(),wt.width=P,wt.height=D,Tt=wt.getContext("2d"),jt=new S.VL(wt,Qe({resolution:E},B)),kt.push(jt),ne.push(new S.xE(jt)),j.page.push({id:ne.length-1,file:""}));const Te=G[oe],Pe=gi.measureText(Te,X,!1,wt),Ke=Pe.width,pe=Math.ceil(Pe.height),Ut=Math.ceil((X.fontStyle==="italic"?2:1)*Ke);if(ht>=D-pe*E){if(ht===0)throw new Error(`[BitmapFont] textureHeight ${D}px is too small (fontFamily: '${X.fontFamily}', fontSize: ${X.fontSize}px, char: '${Te}')`);--oe,wt=null,Tt=null,jt=null,ht=0,et=0,Rt=0;continue}if(Rt=Math.max(pe+Pe.fontProperties.descent,Rt),Ut*E+et>=W){if(et===0)throw new Error(`[BitmapFont] textureWidth ${P}px is too small (fontFamily: '${X.fontFamily}', fontSize: ${X.fontSize}px, char: '${Te}')`);--oe,ht+=Rt*E,ht=Math.ceil(ht),et=0,Rt=0;continue}Jn(wt,Tt,Pe,et,ht,E,X);const ie=_s(Pe.text);j.char.push({id:ie,page:ne.length-1,x:et/E,y:ht/E,width:Ut,height:pe,xoffset:0,yoffset:0,xadvance:Ke-(X.dropShadow?X.dropShadowDistance:0)-(X.stroke?X.strokeThickness:0)}),et+=(Ut+2*T)*E,et=Math.ceil(et)}if(!(g!=null&&g.skipKerning))for(let oe=0,Te=G.length;oe<Te;oe++){const Pe=G[oe];for(let Ke=0;Ke<Te;Ke++){const pe=G[Ke],Ut=Tt.measureText(Pe).width,ie=Tt.measureText(pe).width,we=Tt.measureText(Pe+pe).width-(Ut+ie);we&&j.kerning.push({first:_s(Pe),second:_s(pe),amount:we})}}const Ce=new bi(j,ne,!0);return bi.available[u]!==void 0&&bi.uninstall(u),bi.available[u]=Ce,Ce}};Pr.ALPHA=[["a","z"],["A","Z"]," "],Pr.NUMERIC=[["0","9"]],Pr.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Pr.ASCII=[[" ","~"]],Pr.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Pr.ALPHANUMERIC},Pr.available={};let Or=Pr;var ro=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,Ro=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const io=[],En=[],Hs=[],so=class Xo extends mt{constructor(u,d={}){super();const{align:g,tint:y,maxWidth:T,letterSpacing:E,fontName:P,fontSize:D}=Object.assign({},Xo.styleDefaults,d);if(!Or.available[P])throw new Error(`Missing BitmapFont "${P}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=g,this._tintColor=new S.Il(y),this._font=void 0,this._fontName=P,this._fontSize=D,this.text=u,this._maxWidth=T,this._maxLineHeight=0,this._letterSpacing=E,this._anchor=new S.AB(()=>{this.dirty=!0},this,0,0),this._roundPixels=S.Xd.ROUND_PIXELS,this.dirty=!0,this._resolution=S.Xd.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var Ke;const u=Or.available[this._fontName],d=this.fontSize,g=d/u.size,y=new S.E9,T=[],E=[],P=[],D=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",B=to(D),G=this._maxWidth*u.size/d,X=u.distanceFieldType==="none"?io:En;let W=null,j=0,et=0,ht=0,wt=-1,Tt=0,jt=0,Rt=0,kt=0;for(let pe=0;pe<B.length;pe++){const Ut=B[pe],ie=_s(Ut);if(/(?:\s)/.test(Ut)&&(wt=pe,Tt=j,kt++),Ut==="\r"||Ut===`
`){E.push(j),P.push(-1),et=Math.max(et,j),++ht,++jt,y.x=0,y.y+=u.lineHeight,W=null,kt=0;continue}const we=u.chars[ie];if(!we)continue;W&&we.kerning[W]&&(y.x+=we.kerning[W]);const je=Hs.pop()||{texture:S.xE.EMPTY,line:0,charCode:0,prevSpaces:0,position:new S.E9};je.texture=we.texture,je.line=ht,je.charCode=ie,je.position.x=Math.round(y.x+we.xOffset+this._letterSpacing/2),je.position.y=Math.round(y.y+we.yOffset),je.prevSpaces=kt,T.push(je),j=je.position.x+Math.max(we.xAdvance-we.xOffset,we.texture.orig.width),y.x+=we.xAdvance+this._letterSpacing,Rt=Math.max(Rt,we.yOffset+we.texture.height),W=ie,wt!==-1&&G>0&&y.x>G&&(++jt,S.P6.removeItems(T,1+wt-jt,1+pe-wt),pe=wt,wt=-1,E.push(Tt),P.push(T.length>0?T[T.length-1].prevSpaces:0),et=Math.max(et,Tt),ht++,y.x=0,y.y+=u.lineHeight,W=null,kt=0)}const ne=B[B.length-1];ne!=="\r"&&ne!==`
`&&(/(?:\s)/.test(ne)&&(j=Tt),E.push(j),et=Math.max(et,j),P.push(-1));const Ce=[];for(let pe=0;pe<=ht;pe++){let Ut=0;this._align==="right"?Ut=et-E[pe]:this._align==="center"?Ut=(et-E[pe])/2:this._align==="justify"&&(Ut=P[pe]<0?0:(et-E[pe])/P[pe]),Ce.push(Ut)}const ae=T.length,oe={},Te=[],Pe=this._activePagesMeshData;X.push(...Pe);for(let pe=0;pe<ae;pe++){const Ut=T[pe].texture,ie=Ut.baseTexture.uid;if(!oe[ie]){let we=X.pop();if(!we){const be=new pn;let Me,hr;u.distanceFieldType==="none"?(Me=new ps(S.xE.EMPTY),hr=S.T$.NORMAL):(Me=new ps(S.xE.EMPTY,{program:S.$r.from(Ro,ro),uniforms:{uFWidth:0}}),hr=S.T$.NORMAL_NPM);const ur=new Ns(be,Me);ur.blendMode=hr,we={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:ur,vertices:null,uvs:null,indices:null}}we.index=0,we.indexCount=0,we.vertexCount=0,we.uvsCount=0,we.total=0;const{_textureCache:je}=this;je[ie]=je[ie]||new S.xE(Ut.baseTexture),we.mesh.texture=je[ie],we.mesh.tint=this._tintColor.value,Te.push(we),oe[ie]=we}oe[ie].total++}for(let pe=0;pe<Pe.length;pe++)Te.includes(Pe[pe])||this.removeChild(Pe[pe].mesh);for(let pe=0;pe<Te.length;pe++)Te[pe].mesh.parent!==this&&this.addChild(Te[pe].mesh);this._activePagesMeshData=Te;for(const pe in oe){const Ut=oe[pe],ie=Ut.total;if(!(((Ke=Ut.indices)==null?void 0:Ke.length)>6*ie)||Ut.vertices.length<Ns.BATCHABLE_SIZE*2)Ut.vertices=new Float32Array(4*2*ie),Ut.uvs=new Float32Array(4*2*ie),Ut.indices=new Uint16Array(6*ie);else{const we=Ut.total,je=Ut.vertices;for(let be=we*4*2;be<je.length;be++)je[be]=0}Ut.mesh.size=6*ie}for(let pe=0;pe<ae;pe++){const Ut=T[pe];let ie=Ut.position.x+Ce[Ut.line]*(this._align==="justify"?Ut.prevSpaces:1);this._roundPixels&&(ie=Math.round(ie));const we=ie*g,je=Ut.position.y*g,be=Ut.texture,Me=oe[be.baseTexture.uid],hr=be.frame,ur=be._uvs,ke=Me.index++;Me.indices[ke*6+0]=0+ke*4,Me.indices[ke*6+1]=1+ke*4,Me.indices[ke*6+2]=2+ke*4,Me.indices[ke*6+3]=0+ke*4,Me.indices[ke*6+4]=2+ke*4,Me.indices[ke*6+5]=3+ke*4,Me.vertices[ke*8+0]=we,Me.vertices[ke*8+1]=je,Me.vertices[ke*8+2]=we+hr.width*g,Me.vertices[ke*8+3]=je,Me.vertices[ke*8+4]=we+hr.width*g,Me.vertices[ke*8+5]=je+hr.height*g,Me.vertices[ke*8+6]=we,Me.vertices[ke*8+7]=je+hr.height*g,Me.uvs[ke*8+0]=ur.x0,Me.uvs[ke*8+1]=ur.y0,Me.uvs[ke*8+2]=ur.x1,Me.uvs[ke*8+3]=ur.y1,Me.uvs[ke*8+4]=ur.x2,Me.uvs[ke*8+5]=ur.y2,Me.uvs[ke*8+6]=ur.x3,Me.uvs[ke*8+7]=ur.y3}this._textWidth=et*g,this._textHeight=(y.y+u.lineHeight)*g;for(const pe in oe){const Ut=oe[pe];if(this.anchor.x!==0||this.anchor.y!==0){let be=0;const Me=this._textWidth*this.anchor.x,hr=this._textHeight*this.anchor.y;for(let ur=0;ur<Ut.total;ur++)Ut.vertices[be++]-=Me,Ut.vertices[be++]-=hr,Ut.vertices[be++]-=Me,Ut.vertices[be++]-=hr,Ut.vertices[be++]-=Me,Ut.vertices[be++]-=hr,Ut.vertices[be++]-=Me,Ut.vertices[be++]-=hr}this._maxLineHeight=Rt*g;const ie=Ut.mesh.geometry.getBuffer("aVertexPosition"),we=Ut.mesh.geometry.getBuffer("aTextureCoord"),je=Ut.mesh.geometry.getIndex();ie.data=Ut.vertices,we.data=Ut.uvs,je.data=Ut.indices,ie.update(),we.update(),je.update()}for(let pe=0;pe<T.length;pe++)Hs.push(T[pe]);this._font=u,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(u){this._autoResolution&&this._resolution!==u.resolution&&(this._resolution=u.resolution,this.dirty=!0);const{distanceFieldRange:d,distanceFieldType:g,size:y}=Or.available[this._fontName];if(g!=="none"){const{a:T,b:E,c:P,d:D}=this.worldTransform,B=Math.sqrt(T*T+E*E),G=Math.sqrt(P*P+D*D),X=(Math.abs(B)+Math.abs(G))/2,W=this.fontSize/y,j=u._view.resolution;for(const et of this._activePagesMeshData)et.mesh.shader.uniforms.uFWidth=X*d*W*j}super._render(u)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const u=Or.available[this._fontName];if(!u)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==u&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(u){if(this.tint!==u){this._tintColor.setValue(u);for(let d=0;d<this._activePagesMeshData.length;d++)this._activePagesMeshData[d].mesh.tint=u}}get align(){return this._align}set align(u){this._align!==u&&(this._align=u,this.dirty=!0)}get fontName(){return this._fontName}set fontName(u){if(!Or.available[u])throw new Error(`Missing BitmapFont "${u}"`);this._fontName!==u&&(this._fontName=u,this.dirty=!0)}get fontSize(){var u;return(u=this._fontSize)!=null?u:Or.available[this._fontName].size}set fontSize(u){this._fontSize!==u&&(this._fontSize=u,this.dirty=!0)}get anchor(){return this._anchor}set anchor(u){typeof u=="number"?this._anchor.set(u):this._anchor.copyFrom(u)}get text(){return this._text}set text(u){u=String(u!=null?u:""),this._text!==u&&(this._text=u,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(u){this._maxWidth!==u&&(this._maxWidth=u,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(u){this._letterSpacing!==u&&(this._letterSpacing=u,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(u){u!==this._roundPixels&&(this._roundPixels=u,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(u){this._autoResolution=!1,this._resolution!==u&&(this._resolution=u,this.dirty=!0)}destroy(u){const{_textureCache:d}=this,g=Or.available[this._fontName].distanceFieldType==="none"?io:En;g.push(...this._activePagesMeshData);for(const y of this._activePagesMeshData)this.removeChild(y.mesh);this._activePagesMeshData=[],g.filter(y=>d[y.mesh.texture.baseTexture.uid]).forEach(y=>{y.mesh.texture=S.xE.EMPTY});for(const y in d)d[y].destroy(),delete d[y];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(u)}};so.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};let Fo=null;const bo=[".xml",".fnt"],no={extension:{type:S.nw.LoadParser,priority:k.Normal},name:"loadBitmapFont",test(C){return bo.includes(S.P6.path.extname(C).toLowerCase())},testParse(C){return ce(this,null,function*(){return ys.test(C)||Vs.test(C)})},parse(C,u,d){return ce(this,null,function*(){const g=ys.test(C)?ys.parse(C):Vs.parse(C),{src:y}=u,{page:T}=g,E=[];for(let B=0;B<T.length;++B){const G=T[B].file;let X=S.P6.path.join(S.P6.path.dirname(y),G);X=Gr(X,y),E.push(X)}const P=yield d.load(E),D=E.map(B=>P[B]);return Or.install(g,D,!0)})},load(C,u){return ce(this,null,function*(){return(yield S.Xd.ADAPTER.fetch(C)).text()})},unload(C){C.destroy()}};S.Rw.add(no);const Sn=class Ks extends yi{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(u){return new Ks(Object.keys(Ks.defaultOptions).reduce((d,g)=>Ni(Qe({},d),{[g]:u[g]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(u=>{URL.revokeObjectURL(u.src),u.refs--,u.refs===0&&(u.fontFace&&document.fonts.delete(u.fontFace),delete Ks.availableFonts[u.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(u,d={}){const{availableFonts:g}=Ks;if(g[u]){const y=g[u];return this._fonts.push(y),y.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return S.Xd.ADAPTER.fetch(u).then(y=>y.blob()).then(y=>ce(this,null,function*(){return new Promise((T,E)=>{const P=URL.createObjectURL(y),D=new FileReader;D.onload=()=>T([P,D.result]),D.onerror=E,D.readAsDataURL(y)})})).then(E=>ce(this,[E],function*([y,T]){const P=Object.assign({family:S.P6.path.basename(u,S.P6.path.extname(u)),weight:"normal",style:"normal",display:"auto",src:y,dataSrc:T,refs:1,originalUrl:u,fontFace:null},d);g[u]=P,this._fonts.push(P),this.styleID++;const D=new FontFace(P.family,`url(${P.src})`,{weight:P.weight,style:P.style,display:P.display});P.fontFace=D,yield D.load(),document.fonts.add(D),yield document.fonts.ready,this.styleID++,this.fontsDirty=!0}))}addOverride(...u){const d=u.filter(g=>!this._overrides.includes(g));d.length>0&&(this._overrides.push(...d),this.styleID++)}removeOverride(...u){const d=u.filter(g=>this._overrides.includes(g));d.length>0&&(this._overrides=this._overrides.filter(g=>!d.includes(g)),this.styleID++)}toCSS(u){return[`transform: scale(${u})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((u,d)=>`${u}
            @font-face {
                font-family: "${d.family}";
                src: url('${d.dataSrc}');
                font-weight: ${d.weight};
                font-style: ${d.style};
                font-display: ${d.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(u){this._stylesheet!==u&&(this._stylesheet=u,this.styleID++)}normalizeColor(u){return Array.isArray(u)&&(u=S.P6.rgb2hex(u)),typeof u=="number"?S.P6.hex2string(u):u}dropShadowToCSS(){let u=this.normalizeColor(this.dropShadowColor);const d=this.dropShadowAlpha,g=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),y=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);u.startsWith("#")&&d<1&&(u+=(d*255|0).toString(16).padStart(2,"0"));const T=`${g}px ${y}px`;return this.dropShadowBlur>0?`text-shadow: ${T} ${this.dropShadowBlur}px ${u}`:`text-shadow: ${T} ${u}`}reset(){Object.assign(this,Ks.defaultOptions)}onBeforeDraw(){const{fontsDirty:u}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&u?new Promise(d=>setTimeout(d,100)):Promise.resolve()}get isSafari(){const{userAgent:u}=S.Xd.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(u)}set fillGradientStops(u){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(u){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(u){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(u){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(u){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(u){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(u){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};Sn.availableFonts={},Sn.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Cn=Sn;const Xs=class Zs extends ${constructor(u="",d={}){var X;super(S.xE.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const g=new Image,y=S.xE.from(g,{scaleMode:S.Xd.SCALE_MODE,resourceOptions:{autoLoad:!1}});y.orig=new S.Ae,y.trim=new S.Ae,this.texture=y;const T="http://www.w3.org/2000/svg",E="http://www.w3.org/1999/xhtml",P=document.createElementNS(T,"svg"),D=document.createElementNS(T,"foreignObject"),B=document.createElementNS(E,"div"),G=document.createElementNS(E,"style");D.setAttribute("width","10000"),D.setAttribute("height","10000"),D.style.overflow="hidden",P.appendChild(D),this.maxWidth=Zs.defaultMaxWidth,this.maxHeight=Zs.defaultMaxHeight,this._domElement=B,this._styleElement=G,this._svgRoot=P,this._foreignObject=D,this._foreignObject.appendChild(G),this._foreignObject.appendChild(B),this._image=g,this._loadImage=new Image,this._autoResolution=Zs.defaultAutoResolution,this._resolution=(X=Zs.defaultResolution)!=null?X:S.Xd.RESOLUTION,this.text=u,this.style=d}measureText(u){var G,X;const{text:d,style:g,resolution:y}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},u);Object.assign(this._domElement,{innerHTML:d,style:g.toCSS(y)}),this._styleElement.textContent=g.toGlobalCSS(),document.body.appendChild(this._svgRoot);const T=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:E,height:P}=T;(E>this.maxWidth||P>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const D=Math.min(this.maxWidth,Math.ceil(E)),B=Math.min(this.maxHeight,Math.ceil(P));return this._svgRoot.setAttribute("width",D.toString()),this._svgRoot.setAttribute("height",B.toString()),d!==this._text&&(this._domElement.innerHTML=this._text),g!==this._style&&(Object.assign(this._domElement,{style:(G=this._style)==null?void 0:G.toCSS(y)}),this._styleElement.textContent=(X=this._style)==null?void 0:X.toGlobalCSS()),{width:D+g.padding*2,height:B+g.padding*2}}updateText(u=!0){return ce(this,null,function*(){const{style:d,_image:g,_loadImage:y}=this;if(this.localStyleID!==d.styleID&&(this.dirty=!0,this.localStyleID=d.styleID),!this.dirty&&u)return;const{width:T,height:E}=this.measureText();g.width=y.width=Math.ceil(Math.max(1,T)),g.height=y.height=Math.ceil(Math.max(1,E)),this._updateID++;const P=this._updateID;yield new Promise(D=>{y.onload=()=>ce(this,null,function*(){if(P<this._updateID){D();return}yield d.onBeforeDraw(),g.src=y.src,y.onload=null,y.src="",this.updateTexture(),D()});const B=new XMLSerializer().serializeToString(this._svgRoot);y.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(B)}`})})}get source(){return this._image}updateTexture(){const{style:u,texture:d,_image:g,resolution:y}=this,{padding:T}=u,{baseTexture:E}=d;d.trim.width=d._frame.width=g.width/y,d.trim.height=d._frame.height=g.height/y,d.trim.x=-T,d.trim.y=-T,d.orig.width=d._frame.width-T*2,d.orig.height=d._frame.height-T*2,this._onTextureUpdate(),E.setRealSize(g.width,g.height,y),this.dirty=!1}_render(u){this._autoResolution&&this._resolution!==u.resolution&&(this._resolution=u.resolution,this.dirty=!0),this.updateText(!0),super._render(u)}_renderCanvas(u){this._autoResolution&&this._resolution!==u.resolution&&(this._resolution=u.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(u)}getLocalBounds(u){return this.updateText(!0),super.getLocalBounds(u)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(u){var g,y,T,E,P;typeof u=="boolean"&&(u={children:u}),u=Object.assign({},Zs.defaultDestroyOptions,u),super.destroy(u);const d=null;this.ownsStyle&&((g=this._style)==null||g.cleanFonts()),this._style=d,(y=this._svgRoot)==null||y.remove(),this._svgRoot=d,(T=this._domElement)==null||T.remove(),this._domElement=d,(E=this._foreignObject)==null||E.remove(),this._foreignObject=d,(P=this._styleElement)==null||P.remove(),this._styleElement=d,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=d,this._image.src="",this._image=d}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(u){this.updateText(!0);const d=S.P6.sign(this.scale.x)||1;this.scale.x=d*u/this._image.width/this.resolution,this._width=u}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(u){this.updateText(!0);const d=S.P6.sign(this.scale.y)||1;this.scale.y=d*u/this._image.height/this.resolution,this._height=u}get style(){return this._style}set style(u){this._style!==u&&(u=u||{},u instanceof Cn?(this.ownsStyle=!1,this._style=u):u instanceof yi?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Cn.from(u)):(this.ownsStyle=!0,this._style=new Cn(u)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(u){u=String(u===""||u===null||u===void 0?" ":u),u=this.sanitiseText(u),this._text!==u&&(this._text=u,this.dirty=!0)}get resolution(){return this._resolution}set resolution(u){this._autoResolution=!1,this._resolution!==u&&(this._resolution=u,this.dirty=!0)}sanitiseText(u){return u.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};Xs.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Xs.defaultMaxWidth=2024,Xs.defaultMaxHeight=2024,Xs.defaultAutoResolution=!0;let Do=null}},mr={};function $e(Wt){var Kt=mr[Wt];if(Kt!==void 0)return Kt.exports;var dt=mr[Wt]={id:Wt,loaded:!1,exports:{}};return cr[Wt].call(dt.exports,dt,dt.exports,$e),dt.loaded=!0,dt.exports}(function(){$e.n=function(Wt){var Kt=Wt&&Wt.__esModule?function(){return Wt.default}:function(){return Wt};return $e.d(Kt,{a:Kt}),Kt}})(),function(){$e.d=function(Wt,Kt){for(var dt in Kt)$e.o(Kt,dt)&&!$e.o(Wt,dt)&&Object.defineProperty(Wt,dt,{enumerable:!0,get:Kt[dt]})}}(),function(){$e.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(Wt){if(typeof window=="object")return window}}()}(),function(){$e.o=function(Wt,Kt){return Object.prototype.hasOwnProperty.call(Wt,Kt)}}(),function(){$e.r=function(Wt){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(Wt,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Wt,"__esModule",{value:!0})}}(),function(){$e.nmd=function(Wt){return Wt.paths=[],Wt.children||(Wt.children=[]),Wt}}();var Xr=$e(922)})();
